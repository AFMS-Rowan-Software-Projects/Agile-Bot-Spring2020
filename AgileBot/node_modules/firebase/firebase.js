!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).firebase=e()}(this,function(){"use strict";!function(t){if(!t.fetch){var e="URLSearchParams"in t,n="Symbol"in t&&"iterator"in Symbol,s="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),r="FormData"in t,i="ArrayBuffer"in t;if(i)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(t){return t&&DataView.prototype.isPrototypeOf(t)},u=ArrayBuffer.isView||function(t){return t&&-1<o.indexOf(Object.prototype.toString.call(t))};d.prototype.append=function(t,e){t=l(t),e=f(e);var n=this.map[t];this.map[t]=n?n+","+e:e},d.prototype.delete=function(t){delete this.map[l(t)]},d.prototype.get=function(t){return t=l(t),this.has(t)?this.map[t]:null},d.prototype.has=function(t){return this.map.hasOwnProperty(l(t))},d.prototype.set=function(t,e){this.map[l(t)]=f(e)},d.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},d.prototype.keys=function(){var n=[];return this.forEach(function(t,e){n.push(e)}),p(n)},d.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),p(e)},d.prototype.entries=function(){var n=[];return this.forEach(function(t,e){n.push([e,t])}),p(n)},n&&(d.prototype[Symbol.iterator]=d.prototype.entries);var c=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];b.prototype.clone=function(){return new b(this,{body:this._bodyInit})},w.call(b.prototype),w.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new d(this.headers),url:this.url})},E.error=function(){var t=new E(null,{status:0,statusText:""});return t.type="error",t};var h=[301,302,303,307,308];E.redirect=function(t,e){if(-1===h.indexOf(e))throw new RangeError("Invalid status code");return new E(null,{status:e,headers:{location:t}})},t.Headers=d,t.Request=b,t.Response=E,t.fetch=function(i,o){return new Promise(function(n,t){var e=new b(i,o),r=new XMLHttpRequest;r.onload=function(){var t={status:r.status,statusText:r.statusText,headers:function(t){var i=new d;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var e=t.split(":"),n=e.shift().trim();if(n){var r=e.join(":").trim();i.append(n,r)}}),i}(r.getAllResponseHeaders()||"")};t.url="responseURL"in r?r.responseURL:t.headers.get("X-Request-URL");var e="response"in r?r.response:r.responseText;n(new E(e,t))},r.onerror=function(){t(new TypeError("Network request failed"))},r.ontimeout=function(){t(new TypeError("Network request failed"))},r.open(e.method,e.url,!0),"include"===e.credentials?r.withCredentials=!0:"omit"===e.credentials&&(r.withCredentials=!1),"responseType"in r&&s&&(r.responseType="blob"),e.headers.forEach(function(t,e){r.setRequestHeader(e,t)}),r.send(void 0===e._bodyInit?null:e._bodyInit)})},t.fetch.polyfill=!0}function l(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function f(t){return"string"!=typeof t&&(t=String(t)),t}function p(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function d(e){this.map={},e instanceof d?e.forEach(function(t,e){this.append(e,t)},this):Array.isArray(e)?e.forEach(function(t){this.append(t[0],t[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function v(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function y(n){return new Promise(function(t,e){n.onload=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function g(t){var e=new FileReader,n=y(e);return e.readAsArrayBuffer(t),n}function m(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function w(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(s&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(r&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(i&&s&&a(t))this._bodyArrayBuffer=m(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!i||!ArrayBuffer.prototype.isPrototypeOf(t)&&!u(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=m(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},s&&(this.blob=function(){var t=v(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?v(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(g)}),this.text=function(){var t=v(this);if(t)return t;if(this._bodyBlob)return function(t){var e=new FileReader,n=y(e);return e.readAsText(t),n}(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(_)}),this.json=function(){return this.text().then(JSON.parse)},this}function b(t,e){var n=(e=e||{}).body;if(t instanceof b){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new d(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new d(e.headers)),this.method=function(t){var e=t.toUpperCase();return-1<c.indexOf(e)?e:t}(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function _(t){var i=new FormData;return t.trim().split("&").forEach(function(t){if(t){var e=t.split("="),n=e.shift().replace(/\+/g," "),r=e.join("=").replace(/\+/g," ");i.append(decodeURIComponent(n),decodeURIComponent(r))}}),i}function E(t,e){e=e||{},this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new d(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:void 0);var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t,e){return t(e={exports:{}},e.exports),e.exports}function n(t){return t&&t.Math==Math&&t}function y(t){try{return!!t()}catch(t){return!0}}function g(t){return"object"==typeof t?null!==t:"function"==typeof t}function r(t){return l?u.createElement(t):{}}function d(t){if(!g(t))throw TypeError(String(t)+" is not an object");return t}function o(t,e){if(!g(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!g(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!g(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!g(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")}function m(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}function h(e,n){try{_(w,e,n)}catch(t){w[e]=n}return n}function c(t,e){return S.call(t,e)}function a(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++C+N).toString(36)}function i(t){return c(R,t)||(A&&c(O,t)?R[t]=O[t]:R[t]=P("Symbol."+t)),R[t]}var w=n("object"==typeof globalThis&&globalThis)||n("object"==typeof window&&window)||n("object"==typeof self&&self)||n("object"==typeof t&&t)||Function("return this")(),s=!1,f=!y(function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}),u=w.document,l=g(u)&&g(u.createElement),p=!f&&!y(function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}),v=Object.defineProperty,b={f:f?v:function(t,e,n){if(d(t),e=o(e,!0),d(n),p)try{return v(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(t[e]=n.value),t}},_=f?function(t,e,n){return b.f(t,e,m(1,n))}:function(t,e,n){return t[e]=n,t},E="__core-js_shared__",I=w[E]||h(E,{}),T=e(function(t){(t.exports=function(t,e){return I[t]||(I[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.2",mode:"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})}),S={}.hasOwnProperty,C=0,N=Math.random(),A=!!Object.getOwnPropertySymbols&&!y(function(){return!String(Symbol())}),k=A&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,R=T("wks"),O=w.Symbol,P=k?O:O&&O.withoutSetter||a,D={};D[i("toStringTag")]="z";var x="[object z]"===String(D),L=Function.toString;"function"!=typeof I.inspectSource&&(I.inspectSource=function(t){return L.call(t)});function M(t){return W[t]||(W[t]=a(t))}var U,F,j,q=I.inspectSource,V=w.WeakMap,B="function"==typeof V&&/native code/.test(q(V)),W=T("keys"),H={},G=w.WeakMap;if(B){var K=new G,z=K.get,Q=K.has,Y=K.set;U=function(t,e){return Y.call(K,t,e),e},F=function(t){return z.call(K,t)||{}},j=function(t){return Q.call(K,t)}}else{var X=M("state");H[X]=!0,U=function(t,e){return _(t,X,e),e},F=function(t){return c(t,X)?t[X]:{}},j=function(t){return c(t,X)}}function J(t){return tt.call(t).slice(8,-1)}var $={set:U,get:F,has:j,enforce:function(t){return j(t)?F(t):U(t,{})},getterFor:function(n){return function(t){var e;if(!g(t)||(e=F(t)).type!==n)throw TypeError("Incompatible receiver, "+n+" required");return e}}},Z=e(function(t){var e=$.get,a=$.enforce,u=String(String).split("String");(t.exports=function(t,e,n,r){var i=!!r&&!!r.unsafe,o=!!r&&!!r.enumerable,s=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof e||c(n,"name")||_(n,"name",e),a(n).source=u.join("string"==typeof e?e:"")),t!==w?(i?!s&&t[e]&&(o=!0):delete t[e],o?t[e]=n:_(t,e,n)):o?t[e]=n:h(e,n)})(Function.prototype,"toString",function(){return"function"==typeof this&&e(this).source||q(this)})}),tt={}.toString,et=i("toStringTag"),nt="Arguments"==J(function(){return arguments}()),rt=x?J:function(t){var e,n,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),et))?n:nt?J(e):"Object"==(r=J(e))&&"function"==typeof e.callee?"Arguments":r},it=x?{}.toString:function(){return"[object "+rt(this)+"]"};x||Z(Object.prototype,"toString",it,{unsafe:!0});function ot(t){return isNaN(t=+t)?0:(0<t?Et:_t)(t)}function st(t){if(null==t)throw TypeError("Can't call method on "+t);return t}function at(a){return function(t,e){var n,r,i=String(st(t)),o=ot(e),s=i.length;return o<0||s<=o?a?"":void 0:(n=i.charCodeAt(o))<55296||56319<n||o+1===s||(r=i.charCodeAt(o+1))<56320||57343<r?a?i.charAt(o):n:a?i.slice(o,o+2):r-56320+(n-55296<<10)+65536}}function ut(t){return At(st(t))}function ct(t){return"function"==typeof t?t:void 0}function ht(t,e){return arguments.length<2?ct(Ot[t])||ct(w[t]):Ot[t]&&Ot[t][e]||w[t]&&w[t][e]}function lt(t){return 0<t?Pt(ot(t),9007199254740991):0}function ft(a){return function(t,e,n){var r,i=ut(t),o=lt(i.length),s=function(t,e){var n=ot(t);return n<0?Dt(n+e,0):xt(n,e)}(n,o);if(a&&e!=e){for(;s<o;)if((r=i[s++])!=r)return!0}else for(;s<o;s++)if((a||s in i)&&i[s]===e)return a||s||0;return!a&&-1}}function pt(t,e){var n,r=ut(t),i=0,o=[];for(n in r)!c(H,n)&&c(r,n)&&o.push(n);for(;e.length>i;)c(r,n=e[i++])&&(~Lt(o,n)||o.push(n));return o}function dt(t,e){for(var n=qt(e),r=b.f,i=Rt.f,o=0;o<n.length;o++){var s=n[o];c(t,s)||r(t,s,i(e,s))}}function vt(t,e){var n=Wt[Bt(t)];return n==Gt||n!=Ht&&("function"==typeof e?y(e):!!e)}function yt(t,e){var n,r,i,o,s,a=t.target,u=t.global,c=t.stat;if(n=u?w:c?w[a]||h(a,{}):(w[a]||{}).prototype)for(r in e){if(o=e[r],i=t.noTargetGet?(s=zt(n,r))&&s.value:n[r],!Kt(u?r:a+(c?".":"#")+r,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;dt(o,i)}(t.sham||i&&i.sham)&&_(o,"sham",!0),Z(n,r,o,t)}}function gt(t){return Object(st(t))}var mt,wt,bt,_t=Math.ceil,Et=Math.floor,It={codeAt:at(!1),charAt:at(!0)},Tt={}.propertyIsEnumerable,St=Object.getOwnPropertyDescriptor,Ct={f:St&&!Tt.call({1:2},1)?function(t){var e=St(this,t);return!!e&&e.enumerable}:Tt},Nt="".split,At=y(function(){return!Object("z").propertyIsEnumerable(0)})?function(t){return"String"==J(t)?Nt.call(t,""):Object(t)}:Object,kt=Object.getOwnPropertyDescriptor,Rt={f:f?kt:function(t,e){if(t=ut(t),e=o(e,!0),p)try{return kt(t,e)}catch(t){}if(c(t,e))return m(!Ct.f.call(t,e),t[e])}},Ot=w,Pt=Math.min,Dt=Math.max,xt=Math.min,Lt={includes:ft(!0),indexOf:ft(!1)}.indexOf,Mt=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],Ut=Mt.concat("length","prototype"),Ft={f:Object.getOwnPropertyNames||function(t){return pt(t,Ut)}},jt={f:Object.getOwnPropertySymbols},qt=ht("Reflect","ownKeys")||function(t){var e=Ft.f(d(t)),n=jt.f;return n?e.concat(n(t)):e},Vt=/#|\.prototype\./,Bt=vt.normalize=function(t){return String(t).replace(Vt,".").toLowerCase()},Wt=vt.data={},Ht=vt.NATIVE="N",Gt=vt.POLYFILL="P",Kt=vt,zt=Rt.f,Qt=!y(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Yt=M("IE_PROTO"),Xt=Object.prototype,Jt=Qt?Object.getPrototypeOf:function(t){return t=gt(t),c(t,Yt)?t[Yt]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Xt:null},$t=i("iterator"),Zt=!1;[].keys&&("next"in(bt=[].keys())?(wt=Jt(Jt(bt)))!==Object.prototype&&(mt=wt):Zt=!0),null==mt&&(mt={}),c(mt,$t)||_(mt,$t,function(){return this});function te(){}function ee(t){return"<script>"+t+"</"+ue+">"}var ne,re={IteratorPrototype:mt,BUGGY_SAFARI_ITERATORS:Zt},ie=Object.keys||function(t){return pt(t,Mt)},oe=f?Object.defineProperties:function(t,e){d(t);for(var n,r=ie(e),i=r.length,o=0;o<i;)b.f(t,n=r[o++],e[n]);return t},se=ht("document","documentElement"),ae="prototype",ue="script",ce=M("IE_PROTO"),he=function(){try{ne=document.domain&&new ActiveXObject("htmlfile")}catch(t){}he=ne?function(t){t.write(ee("")),t.close();var e=t.parentWindow.Object;return t=null,e}(ne):function(){var t,e=r("iframe");return e.style.display="none",se.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ee("document.F=Object")),t.close(),t.F}();for(var t=Mt.length;t--;)delete he[ae][Mt[t]];return he()};H[ce]=!0;function le(t,e,n){t&&!c(t=n?t:t.prototype,ge)&&ye(t,ge,{configurable:!0,value:e})}function fe(){return this}function pe(){return this}function de(t,e,n,r,i,o,s){function a(t){if(t===i&&v)return v;if(!Ee&&t in p)return p[t];switch(t){case"keys":case Te:case Se:return function(){return new n(this,t)}}return function(){return new n(this)}}!function(t,e,n){var r=e+" Iterator";t.prototype=ve(we,{next:m(1,n)}),le(t,r,!1),me[r]=fe}(n,e,r);var u,c,h,l=e+" Iterator",f=!1,p=t.prototype,d=p[Ie]||p["@@iterator"]||i&&p[i],v=!Ee&&d||a(i),y="Array"==e&&p.entries||d;if(y&&(u=Jt(y.call(new t)),_e!==Object.prototype&&u.next&&(Jt(u)!==_e&&(be?be(u,_e):"function"!=typeof u[Ie]&&_(u,Ie,pe)),le(u,l,!0))),i==Te&&d&&d.name!==Te&&(f=!0,v=function(){return d.call(this)}),p[Ie]!==v&&_(p,Ie,v),me[e]=v,i)if(c={values:a(Te),keys:o?v:a("keys"),entries:a(Se)},s)for(h in c)!Ee&&!f&&h in p||Z(p,h,c[h]);else yt({target:e,proto:!0,forced:Ee||f},c);return c}var ve=Object.create||function(t,e){var n;return null!==t?(te[ae]=d(t),n=new te,te[ae]=null,n[ce]=t):n=he(),void 0===e?n:oe(n,e)},ye=b.f,ge=i("toStringTag"),me={},we=re.IteratorPrototype,be=Object.setPrototypeOf||("__proto__"in{}?function(){var n,r=!1,t={};try{(n=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(t,[]),r=t instanceof Array}catch(t){}return function(t,e){return d(t),function(t){if(!g(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype")}(e),r?n.call(t,e):t.__proto__=e,t}}():void 0),_e=re.IteratorPrototype,Ee=re.BUGGY_SAFARI_ITERATORS,Ie=i("iterator"),Te="values",Se="entries",Ce=It.charAt,Ne="String Iterator",Ae=$.set,ke=$.getterFor(Ne);de(String,"String",function(t){Ae(this,{type:Ne,string:String(t),index:0})},function(){var t,e=ke(this),n=e.string,r=e.index;return r>=n.length?{value:void 0,done:!0}:(t=Ce(n,r),e.index+=t.length,{value:t,done:!1})});var Re={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Oe=i("unscopables"),Pe=Array.prototype;null==Pe[Oe]&&b.f(Pe,Oe,{configurable:!0,value:ve(null)});function De(t){Pe[Oe][t]=!0}var xe="Array Iterator",Le=$.set,Me=$.getterFor(xe),Ue=de(Array,"Array",function(t,e){Le(this,{type:xe,target:ut(t),index:0,kind:e})},function(){var t=Me(this),e=t.target,n=t.kind,r=t.index++;return!e||r>=e.length?{value:t.target=void 0,done:!0}:"keys"==n?{value:r,done:!1}:"values"==n?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}},"values");me.Arguments=me.Array,De("keys"),De("values"),De("entries");var Fe=i("iterator"),je=i("toStringTag"),qe=Ue.values;for(var Ve in Re){var Be=w[Ve],We=Be&&Be.prototype;if(We){if(We[Fe]!==qe)try{_(We,Fe,qe)}catch(eu){We[Fe]=qe}if(We[je]||_(We,je,Ve),Re[Ve])for(var He in Ue)if(We[He]!==Ue[He])try{_(We,He,Ue[He])}catch(eu){We[He]=Ue[He]}}}function Ge(t,e,n){for(var r in e)Z(t,r,e[r],n);return t}function Ke(t){var e=ht(t),n=b.f;f&&e&&!e[tn]&&n(e,tn,{configurable:!0,get:function(){return this}})}function ze(t){if("function"!=typeof t)throw TypeError(String(t)+" is not a function");return t}function Qe(t,e,n){if(!(t instanceof e))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return t}function Ye(t){return void 0!==t&&(me.Array===t||nn[en]===t)}function Xe(r,i,t){if(ze(r),void 0===i)return r;switch(t){case 0:return function(){return r.call(i)};case 1:return function(t){return r.call(i,t)};case 2:return function(t,e){return r.call(i,t,e)};case 3:return function(t,e,n){return r.call(i,t,e,n)}}return function(){return r.apply(i,arguments)}}function Je(t){if(null!=t)return t[rn]||t["@@iterator"]||me[rt(t)]}function $e(e,t,n,r){try{return r?t(d(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&d(i.call(e)),t}}var Ze=w.Promise,tn=i("species"),en=i("iterator"),nn=Array.prototype,rn=i("iterator"),on=e(function(t){function p(t,e){this.stopped=t,this.result=e}(t.exports=function(t,e,n,r,i){var o,s,a,u,c,h,l,f=Xe(e,n,r?2:1);if(i)o=t;else{if("function"!=typeof(s=Je(t)))throw TypeError("Target is not iterable");if(Ye(s)){for(a=0,u=lt(t.length);a<u;a++)if((c=r?f(d(l=t[a])[0],l[1]):f(t[a]))&&c instanceof p)return c;return new p(!1)}o=s.call(t)}for(h=o.next;!(l=h.call(o)).done;)if("object"==typeof(c=$e(o,f,l.value,r))&&c&&c instanceof p)return c;return new p(!1)}).stop=function(t){return new p(!0,t)}}),sn=i("iterator"),an=!1;try{var un=0,cn={next:function(){return{done:!!un++}},return:function(){an=!0}};cn[sn]=function(){return this},Array.from(cn,function(){throw 2})}catch(eu){}function hn(t,e){if(!e&&!an)return!1;var n=!1;try{var r={};r[sn]=function(){return{next:function(){return{done:n=!0}}}},t(r)}catch(t){}return n}function ln(t,e){var n,r=d(t).constructor;return void 0===r||null==(n=d(r)[wn])?e:ze(n)}function fn(t){if(kn.hasOwnProperty(t)){var e=kn[t];delete kn[t],e()}}function pn(t){return function(){fn(t)}}function dn(t){fn(t.data)}function vn(t){w.postMessage(t+"",En.protocol+"//"+En.host)}var yn,gn,mn,wn=i("species"),bn=ht("navigator","userAgent")||"",_n=/(iphone|ipod|ipad).*applewebkit/i.test(bn),En=w.location,In=w.setImmediate,Tn=w.clearImmediate,Sn=w.process,Cn=w.MessageChannel,Nn=w.Dispatch,An=0,kn={},Rn="onreadystatechange";In&&Tn||(In=function(t){for(var e=[],n=1;n<arguments.length;)e.push(arguments[n++]);return kn[++An]=function(){("function"==typeof t?t:Function(t)).apply(void 0,e)},yn(An),An},Tn=function(t){delete kn[t]},"process"==J(Sn)?yn=function(t){Sn.nextTick(pn(t))}:Nn&&Nn.now?yn=function(t){Nn.now(pn(t))}:Cn&&!_n?(mn=(gn=new Cn).port2,gn.port1.onmessage=dn,yn=Xe(mn.postMessage,mn,1)):!w.addEventListener||"function"!=typeof postMessage||w.importScripts||y(vn)?yn=Rn in r("script")?function(t){se.appendChild(r("script"))[Rn]=function(){se.removeChild(this),fn(t)}}:function(t){setTimeout(pn(t),0)}:(yn=vn,w.addEventListener("message",dn,!1)));var On,Pn,Dn,xn,Ln,Mn,Un,Fn,jn={set:In,clear:Tn},qn=Rt.f,Vn=jn.set,Bn=w.MutationObserver||w.WebKitMutationObserver,Wn=w.process,Hn=w.Promise,Gn="process"==J(Wn),Kn=qn(w,"queueMicrotask"),zn=Kn&&Kn.value;zn||(On=function(){var t,e;for(Gn&&(t=Wn.domain)&&t.exit();Pn;){e=Pn.fn,Pn=Pn.next;try{e()}catch(t){throw Pn?xn():Dn=void 0,t}}Dn=void 0,t&&t.enter()},xn=Gn?function(){Wn.nextTick(On)}:Bn&&!_n?(Ln=!0,Mn=document.createTextNode(""),new Bn(On).observe(Mn,{characterData:!0}),function(){Mn.data=Ln=!Ln}):Hn&&Hn.resolve?(Un=Hn.resolve(void 0),Fn=Un.then,function(){Fn.call(Un,On)}):function(){Vn.call(w,On)});function Qn(t){var n,r;this.promise=new t(function(t,e){if(void 0!==n||void 0!==r)throw TypeError("Bad Promise constructor");n=t,r=e}),this.resolve=ze(n),this.reject=ze(r)}function Yn(t,e){if(d(t),g(e)&&e.constructor===t)return e;var n=tr.f(t);return(0,n.resolve)(e),n.promise}function Xn(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}}var Jn,$n,Zn=zn||function(t){var e={fn:t,next:void 0};Dn&&(Dn.next=e),Pn||(Pn=e,xn()),Dn=e},tr={f:function(t){return new Qn(t)}},er=w.process,nr=er&&er.versions,rr=nr&&nr.v8;rr?$n=(Jn=rr.split("."))[0]+Jn[1]:bn&&(!(Jn=bn.match(/Edge\/(\d+)/))||74<=Jn[1])&&(Jn=bn.match(/Chrome\/(\d+)/))&&($n=Jn[1]);function ir(t){var e;return!(!g(t)||"function"!=typeof(e=t.then))&&e}function or(l,f,p){if(!f.notified){f.notified=!0;var d=f.reactions;Zn(function(){for(var t=f.value,e=1==f.state,n=0;d.length>n;){var r,i,o,s=d[n++],a=e?s.ok:s.fail,u=s.resolve,c=s.reject,h=s.domain;try{a?(e||(2===f.rejection&&xr(l,f),f.rejection=1),!0===a?r=t:(h&&h.enter(),r=a(t),h&&(h.exit(),o=!0)),r===s.promise?c(_r("Promise-chain cycle")):(i=ir(r))?i.call(r,u,c):u(r)):c(t)}catch(t){h&&!o&&h.exit(),c(t)}}f.reactions=[],f.notified=!1,p&&!f.rejection&&Pr(l,f)})}}function sr(t,e,n){var r,i;Ar?((r=Er.createEvent("Event")).promise=e,r.reason=n,r.initEvent(t,!1,!0),w.dispatchEvent(r)):r={promise:e,reason:n},(i=w["on"+t])?i(r):t===kr&&function(t,e){var n=w.console;n&&n.error&&(1===arguments.length?n.error(t):n.error(t,e))}("Unhandled promise rejection",n)}function ar(e,n,r,i){return function(t){e(n,r,t,i)}}function ur(t,e,n,r){e.done||(e.done=!0,r&&(e=r),e.value=n,e.state=2,or(t,e,!0))}var cr,hr,lr,fr,pr=$n&&+$n,dr=jn.set,vr=i("species"),yr="Promise",gr=$.get,mr=$.set,wr=$.getterFor(yr),br=Ze,_r=w.TypeError,Er=w.document,Ir=w.process,Tr=ht("fetch"),Sr=tr.f,Cr=Sr,Nr="process"==J(Ir),Ar=!!(Er&&Er.createEvent&&w.dispatchEvent),kr="unhandledrejection",Rr=Kt(yr,function(){if(!(q(br)!==String(br))){if(66===pr)return!0;if(!Nr&&"function"!=typeof PromiseRejectionEvent)return!0}if(51<=pr&&/native code/.test(br))return!1;function t(t){t(function(){},function(){})}var e=br.resolve(1);return(e.constructor={})[vr]=t,!(e.then(function(){})instanceof t)}),Or=Rr||!hn(function(t){br.all(t).catch(function(){})}),Pr=function(n,r){dr.call(w,function(){var t,e=r.value;if(Dr(r)&&(t=Xn(function(){Nr?Ir.emit("unhandledRejection",e,n):sr(kr,n,e)}),r.rejection=Nr||Dr(r)?2:1,t.error))throw t.value})},Dr=function(t){return 1!==t.rejection&&!t.parent},xr=function(t,e){dr.call(w,function(){Nr?Ir.emit("rejectionHandled",t):sr("rejectionhandled",t,e.value)})},Lr=function(n,r,t,e){if(!r.done){r.done=!0,e&&(r=e);try{if(n===t)throw _r("Promise can't be resolved itself");var i=ir(t);i?Zn(function(){var e={done:!1};try{i.call(t,ar(Lr,n,e,r),ar(ur,n,e,r))}catch(t){ur(n,e,t,r)}}):(r.value=t,r.state=1,or(n,r,!1))}catch(t){ur(n,{done:!1},t,r)}}};Rr&&(br=function(t){Qe(this,br,yr),ze(t),cr.call(this);var e=gr(this);try{t(ar(Lr,this,e),ar(ur,this,e))}catch(t){ur(this,e,t)}},(cr=function(t){mr(this,{type:yr,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Ge(br.prototype,{then:function(t,e){var n=wr(this),r=Sr(ln(this,br));return r.ok="function"!=typeof t||t,r.fail="function"==typeof e&&e,r.domain=Nr?Ir.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&or(this,n,!1),r.promise},catch:function(t){return this.then(void 0,t)}}),hr=function(){var t=new cr,e=gr(t);this.promise=t,this.resolve=ar(Lr,t,e),this.reject=ar(ur,t,e)},tr.f=Sr=function(t){return t===br||t===lr?new hr(t):Cr(t)},"function"==typeof Ze&&(fr=Ze.prototype.then,Z(Ze.prototype,"then",function(t,e){var n=this;return new br(function(t,e){fr.call(n,t,e)}).then(t,e)},{unsafe:!0}),"function"==typeof Tr&&yt({global:!0,enumerable:!0,forced:!0},{fetch:function(t){return Yn(br,Tr.apply(w,arguments))}}))),yt({global:!0,wrap:!0,forced:Rr},{Promise:br}),le(br,yr,!1),Ke(yr),lr=ht(yr),yt({target:yr,stat:!0,forced:Rr},{reject:function(t){var e=Sr(this);return e.reject.call(void 0,t),e.promise}}),yt({target:yr,stat:!0,forced:Rr},{resolve:function(t){return Yn(this,t)}}),yt({target:yr,stat:!0,forced:Or},{all:function(t){var a=this,e=Sr(a),u=e.resolve,c=e.reject,n=Xn(function(){var r=ze(a.resolve),i=[],o=0,s=1;on(t,function(t){var e=o++,n=!1;i.push(void 0),s++,r.call(a,t).then(function(t){n||(n=!0,i[e]=t,--s||u(i))},c)}),--s||u(i)});return n.error&&c(n.value),e.promise},race:function(t){var n=this,r=Sr(n),i=r.reject,e=Xn(function(){var e=ze(n.resolve);on(t,function(t){e.call(n,t).then(r.resolve,i)})});return e.error&&i(e.value),r.promise}}),yt({target:"Promise",stat:!0},{allSettled:function(t){var a=this,e=tr.f(a),u=e.resolve,n=e.reject,r=Xn(function(){var r=ze(a.resolve),i=[],o=0,s=1;on(t,function(t){var e=o++,n=!1;i.push(void 0),s++,r.call(a,t).then(function(t){n||(n=!0,i[e]={status:"fulfilled",value:t},--s||u(i))},function(t){n||(n=!0,i[e]={status:"rejected",reason:t},--s||u(i))})}),--s||u(i)});return r.error&&n(r.value),e.promise}});var Mr=!!Ze&&y(function(){Ze.prototype.finally.call({then:function(){}},function(){})});yt({target:"Promise",proto:!0,real:!0,forced:Mr},{finally:function(e){var n=ln(this,ht("Promise")),t="function"==typeof e;return this.then(t?function(t){return Yn(n,e()).then(function(){return t})}:e,t?function(t){return Yn(n,e()).then(function(){throw t})}:e)}}),"function"!=typeof Ze||Ze.prototype.finally||Z(Ze.prototype,"finally",ht("Promise").prototype.finally);Ot.Promise;var Ur=$.set,Fr=$.getterFor("AggregateError"),jr=function(t,e){var n=this;if(!(n instanceof jr))return new jr(t,e);be&&(n=be(new Error(e),Jt(n)));var r=[];return on(t,r.push,r),f?Ur(n,{errors:r,type:"AggregateError"}):n.errors=r,void 0!==e&&_(n,"message",String(e)),n};jr.prototype=ve(Error.prototype,{constructor:m(5,jr),message:m(5,""),name:m(5,"AggregateError")}),f&&b.f(jr.prototype,"errors",{get:function(){return Fr(this).errors},configurable:!0}),yt({global:!0},{AggregateError:jr}),yt({target:"Promise",stat:!0},{try:function(t){var e=tr.f(this),n=Xn(t);return(n.error?e.reject:e.resolve)(n.value),e.promise}});var qr="No one promise resolved";yt({target:"Promise",stat:!0},{any:function(t){var u=this,e=tr.f(u),c=e.resolve,h=e.reject,n=Xn(function(){var r=ze(u.resolve),i=[],o=0,s=1,a=!1;on(t,function(t){var e=o++,n=!1;i.push(void 0),s++,r.call(u,t).then(function(t){n||a||(a=!0,c(t))},function(t){n||a||(n=!0,i[e]=t,--s||h(new(ht("AggregateError"))(i,qr)))})}),--s||h(new(ht("AggregateError"))(i,qr))});return n.error&&h(n.value),e.promise}});function Vr(t,e){var n;return Gr(t)&&("function"!=typeof(n=t.constructor)||n!==Array&&!Gr(n.prototype)?g(n)&&null===(n=n[Kr])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===e?0:e)}function Br(p){var d=1==p,v=2==p,y=3==p,g=4==p,m=6==p,w=5==p||m;return function(t,e,n,r){for(var i,o,s=gt(t),a=At(s),u=Xe(e,n,3),c=lt(a.length),h=0,l=r||Vr,f=d?l(t,c):v?l(t,0):void 0;h<c;h++)if((w||h in a)&&(o=u(i=a[h],h,s),p))if(d)f[h]=o;else if(o)switch(p){case 3:return!0;case 5:return i;case 6:return h;case 2:zr.call(f,i)}else if(g)return!1;return m?-1:y||g?g:f}}function Wr(t){throw t}function Hr(t,e){var n=[][t],r=!!c(e=e||{},"ACCESSORS")&&e.ACCESSORS,i=c(e,0)?e[0]:Wr,o=c(e,1)?e[1]:void 0;return!!n&&!y(function(){if(r&&!f)return!0;function t(t){r?Yr(e,t,{enumerable:!0,get:Wr}):e[t]=1}var e={length:-1};t(1),t(2147483646),t(4294967294),n.call(e,i,o)})}var Gr=Array.isArray||function(t){return"Array"==J(t)},Kr=i("species"),zr=[].push,Qr={forEach:Br(0),map:Br(1),filter:Br(2),some:Br(3),every:Br(4),find:Br(5),findIndex:Br(6)},Yr=Object.defineProperty,Xr=Qr.find,Jr="find",$r=!0,Zr=Hr(Jr);Jr in[]&&Array(1)[Jr](function(){$r=!1}),yt({target:"Array",proto:!0,forced:$r||!Zr},{find:function(t,e){return Xr(this,t,1<arguments.length?e:void 0)}}),De(Jr);function ti(t,e,n){return Xe(ei,w[t].prototype[e],n)}var ei=Function.call,ni=(ti("Array","find"),Qr.findIndex),ri="findIndex",ii=!0,oi=Hr(ri);ri in[]&&Array(1)[ri](function(){ii=!1}),yt({target:"Array",proto:!0,forced:ii||!oi},{findIndex:function(t,e){return ni(this,t,1<arguments.length?e:void 0)}}),De(ri);function si(t,e,n){var r=o(e);r in t?b.f(t,r,m(0,n)):t[r]=n}ti("Array","findIndex");var ai=!hn(function(t){Array.from(t)});yt({target:"Array",stat:!0,forced:ai},{from:function(t,e,n){var r,i,o,s,a,u,c=gt(t),h="function"==typeof this?this:Array,l=arguments.length,f=1<l?e:void 0,p=void 0!==f,d=Je(c),v=0;if(p&&(f=Xe(f,2<l?n:void 0,2)),null==d||h==Array&&Ye(d))for(i=new h(r=lt(c.length));v<r;v++)u=p?f(c[v],v):c[v],si(i,v,u);else for(a=(s=d.call(c)).next,i=new h;!(o=a.call(s)).done;v++)u=p?$e(s,f,[o.value,v],!0):o.value,si(i,v,u);return i.length=v,i}});Ot.Array.from;var ui,ci,hi=Qr.some,li=!!(ci=[]["some"])&&y(function(){ci.call(null,ui||function(){throw 1},1)}),fi=Hr("some");yt({target:"Array",proto:!0,forced:!li||!fi},{some:function(t,e){return hi(this,t,1<arguments.length?e:void 0)}});ti("Array","some");function pi(t){return g(t)&&c(Ni,rt(t))}var di,vi="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView,yi=b.f,gi=w.Int8Array,mi=gi&&gi.prototype,wi=w.Uint8ClampedArray,bi=wi&&wi.prototype,_i=gi&&Jt(gi),Ei=mi&&Jt(mi),Ii=Object.prototype,Ti=(Ii.isPrototypeOf,i("toStringTag")),Si=a("TYPED_ARRAY_TAG"),Ci=vi&&!!be&&"Opera"!==rt(w.opera),Ni={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8};for(di in Ni)w[di]||(Ci=!1);if((!Ci||"function"!=typeof _i||_i===Function.prototype)&&(_i=function(){throw TypeError("Incorrect invocation")},Ci))for(di in Ni)w[di]&&be(w[di],_i);if((!Ci||!Ei||Ei===Ii)&&(Ei=_i.prototype,Ci))for(di in Ni)w[di]&&be(w[di].prototype,Ei);if(Ci&&Jt(bi)!==Ei&&be(bi,Ei),f&&!c(Ei,Ti))for(di in!0,yi(Ei,Ti,{get:function(){return g(this)?this[Si]:void 0}}),Ni)w[di]&&_(w[di],Si,di);function Ai(){return Di.call(Mi(this))}var ki=function(t){if(pi(t))return t;throw TypeError("Target is not a typed array")},Ri=function(t,e,n){if(f){if(n)for(var r in Ni){var i=w[r];i&&c(i.prototype,t)&&delete i.prototype[t]}Ei[t]&&!n||Z(Ei,t,n?e:Ci&&mi[t]||e)}},Oi=i("iterator"),Pi=w.Uint8Array,Di=Ue.values,xi=Ue.keys,Li=Ue.entries,Mi=ki,Ui=Ri,Fi=Pi&&Pi.prototype[Oi],ji=!!Fi&&("values"==Fi.name||null==Fi.name);Ui("entries",function(){return Li.call(Mi(this))}),Ui("keys",function(){return xi.call(Mi(this))}),Ui("values",Ai,!ji),Ui(Oi,Ai,!ji);var qi=Object.assign,Vi=Object.defineProperty,Bi=!qi||y(function(){if(f&&1!==qi({b:1},qi(Vi({},"a",{enumerable:!0,get:function(){Vi(this,"b",{value:3,enumerable:!1})}}),{b:2})).b)return!0;var t={},e={},n=Symbol(),r="abcdefghijklmnopqrst";return t[n]=7,r.split("").forEach(function(t){e[t]=t}),7!=qi({},t)[n]||ie(qi({},e)).join("")!=r})?function(t,e){for(var n=gt(t),r=arguments.length,i=1,o=jt.f,s=Ct.f;i<r;)for(var a,u=At(arguments[i++]),c=o?ie(u).concat(o(u)):ie(u),h=c.length,l=0;l<h;)a=c[l++],f&&!s.call(u,a)||(n[a]=u[a]);return n}:qi;yt({target:"Object",stat:!0,forced:Object.assign!==Bi},{assign:Bi});Ot.Object.assign;function Wi(a){return function(t){for(var e,n=ut(t),r=ie(n),i=r.length,o=0,s=[];o<i;)e=r[o++],f&&!Hi.call(n,e)||s.push(a?[e,n[e]]:n[e]);return s}}var Hi=Ct.f,Gi={entries:Wi(!0),values:Wi(!1)},Ki=Gi.entries;yt({target:"Object",stat:!0},{entries:function(t){return Ki(t)}});Ot.Object.entries;var zi=Gi.values;yt({target:"Object",stat:!0},{values:function(t){return zi(t)}});Ot.Object.values;function Qi(t){if(function(t){var e;return g(t)&&(void 0!==(e=t[Xi])?!!e:"RegExp"==J(t))}(t))throw TypeError("The method doesn't accept regular expressions");return t}function Yi(e){var n=/./;try{"/./"[e](n)}catch(t){try{return n[Ji]=!1,"/./"[e](n)}catch(t){}}return!1}var Xi=i("match"),Ji=i("match");yt({target:"String",proto:!0,forced:!Yi("includes")},{includes:function(t,e){return!!~String(st(this)).indexOf(Qi(t),1<arguments.length?e:void 0)}});ti("String","includes");var $i,Zi=Rt.f,to="".startsWith,eo=Math.min,no=Yi("startsWith"),ro=!(no||(!($i=Zi(String.prototype,"startsWith"))||$i.writable));yt({target:"String",proto:!0,forced:!ro&&!no},{startsWith:function(t,e){var n=String(st(this));Qi(t);var r=lt(eo(1<arguments.length?e:void 0,n.length)),i=String(t);return to?to.call(n,i,r):n.slice(r,r+i.length)===i}});ti("String","startsWith");yt({target:"String",proto:!0},{repeat:"".repeat||function(t){var e=String(st(this)),n="",r=ot(t);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;0<r;(r>>>=1)&&(e+=e))1&r&&(n+=e);return n}});ti("String","repeat");function io(t){if(!g(t))return!1;var e=t[ao];return void 0!==e?!!e:Gr(t)}var oo,so=i("species"),ao=i("isConcatSpreadable"),uo=9007199254740991,co="Maximum allowed index exceeded",ho=51<=pr||!y(function(){var t=[];return t[ao]=!1,t.concat()[0]!==t}),lo=(oo="concat",51<=pr||!y(function(){var t=[];return(t.constructor={})[so]=function(){return{foo:1}},1!==t[oo](Boolean).foo}));yt({target:"Array",proto:!0,forced:!ho||!lo},{concat:function(t){var e,n,r,i,o,s=gt(this),a=Vr(s,0),u=0;for(e=-1,r=arguments.length;e<r;e++)if(io(o=-1===e?s:arguments[e])){if(i=lt(o.length),uo<u+i)throw TypeError(co);for(n=0;n<i;n++,u++)n in o&&si(a,u,o[n])}else{if(uo<=u)throw TypeError(co);si(a,u++,o)}return a.length=u,a}});function fo(t){var e=Ot.Symbol||(Ot.Symbol={});c(e,t)||Io(e,t,{value:Eo.f(t)})}function po(t,e){var n=Fo[t]=ve(Po[No]);return ko(n,{type:Co,tag:t,description:e}),f||(n.description=e),n}function vo(e,t){d(e);var n=ut(t),r=ie(n).concat(Yo(n));return To(r,function(t){f&&!Qo.call(n,t)||zo(e,t,n[t])}),e}function yo(t,e){var n=ut(t),r=o(e,!0);if(n!==Oo||!c(Fo,r)||c(jo,r)){var i=xo(n,r);return!i||!c(Fo,r)||c(n,So)&&n[So][r]||(i.enumerable=!0),i}}function go(t){var e=Mo(ut(t)),n=[];return To(e,function(t){c(Fo,t)||c(H,t)||n.push(t)}),n}var mo=Ft.f,wo={}.toString,bo="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_o={f:function(t){return bo&&"[object Window]"==wo.call(t)?function(t){try{return mo(t)}catch(t){return bo.slice()}}(t):mo(ut(t))}},Eo={f:i},Io=b.f,To=Qr.forEach,So=M("hidden"),Co="Symbol",No="prototype",Ao=i("toPrimitive"),ko=$.set,Ro=$.getterFor(Co),Oo=Object[No],Po=w.Symbol,Do=ht("JSON","stringify"),xo=Rt.f,Lo=b.f,Mo=_o.f,Uo=Ct.f,Fo=T("symbols"),jo=T("op-symbols"),qo=T("string-to-symbol-registry"),Vo=T("symbol-to-string-registry"),Bo=T("wks"),Wo=w.QObject,Ho=!Wo||!Wo[No]||!Wo[No].findChild,Go=f&&y(function(){return 7!=ve(Lo({},"a",{get:function(){return Lo(this,"a",{value:7}).a}})).a})?function(t,e,n){var r=xo(Oo,e);r&&delete Oo[e],Lo(t,e,n),r&&t!==Oo&&Lo(Oo,e,r)}:Lo,Ko=k?function(t){return"symbol"==typeof t}:function(t){return Object(t)instanceof Po},zo=function(t,e,n){t===Oo&&zo(jo,e,n),d(t);var r=o(e,!0);return d(n),c(Fo,r)?(n.enumerable?(c(t,So)&&t[So][r]&&(t[So][r]=!1),n=ve(n,{enumerable:m(0,!1)})):(c(t,So)||Lo(t,So,m(1,{})),t[So][r]=!0),Go(t,r,n)):Lo(t,r,n)},Qo=function(t){var e=o(t,!0),n=Uo.call(this,e);return!(this===Oo&&c(Fo,e)&&!c(jo,e))&&(!(n||!c(this,e)||!c(Fo,e)||c(this,So)&&this[So][e])||n)},Yo=function(t){var e=t===Oo,n=Mo(e?jo:ut(t)),r=[];return To(n,function(t){!c(Fo,t)||e&&!c(Oo,t)||r.push(Fo[t])}),r};if(A||(Z((Po=function(t){if(this instanceof Po)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==t?String(t):void 0,n=a(e),r=function(t){this===Oo&&r.call(jo,t),c(this,So)&&c(this[So],n)&&(this[So][n]=!1),Go(this,n,m(1,t))};return f&&Ho&&Go(Oo,n,{configurable:!0,set:r}),po(n,e)})[No],"toString",function(){return Ro(this).tag}),Z(Po,"withoutSetter",function(t){return po(a(t),t)}),Ct.f=Qo,b.f=zo,Rt.f=yo,Ft.f=_o.f=go,jt.f=Yo,Eo.f=function(t){return po(i(t),t)},f&&(Lo(Po[No],"description",{configurable:!0,get:function(){return Ro(this).description}}),Z(Oo,"propertyIsEnumerable",Qo,{unsafe:!0}))),yt({global:!0,wrap:!0,forced:!A,sham:!A},{Symbol:Po}),To(ie(Bo),function(t){fo(t)}),yt({target:Co,stat:!0,forced:!A},{for:function(t){var e=String(t);if(c(qo,e))return qo[e];var n=Po(e);return qo[e]=n,Vo[n]=e,n},keyFor:function(t){if(!Ko(t))throw TypeError(t+" is not a symbol");if(c(Vo,t))return Vo[t]},useSetter:function(){Ho=!0},useSimple:function(){Ho=!1}}),yt({target:"Object",stat:!0,forced:!A,sham:!f},{create:function(t,e){return void 0===e?ve(t):vo(ve(t),e)},defineProperty:zo,defineProperties:vo,getOwnPropertyDescriptor:yo}),yt({target:"Object",stat:!0,forced:!A},{getOwnPropertyNames:go,getOwnPropertySymbols:Yo}),yt({target:"Object",stat:!0,forced:y(function(){jt.f(1)})},{getOwnPropertySymbols:function(t){return jt.f(gt(t))}}),Do){var Xo=!A||y(function(){var t=Po();return"[null]"!=Do([t])||"{}"!=Do({a:t})||"{}"!=Do(Object(t))});yt({target:"JSON",stat:!0,forced:Xo},{stringify:function(t,e,n){for(var r,i=[t],o=1;o<arguments.length;)i.push(arguments[o++]);if((g(r=e)||void 0!==t)&&!Ko(t))return Gr(e)||(e=function(t,e){if("function"==typeof r&&(e=r.call(this,t,e)),!Ko(e))return e}),i[1]=e,Do.apply(null,i)}})}Po[No][Ao]||_(Po[No],Ao,Po[No].valueOf),le(Po,Co),H[So]=!0,fo("asyncIterator");var Jo=b.f,$o=w.Symbol;if(!(!f||"function"!=typeof $o||"description"in $o.prototype&&void 0===$o().description)){var Zo={},ts=function(t){var e=arguments.length<1||void 0===t?void 0:String(t),n=this instanceof ts?new $o(e):void 0===e?$o():$o(e);return""===e&&(Zo[n]=!0),n};dt(ts,$o);var es=ts.prototype=$o.prototype;es.constructor=ts;var ns=es.toString,rs="Symbol(test)"==String($o("test")),is=/^Symbol\((.*)\)[^)]+$/;Jo(es,"description",{configurable:!0,get:function(){var t=g(this)?this.valueOf():this,e=ns.call(t);if(c(Zo,t))return"";var n=rs?e.slice(7,-1):e.replace(is,"$1");return""===n?void 0:n}}),yt({global:!0,forced:!0},{Symbol:ts})}fo("hasInstance"),fo("isConcatSpreadable"),fo("iterator"),fo("match"),fo("matchAll"),fo("replace"),fo("search"),fo("species"),fo("split"),fo("toPrimitive"),fo("toStringTag"),fo("unscopables"),le(Math,"Math",!0),le(w.JSON,"JSON",!0);Ot.Symbol;fo("asyncDispose"),fo("dispose"),fo("observable"),fo("patternMatch"),fo("replaceAll");Eo.f("iterator");function os(r,t,e){function n(t){var n=u[t];Z(u,t,"add"==t?function(t){return n.call(this,0===t?0:t),this}:"delete"==t?function(t){return!(o&&!g(t))&&n.call(this,0===t?0:t)}:"get"==t?function(t){return o&&!g(t)?void 0:n.call(this,0===t?0:t)}:"has"==t?function(t){return!(o&&!g(t))&&n.call(this,0===t?0:t)}:function(t,e){return n.call(this,0===t?0:t,e),this})}var i=-1!==r.indexOf("Map"),o=-1!==r.indexOf("Weak"),s=i?"set":"add",a=w[r],u=a&&a.prototype,c=a,h={};if(Kt(r,"function"!=typeof a||!(o||u.forEach&&!y(function(){(new a).entries().next()}))))c=e.getConstructor(t,r,i,s),us.REQUIRED=!0;else if(Kt(r,!0)){var l=new c,f=l[s](o?{}:-0,1)!=l,p=y(function(){l.has(1)}),d=hn(function(t){new a(t)}),v=!o&&y(function(){for(var t=new a,e=5;e--;)t[s](e,e);return!t.has(-0)});d||(((c=t(function(t,e){Qe(t,c,r);var n=function(t,e,n){var r,i;return be&&"function"==typeof(r=e.constructor)&&r!==n&&g(i=r.prototype)&&i!==n.prototype&&be(t,i),t}(new a,t,c);return null!=e&&on(e,n[s],n,i),n})).prototype=u).constructor=c),(p||v)&&(n("delete"),n("has"),i&&n("get")),(v||f)&&n(s),o&&u.clear&&delete u.clear}return h[r]=c,yt({global:!0,forced:c!=a},h),le(c,r),o||e.setStrong(c,r,i),c}function ss(t,e,n){var r,i,o,s,a=arguments.length,u=1<a?e:void 0;return ze(this),(r=void 0!==u)&&ze(u),null==t?new this:(i=[],r?(o=0,s=Xe(u,2<a?n:void 0,2),on(t,function(t){i.push(s(t,o++))})):on(t,i.push,i),new this(i))}var as=!y(function(){return Object.isExtensible(Object.preventExtensions({}))}),us=e(function(t){function n(t){e(t,r,{value:{objectID:"O"+ ++i,weakData:{}}})}var e=b.f,r=a("meta"),i=0,o=Object.isExtensible||function(){return!0},s=t.exports={REQUIRED:!1,fastKey:function(t,e){if(!g(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!c(t,r)){if(!o(t))return"F";if(!e)return"E";n(t)}return t[r].objectID},getWeakData:function(t,e){if(!c(t,r)){if(!o(t))return!0;if(!e)return!1;n(t)}return t[r].weakData},onFreeze:function(t){return as&&s.REQUIRED&&o(t)&&!c(t,r)&&n(t),t}};H[r]=!0}),cs=(us.REQUIRED,us.fastKey,us.getWeakData,us.onFreeze,b.f),hs=us.fastKey,ls=$.set,fs=$.getterFor,ps={getConstructor:function(t,n,r,i){function o(t,e,n){var r,i,o=a(t),s=u(t,e);return s?s.value=n:(o.last=s={index:i=hs(e,!0),key:e,value:n,previous:r=o.last,next:void 0,removed:!1},o.first||(o.first=s),r&&(r.next=s),f?o.size++:t.size++,"F"!==i&&(o.index[i]=s)),t}var s=t(function(t,e){Qe(t,s,n),ls(t,{type:n,index:ve(null),first:void 0,last:void 0,size:0}),f||(t.size=0),null!=e&&on(e,t[i],t,r)}),a=fs(n),u=function(t,e){var n,r=a(t),i=hs(e);if("F"!==i)return r.index[i];for(n=r.first;n;n=n.next)if(n.key==e)return n};return Ge(s.prototype,{clear:function(){for(var t=a(this),e=t.index,n=t.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete e[n.index],n=n.next;t.first=t.last=void 0,f?t.size=0:this.size=0},delete:function(t){var e=a(this),n=u(this,t);if(n){var r=n.next,i=n.previous;delete e.index[n.index],n.removed=!0,i&&(i.next=r),r&&(r.previous=i),e.first==n&&(e.first=r),e.last==n&&(e.last=i),f?e.size--:this.size--}return!!n},forEach:function(t,e){for(var n,r=a(this),i=Xe(t,1<arguments.length?e:void 0,3);n=n?n.next:r.first;)for(i(n.value,n.key,this);n&&n.removed;)n=n.previous},has:function(t){return!!u(this,t)}}),Ge(s.prototype,r?{get:function(t){var e=u(this,t);return e&&e.value},set:function(t,e){return o(this,0===t?0:t,e)}}:{add:function(t){return o(this,t=0===t?0:t,t)}}),f&&cs(s.prototype,"size",{get:function(){return a(this).size}}),s},setStrong:function(t,e,n){var r=e+" Iterator",i=fs(e),o=fs(r);de(t,e,function(t,e){ls(this,{type:r,target:t,state:i(t),kind:e,last:void 0})},function(){for(var t=o(this),e=t.kind,n=t.last;n&&n.removed;)n=n.previous;return t.target&&(t.last=n=n?n.next:t.state.first)?"keys"==e?{value:n.key,done:!1}:"values"==e?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:{value:t.target=void 0,done:!0}},n?"entries":"values",!n,!0),Ke(e)}};os("Map",function(e){return function(t){return e(this,arguments.length?t:void 0)}},ps),Ot.Map;yt({target:"Map",stat:!0},{from:ss});function ds(){for(var t=arguments.length,e=new Array(t);t--;)e[t]=arguments[t];return new this(e)}yt({target:"Map",stat:!0},{of:ds});function vs(){for(var t,e=d(this),n=ze(e.delete),r=!0,i=0,o=arguments.length;i<o;i++)t=n.call(e,arguments[i]),r=r&&t;return!!r}yt({target:"Map",proto:!0,real:!0,forced:s},{deleteAll:function(){return vs.apply(this,arguments)}});function ys(t){return Map.prototype.entries.call(t)}yt({target:"Map",proto:!0,real:!0,forced:s},{every:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3);return!on(r,function(t,e){if(!i(e,t,n))return on.stop()},void 0,!0,!0).stopped}}),yt({target:"Map",proto:!0,real:!0,forced:s},{filter:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3),o=new(ln(n,ht("Map"))),s=ze(o.set);return on(r,function(t,e){i(e,t,n)&&s.call(o,t,e)},void 0,!0,!0),o}}),yt({target:"Map",proto:!0,real:!0,forced:s},{find:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3);return on(r,function(t,e){if(i(e,t,n))return on.stop(e)},void 0,!0,!0).result}}),yt({target:"Map",proto:!0,real:!0,forced:s},{findKey:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3);return on(r,function(t,e){if(i(e,t,n))return on.stop(t)},void 0,!0,!0).result}}),yt({target:"Map",stat:!0},{groupBy:function(t,n){var r=new this;ze(n);var i=ze(r.has),o=ze(r.get),s=ze(r.set);return on(t,function(t){var e=n(t);i.call(r,e)?o.call(r,e).push(t):s.call(r,e,[t])}),r}});yt({target:"Map",proto:!0,real:!0,forced:s},{includes:function(n){return on(ys(d(this)),function(t,e){if(function(t,e){return t===e||t!=t&&e!=e}(e,n))return on.stop()},void 0,!0,!0).stopped}}),yt({target:"Map",stat:!0},{keyBy:function(t,e){var n=new this;ze(e);var r=ze(n.set);return on(t,function(t){r.call(n,e(t),t)}),n}}),yt({target:"Map",proto:!0,real:!0,forced:s},{keyOf:function(n){return on(ys(d(this)),function(t,e){if(e===n)return on.stop(t)},void 0,!0,!0).result}}),yt({target:"Map",proto:!0,real:!0,forced:s},{mapKeys:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3),o=new(ln(n,ht("Map"))),s=ze(o.set);return on(r,function(t,e){s.call(o,i(e,t,n),e)},void 0,!0,!0),o}}),yt({target:"Map",proto:!0,real:!0,forced:s},{mapValues:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3),o=new(ln(n,ht("Map"))),s=ze(o.set);return on(r,function(t,e){s.call(o,t,i(e,t,n))},void 0,!0,!0),o}}),yt({target:"Map",proto:!0,real:!0,forced:s},{merge:function(t){for(var e=d(this),n=ze(e.set),r=0;r<arguments.length;)on(arguments[r++],n,e,!0);return e}}),yt({target:"Map",proto:!0,real:!0,forced:s},{reduce:function(n,t){var r=d(this),e=ys(r),i=arguments.length<2,o=i?void 0:t;if(ze(n),on(e,function(t,e){o=i?(i=!1,e):n(o,e,t,r)},void 0,!0,!0),i)throw TypeError("Reduce of empty map with no initial value");return o}}),yt({target:"Map",proto:!0,real:!0,forced:s},{some:function(t,e){var n=d(this),r=ys(n),i=Xe(t,1<arguments.length?e:void 0,3);return on(r,function(t,e){if(i(e,t,n))return on.stop()},void 0,!0,!0).stopped}}),yt({target:"Map",proto:!0,real:!0,forced:s},{update:function(t,e,n){var r=d(this),i=arguments.length;ze(e);var o=r.has(t);if(!o&&i<3)throw TypeError("Updating absent value");var s=o?r.get(t):ze(2<i?n:void 0)(t,r);return r.set(t,e(s,t,r)),r}});function gs(t,e,n){var r,i=d(this),o=2<arguments.length?n:void 0;if("function"!=typeof e&&"function"!=typeof o)throw TypeError("At least one callback required");return i.has(t)?(r=i.get(t),"function"==typeof e&&(r=e(r),i.set(t,r))):"function"==typeof o&&(r=o(),i.set(t,r)),r}yt({target:"Map",proto:!0,real:!0,forced:s},{upsert:gs}),yt({target:"Map",proto:!0,real:!0,forced:s},{updateOrInsert:gs});os("Set",function(e){return function(t){return e(this,arguments.length?t:void 0)}},ps),Ot.Set;yt({target:"Set",stat:!0},{from:ss}),yt({target:"Set",stat:!0},{of:ds});yt({target:"Set",proto:!0,real:!0,forced:s},{addAll:function(){return function(){for(var t=d(this),e=ze(t.add),n=0,r=arguments.length;n<r;n++)e.call(t,arguments[n]);return t}.apply(this,arguments)}}),yt({target:"Set",proto:!0,real:!0,forced:s},{deleteAll:function(){return vs.apply(this,arguments)}});function ms(t){return Set.prototype.values.call(t)}yt({target:"Set",proto:!0,real:!0,forced:s},{every:function(t,e){var n=d(this),r=ms(n),i=Xe(t,1<arguments.length?e:void 0,3);return!on(r,function(t){if(!i(t,t,n))return on.stop()},void 0,!1,!0).stopped}}),yt({target:"Set",proto:!0,real:!0,forced:s},{difference:function(t){var e=d(this),n=new(ln(e,ht("Set")))(e),r=ze(n.delete);return on(t,function(t){r.call(n,t)}),n}}),yt({target:"Set",proto:!0,real:!0,forced:s},{filter:function(t,e){var n=d(this),r=ms(n),i=Xe(t,1<arguments.length?e:void 0,3),o=new(ln(n,ht("Set"))),s=ze(o.add);return on(r,function(t){i(t,t,n)&&s.call(o,t)},void 0,!1,!0),o}}),yt({target:"Set",proto:!0,real:!0,forced:s},{find:function(t,e){var n=d(this),r=ms(n),i=Xe(t,1<arguments.length?e:void 0,3);return on(r,function(t){if(i(t,t,n))return on.stop(t)},void 0,!1,!0).result}}),yt({target:"Set",proto:!0,real:!0,forced:s},{intersection:function(t){var e=d(this),n=new(ln(e,ht("Set"))),r=ze(e.has),i=ze(n.add);return on(t,function(t){r.call(e,t)&&i.call(n,t)}),n}}),yt({target:"Set",proto:!0,real:!0,forced:s},{isDisjointFrom:function(t){var e=d(this),n=ze(e.has);return!on(t,function(t){if(!0===n.call(e,t))return on.stop()}).stopped}}),yt({target:"Set",proto:!0,real:!0,forced:s},{isSubsetOf:function(t){var e=function(t){var e=Je(t);if("function"!=typeof e)throw TypeError(String(t)+" is not iterable");return d(e.call(t))}(this),n=d(t),r=n.has;return"function"!=typeof r&&(n=new(ht("Set"))(t),r=ze(n.has)),!on(e,function(t){if(!1===r.call(n,t))return on.stop()},void 0,!1,!0).stopped}}),yt({target:"Set",proto:!0,real:!0,forced:s},{isSupersetOf:function(t){var e=d(this),n=ze(e.has);return!on(t,function(t){if(!1===n.call(e,t))return on.stop()}).stopped}}),yt({target:"Set",proto:!0,real:!0,forced:s},{join:function(t){var e=d(this),n=ms(e),r=void 0===t?",":String(t),i=[];return on(n,i.push,i,!1,!0),i.join(r)}}),yt({target:"Set",proto:!0,real:!0,forced:s},{map:function(t,e){var n=d(this),r=ms(n),i=Xe(t,1<arguments.length?e:void 0,3),o=new(ln(n,ht("Set"))),s=ze(o.add);return on(r,function(t){s.call(o,i(t,t,n))},void 0,!1,!0),o}}),yt({target:"Set",proto:!0,real:!0,forced:s},{reduce:function(e,t){var n=d(this),r=ms(n),i=arguments.length<2,o=i?void 0:t;if(ze(e),on(r,function(t){o=i?(i=!1,t):e(o,t,t,n)},void 0,!1,!0),i)throw TypeError("Reduce of empty set with no initial value");return o}}),yt({target:"Set",proto:!0,real:!0,forced:s},{some:function(t,e){var n=d(this),r=ms(n),i=Xe(t,1<arguments.length?e:void 0,3);return on(r,function(t){if(i(t,t,n))return on.stop()},void 0,!1,!0).stopped}}),yt({target:"Set",proto:!0,real:!0,forced:s},{symmetricDifference:function(t){var e=d(this),n=new(ln(e,ht("Set")))(e),r=ze(n.delete),i=ze(n.add);return on(t,function(t){r.call(n,t)||i.call(n,t)}),n}}),yt({target:"Set",proto:!0,real:!0,forced:s},{union:function(t){var e=d(this),n=new(ln(e,ht("Set")))(e);return on(t,ze(n.add),n),n}});var ws=Math.floor;yt({target:"Number",stat:!0},{isInteger:function(t){return!g(t)&&isFinite(t)&&ws(t)===t}});Ot.Number.isInteger;var bs=function(t,e){return(bs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function _s(t,e){function n(){this.constructor=t}bs(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var Es=function(){return(Es=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Is(o,s,a,u){return new(a=a||Promise)(function(t,e){function n(t){try{i(u.next(t))}catch(t){e(t)}}function r(t){try{i(u.throw(t))}catch(t){e(t)}}function i(e){e.done?t(e.value):new a(function(t){t(e.value)}).then(n,r)}i((u=u.apply(o,s||[])).next())})}function Ts(n,r){var i,o,s,t,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return t={next:e(0),throw:e(1),return:e(2)},"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;a;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,s&&(e=[2&e[0],s.value]),e[0]){case 0:case 1:s=e;break;case 4:return a.label++,{value:e[1],done:!1};case 5:a.label++,o=e[1],e=[0];continue;case 7:e=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){a=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){a.label=e[1];break}if(6===e[0]&&a.label<s[1]){a.label=s[1],s=e;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(e);break}s[2]&&a.ops.pop(),a.trys.pop();continue}e=r.call(n,a)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function Ss(t){var e="function"==typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function Cs(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),s=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)s.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s}function Ns(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Cs(arguments[e]));return t}function As(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}function ks(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128):e[n++]=i>>12|224,e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e}function Rs(t){try{return xs.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}var Os={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Ps=function(t,e){if(!t)throw Ds(e)},Ds=function(t){return new Error("Firebase Database ("+Os.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},xs={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],s=i+1<t.length,a=s?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,h=o>>2,l=(3&o)<<4|a>>4,f=(15&a)<<2|c>>6,p=63&c;u||(p=64,s||(f=64)),r.push(n[h],n[l],n[f],n[p])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ks(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(191<i&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&i<365){var s=((7&i)<<18|(63&(o=t[n++]))<<12|(63&(a=t[n++]))<<6|63&t[n++])-65536;e[r++]=String.fromCharCode(55296+(s>>10)),e[r++]=String.fromCharCode(56320+(1023&s))}else{o=t[n++];var a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")}(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],s=i<t.length?n[t.charAt(i)]:0,a=++i<t.length?n[t.charAt(i)]:64,u=++i<t.length?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==a||null==u)throw Error();var c=o<<2|s>>4;if(r.push(c),64!==a){var h=s<<4&240|a>>2;if(r.push(h),64!==u){var l=a<<6&192|u;r.push(l)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),(this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t)>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};function Ls(t){return Ms(void 0,t)}function Ms(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var n in e)e.hasOwnProperty(n)&&(t[n]=Ms(t[n],e[n]));return t}var Us=(Fs.prototype.wrapCallback=function(n){var r=this;return function(t,e){t?r.reject(t):r.resolve(e),"function"==typeof n&&(r.promise.catch(function(){}),1===n.length?n(t):n(t,e))}},Fs);function Fs(){var n=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}function js(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function qs(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(js())}function Vs(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function Bs(){return!0===Os.NODE_ADMIN}var Ws,Hs=(_s(Gs,Ws=Error),Gs);function Gs(t,e){var n=Ws.call(this,e)||this;return n.code=t,n.name="FirebaseError",Object.setPrototypeOf(n,Gs.prototype),Error.captureStackTrace&&Error.captureStackTrace(n,Ks.prototype.create),n}var Ks=(zs.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=e[0]||{},i=this.service+"/"+t,o=this.errors[t],s=o?function(t,r){return t.replace(Qs,function(t,e){var n=r[e];return null!=n?n.toString():"<"+e+"?>"})}(o,r):"Error",a=this.serviceName+": "+s+" ("+i+").",u=new Hs(i,a),c=0,h=Object.keys(r);c<h.length;c++){var l=h[c];"_"!==l.slice(-1)&&(l in u&&console.warn('Overwriting FirebaseError base field "'+l+'" can cause unexpected behavior.'),u[l]=r[l])}return u},zs);function zs(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var Qs=/\{\$([^}]+)}/g;function Ys(t){return JSON.parse(t)}function Xs(t){return JSON.stringify(t)}function Js(t){var e={},n={},r={},i="";try{var o=t.split(".");e=Ys(Rs(o[0])||""),n=Ys(Rs(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}}function $s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Zs(t,e){return Object.prototype.hasOwnProperty.call(t,e)?t[e]:void 0}function ta(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function ea(t,e,n){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=e.call(n,t[i],i,t));return r}var na=(ra.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},ra.prototype.compress_=function(t,e){e=e||0;var n=this.W_;if("string"==typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,s,a=this.chain_[0],u=this.chain_[1],c=this.chain_[2],h=this.chain_[3],l=this.chain_[4];for(r=0;r<80;r++)s=r<40?r<20?(o=h^u&(c^h),1518500249):(o=u^c^h,1859775393):r<60?(o=u&c|h&(u|c),2400959708):(o=u^c^h,3395469782),i=(a<<5|a>>>27)+o+l+s+n[r]&4294967295,l=h,h=c,c=4294967295&(u<<30|u>>>2),u=a,a=i;this.chain_[0]=this.chain_[0]+a&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+h&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295},ra.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0===o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"==typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},ra.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;56<=n;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;0<=i;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},ra);function ra(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var t=1;t<this.blockSize;++t)this.pad_[t]=0;this.reset()}function ia(t,e){var n=new oa(t,e);return n.subscribe.bind(n)}var oa=(sa.prototype.next=function(e){this.forEachObserver(function(t){t.next(e)})},sa.prototype.error=function(e){this.forEachObserver(function(t){t.error(e)}),this.close(e)},sa.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},sa.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"==typeof t[i])return!0}return!1}(t,["next","error","complete"])?t:{next:t,error:e,complete:n}).next&&(r.next=aa),void 0===r.error&&(r.error=aa),void 0===r.complete&&(r.complete=aa);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},sa.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},sa.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},sa.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},sa.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},sa);function sa(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}function aa(){}function ua(t,e,n,r){var i;if(r<e?i="at least "+e:n<r&&(i=0===n?"none":"no more than "+n),i)throw new Error(t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")}function ca(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}function ha(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(ca(t,e,r)+"must be a valid function.")}function la(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(ca(t,e,r)+"must be a valid context object.")}function fa(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:55296<=r&&r<=56319?(e+=4,n++):e+=3}return e}var pa=(da.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},da.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},da.prototype.setServiceProps=function(t){return this.serviceProps=t,this},da);function da(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var va="[DEFAULT]",ya=(ga.prototype.get=function(t){void 0===t&&(t=va);var e=this.normalizeInstanceIdentifier(t);if(!this.instancesDeferred.has(e)){var n=new Us;this.instancesDeferred.set(e,n);try{var r=this.getOrInitializeService(e);r&&n.resolve(r)}catch(t){}}return this.instancesDeferred.get(e).promise},ga.prototype.getImmediate=function(t){var e=Es({identifier:va,optional:!1},t),n=e.identifier,r=e.optional,i=this.normalizeInstanceIdentifier(n);try{var o=this.getOrInitializeService(i);if(o)return o;if(r)return null;throw Error("Service "+this.name+" is not available")}catch(t){if(r)return null;throw t}},ga.prototype.getComponent=function(){return this.component},ga.prototype.setComponent=function(t){var e,n;if(t.name!==this.name)throw Error("Mismatching Component "+t.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(function(t){return"EAGER"===t.instantiationMode}(this.component=t))try{this.getOrInitializeService(va)}catch(t){}try{for(var r=Ss(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=Cs(i.value,2),s=o[0],a=o[1],u=this.normalizeInstanceIdentifier(s);try{var c=this.getOrInitializeService(u);a.resolve(c)}catch(t){}}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}},ga.prototype.clearInstance=function(t){void 0===t&&(t=va),this.instancesDeferred.delete(t),this.instances.delete(t)},ga.prototype.delete=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(e.filter(function(t){return"INTERNAL"in t}).map(function(t){return t.INTERNAL.delete()}))];case 1:return t.sent(),[2]}})})},ga.prototype.isComponentSet=function(){return null!=this.component},ga.prototype.getOrInitializeService=function(t){var e=this.instances.get(t);return!e&&this.component&&(e=this.component.instanceFactory(this.container,function(t){return t===va?void 0:t}(t)),this.instances.set(t,e)),e||null},ga.prototype.normalizeInstanceIdentifier=function(t){return this.component?this.component.multipleInstances?t:va:t},ga);function ga(t,e){this.name=t,this.container=e,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}var ma,wa,ba=(_a.prototype.addComponent=function(t){var e=this.getProvider(t.name);if(e.isComponentSet())throw new Error("Component "+t.name+" has already been registered with "+this.name);e.setComponent(t)},_a.prototype.addOrOverwriteComponent=function(t){this.getProvider(t.name).isComponentSet()&&this.providers.delete(t.name),this.addComponent(t)},_a.prototype.getProvider=function(t){if(this.providers.has(t))return this.providers.get(t);var e=new ya(t,this);return this.providers.set(t,e),e},_a.prototype.getProviders=function(){return Array.from(this.providers.values())},_a);function _a(t){this.name=t,this.providers=new Map}function Ea(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,i++)r[i]=o[s];return r}(wa=ma=ma||{})[wa.DEBUG=0]="DEBUG",wa[wa.VERBOSE=1]="VERBOSE",wa[wa.INFO=2]="INFO",wa[wa.WARN=3]="WARN",wa[wa.ERROR=4]="ERROR",wa[wa.SILENT=5]="SILENT";function Ia(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString();switch(e){case ma.DEBUG:case ma.VERBOSE:console.log.apply(console,Ea(["["+i+"]  "+t.name+":"],n));break;case ma.INFO:console.info.apply(console,Ea(["["+i+"]  "+t.name+":"],n));break;case ma.WARN:console.warn.apply(console,Ea(["["+i+"]  "+t.name+":"],n));break;case ma.ERROR:console.error.apply(console,Ea(["["+i+"]  "+t.name+":"],n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}}var Ta,Sa=ma.INFO,Ca=(Object.defineProperty(Na.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in ma))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(Na.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),Na.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ea([this,ma.DEBUG],t))},Na.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ea([this,ma.VERBOSE],t))},Na.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ea([this,ma.INFO],t))},Na.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ea([this,ma.WARN],t))},Na.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,Ea([this,ma.ERROR],t))},Na);function Na(t){this.name=t,this._logLevel=Sa,this._logHandler=Ia}var Aa,ka=((Ta={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Ta["bad-app-name"]="Illegal App name: '{$appName}",Ta["duplicate-app"]="Firebase App named '{$appName}' already exists",Ta["app-deleted"]="Firebase App named '{$appName}' already deleted",Ta["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Ta),Ra=new Ks("app","Firebase",ka),Oa="@firebase/app",Pa="[DEFAULT]",Da=((Aa={})[Oa]="fire-core",Aa["@firebase/analytics"]="fire-analytics",Aa["@firebase/auth"]="fire-auth",Aa["@firebase/database"]="fire-rtdb",Aa["@firebase/functions"]="fire-fn",Aa["@firebase/installations"]="fire-iid",Aa["@firebase/messaging"]="fire-fcm",Aa["@firebase/performance"]="fire-perf",Aa["@firebase/remote-config"]="fire-rc",Aa["@firebase/storage"]="fire-gcs",Aa["@firebase/firestore"]="fire-fst",Aa["fire-js"]="fire-js",Aa["firebase-wrapper"]="fire-js-all",Aa),xa=new Ca("@firebase/app"),La=(Object.defineProperty(Ma.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(t){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=t},enumerable:!0,configurable:!0}),Object.defineProperty(Ma.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(Ma.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),Ma.prototype.delete=function(){var e=this;return new Promise(function(t){e.checkDestroyed_(),t()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(t){return t.delete()}))}).then(function(){e.isDeleted_=!0})},Ma.prototype._getService=function(t,e){return void 0===e&&(e=Pa),this.checkDestroyed_(),this.container.getProvider(t).getImmediate({identifier:e})},Ma.prototype._removeServiceInstance=function(t,e){void 0===e&&(e=Pa),this.container.getProvider(t).clearInstance(e)},Ma.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){xa.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},Ma.prototype._addOrOverwriteComponent=function(t){this.container.addOrOverwriteComponent(t)},Ma.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Ra.create("app-deleted",{appName:this.name_})},Ma);function Ma(t,e,n){var r,i,o=this;this.firebase_=n,this.isDeleted_=!1,this.name_=e.name,this.automaticDataCollectionEnabled_=e.automaticDataCollectionEnabled||!1,this.options_=Ls(t),this.container=new ba(e.name),this._addComponent(new pa("app",function(){return o},"PUBLIC"));try{for(var s=Ss(this.firebase_.INTERNAL.components.values()),a=s.next();!a.done;a=s.next()){var u=a.value;this._addComponent(u)}}catch(t){r={error:t}}finally{try{a&&!a.done&&(i=s.return)&&i.call(s)}finally{if(r)throw r.error}}}La.prototype.name&&La.prototype.options||La.prototype.delete||console.log("dc");var Ua="7.9.1";function Fa(u){var c={},h=new Map,l={__esModule:!0,initializeApp:function(t,e){void 0===e&&(e={});if("object"!=typeof e||null===e){e={name:e}}var n=e;void 0===n.name&&(n.name=Pa);var r=n.name;if("string"!=typeof r||!r)throw Ra.create("bad-app-name",{appName:String(r)});if($s(c,r))throw Ra.create("duplicate-app",{appName:r});var i=new u(t,n,l);return c[r]=i},app:f,registerVersion:function(t,e,n){var r,i=null!==(r=Da[t])&&void 0!==r?r:t;n&&(i+="-"+n);var o=i.match(/\s|\//),s=e.match(/\s|\//);if(o||s){var a=['Unable to register library "'+i+'" with version "'+e+'":'];return o&&a.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),o&&s&&a.push("and"),s&&a.push('version name "'+e+'" contains illegal characters (whitespace or "/")'),void xa.warn(a.join(" "))}p(new pa(i+"-version",function(){return{library:i,version:e}},"VERSION"))},apps:null,SDK_VERSION:Ua,INTERNAL:{registerComponent:p,removeApp:function(t){delete c[t]},components:h,useAsService:function(t,e){return"serverAuth"!==e?e:null}}};function f(t){if(!$s(c,t=t||Pa))throw Ra.create("no-app",{appName:t});return c[t]}function p(n){var e,t,r=n.name;if(h.has(r))return xa.debug("There were multiple attempts to register component "+r+"."),"PUBLIC"===n.type?l[r]:null;if(h.set(r,n),"PUBLIC"===n.type){var i=function(t){if(void 0===t&&(t=f()),"function"!=typeof t[r])throw Ra.create("invalid-app-argument",{appName:r});return t[r]()};void 0!==n.serviceProps&&Ms(i,n.serviceProps),l[r]=i,u.prototype[r]=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this._getService.bind(this,r).apply(this,n.multipleInstances?t:[])}}try{for(var o=Ss(Object.keys(c)),s=o.next();!s.done;s=o.next()){var a=s.value;c[a]._addComponent(n)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return"PUBLIC"===n.type?l[r]:null}return l.default=l,Object.defineProperty(l,"apps",{get:function(){return Object.keys(c).map(function(t){return c[t]})}}),f.App=u,l}var ja=function t(){var e=Fa(La);return e.INTERNAL=Es(Es({},e.INTERNAL),{createFirebaseNamespace:t,extendNamespace:function(t){Ms(e,t)},createSubscribe:ia,ErrorFactory:Ks,deepExtend:Ms}),e}(),qa=(Va.prototype.getPlatformInfoString=function(){return this.container.getProviders().map(function(t){if(function(t){var e,n=t.getComponent();return"VERSION"===(null===(e=n)||void 0===e?void 0:e.type)}(t)){var e=t.getImmediate();return e.library+"/"+e.version}return null}).filter(function(t){return t}).join(" ")},Va);function Va(t){this.container=t}if("object"==typeof self&&self.self===self&&void 0!==self.firebase){xa.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var Ba=self.firebase.SDK_VERSION;Ba&&0<=Ba.indexOf("LITE")&&xa.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var Wa=ja.initializeApp;ja.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(t){return!1}}()&&xa.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the rollup-plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/rollup-plugin-node-resolve\n      '),Wa.apply(void 0,t)};var Ha,Ga,fl=ja;(Ha=fl).INTERNAL.registerComponent(new pa("platform-logger",function(t){return new qa(t)},"PRIVATE")),Ha.registerVersion(Oa,"0.5.4",Ga),Ha.registerVersion("fire-js","");fl.registerVersion("firebase","7.9.1","app");(function(){var t,o="function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,n){t!=Array.prototype&&t!=Object.prototype&&(t[e]=n.value)};var s=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global,t];for(var e=0;e<t.length;++e){var n=t[e];if(n&&n.Math==Math)return n}return globalThis}(this);function c(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):{next:function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}(t)}}!function(t,e){if(e){var n=s;t=t.split(".");for(var r=0;r<t.length-1;r++){var i=t[r];i in n||(n[i]={}),n=n[i]}(e=e(r=n[t=t[t.length-1]]))!=r&&null!=e&&o(n,t,{configurable:!0,writable:!0,value:e})}}("Promise",function(t){function a(t){this.b=0,this.c=void 0,this.a=[];var e=this.f();try{t(e.resolve,e.reject)}catch(t){e.reject(t)}}function e(){this.a=null}function u(e){return e instanceof a?e:new a(function(t){t(e)})}if(t)return t;e.prototype.b=function(t){if(null==this.a){this.a=[];var e=this;this.c(function(){e.g()})}this.a.push(t)};var n=s.setTimeout;e.prototype.c=function(t){n(t,0)},e.prototype.g=function(){for(;this.a&&this.a.length;){var t=this.a;this.a=[];for(var e=0;e<t.length;++e){var n=t[e];t[e]=null;try{n()}catch(t){this.f(t)}}}this.a=null},e.prototype.f=function(t){this.c(function(){throw t})},a.prototype.f=function(){function t(e){return function(t){r||(r=!0,e.call(n,t))}}var n=this,r=!1;return{resolve:t(this.m),reject:t(this.g)}},a.prototype.m=function(t){if(t===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(t instanceof a)this.o(t);else{t:switch(typeof t){case"object":var e=null!=t;break t;case"function":e=!0;break t;default:e=!1}e?this.u(t):this.h(t)}},a.prototype.u=function(t){var e=void 0;try{e=t.then}catch(t){return void this.g(t)}"function"==typeof e?this.v(e,t):this.h(t)},a.prototype.g=function(t){this.i(2,t)},a.prototype.h=function(t){this.i(1,t)},a.prototype.i=function(t,e){if(0!=this.b)throw Error("Cannot settle("+t+", "+e+"): Promise already settled in state"+this.b);this.b=t,this.c=e,this.l()},a.prototype.l=function(){if(null!=this.a){for(var t=0;t<this.a.length;++t)i.b(this.a[t]);this.a=null}};var i=new e;return a.prototype.o=function(t){var e=this.f();t.La(e.resolve,e.reject)},a.prototype.v=function(t,e){var n=this.f();try{t.call(e,n.resolve,n.reject)}catch(t){n.reject(t)}},a.prototype.then=function(t,e){function n(e,t){return"function"==typeof e?function(t){try{r(e(t))}catch(t){i(t)}}:t}var r,i,o=new a(function(t,e){r=t,i=e});return this.La(n(t,r),n(e,i)),o},a.prototype.catch=function(t){return this.then(void 0,t)},a.prototype.La=function(t,e){function n(){switch(r.b){case 1:t(r.c);break;case 2:e(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?i.b(n):this.a.push(n)},a.resolve=u,a.reject=function(n){return new a(function(t,e){e(n)})},a.race=function(i){return new a(function(t,e){for(var n=c(i),r=n.next();!r.done;r=n.next())u(r.value).La(t,e)})},a.all=function(t){var o=c(t),s=o.next();return s.done?u([]):new a(function(n,t){function e(e){return function(t){r[e]=t,0==--i&&n(r)}}for(var r=[],i=0;r.push(void 0),i++,u(s.value).La(e(r.length-1),t),!(s=o.next()).done;);})},a});var u=u||{},l=this||self;function h(t){return"string"==typeof t}function n(t){return"boolean"==typeof t}var a=/^[\w+/_-]+[=]{0,2}$/,f=null;function p(){}function r(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function i(t){return null===t}function d(t){return"array"==r(t)}function v(t){var e=r(t);return"array"==e||"object"==e&&"number"==typeof t.length}function y(t){return"function"==r(t)}function g(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var e="closure_uid_"+(1e9*Math.random()>>>0),m=0;function w(t,e,n){return t.call.apply(t.bind,arguments)}function b(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function _(t,e,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?w:b).apply(null,arguments)}function E(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var I=Date.now||function(){return+new Date};function T(t,e){function n(){}n.prototype=e.prototype,t.qb=e.prototype,t.prototype=new n,t.prototype.constructor=t}function S(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function C(t){if(Error.captureStackTrace)Error.captureStackTrace(this,C);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function N(t,e){for(var n="",r=(t=t.split("%s")).length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");C.call(this,n+t[r])}function A(t,e){throw new N("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function k(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function R(t,e){t.f(e),t.b<100&&(t.b++,e.next=t.a,t.a=e)}function O(){this.b=this.a=null}T(C,Error),C.prototype.name="CustomError",T(N,C),N.prototype.name="AssertionError",k.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var P=new k(function(){return new D},function(t){t.reset()});function D(){this.next=this.b=this.a=null}function x(t,e){t:{try{var n=t&&t.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||l).Element&&r.Location){var i=r;break t}}catch(t){}i=null}if(i&&void 0!==i[e]&&(!t||!(t instanceof i[e])&&(t instanceof i.Location||t instanceof i.Element))){if(g(t))try{var o=t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t)}catch(t){o="<object could not be stringified>"}else o=void 0===t?"undefined":null===t?"null":typeof t;A("Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,o)}}O.prototype.add=function(t,e){var n=P.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},D.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},D.prototype.reset=function(){this.next=this.b=this.a=null};var L=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(h(t))return h(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},M=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=h(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};var U=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=Array(n),i=h(t)?t.split(""):t,o=0;o<n;o++)o in i&&(r[o]=e.call(void 0,i[o],o,t));return r},F=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(t,e){for(var n=t.length,r=h(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t))return!0;return!1};function j(t,e){return 0<=L(t,e)}function q(t,e){var n;return(n=0<=(e=L(t,e)))&&Array.prototype.splice.call(t,e,1),n}function V(n,r){!function(t,e){for(var n=h(t)?t.split(""):t,r=t.length-1;0<=r;--r)r in n&&e.call(void 0,n[r],r,t)}(n,function(t,e){r.call(void 0,t,e,n)&&1==Array.prototype.splice.call(n,e,1).length&&0})}function B(t){return Array.prototype.concat.apply([],arguments)}function W(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function H(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function G(t){for(var e in t)return!1;return!0}function K(t){var e,n={};for(e in t)n[e]=t[e];return n}var z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Q(t,e){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])t[n]=r[n];for(var o=0;o<z.length;o++)n=z[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Y(t,e){this.a=t===$&&e||"",this.b=J}function X(t){return t instanceof Y&&t.constructor===Y&&t.b===J?t.a:(A("expected object of type Const, got '"+t+"'"),"type_error:Const")}Y.prototype.qa=!0,Y.prototype.pa=function(){return this.a},Y.prototype.toString=function(){return"Const{"+this.a+"}"};var J={},$={},Z=new Y($,"");function tt(){this.a="",this.b=ot}function et(t){return t instanceof tt&&t.constructor===tt&&t.b===ot?t.a:(A("expected object of type TrustedResourceUrl, got '"+t+"' of type "+r(t)),"type_error:TrustedResourceUrl")}function nt(t,n){var r=X(t);if(!it.test(r))throw Error("Invalid TrustedResourceUrl format: "+r);return st(t=r.replace(rt,function(t,e){if(!Object.prototype.hasOwnProperty.call(n,e))throw Error('Found marker, "'+e+'", in format string, "'+r+'", but no valid label mapping found in args: '+JSON.stringify(n));return(t=n[e])instanceof Y?X(t):encodeURIComponent(String(t))}))}tt.prototype.qa=!0,tt.prototype.pa=function(){return this.a.toString()},tt.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var rt=/%{(\w+)}/g,it=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,ot={};function st(t){var e=new tt;return e.a=t,e}var at=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},ut=/&/g,ct=/</g,ht=/>/g,lt=/"/g,ft=/'/g,pt=/\x00/g,dt=/[\x00&<>"']/;function vt(t,e){return-1!=t.indexOf(e)}function yt(t,e){return t<e?-1:e<t?1:0}function gt(){this.a="",this.b=Et}function mt(t){return t instanceof gt&&t.constructor===gt&&t.b===Et?t.a:(A("expected object of type SafeUrl, got '"+t+"' of type "+r(t)),"type_error:SafeUrl")}gt.prototype.qa=!0,gt.prototype.pa=function(){return this.a.toString()},gt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var wt=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function bt(t){return t instanceof gt?t:(t="object"==typeof t&&t.qa?t.pa():String(t),wt.test(t)||(t="about:invalid#zClosurez"),It(t))}var _t,Et={};function It(t){var e=new gt;return e.a=t,e}It("about:blank");t:{var Tt=l.navigator;if(Tt){var St=Tt.userAgent;if(St){_t=St;break t}}_t=""}function Ct(t){return vt(_t,t)}function Nt(){this.a="",this.b=kt}function At(t){return t instanceof Nt&&t.constructor===Nt&&t.b===kt?t.a:(A("expected object of type SafeHtml, got '"+t+"' of type "+r(t)),"type_error:SafeHtml")}Nt.prototype.qa=!0,Nt.prototype.pa=function(){return this.a.toString()},Nt.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var kt={};function Rt(t){var e=new Nt;return e.a=t,e}Rt("<!DOCTYPE html>");var Ot,Pt,Dt=Rt("");function xt(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Lt(t){return dt.test(t)&&(-1!=t.indexOf("&")&&(t=t.replace(ut,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(ct,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(ht,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(lt,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(ft,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(pt,"&#0;"))),t}function Mt(t){l.setTimeout(function(){throw t},0)}function Ut(){var t=l.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!Ct("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",function(t){var e=st(X(Z));x(t,"HTMLIFrameElement"),t.src=et(e).toString()}(t),document.documentElement.appendChild(t);var e=t.contentWindow;(t=e.document).open(),t.write(At(Dt)),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=_(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),void 0===t||Ct("Trident")||Ct("MSIE"))return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){l.setTimeout(t,0)};var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){var t=(n=n.next).yb;n.yb=null,t()}},function(t){r.next={yb:t},r=r.next,e.port2.postMessage(0)}}function Ft(t,e){Pt||function(){if(l.Promise&&l.Promise.resolve){var t=l.Promise.resolve(void 0);Pt=function(){t.then(Vt)}}else Pt=function(){var t=Vt;!y(l.setImmediate)||l.Window&&l.Window.prototype&&!Ct("Edge")&&l.Window.prototype.setImmediate==l.setImmediate?(Ot=Ot||Ut())(t):l.setImmediate(t)}}(),jt||(Pt(),jt=!0),qt.add(t,e)}Rt("<br>");var jt=!1,qt=new O;function Vt(){for(var t;n=e=void 0,n=null,(e=qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){Mt(t)}R(P,t)}var e,n;jt=!1}function Bt(t,e){if(this.a=Wt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=p)try{var n=this;t.call(e,function(t){ee(n,Ht,t)},function(t){if(!(t instanceof ue))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}ee(n,Gt,t)})}catch(t){ee(this,Gt,t)}}var Wt=0,Ht=2,Gt=3;function Kt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Kt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var zt=new k(function(){return new Kt},function(t){t.reset()});function Qt(t,e,n){var r=zt.get();return r.g=t,r.b=e,r.f=n,r}function Yt(t){if(t instanceof Bt)return t;var e=new Bt(p);return ee(e,Ht,t),e}function Xt(n){return new Bt(function(t,e){e(n)})}function Jt(t,e,n){ne(t,e,n,null)||Ft(E(e,t))}function $t(n){return new Bt(function(r){var i=n.length,o=[];if(i)for(var t=function(t,e,n){i--,o[t]=e?{Gb:!0,value:n}:{Gb:!1,reason:n},0==i&&r(o)},e=0;e<n.length;e++)Jt(n[e],E(t,e,!0),E(t,e,!1));else r(o)})}function Zt(t,e){t.b||t.a!=Ht&&t.a!=Gt||re(t),t.f?t.f.next=e:t.b=e,t.f=e}function te(t,i,o,s){var e=Qt(null,null,null);return e.a=new Bt(function(n,r){e.g=i?function(t){try{var e=i.call(s,t);n(e)}catch(t){r(t)}}:n,e.b=o?function(t){try{var e=o.call(s,t);void 0===e&&t instanceof ue?r(t):n(e)}catch(t){r(t)}}:r}),Zt(e.a.c=t,e),e.a}function ee(t,e,n){t.a==Wt&&(t===n&&(e=Gt,n=new TypeError("Promise cannot resolve to itself")),t.a=1,ne(n,t.Oc,t.Pc,t)||(t.i=n,t.a=e,t.c=null,re(t),e!=Gt||n instanceof ue||function(t,e){t.g=!0,Ft(function(){t.g&&ae.call(null,e)})}(t,n)))}function ne(t,e,n,r){if(t instanceof Bt)return Zt(t,Qt(e||p,n||null,r)),!0;if(S(t))return t.then(e,n,r),!0;if(g(t))try{var i=t.then;if(y(i))return function(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}var s=!1;try{e.call(t,function(t){s||(s=!0,n.call(i,t))},o)}catch(t){o(t)}}(t,i,e,n,r),!0}catch(t){return n.call(r,t),!0}return!1}function re(t){t.h||(t.h=!0,Ft(t.Zb,t))}function ie(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function oe(t,e,n,r){if(n==Gt&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,se(e,n,r);else try{e.c?e.g.call(e.f):se(e,n,r)}catch(t){ae.call(null,t)}R(zt,e)}function se(t,e,n){e==Ht?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}Bt.prototype.then=function(t,e,n){return te(this,y(t)?t:null,y(e)?e:null,n)},Bt.prototype.$goog_Thenable=!0,(t=Bt.prototype).ka=function(t,e){return(t=Qt(t,t,e)).c=!0,Zt(this,t),this},t.s=function(t,e){return te(this,null,t,e)},t.cancel=function(t){this.a==Wt&&Ft(function(){!function t(e,n){if(e.a==Wt)if(e.c){var r=e.c;if(r.b){for(var i=0,o=null,s=null,a=r.b;a&&(a.c||(i++,a.a==e&&(o=a),!(o&&1<i)));a=a.next)o||(s=a);o&&(r.a==Wt&&1==i?t(r,n):(s?((i=s).next==r.f&&(r.f=i),i.next=i.next.next):ie(r),oe(r,o,Gt,n)))}e.c=null}else ee(e,Gt,n)}(this,new ue(t))},this)},t.Oc=function(t){this.a=Wt,ee(this,Ht,t)},t.Pc=function(t){this.a=Wt,ee(this,Gt,t)},t.Zb=function(){for(var t;t=ie(this);)oe(this,t,this.a,this.i);this.h=!1};var ae=Mt;function ue(t){C.call(this,t)}function ce(){this.va=this.va,this.la=this.la}T(ue,C);var he=0;function le(t){if(!t.va&&(t.va=!0,t.za(),0!=he))t[e]||(t[e]=++m)}function fe(t){return fe[" "](t),t}ce.prototype.va=!(ue.prototype.name="cancel"),ce.prototype.za=function(){if(this.la)for(;this.la.length;)this.la.shift()()},fe[" "]=p;var pe,de,ve=Ct("Opera"),ye=Ct("Trident")||Ct("MSIE"),ge=Ct("Edge"),me=ge||ye,we=Ct("Gecko")&&!(vt(_t.toLowerCase(),"webkit")&&!Ct("Edge"))&&!(Ct("Trident")||Ct("MSIE"))&&!Ct("Edge"),be=vt(_t.toLowerCase(),"webkit")&&!Ct("Edge");function _e(){var t=l.document;return t?t.documentMode:void 0}t:{var Ee="",Ie=(de=_t,we?/rv:([^\);]+)(\)|;)/.exec(de):ge?/Edge\/([\d\.]+)/.exec(de):ye?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(de):be?/WebKit\/(\S+)/.exec(de):ve?/(?:Version)[ \/]?(\S+)/.exec(de):void 0);if(Ie&&(Ee=Ie?Ie[1]:""),ye){var Te=_e();if(null!=Te&&Te>parseFloat(Ee)){pe=String(Te);break t}}pe=Ee}var Se,Ce={};function Ne(a){return function(t,e){var n=Ce;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(a,function(){for(var t=0,e=at(String(pe)).split("."),n=at(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=yt(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||yt(0==o[2].length,0==s[2].length)||yt(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t})}Se=l.document&&ye?_e():void 0;var Ae=Object.freeze||function(t){return t},ke=!ye||9<=Number(Se),Re=ye&&!Ne("9"),Oe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{l.addEventListener("test",p,e),l.removeEventListener("test",p,e)}catch(t){}return t}();function Pe(t,e){this.type=t,this.b=this.target=e,this.Mb=!0}function De(t,e){if(Pe.call(this,t?t.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.b=e,e=t.relatedTarget){if(we){t:{try{fe(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=h(t.pointerType)?t.pointerType:xe[t.pointerType]||"",(this.a=t).defaultPrevented&&this.preventDefault()}}Pe.prototype.preventDefault=function(){this.Mb=!1},T(De,Pe);var xe=Ae({2:"touch",3:"pen",4:"mouse"});De.prototype.preventDefault=function(){De.qb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Re)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}},De.prototype.f=function(){return this.a};var Le="closure_listenable_"+(1e6*Math.random()|0),Me=0;function Ue(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.Pa=i,this.key=++Me,this.ta=this.Ka=!1}function Fe(t){t.ta=!0,t.listener=null,t.proxy=null,t.src=null,t.Pa=null}function je(t){this.src=t,this.a={},this.b=0}function qe(t,e){var n=e.type;n in t.a&&q(t.a[n],e)&&(Fe(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Ve(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ta&&o.listener==e&&o.capture==!!n&&o.Pa==r)return i}return-1}je.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Ve(t,e,r,i);return-1<s?(e=t[s],n||(e.Ka=!1)):((e=new Ue(e,this.src,o,!!r,i)).Ka=n,t.push(e)),e};var Be="closure_lm_"+(1e6*Math.random()|0),We={};function He(t,e,n,r,i){if(r&&r.once)Ke(t,e,n,r,i);else if(d(e))for(var o=0;o<e.length;o++)He(t,e[o],n,r,i);else n=en(n),t&&t[Le]?rn(t,e,n,g(r)?!!r.capture:!!r,i):Ge(t,e,n,!1,r,i)}function Ge(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=g(i)?!!i.capture:!!i,a=Ze(t);if(a||(t[Be]=a=new je(t)),!(n=a.add(e,n,r,s,o)).proxy)if(r=function(){var e=$e,n=ke?function(t){return e.call(n.src,n.listener,t)}:function(t){if(!(t=e.call(n.src,n.listener,t)))return t};return n}(),(n.proxy=r).src=t,r.listener=n,t.addEventListener)Oe||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Ye(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}}function Ke(t,e,n,r,i){if(d(e))for(var o=0;o<e.length;o++)Ke(t,e[o],n,r,i);else n=en(n),t&&t[Le]?on(t,e,n,g(r)?!!r.capture:!!r,i):Ge(t,e,n,!0,r,i)}function ze(t,e,n,r,i){if(d(e))for(var o=0;o<e.length;o++)ze(t,e[o],n,r,i);else r=g(r)?!!r.capture:!!r,n=en(n),t&&t[Le]?(t=t.u,(e=String(e).toString())in t.a&&(-1<(n=Ve(o=t.a[e],n,r,i))&&(Fe(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):(t=t&&Ze(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Ve(e,n,r,i)),(n=-1<t?e[t]:null)&&Qe(n))}function Qe(t){if("number"!=typeof t&&t&&!t.ta){var e=t.src;if(e&&e[Le])qe(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Ye(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Ze(e))?(qe(n,t),0==n.b&&(n.src=null,e[Be]=null)):Fe(t)}}}function Ye(t){return t in We?We[t]:We[t]="on"+t}function Xe(t,e,n,r){var i=!0;if((t=Ze(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ta&&(o=Je(o,r),i=i&&!1!==o)}return i}function Je(t,e){var n=t.listener,r=t.Pa||t.src;return t.Ka&&Qe(t),n.call(r,e)}function $e(t,e){if(t.ta)return!0;if(ke)return Je(t,new De(e,this));if(!e)t:{e=["window","event"];for(var n=l,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(e=new De(r=e,this),n=!0,!(r.keyCode<0||null!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}!i&&null!=r.returnValue||(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=Xe(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=Xe(r[i],t,!1,e),n=n&&o}return n}function Ze(t){return(t=t[Be])instanceof je?t:null}var tn="__closure_events_fn_"+(1e9*Math.random()>>>0);function en(e){return y(e)?e:(e[tn]||(e[tn]=function(t){return e.handleEvent(t)}),e[tn])}function nn(){ce.call(this),this.u=new je(this),(this.Sb=this).Xa=null}function rn(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function on(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function sn(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.ta&&s.capture==n){var a=s.listener,u=s.Pa||s.src;s.Ka&&qe(t.u,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Mb}function an(t,e,n){if(y(t))n&&(t=_(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=_(t.handleEvent,t)}return 2147483647<Number(e)?-1:l.setTimeout(t,e||0)}function un(n){var r=null;return new Bt(function(t,e){-1==(r=an(function(){t(void 0)},n))&&e(Error("Failed to schedule timer."))}).s(function(t){throw l.clearTimeout(r),t})}function cn(t){if(t.U&&"function"==typeof t.U)return t.U();if(h(t))return t.split("");if(v(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}function hn(t){if(t.X&&"function"==typeof t.X)return t.X();if(!t.U||"function"!=typeof t.U){if(v(t)||h(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}for(var r in e=[],n=0,t)e[n++]=r;return e}}function ln(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ln)for(n=t.X(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function fn(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];pn(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)pn(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function pn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}T(nn,ce),nn.prototype[Le]=!0,nn.prototype.addEventListener=function(t,e,n,r){He(this,t,e,n,r)},nn.prototype.removeEventListener=function(t,e,n,r){ze(this,t,e,n,r)},nn.prototype.dispatchEvent=function(t){var e,n=this.Xa;if(n)for(e=[];n;n=n.Xa)e.push(n);n=this.Sb;var r=t.type||t;if(h(t))t=new Pe(t,n);else if(t instanceof Pe)t.target=t.target||n;else{var i=t;Q(t=new Pe(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.b=e[o];i=sn(s,r,!0,t)&&i}if(i=sn(s=t.b=n,r,!0,t)&&i,i=sn(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=sn(s=t.b=e[o],r,!1,t)&&i;return i},nn.prototype.za=function(){if(nn.qb.za.call(this),this.u){var t,e=this.u;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Fe(n[r]);delete e.a[t],e.b--}}this.Xa=null},(t=ln.prototype).U=function(){fn(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},t.X=function(){return fn(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0},t.get=function(t,e){return pn(this.b,t)?this.b[t]:e},t.set=function(t,e){pn(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},t.forEach=function(t,e){for(var n=this.X(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var dn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function vn(t,e){var n;this.b=this.i=this.f="",this.l=null,this.g=this.c="",this.h=!1,t instanceof vn?(this.h=void 0!==e?e:t.h,yn(this,t.f),this.i=t.i,this.b=t.b,gn(this,t.l),this.c=t.c,mn(this,Un(t.a)),this.g=t.g):t&&(n=String(t).match(dn))?(this.h=!!e,yn(this,n[1]||"",!0),this.i=In(n[2]||""),this.b=In(n[3]||"",!0),gn(this,n[4]),this.c=In(n[5]||"",!0),mn(this,n[6]||"",!0),this.g=In(n[7]||"")):(this.h=!!e,this.a=new On(null,this.h))}function yn(t,e,n){t.f=n?In(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function gn(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.l=e}else t.l=null}function mn(t,e,n){e instanceof On?(t.a=e,function(t,e){e&&!t.f&&(Pn(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(xn(this,e),Mn(this,n,t))},t)),t.f=e}(t.a,t.h)):(n||(e=Tn(e,kn)),t.a=new On(e,t.h))}function wn(t,e,n){t.a.set(e,n)}function bn(t,e){return t.a.get(e)}function _n(t){return t instanceof vn?new vn(t):new vn(t,void 0)}function En(t,e){var n=new vn(null,void 0);return yn(n,"https"),t&&(n.b=t),e&&(n.c=e),n}function In(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Tn(t,e,n){return h(t)?(t=encodeURI(t).replace(e,Sn),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Sn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}vn.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Tn(e,Cn,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.i)&&t.push(Tn(e,Cn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.l)&&t.push(":",String(n))),(n=this.c)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Tn(n,"/"==n.charAt(0)?An:Nn,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Tn(n,Rn)),t.join("")},vn.prototype.resolve=function(t){var e=new vn(this),n=!!t.f;n?yn(e,t.f):n=!!t.i,n?e.i=t.i:n=!!t.b,n?e.b=t.b:n=null!=t.l;var r=t.c;if(n)gn(e,t.l);else if(n=!!t.c){if("/"!=r.charAt(0))if(this.b&&!this.c)r="/"+r;else{var i=e.c.lastIndexOf("/");-1!=i&&(r=e.c.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(vt(i,"./")||vt(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.c=r:n=""!==t.a.toString(),n?mn(e,Un(t.a)):n=!!t.g,n&&(e.g=t.g),e};var Cn=/[#\/\?@]/g,Nn=/[#\?:]/g,An=/[#\?]/g,kn=/[#\?@]/g,Rn=/#/g;function On(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Pn(n){n.a||(n.a=new ln,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function Dn(t){var e=hn(t);if(void 0===e)throw Error("Keys are undefined");var n=new On(null,void 0);t=cn(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];d(o)?Mn(n,i,o):n.add(i,o)}return n}function xn(t,e){Pn(t),e=Fn(t,e),pn(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,pn((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&fn(t)))}function Ln(t,e){return Pn(t),e=Fn(t,e),pn(t.a.b,e)}function Mn(t,e,n){xn(t,e),0<n.length&&(t.c=null,t.a.set(Fn(t,e),W(n)),t.b+=n.length)}function Un(t){var e=new On;return e.c=t.c,t.a&&(e.a=new ln(t.a),e.b=t.b),e}function Fn(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}(t=On.prototype).add=function(t,e){Pn(this),this.c=null,t=Fn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},t.clear=function(){this.a=this.c=null,this.b=0},t.forEach=function(n,r){Pn(this),this.a.forEach(function(t,e){M(t,function(t){n.call(r,t,e,this)},this)},this)},t.X=function(){Pn(this);for(var t=this.a.U(),e=this.a.X(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},t.U=function(t){Pn(this);var e=[];if(h(t))Ln(this,t)&&(e=B(e,this.a.get(Fn(this,t))));else{t=this.a.U();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},t.set=function(t,e){return Pn(this),this.c=null,Ln(this,t=Fn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},t.get=function(t,e){return t&&0<(t=this.U(t)).length?String(t[0]):e},t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.X(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.U(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")};var jn=!ye||9<=Number(Se);function qn(t){var e=document;return h(t)?e.getElementById(t):t}function Vn(n,t){H(t,function(t,e){t&&"object"==typeof t&&t.qa&&(t=t.pa()),"style"==e?n.style.cssText=t:"class"==e?n.className=t:"for"==e?n.htmlFor=t:Bn.hasOwnProperty(e)?n.setAttribute(Bn[e],t):0==e.lastIndexOf("aria-",0)||0==e.lastIndexOf("data-",0)?n.setAttribute(e,t):n[e]=t})}var Bn={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function Wn(t,e,n){var r=arguments,i=document,o=String(r[0]),s=r[1];if(!jn&&s&&(s.name||s.type)){if(o=["<",o],s.name&&o.push(' name="',Lt(s.name),'"'),s.type){o.push(' type="',Lt(s.type),'"');var a={};Q(a,s),delete a.type,s=a}o.push(">"),o=o.join("")}return o=i.createElement(o),s&&(h(s)?o.className=s:d(s)?o.className=s.join(" "):Vn(o,s)),2<r.length&&function(e,n,t){function r(t){t&&n.appendChild(h(t)?e.createTextNode(t):t)}for(var i=2;i<t.length;i++){var o=t[i];!v(o)||g(o)&&0<o.nodeType?r(o):M(Hn(o)?W(o):o,r)}}(i,o,r),o}function Hn(t){if(t&&"number"==typeof t.length){if(g(t))return"function"==typeof t.item||"string"==typeof t.item;if(y(t))return"function"==typeof t.item}return!1}function Gn(t){var e=[];return function t(e,n,r){if(null==n)r.push("null");else{if("object"==typeof n){if(d(n)){var i=n;n=i.length,r.push("[");for(var o="",s=0;s<n;s++)r.push(o),t(e,i[s],r),o=",";return void r.push("]")}if(!(n instanceof String||n instanceof Number||n instanceof Boolean)){for(i in r.push("{"),o="",n)Object.prototype.hasOwnProperty.call(n,i)&&("function"!=typeof(s=n[i])&&(r.push(o),Yn(i,r),r.push(":"),t(e,s,r),o=","));return void r.push("}")}n=n.valueOf()}switch(typeof n){case"string":Yn(n,r);break;case"number":r.push(isFinite(n)&&!isNaN(n)?String(n):"null");break;case"boolean":r.push(String(n));break;case"function":r.push("null");break;default:throw Error("Unknown type: "+typeof n)}}}(new Kn,t,e),e.join("")}function Kn(){}var zn={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Qn=/\uffff/.test("ï¿¿")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function Yn(t,e){e.push('"',t.replace(Qn,function(t){var e=zn[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),zn[t]=e),e}),'"')}function Xn(){var t=vr();return ye&&!!Se&&11==Se||/Edge\/\d+/.test(t)}function Jn(){return l.window&&l.window.location.href||self&&self.location&&self.location.href||""}function $n(t,e){e=e||l.window;var n="about:blank";t&&(n=mt(bt(t)).toString()),e.location.href=n}function Zn(t){return!!((t=(t||vr()).toLowerCase()).match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function tr(t){t=t||l.window;try{t.close()}catch(t){}}function er(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;for(s in e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=vr().toLowerCase(),r&&(e.target=r,vt(n,"crios/")&&(e.target="_blank")),fr(vr())==hr&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof gt?n:bt(void 0!==n.href?n.href:String(n)),n=t.target||n.target,i=[],t)switch(s){case"width":case"height":case"top":case"left":i.push(s+"="+t[s]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(s+"="+(t[s]?1:0))}var s=i.join(",");if((Ct("iPhone")&&!Ct("iPod")&&!Ct("iPad")||Ct("iPad")||Ct("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(x(s=r.document.createElement("A"),"HTMLAnchorElement"),e instanceof gt||e instanceof gt||(e="object"==typeof e&&e.qa?e.pa():String(e),wt.test(e)||(e="about:invalid#zClosurez"),e=It(e)),s.href=mt(e),s.setAttribute("target",n),t.noreferrer&&s.setAttribute("rel","noreferrer"),(t=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),s.dispatchEvent(t),s={}):t.noreferrer?(s=r.open("",n,s),t=mt(e).toString(),s&&(me&&vt(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),s.opener=null,t=Rt('<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Lt(t)+'">'),s.document.write(At(t)),s.document.close())):(s=r.open(mt(e).toString(),n,s))&&t.noopener&&(s.opener=null),s)try{s.focus()}catch(t){}return s}var nr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rr=/^[^@]+@[^@]+$/;function ir(){var e=null;return new Bt(function(t){"complete"==l.document.readyState?t():(e=function(){t()},Ke(window,"load",e))}).s(function(t){throw ze(window,"load",e),t})}function or(t){return t=t||vr(),!("file:"!==br()&&"ionic:"!==br()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function sr(){var t=l.window;try{return!(!t||t==t.top)}catch(t){return!1}}function ar(){return void 0!==l.WorkerGlobalScope&&"function"==typeof l.importScripts}function ur(){return fl.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":fl.INTERNAL.hasOwnProperty("node")?"Node":ar()?"Worker":"Browser"}function cr(){var t=ur();return"ReactNative"===t||"Node"===t}var hr="Firefox",lr="Chrome";function fr(t){var e=t.toLowerCase();return vt(e,"opera/")||vt(e,"opr/")||vt(e,"opios/")?"Opera":vt(e,"iemobile")?"IEMobile":vt(e,"msie")||vt(e,"trident/")?"IE":vt(e,"edge/")?"Edge":vt(e,"firefox/")?hr:vt(e,"silk/")?"Silk":vt(e,"blackberry")?"Blackberry":vt(e,"webos")?"Webos":!vt(e,"safari/")||vt(e,"chrome/")||vt(e,"crios/")||vt(e,"android")?!vt(e,"chrome/")&&!vt(e,"crios/")||vt(e,"edge/")?vt(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":lr:"Safari"}var pr={Wc:"FirebaseCore-web",Yc:"FirebaseUI-web"};function dr(t,e){e=e||[];var n,r=[],i={};for(n in pr)i[pr[n]]=!0;for(n=0;n<e.length;n++)void 0!==i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),(e=r).length||(e=["FirebaseCore-web"]),"Browser"===(r=ur())?r=fr(i=vr()):"Worker"===r&&(r=fr(i=vr())+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function vr(){return l.navigator&&l.navigator.userAgent||""}function yr(t,e){t=t.split("."),e=e||l;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function gr(){try{var t=l.localStorage,e=Sr();if(t)return t.setItem(e,"1"),t.removeItem(e),!Xn()||!!l.indexedDB}catch(t){return ar()&&!!l.indexedDB}return!1}function mr(){return(wr()||"chrome-extension:"===br()||or())&&!cr()&&gr()&&!ar()}function wr(){return"http:"===br()||"https:"===br()}function br(){return l.location&&l.location.protocol||null}function _r(t){return!Zn(t=t||vr())&&fr(t)!=hr}function Er(t){return void 0===t?null:Gn(t)}function Ir(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function Tr(t){if(null!==t)return JSON.parse(t)}function Sr(t){return t||Math.floor(1e9*Math.random()).toString()}function Cr(t){return"Safari"!=fr(t=t||vr())&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function Nr(){var t=l.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function Ar(t,e){if(e<t)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=vr(),e=ur(),this.b=Zn(t)||"ReactNative"===e}function kr(){var t=l.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState}function Rr(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function Or(){return!(!yr("fireauth.oauthhelper",l)&&!yr("fireauth.iframe",l))}Ar.prototype.get=function(){var t=l.navigator;return!t||"boolean"!=typeof t.onLine||!wr()&&"chrome-extension:"!==br()&&void 0===t.connection||t.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Pr,Dr={};function xr(t){Dr[t]||(Dr[t]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t))}try{var Lr={};Object.defineProperty(Lr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Lr,"abcd",{configurable:!0,enumerable:!0,value:2}),Pr=2==Lr.abcd}catch(t){Pr=!1}function Mr(t,e,n){Pr?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function Ur(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&Mr(t,n,e[n])}function Fr(t){var e={};return Ur(e,t),e}function jr(t){var e=t;if("object"==typeof t&&null!=t)for(var n in e="length"in t?[]:{},t)Mr(e,n,jr(t[n]));return e}function qr(t){var e={},n=t[Br],r=t[Wr];if(!(t=t[Hr])||t!=Vr&&!n)throw Error("Invalid provider user info!");e[Kr]=r||null,e[Gr]=n||null,Mr(this,Qr,t),Mr(this,zr,jr(e))}var Vr="EMAIL_SIGNIN",Br="email",Wr="newEmail",Hr="requestType",Gr="email",Kr="fromEmail",zr="data",Qr="operation";function Yr(t,e){this.code=Jr+t,this.message=e||$r[t]||""}function Xr(t){var e=t&&t.code;return e?new Yr(e.substring(Jr.length),t.message):null}T(Yr,Error),Yr.prototype.A=function(){return{code:this.code,message:this.message}},Yr.prototype.toJSON=function(){return this.A()};var Jr="auth/",$r={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."};function Zr(t){var e=bn(t=_n(t),ti)||null,n=bn(t,ei)||null,r=bn(t,ii)||null;if(r=r&&si[r]||null,!e||!n||!r)throw new Yr("argument-error",ti+", "+ei+"and "+ii+" are required in a valid action code URL.");Ur(this,{apiKey:e,operation:r,code:n,continueUrl:bn(t,ni)||null,languageCode:bn(t,ri)||null,tenantId:bn(t,oi)||null})}var ti="apiKey",ei="oobCode",ni="continueUrl",ri="languageCode",ii="mode",oi="tenantId",si={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",signIn:Vr,verifyEmail:"VERIFY_EMAIL"};function ai(t){try{return new Zr(t)}catch(t){return null}}function ui(t){var e=t[pi];if(void 0===e)throw new Yr("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Yr("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[ci];if(n&&"object"==typeof n){e=n[yi];var r=n[di];if(n=n[vi],"string"==typeof e&&e.length){if(this.a=e,void 0!==r&&"boolean"!=typeof r)throw new Yr("argument-error",di+" property must be a boolean when specified.");if(this.g=!!r,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Yr("argument-error",vi+" property must be a non empty string when specified.");this.b=n||null}else{if(void 0!==e)throw new Yr("argument-error",yi+" property must be a non empty string when specified.");if(void 0!==r||void 0!==n)throw new Yr("missing-android-pkg-name")}}else if(void 0!==n)throw new Yr("argument-error",ci+" property must be a non null object when specified.");if(this.f=null,(e=t[fi])&&"object"==typeof e){if("string"==typeof(e=e[gi])&&e.length)this.f=e;else if(void 0!==e)throw new Yr("argument-error",gi+" property must be a non empty string when specified.")}else if(void 0!==e)throw new Yr("argument-error",fi+" property must be a non null object when specified.");if(void 0!==(e=t[li])&&"boolean"!=typeof e)throw new Yr("argument-error",li+" property must be a boolean when specified.");if(this.c=!!e,void 0!==(t=t[hi])&&("string"!=typeof t||"string"==typeof t&&!t.length))throw new Yr("argument-error",hi+" property must be a non empty string when specified.");this.i=t||null}var ci="android",hi="dynamicLinkDomain",li="handleCodeInApp",fi="iOS",pi="url",di="installApp",vi="minimumVersion",yi="packageName",gi="bundleId";function mi(t){var e={};for(var n in e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f,e.dynamicLinkDomain=t.i,e)null===e[n]&&delete e[n];return e}var wi=null,bi=null;function _i(t){var e="";return function(r,t){function e(t){for(;i<r.length;){var e=r.charAt(i++),n=bi[e];if(null!=n)return n;if(!/^[\s\xa0]*$/.test(e))throw Error("Unknown base64 encoding at char: "+e)}return t}!function(){if(!wi){wi={},bi={};for(var t=0;t<65;t++)wi[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),62<=(bi[wi[t]]=t)&&(bi["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}();for(var i=0;;){var n=e(-1),o=e(0),s=e(64),a=e(64);if(64===a&&-1===n)break;t(n<<2|o>>4),64!=s&&(t(o<<4&240|s>>2),64!=a&&t(s<<6&192|a))}}(t,function(t){e+=String.fromCharCode(t)}),e}function Ei(t){this.f=t.sub,this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.c=t.firebase&&t.firebase.tenant||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Ii(t){return(t=Ti(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Ei(t):null}function Ti(t){if(!t)return null;if(3!=(t=t.split(".")).length)return null;for(var e=(4-(t=t[1]).length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(_i(t))}catch(t){}return null}Ei.prototype.R=function(){return this.c},Ei.prototype.g=function(){return this.b};var Si,Ci={bd:{cb:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://securetoken.googleapis.com/v1/token",id:"p"},dd:{cb:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",ib:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},ed:{cb:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",ib:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};function Ni(t){for(var e in Ci)if(Ci[e].id===t)return{firebaseEndpoint:(t=Ci[e]).cb,secureTokenEndpoint:t.ib};return null}Si=Ni("__EID__")?"__EID__":void 0;var Ai="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),ki=["client_id","response_type","scope","redirect_uri","state"],Ri={Xc:{Ea:"locale",sa:700,ra:600,Fa:"facebook.com",Qa:ki},Zc:{Ea:null,sa:500,ra:750,Fa:"github.com",Qa:ki},$c:{Ea:"hl",sa:515,ra:680,Fa:"google.com",Qa:ki},fd:{Ea:"lang",sa:485,ra:705,Fa:"twitter.com",Qa:Ai},Vc:{Ea:"locale",sa:600,ra:600,Fa:"apple.com",Qa:[]}};function Oi(t){for(var e in Ri)if(Ri[e].Fa==t)return Ri[e];return null}function Pi(t){var e={};e["facebook.com"]=Ui,e["google.com"]=ji,e["github.com"]=Fi,e["twitter.com"]=qi;var n=t&&t[xi];try{if(n)return e[n]?new e[n](t):new Mi(t);if(void 0!==t[Di])return new Li(t)}catch(t){}return null}var Di="idToken",xi="providerId";function Li(t){var e=t[xi];if(!e&&t[Di]){var n=Ii(t[Di]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,void 0!==t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),Mr(this,"providerId",e),Mr(this,"isNewUser",n)}function Mi(t){Li.call(this,t),Mr(this,"profile",jr((t=Tr(t.rawUserInfo||"{}"))||{}))}function Ui(t){if(Mi.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function Fi(t){if(Mi.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");Mr(this,"username",this.profile&&this.profile.login||null)}function ji(t){if(Mi.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function qi(t){if(Mi.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");Mr(this,"username",t.screenName||null)}function Vi(t){var e=_n(t),n=bn(e,"link"),r=bn(_n(n),"link");return bn(_n(e=bn(e,"deep_link_id")),"link")||e||r||n||t}function Bi(){}function Wi(t,n){return t.then(function(t){if(t[Ps]){var e=Ii(t[Ps]);if(!e||n!=e.f)throw new Yr("user-mismatch");return t}throw new Yr("user-mismatch")}).s(function(t){throw t&&t.code&&t.code==Jr+"user-not-found"?new Yr("user-mismatch"):t})}function Hi(t,e){if(!e)throw new Yr("internal-error","failed to construct a credential");this.a=e,Mr(this,"providerId",t),Mr(this,"signInMethod",t)}function Gi(t){return{pendingToken:t.a,requestUri:"http://localhost"}}function Ki(t){if(t&&t.providerId&&t.signInMethod&&0==t.providerId.indexOf("saml.")&&t.pendingToken)try{return new Hi(t.providerId,t.pendingToken)}catch(t){}return null}function zi(t,e,n){if(this.a=null,e.idToken||e.accessToken)e.idToken&&Mr(this,"idToken",e.idToken),e.accessToken&&Mr(this,"accessToken",e.accessToken),e.nonce&&!e.pendingToken&&Mr(this,"nonce",e.nonce),e.pendingToken&&(this.a=e.pendingToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Yr("internal-error","failed to construct a credential");Mr(this,"accessToken",e.oauthToken),Mr(this,"secret",e.oauthTokenSecret)}Mr(this,"providerId",t),Mr(this,"signInMethod",n)}function Qi(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,t.nonce&&!t.a&&(e.nonce=t.nonce),e={postBody:Dn(e).toString(),requestUri:"http://localhost"},t.a&&(delete e.postBody,e.pendingToken=t.a),e}function Yi(t){if(t&&t.providerId&&t.signInMethod){var e={idToken:t.oauthIdToken,accessToken:t.oauthTokenSecret?null:t.oauthAccessToken,oauthTokenSecret:t.oauthTokenSecret,oauthToken:t.oauthTokenSecret&&t.oauthAccessToken,nonce:t.nonce,pendingToken:t.pendingToken};try{return new zi(t.providerId,e,t.signInMethod)}catch(t){}}return null}function Xi(t,e){this.Fc=e||[],Ur(this,{providerId:t,isOAuthProvider:!0}),this.zb={},this.eb=(Oi(t)||{}).Ea||null,this.bb=null}function Ji(t){if("string"!=typeof t||0!=t.indexOf("saml."))throw new Yr("argument-error",'SAML provider IDs must be prefixed with "saml."');Xi.call(this,t,[])}function $i(t){Xi.call(this,t,ki),this.a=[]}function Zi(){$i.call(this,"facebook.com")}function to(t){if(!t)throw new Yr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new Zi).credential({accessToken:e})}function eo(){$i.call(this,"github.com")}function no(t){if(!t)throw new Yr("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return g(t)&&(e=t.accessToken),(new eo).credential({accessToken:e})}function ro(){$i.call(this,"google.com"),this.ya("profile")}function io(t,e){var n=t;return g(t)&&(n=t.idToken,e=t.accessToken),(new ro).credential({idToken:n,accessToken:e})}function oo(){Xi.call(this,"twitter.com",Ai)}function so(t,e){var n=t;if(g(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Yr("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new zi("twitter.com",n,"twitter.com")}function ao(t,e,n){this.a=t,this.c=e,Mr(this,"providerId","password"),Mr(this,"signInMethod",n===co.EMAIL_LINK_SIGN_IN_METHOD?co.EMAIL_LINK_SIGN_IN_METHOD:co.EMAIL_PASSWORD_SIGN_IN_METHOD)}function uo(t){return t&&t.email&&t.password?new ao(t.email,t.password,t.signInMethod):null}function co(){Ur(this,{providerId:"password",isOAuthProvider:!1})}function ho(t,e){if(!(e=lo(e)))throw new Yr("argument-error","Invalid email link!");return new ao(t,e.code,co.EMAIL_LINK_SIGN_IN_METHOD)}function lo(t){return(t=ai(t=Vi(t)))&&t.operation===Vr?t:null}function fo(t){if(!(t.Va&&t.Ua||t.Ha&&t.ba))throw new Yr("internal-error");this.a=t,Mr(this,"providerId","phone"),Mr(this,"signInMethod","phone")}function po(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var n={};return M(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(t){e[t]&&(n[t]=e[t])}),new fo(n)}return null}function vo(t){return t.a.Ha&&t.a.ba?{temporaryProof:t.a.Ha,phoneNumber:t.a.ba}:{sessionInfo:t.a.Va,code:t.a.Ua}}function yo(t){try{this.a=t||fl.auth()}catch(t){throw new Yr("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Ur(this,{providerId:"phone",isOAuthProvider:!1})}function go(t,e){if(!t)throw new Yr("missing-verification-id");if(!e)throw new Yr("missing-verification-code");return new fo({Va:t,Ua:e})}function mo(t){if(t.temporaryProof&&t.phoneNumber)return new fo({Ha:t.temporaryProof,ba:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret,i=t&&t.nonce,o=t&&t.oauthIdToken,s=t&&t.pendingToken;try{switch(e){case"google.com":return io(o,n);case"facebook.com":return to(n);case"github.com":return no(n);case"twitter.com":return so(n,r);default:return n||r||o||s?s?0==e.indexOf("saml.")?new Hi(e,s):new zi(e,{pendingToken:s,idToken:t.oauthIdToken,accessToken:t.oauthAccessToken},e):new $i(e).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(t){return null}}function wo(t){if(!t.isOAuthProvider)throw new Yr("invalid-oauth-provider")}function bo(t,e,n,r,i,o,s){if(this.c=t,this.b=e||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=s||null,this.a=i||null,!this.g&&!this.a)throw new Yr("invalid-auth-event");if(this.g&&this.a)throw new Yr("invalid-auth-event");if(this.g&&!this.f)throw new Yr("invalid-auth-event")}function _o(t){return(t=t||{}).type?new bo(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Xr(t.error),t.postBody,t.tenantId):null}function Eo(){this.b=null,this.a=[]}T(Mi,Li),T(Ui,Mi),T(Fi,Mi),T(ji,Mi),T(qi,Mi),Hi.prototype.na=function(t){return Xs(t,Gi(this))},Hi.prototype.b=function(t,e){var n=Gi(this);return n.idToken=e,Js(t,n)},Hi.prototype.f=function(t,e){return Wi($s(t,Gi(this)),e)},Hi.prototype.A=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},zi.prototype.na=function(t){return Xs(t,Qi(this))},zi.prototype.b=function(t,e){var n=Qi(this);return n.idToken=e,Js(t,n)},zi.prototype.f=function(t,e){return Wi($s(t,Qi(this)),e)},zi.prototype.A=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),this.nonce&&(t.nonce=this.nonce),this.a&&(t.pendingToken=this.a),t},Xi.prototype.Ga=function(t){return this.zb=K(t),this},T(Ji,Xi),T($i,Xi),$i.prototype.ya=function(t){return j(this.a,t)||this.a.push(t),this},$i.prototype.Hb=function(){return W(this.a)},$i.prototype.credential=function(t,e){var n;if(!(n=g(t)?{idToken:t.idToken||null,accessToken:t.accessToken||null,nonce:t.rawNonce||null}:{idToken:t||null,accessToken:e||null}).idToken&&!n.accessToken)throw new Yr("argument-error","credential failed: must provide the ID token and/or the access token.");return new zi(this.providerId,n,this.providerId)},T(Zi,$i),Mr(Zi,"PROVIDER_ID","facebook.com"),Mr(Zi,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),T(eo,$i),Mr(eo,"PROVIDER_ID","github.com"),Mr(eo,"GITHUB_SIGN_IN_METHOD","github.com"),T(ro,$i),Mr(ro,"PROVIDER_ID","google.com"),Mr(ro,"GOOGLE_SIGN_IN_METHOD","google.com"),T(oo,Xi),Mr(oo,"PROVIDER_ID","twitter.com"),Mr(oo,"TWITTER_SIGN_IN_METHOD","twitter.com"),ao.prototype.na=function(t){return this.signInMethod==co.EMAIL_LINK_SIGN_IN_METHOD?Na(t,sa,{email:this.a,oobCode:this.c}):Na(t,Ia,{email:this.a,password:this.c})},ao.prototype.b=function(t,e){return this.signInMethod==co.EMAIL_LINK_SIGN_IN_METHOD?Na(t,aa,{idToken:e,email:this.a,oobCode:this.c}):Na(t,ga,{idToken:e,email:this.a,password:this.c})},ao.prototype.f=function(t,e){return Wi(this.na(t),e)},ao.prototype.A=function(){return{email:this.a,password:this.c,signInMethod:this.signInMethod}},Ur(co,{PROVIDER_ID:"password"}),Ur(co,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Ur(co,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),fo.prototype.na=function(t){return t.Wa(vo(this))},fo.prototype.b=function(t,e){var n=vo(this);return n.idToken=e,Na(t,Sa,n)},fo.prototype.f=function(t,e){var n=vo(this);return n.operation="REAUTH",Wi(t=Na(t,Ca,n),e)},fo.prototype.A=function(){var t={providerId:"phone"};return this.a.Va&&(t.verificationId=this.a.Va),this.a.Ua&&(t.verificationCode=this.a.Ua),this.a.Ha&&(t.temporaryProof=this.a.Ha),this.a.ba&&(t.phoneNumber=this.a.ba),t},yo.prototype.Wa=function(e,n){var r=this.a.b;return Yt(n.verify()).then(function(t){if(!h(t))throw new Yr("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return function(t,e){return Na(t,va,e)}(r,{phoneNumber:e,recaptchaToken:t}).then(function(t){return"function"==typeof n.reset&&n.reset(),t},function(t){throw"function"==typeof n.reset&&n.reset(),t});default:throw new Yr("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},Ur(yo,{PROVIDER_ID:"phone"}),Ur(yo,{PHONE_SIGN_IN_METHOD:"phone"}),bo.prototype.getUid=function(){var t=[];return t.push(this.c),this.b&&t.push(this.b),this.f&&t.push(this.f),this.h&&t.push(this.h),t.join("-")},bo.prototype.R=function(){return this.h},bo.prototype.A=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.A()}};var Io,To=null;function So(t){var e="unauthorized-domain",n=void 0,r=_n(t);t=r.b,"chrome-extension"==(r=r.f)?n=xt("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=xt("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Yr.call(this,e,n)}function Co(t,e,n){Yr.call(this,t,n),(t=e||{}).Ab&&Mr(this,"email",t.Ab),t.ba&&Mr(this,"phoneNumber",t.ba),t.credential&&Mr(this,"credential",t.credential),t.Qb&&Mr(this,"tenantId",t.Qb)}function No(t){if(t.code){var e=t.code||"";0==e.indexOf(Jr)&&(e=e.substring(Jr.length));var n={credential:mo(t),Qb:t.tenantId};if(t.email)n.Ab=t.email;else if(t.phoneNumber)n.ba=t.phoneNumber;else if(!n.credential)return new Yr(e,t.message||void 0);return new Co(e,n,t.message)}return null}function Ao(){}function ko(t){return t.c||(t.c=t.b())}function Ro(){}function Oo(t){if(t.f||"undefined"!=typeof XMLHttpRequest||"undefined"==typeof ActiveXObject)return t.f;for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}function Po(){}function Do(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=_(this.fc,this),this.a.onerror=_(this.Ib,this),this.a.onprogress=_(this.gc,this),this.a.ontimeout=_(this.kc,this)}function xo(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Lo(t,e,n){this.reset(t,e,n,void 0,void 0)}function Mo(t){this.f=t,this.b=this.c=this.a=null}function Uo(t,e){this.name=t,this.value=e}T(So,Yr),T(Co,Yr),Co.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber),this.tenantId&&(t.tenantId=this.tenantId);var e=this.credential&&this.credential.A();return e&&Q(t,e),t},Co.prototype.toJSON=function(){return this.A()},Ao.prototype.c=null,T(Ro,Ao),Ro.prototype.a=function(){var t=Oo(this);return t?new ActiveXObject(t):new XMLHttpRequest},Ro.prototype.b=function(){var t={};return Oo(this)&&(t[0]=!0,t[1]=!0),t},Io=new Ro,T(Po,Ao),Po.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Do;throw Error("Unsupported browser")},Po.prototype.b=function(){return{}},(t=Do.prototype).open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},t.fc=function(){this.status=200,this.response=this.responseText=this.a.responseText,xo(this,4)},t.Ib=function(){this.status=500,this.response=this.responseText="",xo(this,4)},t.kc=function(){this.Ib()},t.gc=function(){this.status=200,xo(this,1)},t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Lo.prototype.a=null,Lo.prototype.reset=function(t,e,n,r,i){delete this.a},Uo.prototype.toString=function(){return this.name};var Fo=new Uo("SEVERE",1e3),jo=new Uo("WARNING",900),qo=new Uo("CONFIG",700),Vo=new Uo("FINE",500);Mo.prototype.log=function(t,e,n){if(t.value>=function t(e){return e.c?e.c:e.a?t(e.a):(A("Root logger has no level set."),null)}(this).value)for(y(e)&&(e=e()),t=new Lo(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var Bo,Wo={},Ho=null;function Go(t){var e;if(Ho||(Ho=new Mo(""),(Wo[""]=Ho).c=qo),!(e=Wo[t])){e=new Mo(t);var n=t.lastIndexOf("."),r=t.substr(n+1);(n=Go(t.substr(0,n))).b||(n.b={}),(n.b[r]=e).a=n,Wo[t]=e}return e}function Ko(t,e){t&&t.log(Vo,e,void 0)}function zo(t){this.f=t}function Qo(t){nn.call(this),this.o=t,this.readyState=Yo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.i=new Headers,this.b=null,this.m="GET",this.g="",this.a=!1,this.h=Go("goog.net.FetchXmlHttp"),this.l=this.c=this.f=null}T(zo,Ao),zo.prototype.a=function(){return new Qo(this.f)},zo.prototype.b=(Bo={},function(){return Bo}),T(Qo,nn);var Yo=0;function Xo(t){t.c.read().then(t.ec.bind(t)).catch(t.Oa.bind(t))}function Jo(t,e){e&&t.f&&(t.status=t.f.status,t.statusText=t.f.statusText),t.readyState=4,t.f=null,t.c=null,t.l=null,$o(t)}function $o(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Zo(t){nn.call(this),this.headers=new ln,this.B=t||null,this.c=!1,this.w=this.a=null,this.h=this.O=this.l="",this.f=this.J=this.i=this.I=!1,this.g=0,this.o=null,this.m=ts,this.v=this.P=!1}(t=Qo.prototype).open=function(t,e){if(this.readyState!=Yo)throw this.abort(),Error("Error reopening a connection");this.m=t,this.g=e,this.readyState=1,$o(this)},t.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.i,method:this.m,credentials:void 0,cache:void 0};t&&(e.body=t),this.o.fetch(new Request(this.g,e)).then(this.jc.bind(this),this.Oa.bind(this))},t.abort=function(){this.response=this.responseText="",this.i=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Jo(this,!1)),this.readyState=Yo},t.jc=function(t){this.a&&(this.f=t,this.b||(this.b=t.headers,this.readyState=2,$o(this)),this.a&&(this.readyState=3,$o(this),this.a&&("arraybuffer"===this.responseType?t.arrayBuffer().then(this.hc.bind(this),this.Oa.bind(this)):void 0!==l.ReadableStream&&"body"in t?(this.response=this.responseText="",this.c=t.body.getReader(),this.l=new TextDecoder,Xo(this)):t.text().then(this.ic.bind(this),this.Oa.bind(this)))))},t.ec=function(t){if(this.a){var e=this.l.decode(t.value?t.value:new Uint8Array(0),{stream:!t.done});e&&(this.response=this.responseText+=e),t.done?Jo(this,!0):$o(this),3==this.readyState&&Xo(this)}},t.ic=function(t){this.a&&(this.response=this.responseText=t,Jo(this,!0))},t.hc=function(t){this.a&&(this.response=t,Jo(this,!0))},t.Oa=function(t){var e=this.h;e&&e.log(jo,"Failed to fetch url "+this.g,t instanceof Error?t:Error(t)),this.a&&Jo(this,!0)},t.setRequestHeader=function(t,e){this.i.append(t,e)},t.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.h)&&t.log(jo,"Attempting to get response header but no headers have been received for url: "+this.g,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var t=this.h;return t&&t.log(jo,"Attempting to get all response headers but no headers have been received for url: "+this.g,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},T(Zo,nn);var ts="";Zo.prototype.b=Go("goog.net.XhrIo");var es=/^https?$/i,ns=["POST","PUT"];function rs(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.O=n,e.I=!1,e.c=!0,e.a=e.B?e.B.a():Io.a(),e.w=e.B?ko(e.B):ko(Io),e.a.onreadystatechange=_(e.Lb,e);try{Ko(e.b,fs(e,"Opening Xhr")),e.J=!0,e.a.open(n,String(t),!0),e.J=!1}catch(t){return Ko(e.b,fs(e,"Error opening Xhr: "+t.message)),void os(e,t)}t=r||"";var o=new ln(e.headers);i&&function(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(v(t)||h(t))M(t,e,void 0);else for(var n=hn(t),r=cn(t),i=r.length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}(i,function(t,e){o.set(e,t)}),i=function(t){t:{for(var e=is,n=t.length,r=h(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:h(t)?t.charAt(e):t[e]}(o.X()),r=l.FormData&&t instanceof l.FormData,!j(ns,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.P&&(e.a.withCredentials=e.P);try{cs(e),0<e.g&&(e.v=function(t){return ye&&Ne(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}(e.a),Ko(e.b,fs(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.v)),e.v?(e.a.timeout=e.g,e.a.ontimeout=_(e.Ia,e)):e.o=an(e.Ia,e.g,e)),Ko(e.b,fs(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(t){Ko(e.b,fs(e,"Send error: "+t.message)),os(e,t)}}function is(t){return"content-type"==t.toLowerCase()}function os(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,ss(t),us(t)}function ss(t){t.I||(t.I=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function as(e){if(e.c&&void 0!==u)if(e.w[1]&&4==hs(e)&&2==ls(e))Ko(e.b,fs(e,"Local request error detected and ignored"));else if(e.i&&4==hs(e))an(e.Lb,0,e);else if(e.dispatchEvent("readystatechange"),4==hs(e)){Ko(e.b,fs(e,"Request complete")),e.c=!1;try{var t,n=ls(e);t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(dn)[1]||null;if(!o&&l.self&&l.self.location){var s=l.self.location.protocol;o=s.substr(0,s.length-1)}i=!es.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var a=2<hs(e)?e.a.statusText:""}catch(t){Ko(e.b,"Can not get status: "+t.message),a=""}e.h=a+" ["+ls(e)+"]",ss(e)}}finally{us(e)}}}function us(e,t){if(e.a){cs(e);var n=e.a,r=e.w[0]?p:null;e.a=null,e.w=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){(e=e.b)&&e.log(Fo,"Problem encountered resetting onreadystatechange: "+t.message,void 0)}}}function cs(t){t.a&&t.v&&(t.a.ontimeout=null),t.o&&(l.clearTimeout(t.o),t.o=null)}function hs(t){return t.a?t.a.readyState:0}function ls(t){try{return 2<hs(t)?t.a.status:-1}catch(t){return-1}}function fs(t,e){return e+" ["+t.O+" "+t.l+" "+ls(t)+"]"}function ps(t){var e=Ts;this.g=[],this.v=e,this.o=t||null,this.f=this.a=!1,this.c=void 0,this.u=this.w=this.i=!1,this.h=0,this.b=null,this.l=0}function ds(t,e,n){t.a=!0,t.c=n,t.f=!e,ms(t)}function vs(t){if(t.a){if(!t.u)throw new ws(t);t.u=!1}}function ys(t,e,n,r){t.g.push([e,n,r]),t.a&&ms(t)}function gs(t){return F(t.g,function(t){return y(t[1])})}function ms(e){if(e.h&&e.a&&gs(e)){var n=e.h,r=Es[n];r&&(l.clearTimeout(r.a),delete Es[n]),e.h=0}e.b&&(e.b.l--,delete e.b),n=e.c;for(var t=r=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],s=i[1];if(i=i[2],o=e.f?s:o)try{var a=o.call(i||e.o,n);void 0!==a&&(e.f=e.f&&(a==n||a instanceof Error),e.c=n=a),(S(n)||"function"==typeof l.Promise&&n instanceof l.Promise)&&(t=!0,e.i=!0)}catch(t){n=t,e.f=!0,gs(e)||(r=!0)}}e.c=n,t&&(a=_(e.m,e,!0),t=_(e.m,e,!1),n instanceof ps?(ys(n,a,t),n.w=!0):n.then(a,t)),r&&(n=new _s(n),Es[n.a]=n,e.h=n.a)}function ws(){C.call(this)}function bs(){C.call(this)}function _s(t){this.a=l.setTimeout(_(this.c,this),0),this.b=t}(t=Zo.prototype).Ia=function(){void 0!==u&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Ko(this.b,fs(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},t.abort=function(){this.a&&this.c&&(Ko(this.b,fs(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),us(this))},t.za=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),us(this,!0)),Zo.qb.za.call(this)},t.Lb=function(){this.va||(this.J||this.i||this.f?as(this):this.yc())},t.yc=function(){as(this)},t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ts:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(Fo,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return Ko(this.b,"Can not get response: "+t.message),null}},ps.prototype.cancel=function(t){if(this.a)this.c instanceof ps&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):(e.l--,e.l<=0&&e.cancel())}this.v?this.v.call(this.o,this):this.u=!0,this.a||(t=new bs(this),vs(this),ds(this,!1,t))}},ps.prototype.m=function(t,e){this.i=!1,ds(this,t,e)},ps.prototype.then=function(t,e,n){var r,i,o=new Bt(function(t,e){r=t,i=e});return ys(this,r,function(t){t instanceof bs?o.cancel():i(t)}),o.then(t,e,n)},ps.prototype.$goog_Thenable=!0,T(ws,C),ws.prototype.message="Deferred has already fired",ws.prototype.name="AlreadyCalledError",T(bs,C),bs.prototype.message="Deferred was canceled",bs.prototype.name="CanceledError",_s.prototype.c=function(){throw delete Es[this.a],this.b};var Es={};function Is(t){var e,n=document,r=et(t).toString(),i=document.createElement("SCRIPT"),o={Nb:i,Ia:void 0},s=new ps(o);return e=window.setTimeout(function(){Ss(i,!0);var t=new As(Ns,"Timeout reached for loading script "+r);vs(s),ds(s,!1,t)},5e3),o.Ia=e,i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Ss(i,!1,e),vs(s),ds(s,!0,null))},i.onerror=function(){Ss(i,!0,e);var t=new As(Cs,"Error while loading script "+r);vs(s),ds(s,!1,t)},Q(o={},{type:"text/javascript",charset:"UTF-8"}),Vn(i,o),function(t,e){x(t,"HTMLScriptElement"),t.src=et(e),null===f&&(f=(e=(e=l.document).querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&a.test(e)?e:""),(e=f)&&t.setAttribute("nonce",e)}(i,t),function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}(n).appendChild(i),s}function Ts(){if(this&&this.Nb){var t=this.Nb;t&&"SCRIPT"==t.tagName&&Ss(t,!0,this.Ia)}}function Ss(t,e,n){null!=n&&l.clearTimeout(n),t.onload=p,t.onerror=p,t.onreadystatechange=p,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}var Cs=0,Ns=1;function As(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),C.call(this,n),this.code=t}function ks(t){this.f=t}function Rs(t,e,n){if(this.c=t,t=e||{},this.l=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.u=t.secureTokenTimeout||Ds,this.g=K(t.secureTokenHeaders||xs),this.h=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=t.firebaseTimeout||Ls,this.a=K(t.firebaseHeaders||Ms),n&&(this.a["X-Client-Version"]=n,this.g["X-Client-Version"]=n),n="Node"==ur(),!(n=l.XMLHttpRequest||n&&fl.INTERNAL.node&&fl.INTERNAL.node.XMLHttpRequest)&&!ar())throw new Yr("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,ar()?this.f=new zo(self):cr()?this.f=new ks(n):this.f=new Po,this.b=null}T(As,C),T(ks,Ao),ks.prototype.a=function(){return new this.f},ks.prototype.b=function(){return{}};var Os,Ps="idToken",Ds=new Ar(3e4,6e4),xs={"Content-Type":"application/x-www-form-urlencoded"},Ls=new Ar(3e4,6e4),Ms={"Content-Type":"application/json"};function Us(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function Fs(t,e){e?(t.a["X-Client-Version"]=e,t.g["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.g["X-Client-Version"])}function js(t,e,n,r,i,o,s){(t=function(){var t=vr();return!((t=fr(t)!=lr?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&t<30)&&(!ye||!Se||9<Se)}()||ar()?_(t.o,t):(Os=Os||new Bt(function(t,e){!function(t,e){if(((window.gapi||{}).client||{}).request)t();else{l[Vs]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))},function(t,e){ys(t,null,e,void 0)}(Is(nt(qs,{onload:Vs})),function(){e(Error("CORS_UNSUPPORTED"))})}}(t,e)}),_(t.m,t)))(e,n,r,i,o,s)}Rs.prototype.R=function(){return this.b},Rs.prototype.o=function(t,n,e,r,i,o){if(ar()&&(void 0===l.fetch||void 0===l.Headers||void 0===l.Request))throw new Yr("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var s=new Zo(this.f);if(o){s.g=Math.max(0,o);var a=setTimeout(function(){s.dispatchEvent("timeout")},o)}rn(s,"complete",function(){a&&clearTimeout(a);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return Ko(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(t){e=null}n&&n(e)}),on(s,"ready",function(){a&&clearTimeout(a),le(this)}),on(s,"timeout",function(){a&&clearTimeout(a),le(this),n&&n(null)}),rs(s,t,e,r,i)};var qs=new Y($,"https://apis.google.com/js/client.js?onload=%{onload}"),Vs="__fcb"+Math.floor(1e6*Math.random()).toString();function Bs(t){if(!h(t=t.email)||!rr.test(t))throw new Yr("invalid-email")}function Ws(t){"email"in t&&Bs(t)}function Hs(t){if(!t[Ps])throw new Yr("internal-error")}function Gs(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Yr("internal-error")}else{if(!t.sessionInfo)throw new Yr("missing-verification-id");if(!t.code)throw new Yr("missing-verification-code")}}Rs.prototype.m=function(t,n,r,i,o){var s=this;Os.then(function(){window.gapi.client.setApiKey(s.c);var e=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:r,body:i,headers:o,authType:"none",callback:function(t){window.gapi.auth.setToken(e),n&&n(t)}})}).s(function(t){n&&n({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},Rs.prototype.ob=function(){return Na(this,ma,{})},Rs.prototype.rb=function(t,e){return Na(this,ya,{idToken:t,email:e})},Rs.prototype.sb=function(t,e){return Na(this,ga,{idToken:t,password:e})};var Ks={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function zs(t){if(!t.requestUri||!t.sessionId&&!t.postBody&&!t.pendingToken)throw new Yr("internal-error")}function Qs(t,e){return e.oauthIdToken&&e.providerId&&0==e.providerId.indexOf("oidc.")&&!e.pendingToken&&(t.sessionId?e.nonce=t.sessionId:t.postBody&&(Ln(t=new On(t.postBody),"nonce")&&(e.nonce=t.get("nonce")))),e}function Ys(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=No(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=No(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=No(t)):t.errorMessage&&(e=Aa(t.errorMessage)),e)throw e;if(!t[Ps])throw new Yr("internal-error")}function Xs(t,e){return e.returnIdpCredential=!0,Na(t,wa,e)}function Js(t,e){return e.returnIdpCredential=!0,Na(t,_a,e)}function $s(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Na(t,ba,e)}function Zs(t){if(!t.oobCode)throw new Yr("invalid-action-code")}(t=Rs.prototype).tb=function(t,r){var i={idToken:t},o=[];return H(Ks,function(t,e){var n=r[e];null===n?o.push(t):e in r&&(i[e]=n)}),o.length&&(i.deleteAttribute=o),Na(this,ya,i)},t.kb=function(t,e){return Q(t={requestType:"PASSWORD_RESET",email:t},e),Na(this,la,t)},t.lb=function(t,e){return Q(t={requestType:"EMAIL_SIGNIN",email:t},e),Na(this,ca,t)},t.jb=function(t,e){return Q(t={requestType:"VERIFY_EMAIL",idToken:t},e),Na(this,ha,t)},t.Wa=function(t){return Na(this,Ta,t)},t.ab=function(t,e){return Na(this,da,{oobCode:t,newPassword:e})},t.Ma=function(t){return Na(this,ea,{oobCode:t})},t.Ya=function(t){return Na(this,ta,{oobCode:t})};var ta={endpoint:"setAccountInfo",D:Zs,fa:"email",F:!0},ea={endpoint:"resetPassword",D:Zs,K:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new Yr("internal-error")},F:!0},na={endpoint:"signupNewUser",D:function(t){if(Bs(t),!t.password)throw new Yr("weak-password")},K:Hs,T:!0,F:!0},ra={endpoint:"createAuthUri",F:!0},ia={endpoint:"deleteAccount",V:["idToken"]},oa={endpoint:"setAccountInfo",V:["idToken","deleteProvider"],D:function(t){if(!d(t.deleteProvider))throw new Yr("internal-error")}},sa={endpoint:"emailLinkSignin",V:["email","oobCode"],D:Bs,K:Hs,T:!0,F:!0},aa={endpoint:"emailLinkSignin",V:["idToken","email","oobCode"],D:Bs,K:Hs,T:!0},ua={endpoint:"getAccountInfo"},ca={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new Yr("internal-error");Bs(t)},fa:"email",F:!0},ha={endpoint:"getOobConfirmationCode",V:["idToken","requestType"],D:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Yr("internal-error")},fa:"email",F:!0},la={endpoint:"getOobConfirmationCode",V:["requestType"],D:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Yr("internal-error");Bs(t)},fa:"email",F:!0},fa={wb:!0,endpoint:"getProjectConfig",Kb:"GET"},pa={wb:!0,endpoint:"getRecaptchaParam",Kb:"GET",K:function(t){if(!t.recaptchaSiteKey)throw new Yr("internal-error")}},da={endpoint:"resetPassword",D:Zs,fa:"email",F:!0},va={endpoint:"sendVerificationCode",V:["phoneNumber","recaptchaToken"],fa:"sessionInfo",F:!0},ya={endpoint:"setAccountInfo",V:["idToken"],D:Ws,T:!0},ga={endpoint:"setAccountInfo",V:["idToken"],D:function(t){if(Ws(t),!t.password)throw new Yr("weak-password")},K:Hs,T:!0},ma={endpoint:"signupNewUser",K:Hs,T:!0,F:!0},wa={endpoint:"verifyAssertion",D:zs,Ra:Qs,K:Ys,T:!0,F:!0},ba={endpoint:"verifyAssertion",D:zs,Ra:Qs,K:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Yr("user-not-found");if(t.errorMessage)throw Aa(t.errorMessage);if(!t[Ps])throw new Yr("internal-error")},T:!0,F:!0},_a={endpoint:"verifyAssertion",D:function(t){if(zs(t),!t.idToken)throw new Yr("internal-error")},Ra:Qs,K:Ys,T:!0},Ea={endpoint:"verifyCustomToken",D:function(t){if(!t.token)throw new Yr("invalid-custom-token")},K:Hs,T:!0,F:!0},Ia={endpoint:"verifyPassword",D:function(t){if(Bs(t),!t.password)throw new Yr("wrong-password")},K:Hs,T:!0,F:!0},Ta={endpoint:"verifyPhoneNumber",D:Gs,K:Hs,F:!0},Sa={endpoint:"verifyPhoneNumber",D:function(t){if(!t.idToken)throw new Yr("internal-error");Gs(t)},K:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",No(t);Hs(t)}},Ca={Yb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",D:Gs,K:Hs,F:!0};function Na(t,e,n){if(!function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(null==r||""===r)return!1}return!0}(n,e.V))return Xt(new Yr("internal-error"));var r,i=e.Kb||"POST";return Yt(n).then(e.D).then(function(){return e.T&&(n.returnSecureToken=!0),e.F&&t.b&&void 0===n.tenantId&&(n.tenantId=t.b),function(t,e,r,i,o,n){var s=_n(t.h+e);wn(s,"key",t.c),n&&wn(s,"cb",I().toString());var a="GET"==r;if(a)for(var u in i)i.hasOwnProperty(u)&&wn(s,u,i[u]);return new Bt(function(e,n){js(t,s.toString(),function(t){t?t.error?n(ka(t,o||{})):e(t):n(new Yr("network-request-failed"))},r,a?void 0:Gn(Ir(i)),t.a,t.i.get())})}(t,e.endpoint,i,n,e.Yb,e.wb||!1)}).then(function(t){return r=t,e.Ra?e.Ra(n,r):r}).then(e.K).then(function(){if(!e.fa)return r;if(!(e.fa in r))throw new Yr("internal-error");return r[e.fa]})}function Aa(t){return ka({error:{errors:[{message:t}],code:400,message:t}})}function ka(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new Yr(r[n]):null)return n;for(var i in n=t.error&&t.error.message||"",Q(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation"},e||{}),e=(e=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<e.length?e[1]:void 0,r)if(0===n.indexOf(i))return new Yr(r[i],e);return!e&&t&&(e=Er(t)),new Yr("internal-error",e)}function Ra(t){this.b=t,this.a=null,this.gb=function(o){return(xa=xa||new Bt(function(t,e){function n(){Nr(),yr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){Nr(),e(Error("Network Error"))},timeout:Pa.get()})}if(yr("gapi.iframes.Iframe"))t();else if(yr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();l[r]=function(){yr("gapi.load")?n():e(Error("Network Error"))},Yt(Is(r=nt(Oa,{onload:r}))).s(function(){e(Error("Network Error"))})}}).s(function(t){throw xa=null,t})).then(function(){return new Bt(function(r,i){yr("gapi.iframes.getContext")().open({where:document.body,url:o.b,messageHandlersFilter:yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(t){function e(){clearTimeout(n),r()}o.a=t,o.a.restyle({setHideOnLeave:!1});var n=setTimeout(function(){i(Error("Network Error"))},Da.get());t.ping(e).then(e,function(){i(Error("Network Error"))})})})})}(this)}var Oa=new Y($,"https://apis.google.com/js/api.js?onload=%{onload}"),Pa=new Ar(3e4,6e4),Da=new Ar(5e3,15e3),xa=null;function La(t,e,n){this.i=t,this.g=e,this.h=n,this.f=null,this.a=En(this.i,"/__/auth/iframe"),wn(this.a,"apiKey",this.g),wn(this.a,"appName",this.h),this.b=null,this.c=[]}function Ma(t,e,n,r,i){this.o=t,this.m=e,this.c=n,this.u=r,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function Ua(t){try{return fl.app(t).auth().Ca()}catch(t){return[]}}function Fa(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.m=this.o=this.v=null,this.g=[],this.l=this.a=null}function ja(t){var a=Jn();return function(t){return Na(t,fa,{}).then(function(t){return t.authorizedDomains||[]})}(t).then(function(t){t:{var e=_n(a),n=e.f;e=e.b;for(var r=0;r<t.length;r++){var i=t[r],o=e,s=n;if(o=0==i.indexOf("chrome-extension://")?_n(i).b==o&&"chrome-extension"==s:("http"==s||"https"==s)&&(nr.test(i)?o==i:(i=i.split(".").join("\\."),new RegExp("^(.+\\."+i+"|"+i+")$","i").test(o)))){t=!0;break t}}t=!1}if(!t)throw new So(Jn())})}function qa(i){return i.l||(i.l=ir().then(function(){if(!i.o){var t=i.c,e=i.h,n=Ua(i.b),r=new La(i.u,i.f,i.b);r.f=t,r.b=e,r.c=W(n||[]),i.o=r.toString()}i.i=new Ra(i.o),function(r){if(!r.i)throw Error("IfcHandler must be initialized!");!function(t,e){t.gb.then(function(){t.a.register("authEvent",e,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}(r.i,function(t){var e={};if(t&&t.authEvent){var n=!1;for(t=_o(t.authEvent),e=0;e<r.g.length;e++)n=r.g[e](t)||n;return(e={}).status=n?"ACK":"ERROR",Yt(e)}return e.status="ERROR",Yt(e)})}(i)})),i.l}function Va(t){return t.m||(t.v=t.c?dr(t.c,Ua(t.b)):null,t.m=new Rs(t.f,Ni(t.h),t.v)),t.m}function Ba(t,e,n,r,i,o,s,a,u,c,h){return(t=new Ma(t,e,n,r,i)).l=o,t.g=s,t.i=a,t.b=K(u||null),t.f=c,t.nb(h).toString()}function Wa(t){if(this.a=t||fl.INTERNAL.reactNative&&fl.INTERNAL.reactNative.AsyncStorage,!this.a)throw new Yr("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Ha(t){this.b=t,this.a={},this.f=_(this.c,this)}La.prototype.toString=function(){return this.f?wn(this.a,"v",this.f):xn(this.a.a,"v"),this.b?wn(this.a,"eid",this.b):xn(this.a.a,"eid"),this.c.length?wn(this.a,"fw",this.c.join(",")):xn(this.a.a,"fw"),this.a.toString()},Ma.prototype.nb=function(t){return this.h=t,this},Ma.prototype.toString=function(){var t=En(this.o,"/__/auth/handler");if(wn(t,"apiKey",this.m),wn(t,"appName",this.c),wn(t,"authType",this.u),this.a.isOAuthProvider){var e=this.a;try{var n=fl.app(this.c).auth().ha()}catch(t){n=null}for(var r in e.bb=n,wn(t,"providerId",this.a.providerId),n=Ir((e=this.a).zb))n[r]=n[r].toString();r=e.Fc,n=K(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.eb&&e.bb&&!n[e.eb]&&(n[e.eb]=e.bb),G(n)||wn(t,"customParameters",Er(n))}if("function"==typeof this.a.Hb&&((e=this.a.Hb()).length&&wn(t,"scopes",e.join(","))),this.l?wn(t,"redirectUrl",this.l):xn(t.a,"redirectUrl"),this.g?wn(t,"eventId",this.g):xn(t.a,"eventId"),this.i?wn(t,"v",this.i):xn(t.a,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!bn(t,s)&&wn(t,s,this.b[s]);return this.h?wn(t,"tid",this.h):xn(t.a,"tid"),this.f?wn(t,"eid",this.f):xn(t.a,"eid"),(s=Ua(this.c)).length&&wn(t,"fw",s.join(",")),t.toString()},(t=Fa.prototype).Fb=function(e,n,t){var r=new Yr("popup-closed-by-user"),i=new Yr("web-storage-unsupported"),o=this,s=!1;return this.ia().then(function(){(function(t){var e={type:"webStorageSupport"};return qa(t).then(function(){return function(e,n){return e.gb.then(function(){return new Bt(function(t){e.a.send(n.type,n,t,yr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}(t.i,e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})})(o).then(function(t){t||(e&&tr(e),n(i),s=!0)})}).s(function(){}).then(function(){if(!s)return function(n){return new Bt(function(e){return function t(){un(2e3).then(function(){if(n&&!n.closed)return t();e()})}()})}(e)}).then(function(){if(!s)return un(t).then(function(){n(r)})})},t.Ob=function(){var t=vr();return!_r(t)&&!Cr(t)},t.Jb=function(){return!1},t.Db=function(e,t,n,r,i,o,s,a){if(!e)return Xt(new Yr("popup-blocked"));if(s&&!_r())return this.ia().s(function(t){tr(e),i(t)}),r(),Yt();this.a||(this.a=ja(Va(this)));var u=this;return this.a.then(function(){var t=u.ia().s(function(t){throw tr(e),i(t),t});return r(),t}).then(function(){wo(n),s||$n(Ba(u.u,u.f,u.b,t,n,null,o,u.c,void 0,u.h,a),e)}).s(function(t){throw"auth/network-request-failed"==t.code&&(u.a=null),t})},t.Eb=function(t,e,n,r){this.a||(this.a=ja(Va(this)));var i=this;return this.a.then(function(){wo(e),$n(Ba(i.u,i.f,i.b,t,e,Jn(),n,i.c,void 0,i.h,r))}).s(function(t){throw"auth/network-request-failed"==t.code&&(i.a=null),t})},t.ia=function(){var t=this;return qa(this).then(function(){return t.i.gb}).s(function(){throw t.a=null,new Yr("network-request-failed")})},t.Rb=function(){return!0},t.Aa=function(t){this.g.push(t)},t.Na=function(e){V(this.g,function(t){return t==e})},(t=Wa.prototype).get=function(t){return Yt(this.a.getItem(t)).then(function(t){return t&&Tr(t)})},t.set=function(t,e){return Yt(this.a.setItem(t,Er(e)))},t.S=function(t){return Yt(this.a.removeItem(t))},t.$=function(){},t.ea=function(){};var Ga,Ka=[];function za(t,e,n){G(t.a)&&t.b.addEventListener("message",t.f),void 0===t.a[e]&&(t.a[e]=[]),t.a[e].push(n)}function Qa(t){this.a=t}function Ya(t){this.c=t,this.b=!1,this.a=[]}function Xa(r,t,e,n){var i,o,s,a,u=e||{},c=null;if(r.b)return Xt(Error("connection_unavailable"));var h=n?800:50,l="undefined"!=typeof MessageChannel?new MessageChannel:null;return new Bt(function(e,n){l?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),l.port1.start(),s=setTimeout(function(){n(Error("unsupported_event"))},h),c={messageChannel:l,onMessage:o=function(t){t.data.eventId===i&&("ack"===t.data.status?(clearTimeout(s),a=setTimeout(function(){n(Error("timeout"))},3e3)):"done"===t.data.status?(clearTimeout(a),void 0!==t.data.response?e(t.data.response):n(Error("unknown_error"))):(clearTimeout(s),clearTimeout(a),n(Error("invalid_response"))))}},r.a.push(c),l.port1.addEventListener("message",o),r.c.postMessage({eventType:t,eventId:i,data:u},[l.port2])):n(Error("connection_unavailable"))}).then(function(t){return Ja(r,c),t}).s(function(t){throw Ja(r,c),t})}function Ja(t,e){if(e){var n=e.messageChannel,r=e.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),V(t.a,function(t){return t==e})}}function $a(){if(!eu())throw new Yr("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.u=l.indexedDB,this.type="indexedDB",this.g=this.l=this.f=this.i=null,this.o=!1,this.h=null;var r=this;ar()&&self?(this.l=function(){var e=ar()?self:null;if(M(Ka,function(t){t.b==e&&(n=t)}),!n){var n=new Ha(e);Ka.push(n)}return n}(),za(this.l,"keyChanged",function(t,n){return su(r).then(function(e){return 0<e.length&&M(r.a,function(t){t(e)}),{keyProcessed:j(e,n.key)}})}),za(this.l,"ping",function(){return Yt(["keyChanged"])})):function(){var t=l.navigator;return t&&t.serviceWorker?Yt().then(function(){return t.serviceWorker.ready}).then(function(t){return t.active||null}).s(function(){return null}):Yt(null)}().then(function(t){(r.h=t)&&(r.g=new Ya(new Qa(t)),Xa(r.g,"ping",null,!0).then(function(t){t[0].fulfilled&&j(t[0].value,"keyChanged")&&(r.o=!0)}).s(function(){}))})}function Za(r){return new Bt(function(e,n){var t=r.u.open("firebaseLocalStorageDb",1);t.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},t.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},t.onsuccess=function(t){(t=t.target.result).objectStoreNames.contains("firebaseLocalStorage")?e(t):function(r){return new Bt(function(t,e){var n=r.u.deleteDatabase("firebaseLocalStorageDb");n.onsuccess=function(){t()},n.onerror=function(t){e(Error(t.target.error))}})}(r).then(function(){return Za(r)}).then(function(t){e(t)}).s(function(t){n(t)})}})}function tu(t){return t.m||(t.m=Za(t)),t.m}function eu(){try{return!!l.indexedDB}catch(t){return!1}}function nu(t){return t.objectStore("firebaseLocalStorage")}function ru(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function iu(t){return new Bt(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(t.target.error)}})}function ou(t,e){return t.g&&t.h&&function(){var t=l.navigator;return t&&t.serviceWorker&&t.serviceWorker.controller||null}()===t.h?Xa(t.g,"keyChanged",{key:e},t.o).then(function(){}).s(function(){}):Yt()}function su(r){return tu(r).then(function(t){var i=nu(ru(t,!1));return i.getAll?iu(i.getAll()):new Bt(function(e,n){var r=[],t=i.openCursor();t.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},t.onerror=function(t){n(t.target.error)}})}).then(function(t){var e={},n=[];if(0==r.b){for(n=0;n<t.length;n++)e[t[n].fbase_key]=t[n].value;n=function t(e,n){var r,i=[];for(r in e)r in n?typeof e[r]!=typeof n[r]?i.push(r):"object"==typeof e[r]&&null!=e[r]&&null!=n[r]?0<t(e[r],n[r]).length&&i.push(r):e[r]!==n[r]&&i.push(r):i.push(r);for(r in n)r in e||i.push(r);return i}(r.c,e),r.c=e}return n})}function au(t){t.i&&t.i.cancel("STOP_EVENT"),t.f&&(clearTimeout(t.f),t.f=null)}function uu(t){var r=this,i=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Yt().then(function(){if(eu()){var e=Sr(),n="__sak"+e;return Ga=Ga||new $a,(i=Ga).set(n,e).then(function(){return i.get(n)}).then(function(t){if(t!==e)throw Error("indexedDB not supported!");return i.S(n)}).then(function(){return i}).s(function(){return r.c})}return r.c}).then(function(t){return r.type=t.type,t.$(function(e){M(r.a,function(t){t(e)})}),t})}function cu(){this.a={},this.type="inMemory"}function hu(){if(!function(){var t="Node"==ur();if(!(t=lu()||t&&fl.INTERNAL.node&&fl.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ur())throw new Yr("internal-error","The LocalStorage compatibility library was not found.");throw new Yr("web-storage-unsupported")}this.a=lu()||fl.INTERNAL.node.localStorage,this.type="localStorage"}function lu(){try{var t=l.localStorage,e=Sr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function fu(){this.type="nullStorage"}function pu(){if(!function(){var t="Node"==ur();if(!(t=du()||t&&fl.INTERNAL.node&&fl.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}()){if("Node"==ur())throw new Yr("internal-error","The SessionStorage compatibility library was not found.");throw new Yr("web-storage-unsupported")}this.a=du()||fl.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function du(){try{var t=l.sessionStorage,e=Sr();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function vu(){var t={};t.Browser=mu,t.Node=wu,t.ReactNative=bu,t.Worker=_u,this.a=t[ur()]}Ha.prototype.c=function(n){var r=n.data.eventType,i=n.data.eventId,t=this.a[r];if(t&&0<t.length){n.ports[0].postMessage({status:"ack",eventId:i,eventType:r,response:null});var e=[];M(t,function(t){e.push(Yt().then(function(){return t(n.origin,n.data.data)}))}),$t(e).then(function(t){var e=[];M(t,function(t){e.push({fulfilled:t.Gb,value:t.value,reason:t.reason?t.reason.message:void 0})}),M(e,function(t){for(var e in t)void 0===t[e]&&delete t[e]}),n.ports[0].postMessage({status:"done",eventId:i,eventType:r,response:e})})}},Qa.prototype.postMessage=function(t,e){this.a.postMessage(t,e)},Ya.prototype.close=function(){for(;0<this.a.length;)Ja(this,this.a[0]);this.b=!0},(t=$a.prototype).set=function(n,r){var i,o=!1,s=this;return tu(this).then(function(t){return iu((t=nu(ru(i=t,!0))).get(n))}).then(function(t){var e=nu(ru(i,!0));return t?(t.value=r,iu(e.put(t))):(s.b++,o=!0,(t={}).fbase_key=n,t.value=r,iu(e.add(t)))}).then(function(){return s.c[n]=r,ou(s,n)}).ka(function(){o&&s.b--})},t.get=function(e){return tu(this).then(function(t){return iu(nu(ru(t,!1)).get(e))}).then(function(t){return t&&t.value})},t.S=function(e){var n=!1,r=this;return tu(this).then(function(t){return n=!0,r.b++,iu(nu(ru(t,!0)).delete(e))}).then(function(){return delete r.c[e],ou(r,e)}).ka(function(){n&&r.b--})},t.$=function(t){0==this.a.length&&function(t){au(t),function e(){t.f=setTimeout(function(){t.i=su(t).then(function(e){0<e.length&&M(t.a,function(t){t(e)})}).then(function(){e()}).s(function(t){"STOP_EVENT"!=t.message&&e()})},800)}()}(this),this.a.push(t)},t.ea=function(e){V(this.a,function(t){return t==e}),0==this.a.length&&au(this)},(t=uu.prototype).get=function(e){return this.b.then(function(t){return t.get(e)})},t.set=function(e,n){return this.b.then(function(t){return t.set(e,n)})},t.S=function(e){return this.b.then(function(t){return t.S(e)})},t.$=function(t){this.a.push(t)},t.ea=function(e){V(this.a,function(t){return t==e})},(t=cu.prototype).get=function(t){return Yt(this.a[t])},t.set=function(t,e){return this.a[t]=e,Yt()},t.S=function(t){return delete this.a[t],Yt()},t.$=function(){},t.ea=function(){},(t=hu.prototype).get=function(t){var e=this;return Yt().then(function(){return Tr(e.a.getItem(t))})},t.set=function(e,n){var r=this;return Yt().then(function(){var t=Er(n);null===t?r.S(e):r.a.setItem(e,t)})},t.S=function(t){var e=this;return Yt().then(function(){e.a.removeItem(t)})},t.$=function(t){l.window&&He(l.window,"storage",t)},t.ea=function(t){l.window&&ze(l.window,"storage",t)},(t=fu.prototype).get=function(){return Yt(null)},t.set=function(){return Yt()},t.S=function(){return Yt()},t.$=function(){},t.ea=function(){},(t=pu.prototype).get=function(t){var e=this;return Yt().then(function(){return Tr(e.a.getItem(t))})},t.set=function(e,n){var r=this;return Yt().then(function(){var t=Er(n);null===t?r.S(e):r.a.setItem(e,t)})},t.S=function(t){var e=this;return Yt().then(function(){e.a.removeItem(t)})},t.$=function(){},t.ea=function(){};var yu,gu,mu={C:hu,Ta:pu},wu={C:hu,Ta:pu},bu={C:Wa,Ta:fu},_u={C:hu,Ta:fu},Eu={ad:"local",NONE:"none",cd:"session"};function Iu(){var t=!(Cr(vr())||!sr()),e=_r(),n=gr();this.m=t,this.h=e,this.l=n,this.a={},t=yu=yu||new vu;try{this.g=!Xn()&&Or()||!l.indexedDB?new t.a.C:new uu(ar()?new cu:new t.a.C)}catch(t){this.g=new cu,this.h=!0}try{this.i=new t.a.Ta}catch(t){this.i=new cu}this.u=new cu,this.f=_(this.Pb,this),this.b={}}function Tu(){return gu=gu||new Iu}function Su(t,e){switch(e){case"session":return t.i;case"none":return t.u;default:return t.g}}function Cu(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Nu(t,e,n){return n=Cu(e,n),"local"==e.C&&(t.b[n]=null),Su(t,e.C).S(n)}function Au(t){t.c&&(clearInterval(t.c),t.c=null)}function ku(t){this.a=t,this.b=Tu()}(t=Iu.prototype).get=function(t,e){return Su(this,t.C).get(Cu(t,e))},t.set=function(e,t,n){var r=Cu(e,n),i=this,o=Su(this,e.C);return o.set(r,t).then(function(){return o.get(r)}).then(function(t){"local"==e.C&&(i.b[r]=t)})},t.addListener=function(t,e,n){t=Cu(t,e),this.l&&(this.b[t]=l.localStorage.getItem(t)),G(this.a)&&(Su(this,"local").$(this.f),this.h||(Xn()||!Or())&&l.indexedDB||!this.l||function(r){Au(r),r.c=setInterval(function(){for(var t in r.a){var e=l.localStorage.getItem(t),n=r.b[t];e!=n&&(r.b[t]=e,e=new De({type:"storage",key:t,target:window,oldValue:n,newValue:e,a:!0}),r.Pb(e))}},1e3)}(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},t.removeListener=function(t,e,n){t=Cu(t,e),this.a[t]&&(V(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),G(this.a)&&(Su(this,"local").ea(this.f),Au(this))},t.Pb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];void 0===r&&(r=null);var i=l.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.$a(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if(void 0!==t.a.a?Su(this,"local").ea(this.f):Au(this),this.m)if(n=l.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?l.localStorage.setItem(e,r):l.localStorage.removeItem(e);else if(this.b[e]===r&&void 0===t.a.a)return;var o=this;n=function(){void 0===t.a.a&&o.b[e]===l.localStorage.getItem(e)||(o.b[e]=l.localStorage.getItem(e),o.$a(e))},ye&&Se&&10==Se&&l.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else M(t,_(this.$a,this))},t.$a=function(t){this.a[t]&&M(this.a[t],function(t){t()})};var Ru,Ou={name:"authEvent",C:"local"};function Pu(){this.a=Tu()}function Du(t,e){this.b=xu,this.f=l.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=t,this.h=e,this.l=l.Int32Array?new Int32Array(64):Array(64),void 0!==Ru||(Ru=l.Int32Array?new Int32Array(Vu):Vu),this.reset()}T(Du,function(){this.b=-1});for(var xu=64,Lu=xu-1,Mu=[],Uu=0;Uu<Lu;Uu++)Mu[Uu]=0;var Fu=B(128,Mu);function ju(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;e<64;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,s=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+s|0}r=0|t.a[0],i=0|t.a[1];var a=0|t.a[2],u=0|t.a[3],c=0|t.a[4],h=0|t.a[5],l=0|t.a[6];for(o=0|t.a[7],e=0;e<64;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&a^i&a)|0;s=(o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0)+((s=(s=c&h^~c&l)+(0|Ru[e])|0)+(0|n[e])|0)|0,o=l,l=h,h=c,c=u+s|0,u=a,a=i,i=r,r=s+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+a|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+h|0,t.a[6]=t.a[6]+l|0,t.a[7]=t.a[7]+o|0}function qu(t,e,n){void 0===n&&(n=e.length);var r=0,i=t.c;if(h(e))for(;r<n;)t.f[i++]=e.charCodeAt(r++),i==t.b&&(ju(t),i=0);else{if(!v(e))throw Error("message must be string or array");for(;r<n;){var o=e[r++];if(!("number"==typeof o&&0<=o&&o<=255&&o==(0|o)))throw Error("message must be a byte array");t.f[i++]=o,i==t.b&&(ju(t),i=0)}}t.c=i,t.g+=n}Du.prototype.reset=function(){this.g=this.c=0,this.a=l.Int32Array?new Int32Array(this.h):W(this.h)};var Vu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Bu(){Du.call(this,8,Wu)}T(Bu,Du);var Wu=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Hu(t,e,n,r,i){this.u=t,this.i=e,this.l=n,this.m=r||null,this.o=i||null,this.h=e+":"+n,this.v=new Pu,this.g=new ku(this.h),this.f=null,this.b=[],this.a=this.c=null}function Gu(t){return new Yr("invalid-cordova-configuration",t)}function Ku(t){var e=new Bu;qu(e,t),t=[];var n=8*e.g;e.c<56?qu(e,Fu,56-e.c):qu(e,Fu,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(ju(e),r=n=0;r<e.i;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return function(t){return U(t,function(t){return 1<(t=t.toString(16)).length?t:"0"+t}).join("")}(t)}function zu(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function Qu(r){return r.f||(r.f=r.ia().then(function(){return new Bt(function(n){r.Aa(function t(e){return n(e),r.Na(t),!1}),function(i){function e(r){t=!0,n&&n.cancel(),Yu(i).then(function(t){var e=o;if(t&&r&&r.url){var n=null;-1!=(e=Vi(r.url)).indexOf("/__/auth/callback")&&(n=(n="object"==typeof(n=Tr(bn(n=_n(e),"firebaseError")||null))?Xr(n):null)?new bo(t.c,t.b,null,null,n,null,t.R()):new bo(t.c,t.b,e,t.f,null,null,t.R())),e=n||o}zu(i,e)})}var o=new bo("unknown",null,null,null,new Yr("no-auth-event")),t=!1,n=un(500).then(function(){return Yu(i).then(function(){t||zu(i,o)})}),r=l.handleOpenURL;l.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(yr("BuildInfo.packageName",l).toLowerCase()+"://")&&e({url:t}),"function"==typeof r)try{r(t)}catch(t){console.error(t)}},To=To||new Eo,function(t){var n=To;n.a.push(t),n.b||(n.b=function(t){for(var e=0;e<n.a.length;e++)n.a[e](t)},"function"==typeof(t=yr("universalLinks.subscribe",l))&&t(null,n.b))}(e)}(r)})})),r.f}function Yu(e){var n=null;return function(t){return t.b.get(Ou,t.a).then(function(t){return _o(t)})}(e.g).then(function(t){return n=t,Nu((t=e.g).b,Ou,t.a)}).then(function(){return n})}function Xu(t){this.a=t,this.b=Tu()}(t=Hu.prototype).ia=function(){return this.Da?this.Da:this.Da=(or(void 0)?ir().then(function(){return new Bt(function(t,e){var n=l.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):Xt(Error("Cordova must run in an Android or iOS file scheme."))).then(function(){if("function"!=typeof yr("universalLinks.subscribe",l))throw Gu("cordova-universal-links-plugin-fix is not installed");if(void 0===yr("BuildInfo.packageName",l))throw Gu("cordova-plugin-buildinfo is not installed");if("function"!=typeof yr("cordova.plugins.browsertab.openUrl",l))throw Gu("cordova-plugin-browsertab is not installed");if("function"!=typeof yr("cordova.InAppBrowser.open",l))throw Gu("cordova-plugin-inappbrowser is not installed")},function(){throw new Yr("cordova-not-ready")})},t.Fb=function(t,e){return e(new Yr("operation-not-supported-in-this-environment")),Yt()},t.Db=function(){return Xt(new Yr("operation-not-supported-in-this-environment"))},t.Rb=function(){return!1},t.Ob=function(){return!0},t.Jb=function(){return!0},t.Eb=function(t,e,n,r){if(this.c)return Xt(new Yr("redirect-operation-pending"));var i=this,o=l.document,s=null,a=null,u=null,c=null;return this.c=Yt().then(function(){return wo(e),Qu(i)}).then(function(){return function(n,t,e,r,i){var o=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}(),s=new bo(t,r,null,o,new Yr("no-auth-event"),null,i),a=yr("BuildInfo.packageName",l);if("string"!=typeof a)throw new Yr("invalid-cordova-configuration");var u=yr("BuildInfo.displayName",l),c={};if(vr().toLowerCase().match(/iphone|ipad|ipod/))c.ibi=a;else{if(!vr().toLowerCase().match(/android/))return Xt(new Yr("operation-not-supported-in-this-environment"));c.apn=a}u&&(c.appDisplayName=u),o=Ku(o),c.sessionId=o;var h=Ba(n.u,n.i,n.l,t,e,null,r,n.m,c,n.o,i);return n.ia().then(function(){var t=n.h;return n.v.a.set(Ou,s.A(),t)}).then(function(){var t=yr("cordova.plugins.browsertab.isAvailable",l);if("function"!=typeof t)throw new Yr("invalid-cordova-configuration");var e=null;t(function(t){if(t){if("function"!=typeof(e=yr("cordova.plugins.browsertab.openUrl",l)))throw new Yr("invalid-cordova-configuration");e(h)}else{if("function"!=typeof(e=yr("cordova.InAppBrowser.open",l)))throw new Yr("invalid-cordova-configuration");t=vr(),n.a=e(h,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}(i,t,e,n,r)}).then(function(){return new Bt(function(e,t){a=function(){var t=yr("cordova.plugins.browsertab.close",l);return e(),"function"==typeof t&&t(),i.a&&"function"==typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Aa(a),u=function(){s=s||un(2e3).then(function(){t(new Yr("redirect-cancelled-by-user"))})},c=function(){kr()&&u()},o.addEventListener("resume",u,!1),vr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",c,!1)}).s(function(t){return Yu(i).then(function(){throw t})})}).ka(function(){u&&o.removeEventListener("resume",u,!1),c&&o.removeEventListener("visibilitychange",c,!1),s&&s.cancel(),a&&i.Na(a),i.c=null})},t.Aa=function(e){this.b.push(e),Qu(this).s(function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new bo("unknown",null,null,null,new Yr("no-auth-event")),e(t))})},t.Na=function(e){V(this.b,function(t){return t==e})};var Ju={name:"pendingRedirect",C:"session"};function $u(t){return Nu(t.b,Ju,t.a)}function Zu(t,e,n){this.i={},this.v=0,this.B=t,this.u=e,this.m=n,this.h=[],this.f=!1,this.l=_(this.o,this),this.b=new pc,this.w=new mc,this.g=new Xu(this.u+":"+this.m),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.w,this.c.linkViaPopup=this.w,this.c.reauthViaPopup=this.w,this.a=tc(this.B,this.u,this.m,Si)}function tc(t,e,n,r){var i=fl.SDK_VERSION||null;return or()?new Hu(t,e,n,i,r):new Fa(t,e,n,i,r)}function ec(e){e.f||(e.f=!0,e.a.Aa(e.l));var n=e.a;return e.a.ia().s(function(t){throw e.a==n&&e.reset(),t})}function nc(n){n.a.Ob()&&ec(n).s(function(t){var e=new bo("unknown",null,null,null,new Yr("operation-not-supported-in-this-environment"));uc(t)&&n.o(e)}),n.a.Jb()||dc(n.b)}function rc(n,t){j(n.h,t)||n.h.push(t),n.f||function(t){return t.b.get(Ju,t.a).then(function(t){return"pending"==t})}(n.g).then(function(t){t?$u(n.g).then(function(){ec(n).s(function(t){var e=new bo("unknown",null,null,null,new Yr("operation-not-supported-in-this-environment"));uc(t)&&n.o(e)})}):nc(n)}).s(function(){nc(n)})}function ic(t,e){V(t.h,function(t){return t==e})}Zu.prototype.reset=function(){this.f=!1,this.a.Na(this.l),this.a=tc(this.B,this.u,this.m),this.i={}},Zu.prototype.o=function(t){if(!t)throw new Yr("invalid-auth-event");if(6e5<=I()-this.v&&(this.i={},this.v=0),t&&t.getUid()&&this.i.hasOwnProperty(t.getUid()))return!1;for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.xb(t.c,t.b)){(e=this.c[t.c])&&(e.h(t,r),t&&(t.f||t.b)&&(this.i[t.getUid()]=!0,this.v=I())),e=!0;break}}return dc(this.b),e};var oc=new Ar(2e3,1e4),sc=new Ar(3e4,6e4);function ac(t,e,n,r,i,o,s){return t.a.Db(e,n,r,function(){t.f||(t.f=!0,t.a.Aa(t.l))},function(){t.reset()},i,o,s)}function uc(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function cc(e,t,n,r,i){var o;return function(t){return t.b.set(Ju,"pending",t.a)}(e.g).then(function(){return e.a.Eb(t,n,r,i).s(function(t){if(uc(t))throw new Yr("operation-not-supported-in-this-environment");return o=t,$u(e.g).then(function(){throw o})}).then(function(){return e.a.Rb()?new Bt(function(){}):$u(e.g).then(function(){return e.oa()}).then(function(){}).s(function(){})})})}function hc(t,e,n,r,i){return t.a.Fb(r,function(t){e.ja(n,null,t,i)},oc.get())}Zu.prototype.oa=function(){return this.b.oa()};var lc={};function fc(t,e,n){var r=e+":"+n;return lc[r]||(lc[r]=new Zu(t,e,n)),lc[r]}function pc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function dc(t){t.g||(t.g=!0,gc(t,!1,null,null))}function vc(t){t.g&&!t.i&&gc(t,!1,null,null)}function yc(t,e){if(t.b=function(){return Yt(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function gc(t,e,n,r){e?r?function(t,e){if(t.b=function(){return Xt(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}(t,r):yc(t,n):yc(t,{user:null}),t.f=[],t.c=[]}function mc(){}function wc(){this.vb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.vb},set:function(t){this.vb=t},enumerable:!1})}function bc(t,e){this.a=e,Mr(this,"verificationId",t)}function _c(t,e,n,r){return new yo(t).Wa(e,n).then(function(t){return new bc(t,r)})}function Ec(t){var e=Ti(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new Yr("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Ur(this,{token:t,expirationTime:Rr(1e3*e.exp),authTime:Rr(1e3*e.auth_time),issuedAtTime:Rr(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function Ic(t,e,n){if(this.h=t,this.i=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function Tc(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function Sc(t){this.f=t,this.b=this.a=null,this.c=0}function Cc(t,e){var n=e[Ps],r=e.refreshToken;e=Nc(e.expiresIn),t.b=n,t.c=e,t.a=r}function Nc(t){return I()+1e3*parseInt(t,10)}function Ac(e,t){return function(t,r){return new Bt(function(e,n){"refresh_token"==r.grant_type&&r.refresh_token||"authorization_code"==r.grant_type&&r.code?js(t,t.l+"?key="+encodeURIComponent(t.c),function(t){t?t.error?n(ka(t)):t.access_token&&t.refresh_token?e(t):n(new Yr("internal-error")):n(new Yr("network-request-failed"))},"POST",Dn(r).toString(),t.g,t.u.get()):n(new Yr("internal-error"))})}(e.f,t).then(function(t){return e.b=t.access_token,e.c=Nc(t.expires_in),e.a=t.refresh_token,{accessToken:e.b,expirationTime:e.c,refreshToken:e.a}}).s(function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t})}function kc(t,e){this.a=t||null,this.b=e||null,Ur(this,{lastSignInTime:Rr(e||null),creationTime:Rr(t||null)})}function Rc(t,e,n,r,i,o){Ur(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Oc(t,e){for(var n in Pe.call(this,t),e)this[n]=e[n]}function Pc(t,e,n){this.I=[],this.l=t.apiKey,this.m=t.appName,this.o=t.authDomain||null,t=fl.SDK_VERSION?dr(fl.SDK_VERSION):null,this.a=new Rs(this.l,Ni(Si),t),this.b=new Sc(this.a),jc(this,e[Ps]),Cc(this.b,e),Mr(this,"refreshToken",this.b.a),Bc(this,n||{}),nn.call(this),this.J=!1,this.o&&mr()&&(this.i=fc(this.o,this.l,this.m)),this.O=[],this.h=null,this.w=function(e){return new Ic(function(){return e.G(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var t=e.b.c-I()-3e5;return 0<t?t:0})}(this),this.W=_(this.Ja,this);var r=this;this.ga=null,this.xa=function(t){r.ua(t.g)},this.Z=null,this.P=[],this.wa=function(t){xc(r,t.c)},this.Y=null}function Dc(t,e){t.Z&&ze(t.Z,"languageCodeChanged",t.xa),(t.Z=e)&&He(e,"languageCodeChanged",t.xa)}function xc(t,e){t.P=e,Fs(t.a,fl.SDK_VERSION?dr(fl.SDK_VERSION,t.P):null)}function Lc(t,e){t.Y&&ze(t.Y,"frameworkChanged",t.wa),(t.Y=e)&&He(e,"frameworkChanged",t.wa)}function Mc(e){try{return fl.app(e.m).auth()}catch(t){throw new Yr("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function Uc(t){t.B||t.w.b||(t.w.start(),ze(t,"tokenChanged",t.W),He(t,"tokenChanged",t.W))}function Fc(t){ze(t,"tokenChanged",t.W),t.w.stop()}function jc(t,e){t.ma=e,Mr(t,"_lat",e)}function qc(t){for(var e=[],n=0;n<t.O.length;n++)e.push(t.O[n](t));return $t(e).then(function(){return t})}function Vc(t){t.i&&!t.J&&(t.J=!0,rc(t.i,t))}function Bc(t,e){Ur(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,tenantId:e.tenantId||null,metadata:new kc(e.createdAt,e.lastLoginAt),providerData:[]}),t.a.b=t.tenantId}function Wc(){}function Hc(t){return Yt().then(function(){if(t.B)throw new Yr("app-deleted")})}function Gc(t){return U(t.providerData,function(t){return t.providerId})}function Kc(t,e){e&&(zc(t,e.providerId),t.providerData.push(e))}function zc(t,e){V(t.providerData,function(t){return t.providerId==e})}function Qc(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&Mr(t,e,n)}function Yc(e,t){e!=t&&(Ur(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),t.metadata?Mr(e,"metadata",function(t){return new kc(t.a,t.b)}(t.metadata)):Mr(e,"metadata",new kc),M(t.providerData,function(t){Kc(e,t)}),function(t,e){t.b=e.b,t.a=e.a,t.c=e.c}(e.b,t.b),Mr(e,"refreshToken",e.b.a))}function Xc(n){return n.G().then(function(t){var e=n.isAnonymous;return function(t,e){return Na(t.a,ua,{idToken:e}).then(_(t.zc,t))}(n,t).then(function(){return e||Qc(n,"isAnonymous",!1),t})})}function Jc(t,e){e[Ps]&&t.ma!=e[Ps]&&(Cc(t.b,e),t.dispatchEvent(new Oc("tokenChanged")),jc(t,e[Ps]),Qc(t,"refreshToken",t.b.a))}function $c(t,e){return Xc(t).then(function(){if(j(Gc(t),e))return qc(t).then(function(){throw new Yr("provider-already-linked")})})}function Zc(t,e,n){return Fr({user:t,credential:mo(e),additionalUserInfo:e=Pi(e),operationType:n})}function th(t,e){return Jc(t,e),t.reload().then(function(){return t})}function eh(n,r,t,e,i){if(!mr())return Xt(new Yr("operation-not-supported-in-this-environment"));if(n.h&&!i)return Xt(n.h);var o=Oi(t.providerId),s=Sr(n.uid+":::"),a=null;(!_r()||sr())&&n.o&&t.isOAuthProvider&&(a=Ba(n.o,n.l,n.m,r,t,null,s,fl.SDK_VERSION||null,null,null,n.tenantId));var u=er(a,o&&o.sa,o&&o.ra);return e=e().then(function(){if(rh(n),!i)return n.G().then(function(){})}).then(function(){return ac(n.i,u,r,t,s,!!a,n.tenantId)}).then(function(){return new Bt(function(t,e){n.ja(r,null,new Yr("cancelled-popup-request"),n.g||null),n.f=t,n.v=e,n.g=s,n.c=hc(n.i,n,r,u,s)})}).then(function(t){return u&&tr(u),t?Fr(t):null}).s(function(t){throw u&&tr(u),t}),ih(n,e,i)}function nh(e,t,n,r,i){if(!mr())return Xt(new Yr("operation-not-supported-in-this-environment"));if(e.h&&!i)return Xt(e.h);var o=null,s=Sr(e.uid+":::");return r=r().then(function(){if(rh(e),!i)return e.G().then(function(){})}).then(function(){return e.ca=s,qc(e)}).then(function(t){return e.da&&(t=(t=e.da).b.set(ah,e.A(),t.a)),t}).then(function(){return cc(e.i,t,n,s,e.tenantId)}).s(function(t){if(o=t,e.da)return uh(e.da);throw o}).then(function(){if(o)throw o}),ih(e,r,i)}function rh(t){if(!t.i||!t.J){if(t.i&&!t.J)throw new Yr("internal-error");throw new Yr("auth-domain-config-required")}}function ih(t,e,n){var r=function(e,t,n){return e.h&&!n?(t.cancel(),Xt(e.h)):t.s(function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.h||e.dispatchEvent(new Oc("userInvalidated")),e.h=t),t})}(t,e,n);return t.I.push(r),r.ka(function(){q(t.I,r)}),r}function oh(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[Ps]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-I())/1e3;var r=new Pc(e,n,t);return t.providerData&&M(t.providerData,function(t){t&&Kc(r,Fr(t))}),t.redirectEventId&&(r.ca=t.redirectEventId),r}function sh(t){this.a=t,this.b=Tu()}pc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},pc.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.c,r=t.b,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?t.a?(gc(this,!0,null,t.a),Yt()):e.Ba(n,r)?function(e,t,n){n=n.Ba(t.c,t.b);var r=t.g,i=t.f,o=t.i,s=t.R(),a=!!t.c.match(/Redirect$/);n(r,i,s,o).then(function(t){gc(e,a,t,null)}).s(function(t){gc(e,a,null,t)})}(this,t,e):Xt(new Yr("invalid-auth-event")):(gc(this,!1,null,null),Yt())}else Xt(new Yr("invalid-auth-event"))},pc.prototype.oa=function(){var n=this;return new Bt(function(t,e){n.b?n.b().then(t,e):(n.f.push(t),n.c.push(e),function(t){var e=new Yr("timeout");t.a&&t.a.cancel(),t.a=un(sc.get()).then(function(){t.b||(t.g=!0,gc(t,!0,null,e))})}(n))})},mc.prototype.h=function(t,e){if(t){var n=t.c,r=t.b;t.a?(e.ja(t.c,null,t.a,t.b),Yt()):e.Ba(n,r)?function(t,e){var n=t.b,r=t.c;e.Ba(r,n)(t.g,t.f,t.R(),t.i).then(function(t){e.ja(r,t,null,n)}).s(function(t){e.ja(r,null,t,n)})}(t,e):Xt(new Yr("invalid-auth-event"))}else Xt(new Yr("invalid-auth-event"))},bc.prototype.confirm=function(t){return t=go(this.verificationId,t),this.a(t)},Ic.prototype.start=function(){this.a=this.c,function e(n,t){n.stop();n.b=un(Tc(n,t)).then(function(){return e=l.document,n=null,kr()||!e?Yt():new Bt(function(t){n=function(){kr()&&(e.removeEventListener("visibilitychange",n,!1),t())},e.addEventListener("visibilitychange",n,!1)}).s(function(t){throw e.removeEventListener("visibilitychange",n,!1),t});var e,n}).then(function(){return n.h()}).then(function(){e(n,!0)}).s(function(t){n.i(t)&&e(n,!1)})}(this,!0)},Ic.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},Sc.prototype.A=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},Sc.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?Xt(new Yr("user-token-expired")):t||!this.b||I()>this.c-3e4?this.a?Ac(this,{grant_type:"refresh_token",refresh_token:this.a}):Yt(null):Yt({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},kc.prototype.A=function(){return{lastLoginAt:this.b,createdAt:this.a}},T(Oc,Pe),T(Pc,nn),Pc.prototype.ua=function(t){this.ga=t,Us(this.a,t)},Pc.prototype.ha=function(){return this.ga},Pc.prototype.Ca=function(){return W(this.P)},Pc.prototype.Ja=function(){this.w.b&&(this.w.stop(),this.w.start())},Mr(Pc.prototype,"providerId","firebase"),(t=Pc.prototype).reload=function(){var t=this;return ih(this,Hc(this).then(function(){return Xc(t).then(function(){return qc(t)}).then(Wc)}))},t.dc=function(t){return this.G(t).then(function(t){return new Ec(t)})},t.G=function(t){var e=this;return ih(this,Hc(this).then(function(){return e.b.getToken(t)}).then(function(t){if(!t)throw new Yr("internal-error");return t.accessToken!=e.ma&&(jc(e,t.accessToken),e.dispatchEvent(new Oc("tokenChanged"))),Qc(e,"refreshToken",t.refreshToken),t.accessToken}))},t.zc=function(t){if(!(t=t.users)||!t.length)throw new Yr("internal-error");Bc(this,{uid:(t=t[0]).localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt,tenantId:t.tenantId});for(var e=function(t){return(t=t.providerUserInfo)&&t.length?U(t,function(t){return new Rc(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}(t),n=0;n<e.length;n++)Kc(this,e[n]);Qc(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))},t.Ac=function(t){return xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.hb(t)},t.hb=function(t){var e=this,n=null;return ih(this,t.f(this.a,this.uid).then(function(t){return Jc(e,t),n=Zc(e,t,"reauthenticate"),e.h=null,e.reload()}).then(function(){return n}),!0)},t.rc=function(t){return xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.fb(t)},t.fb=function(e){var n=this,r=null;return ih(this,$c(this,e.providerId).then(function(){return n.G()}).then(function(t){return e.b(n.a,t)}).then(function(t){return r=Zc(n,t,"link"),th(n,t)}).then(function(){return r}))},t.sc=function(t,e){var n=this;return ih(this,$c(this,"phone").then(function(){return _c(Mc(n),t,e,_(n.fb,n))}))},t.Bc=function(t,e){var n=this;return ih(this,Yt().then(function(){return _c(Mc(n),t,e,_(n.hb,n))}),!0)},t.rb=function(e){var n=this;return ih(this,this.G().then(function(t){return n.a.rb(t,e)}).then(function(t){return Jc(n,t),n.reload()}))},t.Sc=function(e){var n=this;return ih(this,this.G().then(function(t){return e.b(n.a,t)}).then(function(t){return Jc(n,t),n.reload()}))},t.sb=function(e){var n=this;return ih(this,this.G().then(function(t){return n.a.sb(t,e)}).then(function(t){return Jc(n,t),n.reload()}))},t.tb=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Hc(this);var n=this;return ih(this,this.G().then(function(t){return n.a.tb(t,{displayName:e.displayName,photoUrl:e.photoURL})}).then(function(t){return Jc(n,t),Qc(n,"displayName",t.displayName||null),Qc(n,"photoURL",t.photoUrl||null),M(n.providerData,function(t){"password"===t.providerId&&(Mr(t,"displayName",n.displayName),Mr(t,"photoURL",n.photoURL))}),qc(n)}).then(Wc))},t.Qc=function(e){var n=this;return ih(this,Xc(this).then(function(t){return j(Gc(n),e)?function(t,e,n){return Na(t,oa,{idToken:e,deleteProvider:n})}(n.a,t,[e]).then(function(t){var e={};return M(t.providerUserInfo||[],function(t){e[t.providerId]=!0}),M(Gc(n),function(t){e[t]||zc(n,t)}),e[yo.PROVIDER_ID]||Mr(n,"phoneNumber",null),qc(n)}):qc(n).then(function(){throw new Yr("no-such-provider")})}))},t.delete=function(){var e=this;return ih(this,this.G().then(function(t){return Na(e.a,ia,{idToken:t})}).then(function(){e.dispatchEvent(new Oc("userDeleted"))})).then(function(){for(var t=0;t<e.I.length;t++)e.I[t].cancel("app-deleted");Dc(e,null),Lc(e,null),e.I=[],e.B=!0,Fc(e),Mr(e,"refreshToken",null),e.i&&ic(e.i,e)})},t.xb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.ca||null)==e||"reauthViaRedirect"==t&&(this.ca||null)==e)},t.ja=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?_(this.Bb,this):"reauthViaPopup"==t&&e==(this.g||null)?_(this.Cb,this):"linkViaRedirect"==t&&(this.ca||null)==e?_(this.Bb,this):"reauthViaRedirect"==t&&(this.ca||null)==e?_(this.Cb,this):null},t.tc=function(t){var e=this;return eh(this,"linkViaPopup",t,function(){return $c(e,t.providerId).then(function(){return qc(e)})},!1)},t.Cc=function(t){return eh(this,"reauthViaPopup",t,function(){return Yt()},!0)},t.uc=function(t){var e=this;return nh(this,"linkViaRedirect",t,function(){return $c(e,t.providerId)},!1)},t.Dc=function(t){return nh(this,"reauthViaRedirect",t,function(){return Yt()},!0)},t.Bb=function(e,n,t,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return t=this.G().then(function(t){return Js(i.a,{requestUri:e,postBody:r,sessionId:n,idToken:t})}).then(function(t){return o=Zc(i,t,"link"),th(i,t)}).then(function(){return o}),ih(this,t)},t.Cb=function(t,e,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return ih(this,Yt().then(function(){return Wi($s(i.a,{requestUri:t,sessionId:e,postBody:r,tenantId:n}),i.uid)}).then(function(t){return o=Zc(i,t,"reauthenticate"),Jc(i,t),i.h=null,i.reload()}).then(function(){return o}),!0)},t.jb=function(e){var n=this,r=null;return ih(this,this.G().then(function(t){return r=t,void 0===e||G(e)?{}:mi(new ui(e))}).then(function(t){return n.a.jb(r,t)}).then(function(t){if(n.email!=t)return n.reload()}).then(function(){}))},t.toJSON=function(){return this.A()},t.A=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.o,stsTokenManager:this.b.A(),redirectEventId:this.ca||null};return this.metadata&&Q(e,this.metadata.A()),M(this.providerData,function(t){e.providerData.push(function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}(t))}),e};var ah={name:"redirectUser",C:"session"};function uh(t){return Nu(t.b,ah,t.a)}function ch(t){this.a=t,this.b=Tu(),this.c=null,this.f=function(e){var n=fh("local"),r=fh("session"),i=fh("none");return function(n,r,i){var o=Cu(r,i),s=Su(n,r.C);return n.get(r,i).then(function(t){var e=null;try{e=Tr(l.localStorage.getItem(o))}catch(t){}if(e&&!t)return l.localStorage.removeItem(o),n.set(r,e,i);e&&t&&"localStorage"!=s.type&&l.localStorage.removeItem(o)})}(e.b,n,e.a).then(function(){return e.b.get(r,e.a)}).then(function(t){return t?r:e.b.get(i,e.a).then(function(t){return t?i:e.b.get(n,e.a).then(function(t){return t?n:e.b.get(lh,e.a).then(function(t){return t?fh(t):n})})})}).then(function(t){return e.c=t,hh(e,t.C)}).s(function(){e.c||(e.c=n)})}(this),this.b.addListener(fh("local"),this.a,_(this.g,this))}function hh(t,e){var n,r=[];for(n in Eu)Eu[n]!==e&&r.push(Nu(t.b,fh(Eu[n]),t.a));return r.push(Nu(t.b,lh,t.a)),function(a){return new Bt(function(n,e){var r=a.length,i=[];if(r)for(var t=function(t,e){r--,i[t]=e,0==r&&n(i)},o=function(t){e(t)},s=0;s<a.length;s++)Jt(a[s],E(t,s),o);else n(i)})}(r)}ch.prototype.g=function(){var e=this,n=fh("local");yh(this,function(){return Yt().then(function(){return e.c&&"local"!=e.c.C?e.b.get(n,e.a):null}).then(function(t){if(t)return hh(e,"local").then(function(){e.c=n})})})};var lh={name:"persistence",C:"session"};function fh(t){return{name:"authUser",C:t}}function ph(t,e){return yh(t,function(){return t.b.set(t.c,e.A(),t.a)})}function dh(t){return yh(t,function(){return Nu(t.b,t.c,t.a)})}function vh(t,e){return yh(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),oh(t||{})})})}function yh(t,e){return t.f=t.f.then(e,e),t.f}function gh(t){if(this.l=!1,Mr(this,"settings",new wc),Mr(this,"app",t),!Sh(this).options||!Sh(this).options.apiKey)throw new Yr("invalid-api-key");t=fl.SDK_VERSION?dr(fl.SDK_VERSION):null,this.b=new Rs(Sh(this).options&&Sh(this).options.apiKey,Ni(Si),t),this.O=[],this.m=[],this.J=[],this.Ub=fl.INTERNAL.createSubscribe(_(this.oc,this)),this.W=void 0,this.Vb=fl.INTERNAL.createSubscribe(_(this.pc,this)),Ih(this,null),this.h=new ch(Sh(this).options.apiKey+":"+Sh(this).name),this.w=new sh(Sh(this).options.apiKey+":"+Sh(this).name),this.Y=kh(this,function(n){var t=Sh(n).options.authDomain,e=function(e){var t=function(t,e){return t.b.get(ah,t.a).then(function(t){return t&&e&&(t.authDomain=e),oh(t||{})})}(e.w,Sh(e).options.authDomain).then(function(t){return(e.B=t)&&(t.da=e.w),uh(e.w)});return kh(e,t)}(n).then(function(){return vh(n.h,t)}).then(function(e){return e?(e.da=n.w,n.B&&(n.B.ca||null)==(e.ca||null)?e:e.reload().then(function(){return ph(n.h,e).then(function(){return e})}).s(function(t){return"auth/network-request-failed"==t.code?e:dh(n.h)})):null}).then(function(t){Ih(n,t||null)});return kh(n,e)}(this)),this.i=kh(this,function(e){return e.Y.then(function(){return _h(e)}).s(function(){}).then(function(){if(!e.l)return e.ma()}).s(function(){}).then(function(){if(!e.l){e.ga=!0;var t=e.h;t.b.addListener(fh("local"),t.a,e.ma)}})}(this)),this.ga=!1,this.ma=_(this.Nc,this),this.ub=_(this.aa,this),this.wa=_(this.bc,this),this.xa=_(this.mc,this),this.Ja=_(this.nc,this),this.a=null,function(e){var n=Sh(e).options.authDomain,r=Sh(e).options.apiKey;n&&mr()&&(e.Tb=e.Y.then(function(){if(!e.l){if(e.a=fc(n,r,Sh(e).name),rc(e.a,e),Ch(e)&&Vc(Ch(e)),e.B){Vc(e.B);var t=e.B;t.ua(e.ha()),Dc(t,e),xc(t=e.B,e.I),Lc(t,e),e.B=null}return e.a}}))}(this),this.INTERNAL={},this.INTERNAL.delete=_(this.delete,this),this.INTERNAL.logFramework=_(this.vc,this),this.o=0,nn.call(this),function(t){Object.defineProperty(t,"lc",{get:function(){return this.ha()},set:function(t){this.ua(t)},enumerable:!1}),t.Z=null,Object.defineProperty(t,"ti",{get:function(){return this.R()},set:function(t){this.nb(t)},enumerable:!1}),t.P=null}(this),this.I=[]}function mh(t){Pe.call(this,"languageCodeChanged"),this.g=t}function wh(t){Pe.call(this,"frameworkChanged"),this.c=t}function bh(t){return t.Tb||Xt(new Yr("auth-domain-config-required"))}function _h(t){if(!mr())return Xt(new Yr("operation-not-supported-in-this-environment"));var e=bh(t).then(function(){return t.a.oa()}).then(function(t){return t?Fr(t):null});return kh(t,e)}function Eh(e,t){var n={};return n.apiKey=Sh(e).options.apiKey,n.authDomain=Sh(e).options.authDomain,n.appName=Sh(e).name,e.Y.then(function(){return function(t,e,n,r){var i=new Pc(t,e);return n&&(i.da=n),r&&xc(i,r),i.reload().then(function(){return i})}(n,t,e.w,e.Ca())}).then(function(t){return Ch(e)&&t.uid==Ch(e).uid?Yc(Ch(e),t):(Ih(e,t),Vc(t)),e.aa(t)}).then(function(){Ah(e)})}function Ih(t,e){Ch(t)&&(function(t,e){V(t.O,function(t){return t==e})}(Ch(t),t.ub),ze(Ch(t),"tokenChanged",t.wa),ze(Ch(t),"userDeleted",t.xa),ze(Ch(t),"userInvalidated",t.Ja),Fc(Ch(t))),e&&(e.O.push(t.ub),He(e,"tokenChanged",t.wa),He(e,"userDeleted",t.xa),He(e,"userInvalidated",t.Ja),0<t.o&&Uc(e)),Mr(t,"currentUser",e),e&&(e.ua(t.ha()),Dc(e,t),xc(e,t.I),Lc(e,t))}function Th(e,t){var n=null,r=null;return kh(e,t.then(function(t){return n=mo(t),r=Pi(t),Eh(e,t)}).then(function(){return Fr({user:Ch(e),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Sh(t){return t.app}function Ch(t){return t.currentUser}function Nh(t){return Ch(t)&&Ch(t)._lat||null}function Ah(t){if(t.ga){for(var e=0;e<t.m.length;e++)t.m[e]&&t.m[e](Nh(t));if(t.W!==t.getUid()&&t.J.length)for(t.W=t.getUid(),e=0;e<t.J.length;e++)t.J[e]&&t.J[e](Nh(t))}}function kh(t,e){return t.O.push(e),e.ka(function(){q(t.O,e)}),e}function Rh(){}function Oh(){this.a={},this.b=1e12}ch.prototype.mb=function(e){var n=null,r=this;return function(t){var e=new Yr("invalid-persistence-type"),n=new Yr("unsupported-persistence-type");t:{for(r in Eu)if(Eu[r]==t){var r=!0;break t}r=!1}if(!r||"string"!=typeof t)throw e;switch(ur()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!gr()&&"none"!==t)throw n}}(e),yh(this,function(){return e!=r.c.C?r.b.get(r.c,r.a).then(function(t){return n=t,hh(r,e)}).then(function(){if(r.c=fh(e),n)return r.b.set(r.c,n,r.a)}):Yt()})},T(gh,nn),T(mh,Pe),T(wh,Pe),(t=gh.prototype).mb=function(t){return t=this.h.mb(t),kh(this,t)},t.ua=function(t){this.Z===t||this.l||(this.Z=t,Us(this.b,this.Z),this.dispatchEvent(new mh(this.ha())))},t.ha=function(){return this.Z},t.Tc=function(){var t=l.navigator;this.ua(t&&(t.languages&&t.languages[0]||t.language||t.userLanguage)||null)},t.vc=function(t){this.I.push(t),Fs(this.b,fl.SDK_VERSION?dr(fl.SDK_VERSION,this.I):null),this.dispatchEvent(new wh(this.I))},t.Ca=function(){return W(this.I)},t.nb=function(t){this.P===t||this.l||(this.P=t,this.b.b=this.P)},t.R=function(){return this.P},t.toJSON=function(){return{apiKey:Sh(this).options.apiKey,authDomain:Sh(this).options.authDomain,appName:Sh(this).name,currentUser:Ch(this)&&Ch(this).A()}},t.xb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},t.ja=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},t.Ba=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?_(this.ac,this):null},t.ac=function(t,e,n,r){var i=this;t={requestUri:t,postBody:r,sessionId:e,tenantId:n},this.c&&(this.c.cancel(),this.c=null);var o=null,s=null,a=Xs(i.b,t).then(function(t){return o=mo(t),s=Pi(t),t});return kh(this,t=i.Y.then(function(){return a}).then(function(t){return Eh(i,t)}).then(function(){return Fr({user:Ch(i),credential:o,additionalUserInfo:s,operationType:"signIn"})}))},t.Lc=function(e){if(!mr())return Xt(new Yr("operation-not-supported-in-this-environment"));var n=this,t=Oi(e.providerId),r=Sr(),i=null;(!_r()||sr())&&Sh(this).options.authDomain&&e.isOAuthProvider&&(i=Ba(Sh(this).options.authDomain,Sh(this).options.apiKey,Sh(this).name,"signInViaPopup",e,null,r,fl.SDK_VERSION||null,null,null,this.R()));var o=er(i,t&&t.sa,t&&t.ra);return kh(this,t=bh(this).then(function(t){return ac(t,o,"signInViaPopup",e,r,!!i,n.R())}).then(function(){return new Bt(function(t,e){n.ja("signInViaPopup",null,new Yr("cancelled-popup-request"),n.g),n.f=t,n.v=e,n.g=r,n.c=hc(n.a,n,"signInViaPopup",o,r)})}).then(function(t){return o&&tr(o),t?Fr(t):null}).s(function(t){throw o&&tr(o),t}))},t.Mc=function(t){if(!mr())return Xt(new Yr("operation-not-supported-in-this-environment"));var e=this;return kh(this,bh(this).then(function(){return function(t){return yh(t,function(){return t.b.set(lh,t.c.C,t.a)})}(e.h)}).then(function(){return cc(e.a,"signInViaRedirect",t,void 0,e.R())}))},t.oa=function(){var e=this;return _h(this).then(function(t){return e.a&&vc(e.a.b),t}).s(function(t){throw e.a&&vc(e.a.b),t})},t.Rc=function(t){if(!t)return Xt(new Yr("null-user"));if(this.P!=t.tenantId)return Xt(new Yr("tenant-id-mismatch"));var e=this,n={};n.apiKey=Sh(this).options.apiKey,n.authDomain=Sh(this).options.authDomain,n.appName=Sh(this).name;var r=function(t,e,n,r){e=e||{apiKey:t.l,authDomain:t.o,appName:t.m};var i=t.b,o={};return o[Ps]=i.b,o.refreshToken=i.a,o.expiresIn=(i.c-I())/1e3,e=new Pc(e,o),n&&(e.da=n),r&&xc(e,r),Yc(e,t),e}(t,n,e.w,e.Ca());return kh(this,this.i.then(function(){if(Sh(e).options.apiKey!=t.l)return r.reload()}).then(function(){return Ch(e)&&t.uid==Ch(e).uid?(Yc(Ch(e),t),e.aa(t)):(Ih(e,r),Vc(r),e.aa(r))}).then(function(){Ah(e)}))},t.pb=function(){var t=this,e=this.i.then(function(){return t.a&&vc(t.a.b),Ch(t)?(Ih(t,null),dh(t.h).then(function(){Ah(t)})):Yt()});return kh(this,e)},t.Nc=function(){var r=this;return vh(this.h,Sh(this).options.authDomain).then(function(t){if(!r.l){var e;if(e=Ch(r)&&t){e=Ch(r).uid;var n=t.uid;e=null!=e&&""!==e&&null!=n&&""!==n&&e==n}if(e)return Yc(Ch(r),t),Ch(r).G();(Ch(r)||t)&&(Ih(r,t),t&&(Vc(t),t.da=r.w),r.a&&rc(r.a,r),Ah(r))}})},t.aa=function(t){return ph(this.h,t)},t.bc=function(){Ah(this),this.aa(Ch(this))},t.mc=function(){this.pb()},t.nc=function(){this.pb()},t.oc=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Ch(e))})},t.pc=function(t){var e=this;!function(t,e){t.J.push(e),kh(t,t.i.then(function(){!t.l&&j(t.J,e)&&t.W!==t.getUid()&&(t.W=t.getUid(),e(Nh(t)))}))}(this,function(){t.next(Ch(e))})},t.xc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then(function(){y(t)?t(Ch(r)):y(t.next)&&t.next(Ch(r))}),this.Ub(t,e,n)},t.wc=function(t,e,n){var r=this;return this.ga&&Promise.resolve().then(function(){r.W=r.getUid(),y(t)?t(Ch(r)):y(t.next)&&t.next(Ch(r))}),this.Vb(t,e,n)},t.cc=function(t){var e=this,n=this.i.then(function(){return Ch(e)?Ch(e).G(t).then(function(t){return{accessToken:t}}):null});return kh(this,n)},t.Hc=function(t){var n=this;return this.i.then(function(){return Th(n,Na(n.b,Ea,{token:t}))}).then(function(t){var e=t.user;return Qc(e,"isAnonymous",!1),n.aa(e),t})},t.Ic=function(t,e){var n=this;return this.i.then(function(){return Th(n,Na(n.b,Ia,{email:t,password:e}))})},t.Xb=function(t,e){var n=this;return this.i.then(function(){return Th(n,Na(n.b,na,{email:t,password:e}))})},t.Sa=function(t){var e=this;return this.i.then(function(){return Th(e,t.na(e.b))})},t.Gc=function(t){return xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.Sa(t)},t.ob=function(){var n=this;return this.i.then(function(){var t=Ch(n);return t&&t.isAnonymous?Fr({user:t,credential:null,additionalUserInfo:Fr({providerId:null,isNewUser:!1}),operationType:"signIn"}):Th(n,n.b.ob()).then(function(t){var e=t.user;return Qc(e,"isAnonymous",!0),n.aa(e),t})})},t.getUid=function(){return Ch(this)&&Ch(this).uid||null},t.Wb=function(t){this.addAuthTokenListener(t),this.o++,0<this.o&&Ch(this)&&Uc(Ch(this))},t.Ec=function(e){var n=this;M(this.m,function(t){t==e&&n.o--}),this.o<0&&(this.o=0),0==this.o&&Ch(this)&&Fc(Ch(this)),this.removeAuthTokenListener(e)},t.addAuthTokenListener=function(t){var e=this;this.m.push(t),kh(this,this.i.then(function(){e.l||j(e.m,t)&&t(Nh(e))}))},t.removeAuthTokenListener=function(e){V(this.m,function(t){return t==e})},t.delete=function(){this.l=!0;for(var t=0;t<this.O.length;t++)this.O[t].cancel("app-deleted");return this.O=[],this.h&&(t=this.h).b.removeListener(fh("local"),t.a,this.ma),this.a&&(ic(this.a,this),vc(this.a.b)),Promise.resolve()},t.$b=function(t){return kh(this,function(t,e){return Na(t,ra,{identifier:e,continueUri:wr()?Jn():"http://localhost"}).then(function(t){return t.signinMethods||[]})}(this.b,t))},t.qc=function(t){return!!lo(t)},t.lb=function(e,n){var r=this;return kh(this,Yt().then(function(){var t=new ui(n);if(!t.c)throw new Yr("argument-error",li+" must be true when sending sign in link to email");return mi(t)}).then(function(t){return r.b.lb(e,t)}).then(function(){}))},t.Uc=function(t){return this.Ma(t).then(function(t){return t.data.email})},t.ab=function(t,e){return kh(this,this.b.ab(t,e).then(function(){}))},t.Ma=function(t){return kh(this,this.b.Ma(t).then(function(t){return new qr(t)}))},t.Ya=function(t){return kh(this,this.b.Ya(t).then(function(){}))},t.kb=function(e,t){var n=this;return kh(this,Yt().then(function(){return void 0===t||G(t)?{}:mi(new ui(t))}).then(function(t){return n.b.kb(e,t)}).then(function(){}))},t.Kc=function(t,e){return kh(this,_c(this,t,e,_(this.Sa,this)))},t.Jc=function(n,r){var i=this;return kh(this,Yt().then(function(){var t=r||Jn(),e=ho(n,t);if(!(t=lo(t)))throw new Yr("argument-error","Invalid email link!");if(t.tenantId!==i.R())throw new Yr("tenant-id-mismatch");return i.Sa(e)}))},Rh.prototype.render=function(){},Rh.prototype.reset=function(){},Rh.prototype.getResponse=function(){},Rh.prototype.execute=function(){};var Ph=null;function Dh(t,e){return(e=xh(e))&&t.a[e]||null}function xh(t){return(t=void 0===t?1e12:t)?t.toString():null}function Lh(t,e){this.g=!1,this.c=e,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=qn(t);var n=this;this.i=function(){n.execute()},this.h?this.execute():He(this.f,"click",this.i)}function Mh(t){if(t.g)throw Error("reCAPTCHA mock was already deleted!")}function Uh(){}Oh.prototype.render=function(t,e){return this.a[this.b.toString()]=new Lh(t,e),this.b++},Oh.prototype.reset=function(t){var e=Dh(this,t);t=xh(t),e&&t&&(e.delete(),delete this.a[t])},Oh.prototype.getResponse=function(t){return(t=Dh(this,t))?t.getResponse():null},Oh.prototype.execute=function(t){(t=Dh(this,t))&&t.execute()},Lh.prototype.getResponse=function(){return Mh(this),this.b},Lh.prototype.execute=function(){Mh(this);var n=this;this.a||(this.a=setTimeout(function(){n.b=function(){for(var t=50,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}();var t=n.c.callback,e=n.c["expired-callback"];if(t)try{t(n.b)}catch(t){}n.a=setTimeout(function(){if(n.a=null,n.b=null,e)try{e()}catch(t){}n.h&&n.execute()},6e4)},500))},Lh.prototype.delete=function(){Mh(this),this.g=!0,clearTimeout(this.a),this.a=null,ze(this.f,"click",this.i)},Uh.prototype.g=function(){return Yt(Ph=Ph||new Oh)},Uh.prototype.c=function(){};var Fh=null;function jh(){this.b=l.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var qh=new Y($,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Vh=new Ar(3e4,6e4);jh.prototype.g=function(i){var o=this;return new Bt(function(t,e){var r=setTimeout(function(){e(new Yr("network-request-failed"))},Vh.get());!l.grecaptcha||i!==o.f&&!o.b?(l[o.a]=function(){if(l.grecaptcha){o.f=i;var n=l.grecaptcha.render;l.grecaptcha.render=function(t,e){return t=n(t,e),o.b++,t},clearTimeout(r),t(l.grecaptcha)}else clearTimeout(r),e(new Yr("internal-error"));delete l[o.a]},Yt(Is(nt(qh,{onload:o.a,hl:i||""}))).s(function(){clearTimeout(r),e(new Yr("internal-error","Unable to load external reCAPTCHA dependencies!"))})):(clearTimeout(r),t(l.grecaptcha))})},jh.prototype.c=function(){this.b--};var Bh=null;function Wh(t,e,n,r,i,o,s){if(Mr(this,"type","recaptcha"),this.c=this.f=null,this.B=!1,this.u=e,this.g=null,s=s?Fh=Fh||new Uh:Bh=Bh||new jh,this.m=s,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Kh])throw new Yr("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[zh],!l.document)throw new Yr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!qn(e)||!this.i&&qn(e).hasChildNodes())throw new Yr("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.o=new Rs(t,o||null,i||null),this.v=r||function(){return null};var a=this;this.l=[];var u=this.a[Hh];this.a[Hh]=function(t){if(Qh(a,t),"function"==typeof u)u(t);else if("string"==typeof u){var e=yr(u,l);"function"==typeof e&&e(t)}};var c=this.a[Gh];this.a[Gh]=function(){if(Qh(a,null),"function"==typeof c)c();else if("string"==typeof c){var t=yr(c,l);"function"==typeof t&&t()}}}var Hh="callback",Gh="expired-callback",Kh="sitekey",zh="size";function Qh(t,e){for(var n=0;n<t.l.length;n++)try{t.l[n](e)}catch(t){}}function Yh(t,e){return t.h.push(e),e.ka(function(){q(t.h,e)}),e}function Xh(t){if(t.B)throw new Yr("internal-error","RecaptchaVerifier instance has been destroyed.")}function Jh(t,e,n){var r=!1;try{this.b=n||fl.app()}catch(t){throw new Yr("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new Yr("invalid-api-key");n=this.b.options.apiKey;var i=this,o=null;try{o=this.b.auth().Ca()}catch(t){}try{r=this.b.auth().settings.appVerificationDisabledForTesting}catch(t){}o=fl.SDK_VERSION?dr(fl.SDK_VERSION,o):null,Wh.call(this,n,t,e,function(){try{var e=i.b.auth().ha()}catch(t){e=null}return e},o,Ni(Si),r)}function $h(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,s=0;s<e.length;s++)if(e[s].optional)o=!0;else{if(o)throw new Yr("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].N(n[i])&&!o){if(e=e[i],i<0||i>=Zh.length)throw new Yr("internal-error","Argument validator received an unsupported number of arguments.");n=Zh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.M+".";break t}r=null}}if(r)throw new Yr("argument-error",t+" failed: "+r)}(t=Wh.prototype).Da=function(){var e=this;return this.f?this.f:this.f=Yh(this,Yt().then(function(){if(wr()&&!ar())return ir();throw new Yr("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return e.m.g(e.v())}).then(function(t){return e.g=t,Na(e.o,pa,{})}).then(function(t){e.a[Kh]=t.recaptchaSiteKey}).s(function(t){throw e.f=null,t}))},t.render=function(){Xh(this);var n=this;return Yh(this,this.Da().then(function(){if(null===n.c){var t=n.u;if(!n.i){var e=qn(t);t=Wn("DIV"),e.appendChild(t)}n.c=n.g.render(t,n.a)}return n.c}))},t.verify=function(){Xh(this);var i=this;return Yh(this,this.render().then(function(r){return new Bt(function(e){var t=i.g.getResponse(r);if(t)e(t);else{var n=function(t){t&&(function(t,e){V(t.l,function(t){return t==e})}(i,n),e(t))};i.l.push(n),i.i&&i.g.execute(i.c)}})}))},t.reset=function(){Xh(this),null!==this.c&&this.g.reset(this.c)},t.clear=function(){Xh(this),this.B=!0,this.m.c();for(var t=0;t<this.h.length;t++)this.h[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){t=qn(this.u);for(var e;e=t.firstChild;)t.removeChild(e)}},T(Jh,Wh);var Zh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function tl(t,e){return{name:t||"",M:"a valid string",optional:!!e,N:h}}function el(t,e){return{name:t||"",M:"a boolean",optional:!!e,N:n}}function nl(t,e){return{name:t||"",M:"a valid object",optional:!!e,N:g}}function rl(t,e){return{name:t||"",M:"a function",optional:!!e,N:y}}function il(t,e){return{name:t||"",M:"null",optional:!!e,N:i}}function ol(n){return{name:n?n+"Credential":"credential",M:n?"a valid "+n+" credential":"a valid credential",optional:!1,N:function(t){if(!t)return!1;var e=!n||t.providerId===n;return!(!t.na||!e)}}}function sl(){return{name:"applicationVerifier",M:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,N:function(t){return!!(t&&h(t.type)&&y(t.verify))}}}function al(e,n,t,r){return{name:t||"",M:e.M+" or "+n.M,optional:!!r,N:function(t){return e.N(t)||n.N(t)}}}function ul(t,e){for(var n in e){var r=e[n].name;t[r]=ll(r,t[n],e[n].j)}}function cl(t,e){for(var n in e){var r=e[n].name;r!==n&&Object.defineProperty(t,r,{get:E(function(t){return this[t]},n),set:E(function(t,e,n,r){$h(t,[n],[r],!0),this[e]=r},r,n,e[n].Za),enumerable:!0})}}function hl(t,e,n,r){t[e]=ll(e,n,r)}function ll(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return $h(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=function(t){return(t=t.split("."))[t.length-1]}(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}ul(gh.prototype,{Ya:{name:"applyActionCode",j:[tl("code")]},Ma:{name:"checkActionCode",j:[tl("code")]},ab:{name:"confirmPasswordReset",j:[tl("code"),tl("newPassword")]},Xb:{name:"createUserWithEmailAndPassword",j:[tl("email"),tl("password")]},$b:{name:"fetchSignInMethodsForEmail",j:[tl("email")]},oa:{name:"getRedirectResult",j:[]},qc:{name:"isSignInWithEmailLink",j:[tl("emailLink")]},wc:{name:"onAuthStateChanged",j:[al(nl(),rl(),"nextOrObserver"),rl("opt_error",!0),rl("opt_completed",!0)]},xc:{name:"onIdTokenChanged",j:[al(nl(),rl(),"nextOrObserver"),rl("opt_error",!0),rl("opt_completed",!0)]},kb:{name:"sendPasswordResetEmail",j:[tl("email"),al(nl("opt_actionCodeSettings",!0),il(null,!0),"opt_actionCodeSettings",!0)]},lb:{name:"sendSignInLinkToEmail",j:[tl("email"),nl("actionCodeSettings")]},mb:{name:"setPersistence",j:[tl("persistence")]},Gc:{name:"signInAndRetrieveDataWithCredential",j:[ol()]},ob:{name:"signInAnonymously",j:[]},Sa:{name:"signInWithCredential",j:[ol()]},Hc:{name:"signInWithCustomToken",j:[tl("token")]},Ic:{name:"signInWithEmailAndPassword",j:[tl("email"),tl("password")]},Jc:{name:"signInWithEmailLink",j:[tl("email"),tl("emailLink",!0)]},Kc:{name:"signInWithPhoneNumber",j:[tl("phoneNumber"),sl()]},Lc:{name:"signInWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Mc:{name:"signInWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Rc:{name:"updateCurrentUser",j:[al({name:"user",M:"an instance of Firebase User",optional:!1,N:function(t){return!!(t&&t instanceof Pc)}},il(),"user")]},pb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[tl(null,!0)]},Tc:{name:"useDeviceLanguage",j:[]},Uc:{name:"verifyPasswordResetCode",j:[tl("code")]}}),cl(gh.prototype,{lc:{name:"languageCode",Za:al(tl(),il(),"languageCode")},ti:{name:"tenantId",Za:al(tl(),il(),"tenantId")}}),(gh.Persistence=Eu).LOCAL="local",gh.Persistence.SESSION="session",gh.Persistence.NONE="none",ul(Pc.prototype,{delete:{name:"delete",j:[]},dc:{name:"getIdTokenResult",j:[el("opt_forceRefresh",!0)]},G:{name:"getIdToken",j:[el("opt_forceRefresh",!0)]},rc:{name:"linkAndRetrieveDataWithCredential",j:[ol()]},fb:{name:"linkWithCredential",j:[ol()]},sc:{name:"linkWithPhoneNumber",j:[tl("phoneNumber"),sl()]},tc:{name:"linkWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},uc:{name:"linkWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Ac:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ol()]},hb:{name:"reauthenticateWithCredential",j:[ol()]},Bc:{name:"reauthenticateWithPhoneNumber",j:[tl("phoneNumber"),sl()]},Cc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},Dc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",M:"a valid Auth provider",optional:!1,N:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},jb:{name:"sendEmailVerification",j:[al(nl("opt_actionCodeSettings",!0),il(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[tl(null,!0)]},Qc:{name:"unlink",j:[tl("provider")]},rb:{name:"updateEmail",j:[tl("email")]},sb:{name:"updatePassword",j:[tl("password")]},Sc:{name:"updatePhoneNumber",j:[ol("phone")]},tb:{name:"updateProfile",j:[nl("profile")]}}),ul(Oh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),ul(Rh.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),ul(Bt.prototype,{ka:{name:"finally"},s:{name:"catch"},then:{name:"then"}}),cl(wc.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",Za:el("appVerificationDisabledForTesting")}}),ul(bc.prototype,{confirm:{name:"confirm",j:[tl("verificationCode")]}}),hl(Bi,"fromJSON",function(t){t=h(t)?JSON.parse(t):t;for(var e,n=[Yi,uo,po,Ki],r=0;r<n.length;r++)if(e=n[r](t))return e;return null},[al(tl(),nl(),"json")]),hl(co,"credential",function(t,e){return new ao(t,e)},[tl("email"),tl("password")]),ul(ao.prototype,{A:{name:"toJSON",j:[tl(null,!0)]}}),ul(Zi.prototype,{ya:{name:"addScope",j:[tl("scope")]},Ga:{name:"setCustomParameters",j:[nl("customOAuthParameters")]}}),hl(Zi,"credential",to,[al(tl(),nl(),"token")]),hl(co,"credentialWithLink",ho,[tl("email"),tl("emailLink")]),ul(eo.prototype,{ya:{name:"addScope",j:[tl("scope")]},Ga:{name:"setCustomParameters",j:[nl("customOAuthParameters")]}}),hl(eo,"credential",no,[al(tl(),nl(),"token")]),ul(ro.prototype,{ya:{name:"addScope",j:[tl("scope")]},Ga:{name:"setCustomParameters",j:[nl("customOAuthParameters")]}}),hl(ro,"credential",io,[al(tl(),al(nl(),il()),"idToken"),al(tl(),il(),"accessToken",!0)]),ul(oo.prototype,{Ga:{name:"setCustomParameters",j:[nl("customOAuthParameters")]}}),hl(oo,"credential",so,[al(tl(),nl(),"token"),tl("secret",!0)]),ul($i.prototype,{ya:{name:"addScope",j:[tl("scope")]},credential:{name:"credential",j:[al(tl(),al(nl(),il()),"optionsOrIdToken"),al(tl(),il(),"accessToken",!0)]},Ga:{name:"setCustomParameters",j:[nl("customOAuthParameters")]}}),ul(zi.prototype,{A:{name:"toJSON",j:[tl(null,!0)]}}),ul(Hi.prototype,{A:{name:"toJSON",j:[tl(null,!0)]}}),hl(yo,"credential",go,[tl("verificationId"),tl("verificationCode")]),ul(yo.prototype,{Wa:{name:"verifyPhoneNumber",j:[tl("phoneNumber"),sl()]}}),ul(fo.prototype,{A:{name:"toJSON",j:[tl(null,!0)]}}),ul(Yr.prototype,{toJSON:{name:"toJSON",j:[tl(null,!0)]}}),ul(Co.prototype,{toJSON:{name:"toJSON",j:[tl(null,!0)]}}),ul(So.prototype,{toJSON:{name:"toJSON",j:[tl(null,!0)]}}),ul(Jh.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),hl(Zr,"parseLink",ai,[tl("link")]),function(){if(void 0===fl||!fl.INTERNAL||!fl.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Vr,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:gh,AuthCredential:Bi,Error:Yr};hl(t,"EmailAuthProvider",co,[]),hl(t,"FacebookAuthProvider",Zi,[]),hl(t,"GithubAuthProvider",eo,[]),hl(t,"GoogleAuthProvider",ro,[]),hl(t,"TwitterAuthProvider",oo,[]),hl(t,"OAuthProvider",$i,[tl("providerId")]),hl(t,"SAMLAuthProvider",Ji,[tl("providerId")]),hl(t,"PhoneAuthProvider",yo,[{name:"auth",M:"an instance of Firebase Auth",optional:!0,N:function(t){return!!(t&&t instanceof gh)}}]),hl(t,"RecaptchaVerifier",Jh,[al(tl(),{name:"",M:"an HTML element",optional:!1,N:function(t){return!!(t&&t instanceof Element)}},"recaptchaContainer"),nl("recaptchaParameters",!0),{name:"app",M:"an instance of Firebase App",optional:!0,N:function(t){return!!(t&&t instanceof fl.app.App)}}]),hl(t,"ActionCodeURL",Zr,[]),fl.INTERNAL.registerComponent({name:"auth",instanceFactory:function(t){return new gh(t=t.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:t,instantiationMode:"LAZY",type:"PUBLIC"}),fl.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(t){return{getUid:_((t=t.getProvider("auth").getImmediate()).getUid,t),getToken:_(t.cc,t),addAuthTokenListener:_(t.Wb,t),removeAuthTokenListener:_(t.Ec,t)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),fl.registerVersion("@firebase/auth","0.13.5"),fl.INTERNAL.extendNamespace({User:Pc})}()}).apply("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ka=(za.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),Xs(e))},za.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:Ys(e)},za.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},za.prototype.prefixedName_=function(t){return this.prefix_+t},za.prototype.toString=function(){return this.domStorage_.toString()},za);function za(t){this.domStorage_=t,this.prefix_="firebase:"}var Qa=(Ya.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},Ya.prototype.get=function(t){return $s(this.cache_,t)?this.cache_[t]:null},Ya.prototype.remove=function(t){delete this.cache_[t]},Ya);function Ya(){this.cache_={},this.isInMemoryStorage=!0}function Xa(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new Ka(e)}}catch(t){}return new Qa}function Ja(t){var e=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(55296<=i&&i<=56319){var o=i-55296;Ps(++r<t.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:(i<2048?e[n++]=i>>6|192:(i<65536?e[n++]=i>>12|224:(e[n++]=i>>18|240,e[n++]=i>>12&63|128),e[n++]=i>>6&63|128),e[n++]=63&i|128)}return e}(t),n=new na;n.update(e);var r=n.digest();return xs.encodeByteArray(r)}function $a(t,e){Ps(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(lu.logLevel=ma.VERBOSE,du=lu.log.bind(lu),e&&hu.set("logging_enabled",!0)):"function"==typeof t?du=t:(du=null,hu.remove("logging_enabled"))}function Za(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===vu&&(vu=!1,null===du&&!0===hu.get("logging_enabled")&&$a(!0)),du){var n=pu.apply(null,t);du(n)}}function tu(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Za.apply(void 0,Ns([n],t))}}function eu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+pu.apply(void 0,Ns(t));lu.error(n)}function nu(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+pu.apply(void 0,Ns(t));throw lu.error(n),new Error(n)}function ru(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+pu.apply(void 0,Ns(t));lu.warn(n)}function iu(t){return"number"==typeof t&&(t!=t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)}function ou(t,e){return t===e?0:t<e?-1:1}function su(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Xs(e))}function au(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)n<i+e?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r}var uu,cu=Xa("localStorage"),hu=Xa("sessionStorage"),lu=new Ca("@firebase/database"),fu=(uu=1,function(){return uu++}),pu=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var i=t[r];Array.isArray(i)||i&&"object"==typeof i&&"number"==typeof i.length?n+=pu.apply(null,i):n+="object"==typeof i?Xs(i):i,n+=" "}return n},du=null,vu=!0,yu="[MIN_NAME]",gu="[MAX_NAME]",mu=function(t,e){if(t===e)return 0;if(t===yu||e===gu)return-1;if(e===yu||t===gu)return 1;var n=Su(t),r=Su(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},wu=function(t){if("object"!=typeof t||null===t)return Xs(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=Xs(e[i]),r+=":",r+=wu(t[e[i]]);return r+="}"};function bu(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}function _u(t){var e,n,r,i,o;Ps(!iu(t),"Invalid JSON number"),0===t?e=1/t==-1/(r=n=0)?1:0:(e=t<0,r=(t=Math.abs(t))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023))+1023,Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,Math.round(t/Math.pow(2,-1074))));var s=[];for(o=52;o;o-=1)s.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)s.push(n%2?1:0),n=Math.floor(n/2);s.push(e?1:0),s.reverse();var a=s.join(""),u="";for(o=0;o<64;o+=8){var c=parseInt(a.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()}function Eu(t){try{t()}catch(e){setTimeout(function(){var t=e.stack||"";throw ru("Exception was thrown by user callback.",t),e},Math.floor(0))}}function Iu(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n}var Tu=new RegExp("^-?(0*)\\d{1,10}$"),Su=function(t){if(Tu.test(t)){var e=Number(t);if(-2147483648<=e&&e<=2147483647)return e}return null},Cu=(Object.defineProperty(Nu,"Empty",{get:function(){return new Nu("")},enumerable:!0,configurable:!0}),Nu.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},Nu.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},Nu.prototype.popFront=function(){var t=this.pieceNum_;return t<this.pieces_.length&&t++,new Nu(this.pieces_,t)},Nu.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},Nu.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},Nu.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},Nu.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},Nu.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var t=[],e=this.pieceNum_;e<this.pieces_.length-1;e++)t.push(this.pieces_[e]);return new Nu(t,0)},Nu.prototype.child=function(t){for(var e=[],n=this.pieceNum_;n<this.pieces_.length;n++)e.push(this.pieces_[n]);if(t instanceof Nu)for(n=t.pieceNum_;n<t.pieces_.length;n++)e.push(t.pieces_[n]);else{var r=t.split("/");for(n=0;n<r.length;n++)0<r[n].length&&e.push(r[n])}return new Nu(e,0)},Nu.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},Nu.relativePath=function(t,e){var n=t.getFront(),r=e.getFront();if(null===n)return e;if(n===r)return Nu.relativePath(t.popFront(),e.popFront());throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")},Nu.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=mu(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},Nu.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},Nu.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},Nu);function Nu(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)0<this.pieces_[r].length&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}var Au=(Object.defineProperty(ku,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(ku,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),ku.prototype.push=function(t){0<this.parts_.length&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=fa(t),this.checkValid_()},ku.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=fa(t),0<this.parts_.length&&(this.byteLength_-=1)},ku.prototype.checkValid_=function(){if(this.byteLength_>ku.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+ku.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>ku.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+ku.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},ku.prototype.toErrorString=function(){return 0===this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},ku);function ku(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=fa(this.parts_[n]);this.checkValid_()}var Ru="firebaseio.com",Ou="websocket",Pu="long_polling",Du=(xu.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()||this.includeNamespaceInQueryParams},xu.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},xu.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},xu.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},xu.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&cu.set("host:"+this.host,this.internalHost))},xu.prototype.connectionURL=function(t,e){var n;if(Ps("string"==typeof t,"typeof type must == string"),Ps("object"==typeof e,"typeof params must == object"),t===Ou)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==Pu)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return bu(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},xu.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},xu.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},xu);function xu(t,e,n,r,i,o){void 0===i&&(i=""),void 0===o&&(o=!1),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.includeNamespaceInQueryParams=o,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=cu.get("host:"+t)||this.host}function Lu(t){var e=zu(t),n=e.namespace;"firebase"===e.domain&&nu(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!==n||"localhost"===e.domain||nu("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&ru("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new Du(e.host,e.secure,n,r,"",n!==e.subdomain),path:new Cu(e.pathString)}}function Mu(t){return"string"==typeof t&&0!==t.length&&!Qu.test(t)}function Uu(t){return"string"==typeof t&&0!==t.length&&!Yu.test(t)}function Fu(t){return null===t||"string"==typeof t||"number"==typeof t&&!iu(t)||t&&"object"==typeof t&&$s(t,".sv")}function ju(t,e,n,r,i){i&&void 0===n||Ju(ca(t,e,i),n,r)}function qu(t,e,n,r,i){if(!i||void 0!==n){var o=ca(t,e,i);if(!n||"object"!=typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var s=[];bu(n,function(t,e){var n=new Cu(t);if(Ju(o,e,r.child(n)),".priority"===n.getBack()&&!Fu(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(n)}),function(t,e){var n,r;for(n=0;n<e.length;n++)for(var i=(r=e[n]).slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!Mu(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');e.sort(Cu.comparePaths);var s=null;for(n=0;n<e.length;n++){if(r=e[n],null!==s&&s.contains(r))throw new Error(t+"contains a path "+s.toString()+" that is ancestor of another path "+r.toString());s=r}}(o,s)}}function Vu(t,e,n,r){if(!r||void 0!==n){if(iu(n))throw new Error(ca(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Fu(n))throw new Error(ca(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}}function Bu(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(ca(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}function Wu(t,e,n,r){if(!(r&&void 0===n||Mu(n)))throw new Error(ca(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')}function Hu(t,e,n,r){if(!(r&&void 0===n||Uu(n)))throw new Error(ca(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')}function Gu(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")}function Ku(t,e,n){var r=n.path.toString();if("string"!=typeof n.repoInfo.host||0===n.repoInfo.host.length||!Mu(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!function(t){return t=t&&t.replace(/^\/*\.info(\/|$)/,"/"),Uu(t)}(r))throw new Error(ca(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')}var zu=function(t){var e="",n="",r="",i="",o="",s=!0,a="https",u=443;if("string"==typeof t){var c=t.indexOf("//");0<=c&&(a=t.substring(0,c-1),t=t.substring(c+2));var h=t.indexOf("/");-1===h&&(h=t.length);var l=t.indexOf("?");-1===l&&(l=t.length),e=t.substring(0,Math.min(h,l)),h<l&&(i=function(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(0<n[r].length){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}(t.substring(h,l)));var f=function(t){var e,n,r={};"?"===t.charAt(0)&&(t=t.substring(1));try{for(var i=Ss(t.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var a=s.split("=");2===a.length?r[decodeURIComponent(a[0])]=decodeURIComponent(a[1]):ru("Invalid query segment '"+s+"' in query '"+t+"'")}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}(t.substring(Math.min(t.length,l)));0<=(c=e.indexOf(":"))?(s="https"===a||"wss"===a,u=parseInt(e.substring(c+1),10)):c=t.length;var p=e.split(".");3===p.length?(n=p[1],o=r=p[0].toLowerCase()):2===p.length?n=p[0]:"localhost"===p[0].slice(0,c).toLowerCase()&&(n="localhost"),"ns"in f&&(o=f.ns)}return{host:e,port:u,domain:n,subdomain:r,secure:s,scheme:a,pathString:i,namespace:o}},Qu=/[\[\].#$\/\u0000-\u001F\u007F]/,Yu=/[\[\].#$\u0000-\u001F\u007F]/,Xu=10485760,Ju=function(n,t,e){var r=e instanceof Cu?new Au(e,n):e;if(void 0===t)throw new Error(n+"contains undefined "+r.toErrorString());if("function"==typeof t)throw new Error(n+"contains a function "+r.toErrorString()+" with contents = "+t.toString());if(iu(t))throw new Error(n+"contains "+t.toString()+" "+r.toErrorString());if("string"==typeof t&&t.length>Xu/3&&fa(t)>Xu)throw new Error(n+"contains a string greater than "+Xu+" utf8 bytes "+r.toErrorString()+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){var i=!1,o=!1;if(bu(t,function(t,e){if(".value"===t)i=!0;else if(".priority"!==t&&".sv"!==t&&(o=!0,!Mu(t)))throw new Error(n+" contains an invalid key ("+t+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(t),Ju(n,e,r),r.pop()}),i&&o)throw new Error(n+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},$u=(Zu.prototype.cancel=function(t){ua("OnDisconnect.cancel",0,1,arguments.length),ha("OnDisconnect.cancel",1,t,!0);var e=new Us;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},Zu.prototype.remove=function(t){ua("OnDisconnect.remove",0,1,arguments.length),Gu("OnDisconnect.remove",this.path_),ha("OnDisconnect.remove",1,t,!0);var e=new Us;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},Zu.prototype.set=function(t,e){ua("OnDisconnect.set",1,2,arguments.length),Gu("OnDisconnect.set",this.path_),ju("OnDisconnect.set",1,t,this.path_,!1),ha("OnDisconnect.set",2,e,!0);var n=new Us;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},Zu.prototype.setWithPriority=function(t,e,n){ua("OnDisconnect.setWithPriority",2,3,arguments.length),Gu("OnDisconnect.setWithPriority",this.path_),ju("OnDisconnect.setWithPriority",1,t,this.path_,!1),Vu("OnDisconnect.setWithPriority",2,e,!1),ha("OnDisconnect.setWithPriority",3,n,!0);var r=new Us;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},Zu.prototype.update=function(t,e){if(ua("OnDisconnect.update",1,2,arguments.length),Gu("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,ru("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qu("OnDisconnect.update",1,t,this.path_,!1),ha("OnDisconnect.update",2,e,!0);var i=new Us;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},Zu);function Zu(t,e){this.repo_=t,this.path_=e}var tc=(ec.prototype.toJSON=function(){return ua("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},ec);function ec(t,e){this.committed=t,this.snapshot=e}var nc,rc,ic,oc=(nc="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",rc=0,ic=[],function(t){var e,n=t===rc;rc=t;var r=new Array(8);for(e=7;0<=e;e--)r[e]=nc.charAt(t%64),t=Math.floor(t/64);Ps(0===t,"Cannot push at time == 0");var i=r.join("");if(n){for(e=11;0<=e&&63===ic[e];e--)ic[e]=0;ic[e]++}else for(e=0;e<12;e++)ic[e]=Math.floor(64*Math.random());for(e=0;e<12;e++)i+=nc.charAt(ic[e]);return Ps(20===i.length,"nextPushId: Length should be 20."),i}),sc=(ac.Wrap=function(t,e){return new ac(t,e)},ac);function ac(t,e){this.name=t,this.node=e}var uc,cc=(hc.prototype.getCompare=function(){return this.compare.bind(this)},hc.prototype.indexedValueChanged=function(t,e){var n=new sc(yu,t),r=new sc(yu,e);return 0!==this.compare(n,r)},hc.prototype.minPost=function(){return sc.MIN},hc);function hc(){}var lc,fc=(_s(pc,lc=cc),Object.defineProperty(pc,"__EMPTY_NODE",{get:function(){return uc},set:function(t){uc=t},enumerable:!0,configurable:!0}),pc.prototype.compare=function(t,e){return mu(t.name,e.name)},pc.prototype.isDefinedOn=function(t){throw Ds("KeyIndex.isDefinedOn not expected to be called.")},pc.prototype.indexedValueChanged=function(t,e){return!1},pc.prototype.minPost=function(){return sc.MIN},pc.prototype.maxPost=function(){return new sc(gu,uc)},pc.prototype.makePost=function(t,e){return Ps("string"==typeof t,"KeyIndex indexValue must always be a string."),new sc(t,uc)},pc.prototype.toString=function(){return".key"},pc);function pc(){return null!==lc&&lc.apply(this,arguments)||this}var dc,vc=new fc;function yc(t){return"number"==typeof t?"number:"+_u(t):"string:"+t}function gc(t){if(t.isLeafNode()){var e=t.val();Ps("string"==typeof e||"number"==typeof e||"object"==typeof e&&$s(e,".sv"),"Priority must be a string or number.")}else Ps(t===dc||t.isEmpty(),"priority of unexpected type.");Ps(t===dc||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}var mc,wc,bc,_c,Ec=(Object.defineProperty(Ic,"__childrenNodeConstructor",{get:function(){return mc},set:function(t){mc=t},enumerable:!0,configurable:!0}),Ic.prototype.isLeafNode=function(){return!0},Ic.prototype.getPriority=function(){return this.priorityNode_},Ic.prototype.updatePriority=function(t){return new Ic(this.value_,t)},Ic.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:Ic.__childrenNodeConstructor.EMPTY_NODE},Ic.prototype.getChild=function(t){return t.isEmpty()?this:".priority"===t.getFront()?this.priorityNode_:Ic.__childrenNodeConstructor.EMPTY_NODE},Ic.prototype.hasChild=function(){return!1},Ic.prototype.getPredecessorChildName=function(t,e){return null},Ic.prototype.updateImmediateChild=function(t,e){return".priority"===t?this.updatePriority(e):e.isEmpty()&&".priority"!==t?this:Ic.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,e).updatePriority(this.priorityNode_)},Ic.prototype.updateChild=function(t,e){var n=t.getFront();return null===n?e:e.isEmpty()&&".priority"!==n?this:(Ps(".priority"!==n||1===t.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(n,Ic.__childrenNodeConstructor.EMPTY_NODE.updateChild(t.popFront(),e)))},Ic.prototype.isEmpty=function(){return!1},Ic.prototype.numChildren=function(){return 0},Ic.prototype.forEachChild=function(t,e){return!1},Ic.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},Ic.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+yc(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"==e?_u(this.value_):this.value_,this.lazyHash_=Ja(t)}return this.lazyHash_},Ic.prototype.getValue=function(){return this.value_},Ic.prototype.compareTo=function(t){return t===Ic.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof Ic.__childrenNodeConstructor?-1:(Ps(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},Ic.prototype.compareToLeafNode_=function(t){var e=typeof t.value_,n=typeof this.value_,r=Ic.VALUE_TYPE_ORDER.indexOf(e),i=Ic.VALUE_TYPE_ORDER.indexOf(n);return Ps(0<=r,"Unknown leaf type: "+e),Ps(0<=i,"Unknown leaf type: "+n),r===i?"object"==n?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:i-r},Ic.prototype.withIndex=function(){return this},Ic.prototype.isIndexed=function(){return!0},Ic.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},Ic.VALUE_TYPE_ORDER=["object","boolean","number","string"],Ic);function Ic(t,e){void 0===e&&(e=Ic.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=e,this.lazyHash_=null,Ps(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),gc(this.priorityNode_)}function Tc(){return null!==_c&&_c.apply(this,arguments)||this}var Sc=new(_s(Tc,_c=cc),Tc.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?mu(t.name,e.name):i},Tc.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},Tc.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},Tc.prototype.minPost=function(){return sc.MIN},Tc.prototype.maxPost=function(){return new sc(gu,new Ec("[PRIORITY-POST]",bc))},Tc.prototype.makePost=function(t,e){var n=wc(t);return new sc(e,new Ec("[PRIORITY-POST]",n))},Tc.prototype.toString=function(){return".priority"},Tc),Cc=(Nc.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},Nc.prototype.hasNext=function(){return 0<this.nodeStack_.length},Nc.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},Nc);function Nc(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}var Ac=(kc.prototype.copy=function(t,e,n,r,i){return new kc(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},kc.prototype.count=function(){return this.left.count()+1+this.right.count()},kc.prototype.isEmpty=function(){return!1},kc.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)},kc.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},kc.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},kc.prototype.minKey=function(){return this.min_().key},kc.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},kc.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n))).fixUp_()},kc.prototype.removeMin_=function(){if(this.left.isEmpty())return Pc.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),(t=t.copy(null,null,null,t.left.removeMin_(),null)).fixUp_()},kc.prototype.remove=function(t,e){var n,r;if(e(t,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Pc.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},kc.prototype.isRed_=function(){return this.color},kc.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},kc.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=(t=(t=t.copy(null,null,null,null,t.right.rotateRight_())).rotateLeft_()).colorFlip_()),t},kc.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=(t=t.rotateRight_()).colorFlip_()),t},kc.prototype.rotateLeft_=function(){var t=this.copy(null,null,kc.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},kc.prototype.rotateRight_=function(){var t=this.copy(null,null,kc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},kc.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},kc.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},kc.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},kc.RED=!0,kc.BLACK=!1,kc);function kc(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:kc.RED,this.left=null!=r?r:Pc.EMPTY_NODE,this.right=null!=i?i:Pc.EMPTY_NODE}var Rc=(Oc.prototype.copy=function(t,e,n,r,i){return this},Oc.prototype.insert=function(t,e,n){return new Ac(t,e,null)},Oc.prototype.remove=function(t,e){return this},Oc.prototype.count=function(){return 0},Oc.prototype.isEmpty=function(){return!0},Oc.prototype.inorderTraversal=function(t){return!1},Oc.prototype.reverseTraversal=function(t){return!1},Oc.prototype.minKey=function(){return null},Oc.prototype.maxKey=function(){return null},Oc.prototype.check_=function(){return 0},Oc.prototype.isRed_=function(){return!1},Oc);function Oc(){}var Pc=(Dc.prototype.insert=function(t,e){return new Dc(this.comparator_,this.root_.insert(t,e,this.comparator_).copy(null,null,Ac.BLACK,null,null))},Dc.prototype.remove=function(t){return new Dc(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ac.BLACK,null,null))},Dc.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:0<e&&(n=n.right)}return null},Dc.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:0<e&&(n=(r=n).right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},Dc.prototype.isEmpty=function(){return this.root_.isEmpty()},Dc.prototype.count=function(){return this.root_.count()},Dc.prototype.minKey=function(){return this.root_.minKey()},Dc.prototype.maxKey=function(){return this.root_.maxKey()},Dc.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},Dc.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},Dc.prototype.getIterator=function(t){return new Cc(this.root_,null,this.comparator_,!1,t)},Dc.prototype.getIteratorFrom=function(t,e){return new Cc(this.root_,t,this.comparator_,!1,e)},Dc.prototype.getReverseIteratorFrom=function(t,e){return new Cc(this.root_,t,this.comparator_,!0,e)},Dc.prototype.getReverseIterator=function(t){return new Cc(this.root_,null,this.comparator_,!0,t)},Dc.EMPTY_NODE=new Rc,Dc);function Dc(t,e){void 0===e&&(e=Dc.EMPTY_NODE),this.comparator_=t,this.root_=e}var xc=Math.log(2),Lc=(Mc.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},Mc);function Mc(t){var e;this.count=(e=t+1,parseInt(Math.log(e)/xc,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=t+1&r}var Uc,Fc,jc=function(c,t,h,e){c.sort(t);var l=function(t,e){var n,r,i=e-t;if(0==i)return null;if(1==i)return n=c[t],r=h?h(n):n,new Ac(r,n.node,Ac.BLACK,null,null);var o=parseInt(i/2,10)+t,s=l(t,o),a=l(o+1,e);return n=c[o],r=h?h(n):n,new Ac(r,n.node,Ac.BLACK,s,a)},n=function(t){for(var e=null,n=null,a=c.length,r=function(t,e){var n=a-t,r=a;a-=t;var i=l(1+n,r),o=c[n],s=h?h(o):o;u(new Ac(s,o.node,e,null,i))},u=function(t){e=e?e.left=t:n=t},i=0;i<t.count;++i){var o=t.nextBitIsOne(),s=Math.pow(2,t.count-(i+1));o?r(s,Ac.BLACK):(r(s,Ac.BLACK),r(s,Ac.RED))}return n}(new Lc(c.length));return new Pc(e||t,n)},qc={},Vc=(Object.defineProperty(Bc,"Default",{get:function(){return Ps(Sc,"ChildrenNode.ts has not been loaded"),Uc=Uc||new Bc({".priority":qc},{".priority":Sc})},enumerable:!0,configurable:!0}),Bc.prototype.get=function(t){var e=Zs(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e instanceof Pc?e:null},Bc.prototype.hasIndex=function(t){return $s(this.indexSet_,t.toString())},Bc.prototype.addIndex=function(t,e){Ps(t!==vc,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var n,r=[],i=!1,o=e.getIterator(sc.Wrap),s=o.getNext();s;)i=i||t.isDefinedOn(s.node),r.push(s),s=o.getNext();n=i?jc(r,t.getCompare()):qc;var a=t.toString(),u=Es({},this.indexSet_);u[a]=t;var c=Es({},this.indexes_);return c[a]=n,new Bc(c,u)},Bc.prototype.addToIndexes=function(u,c){var h=this;return new Bc(ea(this.indexes_,function(t,e){var n=Zs(h.indexSet_,e);if(Ps(n,"Missing index implementation for "+e),t===qc){if(n.isDefinedOn(u.node)){for(var r=[],i=c.getIterator(sc.Wrap),o=i.getNext();o;)o.name!==u.name&&r.push(o),o=i.getNext();return r.push(u),jc(r,n.getCompare())}return qc}var s=c.get(u.name),a=t;return s&&(a=a.remove(new sc(u.name,s))),a.insert(u,u.node)}),this.indexSet_)},Bc.prototype.removeFromIndexes=function(n,r){return new Bc(ea(this.indexes_,function(t){if(t===qc)return t;var e=r.get(n.name);return e?t.remove(new sc(n.name,e)):t}),this.indexSet_)},Bc);function Bc(t,e){this.indexes_=t,this.indexSet_=e}function Wc(t,e){return mu(t.name,e.name)}function Hc(t,e){return mu(t,e)}var Gc,Kc=(Object.defineProperty(zc,"EMPTY_NODE",{get:function(){return Fc=Fc||new zc(new Pc(Hc),null,Vc.Default)},enumerable:!0,configurable:!0}),zc.prototype.isLeafNode=function(){return!1},zc.prototype.getPriority=function(){return this.priorityNode_||Fc},zc.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new zc(this.children_,t,this.indexMap_)},zc.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?Fc:e},zc.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},zc.prototype.hasChild=function(t){return null!==this.children_.get(t)},zc.prototype.updateImmediateChild=function(t,e){if(Ps(e,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(e);var n=new sc(t,e),r=void 0,i=void 0;i=e.isEmpty()?(r=this.children_.remove(t),this.indexMap_.removeFromIndexes(n,this.children_)):(r=this.children_.insert(t,e),this.indexMap_.addToIndexes(n,this.children_));var o=r.isEmpty()?Fc:this.priorityNode_;return new zc(r,o,i)},zc.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;Ps(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},zc.prototype.isEmpty=function(){return this.children_.isEmpty()},zc.prototype.numChildren=function(){return this.children_.count()},zc.prototype.val=function(n){if(this.isEmpty())return null;var r={},i=0,o=0,s=!0;if(this.forEachChild(Sc,function(t,e){r[t]=e.val(n),i++,s&&zc.INTEGER_REGEXP_.test(t)?o=Math.max(o,Number(t)):s=!1}),!n&&s&&o<2*i){var t=[];for(var e in r)t[e]=r[e];return t}return n&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r},zc.prototype.hash=function(){if(null===this.lazyHash_){var r="";this.getPriority().isEmpty()||(r+="priority:"+yc(this.getPriority().val())+":"),this.forEachChild(Sc,function(t,e){var n=e.hash();""!==n&&(r+=":"+t+":"+n)}),this.lazyHash_=""===r?"":Ja(r)}return this.lazyHash_},zc.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new sc(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},zc.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},zc.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new sc(e,this.children_.get(e)):null},zc.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},zc.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new sc(e,this.children_.get(e)):null},zc.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},zc.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},zc.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,sc.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},zc.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},zc.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,sc.Wrap),i=r.peek();null!=i&&0<e.compare(i,t);)r.getNext(),i=r.peek();return r},zc.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Yc?-1:0},zc.prototype.withIndex=function(t){if(t===vc||this.indexMap_.hasIndex(t))return this;var e=this.indexMap_.addIndex(t,this.children_);return new zc(this.children_,this.priorityNode_,e)},zc.prototype.isIndexed=function(t){return t===vc||this.indexMap_.hasIndex(t)},zc.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()!==e.children_.count())return!1;for(var n=this.getIterator(Sc),r=e.getIterator(Sc),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1},zc.prototype.resolveIndex_=function(t){return t===vc?null:this.indexMap_.get(t.toString())},zc.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,zc);function zc(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&gc(this.priorityNode_),this.children_.isEmpty()&&Ps(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}function Qc(){return Gc.call(this,new Pc(Hc),Kc.EMPTY_NODE,Vc.Default)||this}var Yc=new(_s(Qc,Gc=Kc),Qc.prototype.compareTo=function(t){return t===this?0:1},Qc.prototype.equals=function(t){return t===this},Qc.prototype.getPriority=function(){return this},Qc.prototype.getImmediateChild=function(t){return Kc.EMPTY_NODE},Qc.prototype.isEmpty=function(){return!1},Qc);Object.defineProperties(sc,{MIN:{value:new sc(yu,Kc.EMPTY_NODE)},MAX:{value:new sc(gu,Yc)}}),fc.__EMPTY_NODE=Kc.EMPTY_NODE,Ec.__childrenNodeConstructor=Kc,dc=Yc,bc=Yc;var Xc,Jc=!0;function $c(r,t){if(void 0===t&&(t=null),null===r)return Kc.EMPTY_NODE;if("object"==typeof r&&".priority"in r&&(t=r[".priority"]),Ps(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof r&&".value"in r&&null!==r[".value"]&&(r=r[".value"]),"object"!=typeof r||".sv"in r)return new Ec(r,$c(t));if(r instanceof Array||!Jc){var i=Kc.EMPTY_NODE;return bu(r,function(t,e){if($s(r,t)&&"."!==t.substring(0,1)){var n=$c(e);!n.isLeafNode()&&n.isEmpty()||(i=i.updateImmediateChild(t,n))}}),i.updatePriority($c(t))}var o=[],s=!1;if(bu(r,function(t,e){if("."!==t.substring(0,1)){var n=$c(e);n.isEmpty()||(s=s||!n.getPriority().isEmpty(),o.push(new sc(t,n)))}}),0===o.length)return Kc.EMPTY_NODE;var e=jc(o,Wc,function(t){return t.name},Hc);if(s){var n=jc(o,Sc.getCompare());return new Kc(e,$c(t),new Vc({".priority":n},{".priority":Sc}))}return new Kc(e,$c(t),Vc.Default)}function Zc(){return null!==Xc&&Xc.apply(this,arguments)||this}wc=$c;var th,eh=new(_s(Zc,Xc=cc),Zc.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?mu(t.name,e.name):n},Zc.prototype.isDefinedOn=function(t){return!0},Zc.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},Zc.prototype.minPost=function(){return sc.MIN},Zc.prototype.maxPost=function(){return sc.MAX},Zc.prototype.makePost=function(t,e){var n=$c(t);return new sc(e,n)},Zc.prototype.toString=function(){return".value"},Zc),nh=(_s(rh,th=cc),rh.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},rh.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},rh.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?mu(t.name,e.name):i},rh.prototype.makePost=function(t,e){var n=$c(t),r=Kc.EMPTY_NODE.updateChild(this.indexPath_,n);return new sc(e,r)},rh.prototype.maxPost=function(){var t=Kc.EMPTY_NODE.updateChild(this.indexPath_,Yc);return new sc(gu,t)},rh.prototype.toString=function(){return this.indexPath_.slice().join("/")},rh);function rh(t){var e=th.call(this)||this;return e.indexPath_=t,Ps(!t.isEmpty()&&".priority"!==t.getFront(),"Can't create PathIndex with empty path or .priority key"),e}var ih=(oh.prototype.val=function(){return ua("DataSnapshot.val",0,0,arguments.length),this.node_.val()},oh.prototype.exportVal=function(){return ua("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},oh.prototype.toJSON=function(){return ua("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},oh.prototype.exists=function(){return ua("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},oh.prototype.child=function(t){ua("DataSnapshot.child",0,1,arguments.length),t=String(t),Hu("DataSnapshot.child",1,t,!1);var e=new Cu(t),n=this.ref_.child(e);return new oh(this.node_.getChild(e),n,Sc)},oh.prototype.hasChild=function(t){ua("DataSnapshot.hasChild",1,1,arguments.length),Hu("DataSnapshot.hasChild",1,t,!1);var e=new Cu(t);return!this.node_.getChild(e).isEmpty()},oh.prototype.getPriority=function(){return ua("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},oh.prototype.forEach=function(n){var r=this;return ua("DataSnapshot.forEach",1,1,arguments.length),ha("DataSnapshot.forEach",1,n,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(t,e){return n(new oh(e,r.ref_.child(t),Sc))})},oh.prototype.hasChildren=function(){return ua("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(oh.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),oh.prototype.numChildren=function(){return ua("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},oh.prototype.getRef=function(){return ua("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(oh.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),oh);function oh(t,e,n){this.node_=t,this.ref_=e,this.index_=n}var sh=(ah.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},ah.prototype.getEventType=function(){return this.eventType},ah.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},ah.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Xs(this.snapshot.exportVal())},ah);function ah(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}var uh=(ch.prototype.getPath=function(){return this.path},ch.prototype.getEventType=function(){return"cancel"},ch.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},ch.prototype.toString=function(){return this.path.toString()+":cancel"},ch);function ch(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}var hh=(lh.prototype.respondsTo=function(t){return"value"===t},lh.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new sh("value",this,new ih(t.snapshotNode,e.getRef(),n))},lh.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Ps(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},lh.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new uh(this,t,e):null},lh.prototype.matches=function(t){return t instanceof lh&&(!t.callback_||!this.callback_||t.callback_===this.callback_&&t.context_===this.context_)},lh.prototype.hasAnyCallback=function(){return null!==this.callback_},lh);function lh(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}var fh,ph=(dh.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,$s(this.callbacks_,e)},dh.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new uh(this,t,e):null},dh.prototype.createEvent=function(t,e){Ps(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new sh(t.type,this,new ih(t.snapshotNode,n,r),t.prevName)},dh.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){Ps(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},dh.prototype.matches=function(e){var n=this;if(e instanceof dh){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var t=Object.keys(e.callbacks_),r=Object.keys(this.callbacks_),i=t.length;if(i===r.length){if(1!==i)return r.every(function(t){return e.callbacks_[t]===n.callbacks_[t]});var o=t[0],s=r[0];return!(s!==o||e.callbacks_[o]&&this.callbacks_[s]&&e.callbacks_[o]!==this.callbacks_[s])}}}return!1},dh.prototype.hasAnyCallback=function(){return null!==this.callbacks_},dh);function dh(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}var vh=(Object.defineProperty(yh,"__referenceConstructor",{get:function(){return Ps(fh,"Reference.ts has not been loaded"),fh},set:function(t){fh=t},enumerable:!0,configurable:!0}),yh.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===vc){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!==yu)throw new Error(r);if("string"!=typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!==gu)throw new Error(r);if("string"!=typeof n)throw new Error(i)}}else if(t.getIndex()===Sc){if(null!=e&&!Fu(e)||null!=n&&!Fu(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Ps(t.getIndex()instanceof nh||t.getIndex()===eh,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},yh.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},yh.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},yh.prototype.getQueryParams=function(){return this.queryParams_},yh.prototype.getRef=function(){return ua("Query.ref",0,0,arguments.length),new yh.__referenceConstructor(this.repo,this.path)},yh.prototype.on=function(t,e,n,r){ua("Query.on",2,4,arguments.length),Bu("Query.on",1,t,!1),ha("Query.on",2,e,!1);var i=yh.getCancelAndContextArgs_("Query.on",n,r);if("value"===t)this.onValueEvent(e,i.cancel,i.context);else{var o={};o[t]=e,this.onChildEvent(o,i.cancel,i.context)}return e},yh.prototype.onValueEvent=function(t,e,n){var r=new hh(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},yh.prototype.onChildEvent=function(t,e,n){var r=new ph(t,e,n);this.repo.addEventCallbackForQuery(this,r)},yh.prototype.off=function(t,e,n){ua("Query.off",0,3,arguments.length),Bu("Query.off",1,t,!0),ha("Query.off",2,e,!0),la("Query.off",3,n,!0);var r=null,i=null;"value"===t?r=new hh(e||null,null,n||null):t&&(e&&((i={})[t]=e),r=new ph(i,null,n||null)),this.repo.removeEventCallbackForQuery(this,r)},yh.prototype.once=function(e,n,t,r){var i=this;ua("Query.once",1,4,arguments.length),Bu("Query.once",1,e,!1),ha("Query.once",2,n,!0);var o=yh.getCancelAndContextArgs_("Query.once",t,r),s=!0,a=new Us;a.promise.catch(function(){});var u=function(t){s&&(s=!1,i.off(e,u),n&&n.bind(o.context)(t),a.resolve(t))};return this.on(e,u,function(t){i.off(e,u),o.cancel&&o.cancel.bind(o.context)(t),a.reject(t)}),a.promise},yh.prototype.limitToFirst=function(t){if(ua("Query.limitToFirst",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new yh(this.repo,this.path,this.queryParams_.limitToFirst(t),this.orderByCalled_)},yh.prototype.limitToLast=function(t){if(ua("Query.limitToLast",1,1,arguments.length),"number"!=typeof t||Math.floor(t)!==t||t<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new yh(this.repo,this.path,this.queryParams_.limitToLast(t),this.orderByCalled_)},yh.prototype.orderByChild=function(t){if(ua("Query.orderByChild",1,1,arguments.length),"$key"===t)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===t)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===t)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');Hu("Query.orderByChild",1,t,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var e=new Cu(t);if(e.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var n=new nh(e),r=this.queryParams_.orderBy(n);return yh.validateQueryEndpoints_(r),new yh(this.repo,this.path,r,!0)},yh.prototype.orderByKey=function(){ua("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var t=this.queryParams_.orderBy(vc);return yh.validateQueryEndpoints_(t),new yh(this.repo,this.path,t,!0)},yh.prototype.orderByPriority=function(){ua("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var t=this.queryParams_.orderBy(Sc);return yh.validateQueryEndpoints_(t),new yh(this.repo,this.path,t,!0)},yh.prototype.orderByValue=function(){ua("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var t=this.queryParams_.orderBy(eh);return yh.validateQueryEndpoints_(t),new yh(this.repo,this.path,t,!0)},yh.prototype.startAt=function(t,e){void 0===t&&(t=null),ua("Query.startAt",0,2,arguments.length),ju("Query.startAt",1,t,this.path,!0),Wu("Query.startAt",2,e,!0);var n=this.queryParams_.startAt(t,e);if(yh.validateLimit_(n),yh.validateQueryEndpoints_(n),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===t&&(e=t=null),new yh(this.repo,this.path,n,this.orderByCalled_)},yh.prototype.endAt=function(t,e){void 0===t&&(t=null),ua("Query.endAt",0,2,arguments.length),ju("Query.endAt",1,t,this.path,!0),Wu("Query.endAt",2,e,!0);var n=this.queryParams_.endAt(t,e);if(yh.validateLimit_(n),yh.validateQueryEndpoints_(n),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new yh(this.repo,this.path,n,this.orderByCalled_)},yh.prototype.equalTo=function(t,e){if(ua("Query.equalTo",1,2,arguments.length),ju("Query.equalTo",1,t,this.path,!1),Wu("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},yh.prototype.toString=function(){return ua("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},yh.prototype.toJSON=function(){return ua("Query.toJSON",0,1,arguments.length),this.toString()},yh.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},yh.prototype.queryIdentifier=function(){var t=this.queryObject(),e=wu(t);return"{}"===e?"default":e},yh.prototype.isEqual=function(t){if(ua("Query.isEqual",1,1,arguments.length),!(t instanceof yh))throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");var e=this.repo===t.repo,n=this.path.equals(t.path),r=this.queryIdentifier()===t.queryIdentifier();return e&&n&&r},yh.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,ha(t,3,r.cancel,!0),r.context=n,la(t,4,r.context,!0);else if(e)if("object"==typeof e&&null!==e)r.context=e;else{if("function"!=typeof e)throw new Error(ca(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(yh.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),yh);function yh(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}var gh=(mh.prototype.find=function(t){if(null!=this.value)return this.value.getChild(t);if(!t.isEmpty()&&0<this.children.size){var e=t.getFront();return t=t.popFront(),this.children.has(e)?this.children.get(e).find(t):null}return null},mh.prototype.remember=function(t,e){if(t.isEmpty())this.value=e,this.children.clear();else if(null!==this.value)this.value=this.value.updateChild(t,e);else{var n=t.getFront();this.children.has(n)||this.children.set(n,new mh);var r=this.children.get(n);t=t.popFront(),r.remember(t,e)}},mh.prototype.forget=function(t){if(t.isEmpty())return this.value=null,this.children.clear(),!0;if(null!==this.value){if(this.value.isLeafNode())return!1;var e=this.value;this.value=null;var n=this;return e.forEachChild(Sc,function(t,e){n.remember(new Cu(t),e)}),this.forget(t)}if(0<this.children.size){var r=t.getFront();return t=t.popFront(),!this.children.has(r)||this.children.get(r).forget(t)&&this.children.delete(r),0===this.children.size}return!0},mh.prototype.forEachTree=function(r,i){null!==this.value?i(r,this.value):this.forEachChild(function(t,e){var n=new Cu(r.toString()+"/"+t);e.forEachTree(n,i)})},mh.prototype.forEachChild=function(n){this.children.forEach(function(t,e){n(e,t)})},mh);function mh(){this.value=null,this.children=new Map}function wh(t,e){return t&&"object"==typeof t?(Ps(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t}var bh,_h,Eh=function(t,r){var i,e=t.getPriority().val(),n=wh(e,r);if(t.isLeafNode()){var o=t,s=wh(o.getValue(),r);return s!==o.getValue()||n!==o.getPriority().val()?new Ec(s,$c(n)):t}var a=t;return n!==(i=a).getPriority().val()&&(i=i.updatePriority(new Ec(n))),a.forEachChild(Sc,function(t,e){var n=Eh(e,r);n!==e&&(i=i.updateImmediateChild(t,n))}),i};(_h=bh=bh||{})[_h.OVERWRITE=0]="OVERWRITE",_h[_h.MERGE=1]="MERGE",_h[_h.ACK_USER_WRITE=2]="ACK_USER_WRITE",_h[_h.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";var Ih=(Th.User=new Th(!0,!1,null,!1),Th.Server=new Th(!1,!0,null,!1),Th.forServerTaggedQuery=function(t){return new Th(!1,!0,t,!0)},Th);function Th(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,Ps(!r||e,"Tagged queries must be from server.")}var Sh,Ch=(Nh.prototype.operationForChild=function(t){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return Ps(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var e=this.affectedTree.subtree(new Cu(t));return new Nh(Cu.Empty,e,this.revert)}return Ps(this.path.getFront()===t,"operationForChild called for unrelated child."),new Nh(this.path.popFront(),this.affectedTree,this.revert)},Nh);function Nh(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=bh.ACK_USER_WRITE,this.source=Ih.User}var Ah=(kh.fromObject=function(t){var n=kh.Empty;return bu(t,function(t,e){n=n.set(new Cu(t),e)}),n},kh.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},kh.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:Cu.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null===r)return null;var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);return null==i?null:{path:new Cu(n).child(i.path),value:i.value}},kh.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},kh.prototype.subtree=function(t){if(t.isEmpty())return this;var e=t.getFront(),n=this.children.get(e);return null!==n?n.subtree(t.popFront()):kh.Empty},kh.prototype.set=function(t,e){if(t.isEmpty())return new kh(e,this.children);var n=t.getFront(),r=(this.children.get(n)||kh.Empty).set(t.popFront(),e),i=this.children.insert(n,r);return new kh(this.value,i)},kh.prototype.remove=function(t){if(t.isEmpty())return this.children.isEmpty()?kh.Empty:new kh(null,this.children);var e=t.getFront(),n=this.children.get(e);if(n){var r=n.remove(t.popFront()),i=void 0;return i=r.isEmpty()?this.children.remove(e):this.children.insert(e,r),null===this.value&&i.isEmpty()?kh.Empty:new kh(this.value,i)}return this},kh.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},kh.prototype.setTree=function(t,e){if(t.isEmpty())return e;var n=t.getFront(),r=(this.children.get(n)||kh.Empty).setTree(t.popFront(),e),i=void 0;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),new kh(this.value,i)},kh.prototype.fold=function(t){return this.fold_(Cu.Empty,t)},kh.prototype.fold_=function(n,r){var i={};return this.children.inorderTraversal(function(t,e){i[t]=e.fold_(n.child(t),r)}),r(n,this.value,i)},kh.prototype.findOnPath=function(t,e){return this.findOnPath_(t,Cu.Empty,e)},kh.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},kh.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,Cu.Empty,e)},kh.prototype.foreachOnPath_=function(t,e,n){if(t.isEmpty())return this;this.value&&n(e,this.value);var r=t.getFront(),i=this.children.get(r);return i?i.foreachOnPath_(t.popFront(),e.child(r),n):kh.Empty},kh.prototype.foreach=function(t){this.foreach_(Cu.Empty,t)},kh.prototype.foreach_=function(n,r){this.children.inorderTraversal(function(t,e){e.foreach_(n.child(t),r)}),this.value&&r(n,this.value)},kh.prototype.foreachChild=function(n){this.children.inorderTraversal(function(t,e){e.value&&n(t,e.value)})},kh.Empty=new kh(null),kh);function kh(t,e){void 0===e&&(e=Sh=Sh||new Pc(ou)),this.value=t,this.children=e}var Rh=(Oh.prototype.operationForChild=function(t){return this.path.isEmpty()?new Oh(this.source,Cu.Empty):new Oh(this.source,this.path.popFront())},Oh);function Oh(t,e){this.source=t,this.path=e,this.type=bh.LISTEN_COMPLETE}var Ph=(Dh.prototype.operationForChild=function(t){return this.path.isEmpty()?new Dh(this.source,Cu.Empty,this.snap.getImmediateChild(t)):new Dh(this.source,this.path.popFront(),this.snap)},Dh);function Dh(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=bh.OVERWRITE}var xh=(Lh.prototype.operationForChild=function(t){if(this.path.isEmpty()){var e=this.children.subtree(new Cu(t));return e.isEmpty()?null:e.value?new Ph(this.source,Cu.Empty,e.value):new Lh(this.source,Cu.Empty,e)}return Ps(this.path.getFront()===t,"Can't get a merge for a child not on the path of the operation"),new Lh(this.source,this.path.popFront(),this.children)},Lh.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},Lh);function Lh(t,e,n){this.source=t,this.path=e,this.children=n,this.type=bh.MERGE}var Mh=(Uh.prototype.isFullyInitialized=function(){return this.fullyInitialized_},Uh.prototype.isFiltered=function(){return this.filtered_},Uh.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},Uh.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},Uh.prototype.getNode=function(){return this.node_},Uh);function Uh(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}var Fh=(jh.prototype.updateEventSnap=function(t,e,n){return new jh(new Mh(t,e,n),this.serverCache_)},jh.prototype.updateServerSnap=function(t,e,n){return new jh(this.eventCache_,new Mh(t,e,n))},jh.prototype.getEventCache=function(){return this.eventCache_},jh.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},jh.prototype.getServerCache=function(){return this.serverCache_},jh.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},jh.Empty=new jh(new Mh(Kc.EMPTY_NODE,!1,!1),new Mh(Kc.EMPTY_NODE,!1,!1)),jh);function jh(t,e){this.eventCache_=t,this.serverCache_=e}var qh=(Vh.valueChange=function(t){return new Vh(Vh.VALUE,t)},Vh.childAddedChange=function(t,e){return new Vh(Vh.CHILD_ADDED,e,t)},Vh.childRemovedChange=function(t,e){return new Vh(Vh.CHILD_REMOVED,e,t)},Vh.childChangedChange=function(t,e,n){return new Vh(Vh.CHILD_CHANGED,e,t,n)},Vh.childMovedChange=function(t,e){return new Vh(Vh.CHILD_MOVED,e,t)},Vh.CHILD_ADDED="child_added",Vh.CHILD_REMOVED="child_removed",Vh.CHILD_CHANGED="child_changed",Vh.CHILD_MOVED="child_moved",Vh.VALUE="value",Vh);function Vh(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}var Bh=(Wh.prototype.updateChild=function(t,e,n,r,i,o){Ps(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=t.getImmediateChild(e);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(qh.childRemovedChange(e,s)):Ps(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?o.trackChildChange(qh.childAddedChange(e,n)):o.trackChildChange(qh.childChangedChange(e,n,s))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},Wh.prototype.updateFullNode=function(r,n,i){return null!=i&&(r.isLeafNode()||r.forEachChild(Sc,function(t,e){n.hasChild(t)||i.trackChildChange(qh.childRemovedChange(t,e))}),n.isLeafNode()||n.forEachChild(Sc,function(t,e){if(r.hasChild(t)){var n=r.getImmediateChild(t);n.equals(e)||i.trackChildChange(qh.childChangedChange(t,e,n))}else i.trackChildChange(qh.childAddedChange(t,e))})),n.withIndex(this.index_)},Wh.prototype.updatePriority=function(t,e){return t.isEmpty()?Kc.EMPTY_NODE:t.updatePriority(e)},Wh.prototype.filtersNodes=function(){return!1},Wh.prototype.getIndexedFilter=function(){return this},Wh.prototype.getIndex=function(){return this.index_},Wh);function Wh(t){this.index_=t}var Hh=(Gh.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;Ps(e===qh.CHILD_ADDED||e===qh.CHILD_CHANGED||e===qh.CHILD_REMOVED,"Only child changes supported for tracking"),Ps(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if(e===qh.CHILD_ADDED&&i===qh.CHILD_REMOVED)this.changeMap.set(n,qh.childChangedChange(n,t.snapshotNode,r.snapshotNode));else if(e===qh.CHILD_REMOVED&&i===qh.CHILD_ADDED)this.changeMap.delete(n);else if(e===qh.CHILD_REMOVED&&i===qh.CHILD_CHANGED)this.changeMap.set(n,qh.childRemovedChange(n,r.oldSnap));else if(e===qh.CHILD_CHANGED&&i===qh.CHILD_ADDED)this.changeMap.set(n,qh.childAddedChange(n,t.snapshotNode));else{if(e!==qh.CHILD_CHANGED||i!==qh.CHILD_CHANGED)throw Ds("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap.set(n,qh.childChangedChange(n,t.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,t)},Gh.prototype.getChanges=function(){return Array.from(this.changeMap.values())},Gh);function Gh(){this.changeMap=new Map}function Kh(){}var zh=new(Kh.prototype.getCompleteChild=function(t){return null},Kh.prototype.getChildAfterChild=function(t,e,n){return null},Kh),Qh=(Yh.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Mh(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},Yh.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},Yh);function Yh(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}var Xh=function(t,e){this.viewCache=t,this.changes=e},Jh=($h.prototype.assertIndexed=function(t){Ps(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),Ps(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},$h.prototype.applyOperation=function(t,e,n,r){var i,o,s=new Hh;if(e.type===bh.OVERWRITE){var a=e;i=a.source.fromUser?this.applyUserOverwrite_(t,a.path,a.snap,n,r,s):(Ps(a.source.fromServer,"Unknown source."),o=a.source.tagged||t.getServerCache().isFiltered()&&!a.path.isEmpty(),this.applyServerOverwrite_(t,a.path,a.snap,n,r,o,s))}else if(e.type===bh.MERGE){var u=e;i=u.source.fromUser?this.applyUserMerge_(t,u.path,u.children,n,r,s):(Ps(u.source.fromServer,"Unknown source."),o=u.source.tagged||t.getServerCache().isFiltered(),this.applyServerMerge_(t,u.path,u.children,n,r,o,s))}else if(e.type===bh.ACK_USER_WRITE){var c=e;i=c.revert?this.revertUserWrite_(t,c.path,n,r,s):this.ackUserWrite_(t,c.path,c.affectedTree,n,r,s)}else{if(e.type!==bh.LISTEN_COMPLETE)throw Ds("Unknown operation type: "+e.type);i=this.listenComplete_(t,e.path,n,s)}var h=s.getChanges();return $h.maybeAddValueEvent_(t,i,h),new Xh(i,h)},$h.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(0<n.length||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(qh.valueChange(e.getCompleteEventSnap()))}},$h.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var s=void 0,a=void 0;if(e.isEmpty())if(Ps(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof Kc?u:Kc.EMPTY_NODE,h=n.calcCompleteEventChildren(c);s=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var l=n.calcCompleteEventCache(t.getCompleteServerSnap());s=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var f=e.getFront();if(".priority"===f){Ps(1===e.getLength(),"Can't have a priority with additional path components");var p=o.getNode();a=t.getServerCache().getNode();var d=n.calcEventCacheAfterServerOverwrite(e,p,a);s=null!=d?this.filter_.updatePriority(p,d):o.getNode()}else{var v=e.popFront(),y=void 0;if(o.isCompleteForChild(f)){a=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),a);y=null!=g?o.getNode().getImmediateChild(f).updateChild(v,g):o.getNode().getImmediateChild(f)}else y=n.calcCompleteChild(f,t.getServerCache());s=null!=y?this.filter_.updateChild(o.getNode(),f,y,v,r,i):o.getNode()}}return t.updateEventSnap(s,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},$h.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,s){var a,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())a=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var h=u.getNode().updateChild(e,n);a=c.updateFullNode(u.getNode(),h,null)}else{var l=e.getFront();if(!u.isCompleteForPath(e)&&1<e.getLength())return t;var f=e.popFront(),p=u.getNode().getImmediateChild(l).updateChild(f,n);a=".priority"===l?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),l,p,f,zh,null)}var d=t.updateServerSnap(a,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),v=new Qh(r,d,i);return this.generateEventCacheAfterServerEvent_(d,e,r,v,s)},$h.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var s,a,u=t.getEventCache(),c=new Qh(r,t,i);if(e.isEmpty())a=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),s=t.updateEventSnap(a,!0,this.filter_.filtersNodes());else{var h=e.getFront();if(".priority"===h)a=this.filter_.updatePriority(t.getEventCache().getNode(),n),s=t.updateEventSnap(a,u.isFullyInitialized(),u.isFiltered());else{var l=e.popFront(),f=u.getNode().getImmediateChild(h),p=void 0;if(l.isEmpty())p=n;else{var d=c.getCompleteChild(h);p=null!=d?".priority"===l.getBack()&&d.getChild(l.parent()).isEmpty()?d:d.updateChild(l,n):Kc.EMPTY_NODE}if(f.equals(p))s=t;else{var v=this.filter_.updateChild(u.getNode(),h,p,l,c,o);s=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return s},$h.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},$h.prototype.applyUserMerge_=function(r,i,t,o,s,a){var u=this,c=r;return t.foreach(function(t,e){var n=i.child(t);$h.cacheHasChild_(r,n.getFront())&&(c=u.applyUserOverwrite_(c,n,e,o,s,a))}),t.foreach(function(t,e){var n=i.child(t);$h.cacheHasChild_(r,n.getFront())||(c=u.applyUserOverwrite_(c,n,e,o,s,a))}),c},$h.prototype.applyMerge_=function(n,t){return t.foreach(function(t,e){n=n.updateChild(t,e)}),n},$h.prototype.applyServerMerge_=function(o,t,e,s,a,u,c){var h=this;if(o.getServerCache().getNode().isEmpty()&&!o.getServerCache().isFullyInitialized())return o;var n,l=o;n=t.isEmpty()?e:Ah.Empty.setTree(t,e);var f=o.getServerCache().getNode();return n.children.inorderTraversal(function(t,e){if(f.hasChild(t)){var n=o.getServerCache().getNode().getImmediateChild(t),r=h.applyMerge_(n,e);l=h.applyServerOverwrite_(l,new Cu(t),r,s,a,u,c)}}),n.children.inorderTraversal(function(t,e){var n=!o.getServerCache().isCompleteForChild(t)&&null==e.value;if(!f.hasChild(t)&&!n){var r=o.getServerCache().getNode().getImmediateChild(t),i=h.applyMerge_(r,e);l=h.applyServerOverwrite_(l,new Cu(t),i,s,a,u,c)}}),l},$h.prototype.ackUserWrite_=function(t,r,e,n,i,o){if(null!=n.shadowingWrite(r))return t;var s=t.getServerCache().isFiltered(),a=t.getServerCache();if(null!=e.value){if(r.isEmpty()&&a.isFullyInitialized()||a.isCompleteForPath(r))return this.applyServerOverwrite_(t,r,a.getNode().getChild(r),n,i,s,o);if(r.isEmpty()){var u=Ah.Empty;return a.getNode().forEachChild(vc,function(t,e){u=u.set(new Cu(t),e)}),this.applyServerMerge_(t,r,u,n,i,s,o)}return t}var c=Ah.Empty;return e.foreach(function(t,e){var n=r.child(t);a.isCompleteForPath(n)&&(c=c.set(t,a.getNode().getChild(n)))}),this.applyServerMerge_(t,r,c,n,i,s,o)},$h.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,zh,r)},$h.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var s=new Qh(n,t,r),a=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var h=t.getServerCache().getNode();Ps(h instanceof Kc,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(h)}c=c,u=this.filter_.updateFullNode(a,c,i)}else{var l=e.getFront(),f=n.calcCompleteChild(l,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(l)&&(f=a.getImmediateChild(l)),(u=null!=f?this.filter_.updateChild(a,l,f,e.popFront(),s,i):t.getEventCache().getNode().hasChild(l)?this.filter_.updateChild(a,l,Kc.EMPTY_NODE,e.popFront(),s,i):a).isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap())).isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(Cu.Empty),t.updateEventSnap(u,o,this.filter_.filtersNodes())},$h);function $h(t){this.filter_=t}var Zh=(tl.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===qh.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(qh.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,qh.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,qh.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,qh.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,qh.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,qh.VALUE,t,n,e),i},tl.prototype.generateEventsForType_=function(r,e,t,i,o){var s=this,n=t.filter(function(t){return t.type===e});n.sort(this.compareChanges_.bind(this)),n.forEach(function(e){var n=s.materializeSingleChange_(e,o);i.forEach(function(t){t.respondsTo(e.type)&&r.push(t.createEvent(n,s.query_))})})},tl.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type||(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_)),t},tl.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw Ds("Should only compare child_ events.");var n=new sc(t.childName,t.snapshotNode),r=new sc(e.childName,e.snapshotNode);return this.index_.compare(n,r)},tl);function tl(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}var el,nl=(rl.prototype.getQuery=function(){return this.query_},rl.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},rl.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},rl.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},rl.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},rl.prototype.removeEventRegistration=function(t,n){var r=[];if(n){Ps(null==t,"A cancel should cancel all event registrations.");var i=this.query_.path;this.eventRegistrations_.forEach(function(t){n=n;var e=t.createCancelEvent(n,i);e&&r.push(e)})}if(t){for(var e=[],o=0;o<this.eventRegistrations_.length;++o){var s=this.eventRegistrations_[o];if(s.matches(t)){if(t.hasAnyCallback()){e=e.concat(this.eventRegistrations_.slice(o+1));break}}else e.push(s)}this.eventRegistrations_=e}else this.eventRegistrations_=[];return r},rl.prototype.applyOperation=function(t,e,n){t.type===bh.MERGE&&null!==t.source.queryId&&(Ps(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),Ps(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),Ps(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},rl.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];return e.getNode().isLeafNode()||e.getNode().forEachChild(Sc,function(t,e){n.push(qh.childAddedChange(t,e))}),e.isFullyInitialized()&&n.push(qh.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},rl.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},rl);function rl(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Bh(n.getIndex()),i=n.getNodeFilter();this.processor_=new Jh(i);var o=e.getServerCache(),s=e.getEventCache(),a=r.updateFullNode(Kc.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Kc.EMPTY_NODE,s.getNode(),null),c=new Mh(a,o.isFullyInitialized(),r.filtersNodes()),h=new Mh(u,s.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Fh(h,c),this.eventGenerator_=new Zh(this.query_)}var il=(Object.defineProperty(ol,"__referenceConstructor",{get:function(){return Ps(el,"Reference.ts has not been loaded"),el},set:function(t){Ps(!el,"__referenceConstructor has already been defined"),el=t},enumerable:!0,configurable:!0}),ol.prototype.isEmpty=function(){return 0===this.views.size},ol.prototype.applyOperation=function(t,e,n){var r,i,o=t.source.queryId;if(null!==o){var s=this.views.get(o);return Ps(null!=s,"SyncTree gave us an op for an invalid query."),s.applyOperation(t,e,n)}var a=[];try{for(var u=Ss(this.views.values()),c=u.next();!c.done;c=u.next())s=c.value,a=a.concat(s.applyOperation(t,e,n))}catch(t){r={error:t}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return a},ol.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),s=this.views.get(o);if(!s){var a=n.calcCompleteEventCache(i?r:null),u=!1;u=!!a||(a=r instanceof Kc?n.calcCompleteEventChildren(r):Kc.EMPTY_NODE,!1);var c=new Fh(new Mh(a,u,!1),new Mh(r,i,!1));s=new nl(t,c),this.views.set(o,s)}return s.addEventRegistration(e),s.getInitialEvents(e)},ol.prototype.removeEventRegistration=function(t,e,n){var r,i,o=t.queryIdentifier(),s=[],a=[],u=this.hasCompleteView();if("default"===o)try{for(var c=Ss(this.views.entries()),h=c.next();!h.done;h=c.next()){var l=Cs(h.value,2),f=l[0],p=l[1];a=a.concat(p.removeEventRegistration(e,n)),p.isEmpty()&&(this.views.delete(f),p.getQuery().getQueryParams().loadsAllData()||s.push(p.getQuery()))}}catch(t){r={error:t}}finally{try{h&&!h.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}else(p=this.views.get(o))&&(a=a.concat(p.removeEventRegistration(e,n)),p.isEmpty()&&(this.views.delete(o),p.getQuery().getQueryParams().loadsAllData()||s.push(p.getQuery())));return u&&!this.hasCompleteView()&&s.push(new ol.__referenceConstructor(t.repo,t.path)),{removed:s,events:a}},ol.prototype.getQueryViews=function(){var e,t,n=[];try{for(var r=Ss(this.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;o.getQuery().getQueryParams().loadsAllData()||n.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},ol.prototype.getCompleteServerCache=function(t){var e,n,r=null;try{for(var i=Ss(this.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r||s.getCompleteServerCache(t)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r},ol.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return this.views.get(e)},ol.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},ol.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},ol.prototype.getCompleteView=function(){var e,t;try{for(var n=Ss(this.views.values()),r=n.next();!r.done;r=n.next()){var i=r.value;if(i.getQuery().getQueryParams().loadsAllData())return i}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}return null},ol);function ol(){this.views=new Map}var sl=(al.prototype.addWrite=function(t,e){if(t.isEmpty())return new al(new Ah(e));var n=this.writeTree_.findRootMostValueAndPath(t);if(null!=n){var r=n.path,i=n.value,o=Cu.relativePath(r,t);return i=i.updateChild(o,e),new al(this.writeTree_.set(r,i))}var s=new Ah(e);return new al(this.writeTree_.setTree(t,s))},al.prototype.addWrites=function(n,t){var r=this;return bu(t,function(t,e){r=r.addWrite(n.child(t),e)}),r},al.prototype.removeWrite=function(t){return t.isEmpty()?al.Empty:new al(this.writeTree_.setTree(t,Ah.Empty))},al.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},al.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(Cu.relativePath(e.path,t)):null},al.prototype.getCompleteChildren=function(){var n=[],t=this.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Sc,function(t,e){n.push(new sc(t,e))}):this.writeTree_.children.inorderTraversal(function(t,e){null!=e.value&&n.push(new sc(t,e.value))}),n},al.prototype.childCompoundWrite=function(t){if(t.isEmpty())return this;var e=this.getCompleteNode(t);return new al(null!=e?new Ah(e):this.writeTree_.subtree(t))},al.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},al.prototype.apply=function(t){return function n(r,t,i){if(null!=t.value)return i.updateChild(r,t.value);var o=null;return t.children.inorderTraversal(function(t,e){".priority"===t?(Ps(null!==e.value,"Priority writes must always be leaf nodes"),o=e.value):i=n(r.child(t),e,i)}),i.getChild(r).isEmpty()||null===o||(i=i.updateChild(r.child(".priority"),o)),i}(Cu.Empty,this.writeTree_,t)},al.Empty=new al(new Ah(null)),al);function al(t){this.writeTree_=t}var ul=(cl.prototype.childWrites=function(t){return new hl(t,this)},cl.prototype.addOverwrite=function(t,e,n,r){Ps(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},cl.prototype.addMerge=function(t,e,n){Ps(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},cl.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},cl.prototype.removeWrite=function(e){var n=this,t=this.allWrites_.findIndex(function(t){return t.writeId===e});Ps(0<=t,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[t];this.allWrites_.splice(t,1);for(var i=r.visible,o=!1,s=this.allWrites_.length-1;i&&0<=s;){var a=this.allWrites_[s];a.visible&&(t<=s&&this.recordContainsPath_(a,r.path)?i=!1:r.path.contains(a.path)&&(o=!0)),s--}return!!i&&(o?this.resetTree_():r.snap?this.visibleWrites_=this.visibleWrites_.removeWrite(r.path):bu(r.children,function(t){n.visibleWrites_=n.visibleWrites_.removeWrite(r.path.child(t))}),!0)},cl.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},cl.prototype.calcCompleteEventCache=function(e,t,n,r){if(n||r){var i=this.visibleWrites_.childCompoundWrite(e);if(!r&&i.isEmpty())return t;if(r||null!=t||i.hasCompleteWrite(Cu.Empty)){var o=cl.layerTree_(this.allWrites_,function(t){return(t.visible||r)&&(!n||!~n.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},e);return u=t||Kc.EMPTY_NODE,o.apply(u)}return null}var s=this.visibleWrites_.getCompleteNode(e);if(null!=s)return s;var a=this.visibleWrites_.childCompoundWrite(e);if(a.isEmpty())return t;if(null!=t||a.hasCompleteWrite(Cu.Empty)){var u=t||Kc.EMPTY_NODE;return a.apply(u)}return null},cl.prototype.calcCompleteEventChildren=function(t,e){var r=Kc.EMPTY_NODE,n=this.visibleWrites_.getCompleteNode(t);if(n)return n.isLeafNode()||n.forEachChild(Sc,function(t,e){r=r.updateImmediateChild(t,e)}),r;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Sc,function(t,e){var n=i.childCompoundWrite(new Cu(t)).apply(e);r=r.updateImmediateChild(t,n)}),i.getCompleteChildren().forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){r=r.updateImmediateChild(t.name,t.node)}),r},cl.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){Ps(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},cl.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);return null!=i?i:n.isCompleteForChild(e)?this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e)):null},cl.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},cl.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var s,a=this.visibleWrites_.childCompoundWrite(t),u=a.getCompleteNode(Cu.Empty);if(null!=u)s=u;else{if(null==e)return[];s=a.apply(e)}if((s=s.withIndex(o)).isEmpty()||s.isLeafNode())return[];for(var c=[],h=o.getCompare(),l=i?s.getReverseIteratorFrom(n,o):s.getIteratorFrom(n,o),f=l.getNext();f&&c.length<r;)0!==h(f,n)&&c.push(f),f=l.getNext();return c},cl.prototype.recordContainsPath_=function(t,e){if(t.snap)return t.path.contains(e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&t.path.child(n).contains(e))return!0;return!1},cl.prototype.resetTree_=function(){this.visibleWrites_=cl.layerTree_(this.allWrites_,cl.DefaultFilter_,Cu.Empty),0<this.allWrites_.length?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},cl.DefaultFilter_=function(t){return t.visible},cl.layerTree_=function(t,e,n){for(var r=sl.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var s=o.path,a=void 0;if(o.snap)n.contains(s)?(a=Cu.relativePath(n,s),r=r.addWrite(a,o.snap)):s.contains(n)&&(a=Cu.relativePath(s,n),r=r.addWrite(Cu.Empty,o.snap.getChild(a)));else{if(!o.children)throw Ds("WriteRecord should have .snap or .children");if(n.contains(s))a=Cu.relativePath(n,s),r=r.addWrites(a,o.children);else if(s.contains(n))if((a=Cu.relativePath(s,n)).isEmpty())r=r.addWrites(Cu.Empty,o.children);else{var u=Zs(o.children,a.getFront());if(u){var c=u.getChild(a.popFront());r=r.addWrite(Cu.Empty,c)}}}}}return r},cl);function cl(){this.visibleWrites_=sl.Empty,this.allWrites_=[],this.lastWriteId_=-1}var hl=(ll.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},ll.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},ll.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},ll.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},ll.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},ll.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},ll.prototype.child=function(t){return new ll(this.treePath_.child(t),this.writeTree_)},ll);function ll(t,e){this.treePath_=t,this.writeTree_=e}var pl=(dl.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new Ph(Ih.User,t,e)):[]},dl.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=Ah.fromObject(e);return this.applyOperationToSyncPoints_(new xh(Ih.User,t,r))},dl.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=Ah.Empty;return null!=n.snap?r=r.set(Cu.Empty,!0):bu(n.children,function(t,e){r=r.set(new Cu(t),e)}),this.applyOperationToSyncPoints_(new Ch(n.path,r,e))}return[]},dl.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new Ph(Ih.Server,t,e))},dl.prototype.applyServerMerge=function(t,e){var n=Ah.fromObject(e);return this.applyOperationToSyncPoints_(new xh(Ih.Server,t,n))},dl.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new Rh(Ih.Server,t))},dl.prototype.applyTaggedQueryOverwrite=function(t,e,n){var r=this.queryKeyForTag_(n);if(null==r)return[];var i=dl.parseQueryKey_(r),o=i.path,s=i.queryId,a=Cu.relativePath(o,t),u=new Ph(Ih.forServerTaggedQuery(s),a,e);return this.applyTaggedOperation_(o,u)},dl.prototype.applyTaggedQueryMerge=function(t,e,n){var r=this.queryKeyForTag_(n);if(r){var i=dl.parseQueryKey_(r),o=i.path,s=i.queryId,a=Cu.relativePath(o,t),u=Ah.fromObject(e),c=new xh(Ih.forServerTaggedQuery(s),a,u);return this.applyTaggedOperation_(o,c)}return[]},dl.prototype.applyTaggedListenComplete=function(t,e){var n=this.queryKeyForTag_(e);if(n){var r=dl.parseQueryKey_(n),i=r.path,o=r.queryId,s=Cu.relativePath(i,t),a=new Rh(Ih.forServerTaggedQuery(o),s);return this.applyTaggedOperation_(i,a)}return[]},dl.prototype.addEventRegistration=function(t,e){var r=t.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=Cu.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()});var n,s=this.syncPointTree_.get(r);s?(o=o||s.hasCompleteView(),i=i||s.getCompleteServerCache(Cu.Empty)):(s=new il,this.syncPointTree_=this.syncPointTree_.set(r,s)),null!=i?n=!0:(n=!1,i=Kc.EMPTY_NODE,this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(Cu.Empty);n&&(i=i.updateImmediateChild(t,n))}));var a=s.viewExistsForQuery(t);if(!a&&!t.getQueryParams().loadsAllData()){var u=dl.makeQueryKey_(t);Ps(!this.queryToTagMap.has(u),"View does not exist, but we have a tag");var c=dl.getNextQueryTag_();this.queryToTagMap.set(u,c),this.tagToQueryMap.set(c,u)}var h=this.pendingWriteTree_.childWrites(r),l=s.addEventRegistration(t,e,h,i,n);if(!a&&!o){var f=s.viewForQuery(t);l=l.concat(this.setupListener_(t,f))}return l},dl.prototype.removeEventRegistration=function(t,e,n){var r=this,i=t.path,o=this.syncPointTree_.get(i),s=[];if(o&&("default"===t.queryIdentifier()||o.viewExistsForQuery(t))){var a=o.removeEventRegistration(t,e,n);o.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i));var u=a.removed;s=a.events;var c=-1!==u.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(i,function(t,e){return e.hasCompleteView()});if(c&&!h){var l=this.syncPointTree_.subtree(i);if(!l.isEmpty())for(var f=this.collectDistinctViewsForSubTree_(l),p=0;p<f.length;++p){var d=f[p],v=d.getQuery(),y=this.createListenerForView_(d);this.listenProvider_.startListening(dl.queryForListening_(v),this.tagForQuery_(v),y.hashFn,y.onComplete)}}!h&&0<u.length&&!n&&(c?this.listenProvider_.stopListening(dl.queryForListening_(t),null):u.forEach(function(t){var e=r.queryToTagMap.get(dl.makeQueryKey_(t));r.listenProvider_.stopListening(dl.queryForListening_(t),e)})),this.removeTags_(u)}return s},dl.prototype.calcCompleteEventCache=function(i,t){var e=this.pendingWriteTree_,n=this.syncPointTree_.findOnPath(i,function(t,e){var n=Cu.relativePath(t,i),r=e.getCompleteServerCache(n);if(r)return r});return e.calcCompleteEventCache(i,n,t,!0)},dl.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView())return[e.getCompleteView()];var r=[];return e&&(r=e.getQueryViews()),bu(n,function(t,e){r=r.concat(e)}),r})},dl.prototype.removeTags_=function(t){for(var e=0;e<t.length;++e){var n=t[e];if(!n.getQueryParams().loadsAllData()){var r=dl.makeQueryKey_(n),i=this.queryToTagMap.get(r);this.queryToTagMap.delete(r),this.tagToQueryMap.delete(i)}}},dl.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},dl.prototype.setupListener_=function(t,e){var n=t.path,r=this.tagForQuery_(t),i=this.createListenerForView_(e),o=this.listenProvider_.startListening(dl.queryForListening_(t),r,i.hashFn,i.onComplete),s=this.syncPointTree_.subtree(n);if(r)Ps(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var a=s.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),bu(n,function(t,e){r=r.concat(e)}),r}),u=0;u<a.length;++u){var c=a[u];this.listenProvider_.stopListening(dl.queryForListening_(c),this.tagForQuery_(c))}return o},dl.prototype.createListenerForView_=function(t){var n=this,r=t.getQuery(),i=this.tagForQuery_(r);return{hashFn:function(){return(t.getServerCache()||Kc.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return i?n.applyTaggedListenComplete(r.path,i):n.applyListenComplete(r.path);var e=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===t?n="Client doesn't have permission to access the desired data.":"unavailable"===t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r}(t,r);return n.removeEventRegistration(r,null,e)}}},dl.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},dl.parseQueryKey_=function(t){var e=t.indexOf("$");return Ps(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new Cu(t.substr(0,e))}},dl.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap.get(t)},dl.prototype.tagForQuery_=function(t){var e=dl.makeQueryKey_(t);return this.queryToTagMap.get(e)},dl.getNextQueryTag_=function(){return dl.nextQueryTag_++},dl.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);Ps(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},dl.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(Cu.Empty))},dl.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(Cu.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(Cu.Empty));var o=[],s=t.path.getFront(),a=t.operationForChild(s),u=e.children.get(s);if(u&&a){var c=n?n.getImmediateChild(s):null,h=r.child(s);o=o.concat(this.applyOperationHelper_(a,u,c,h))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},dl.prototype.applyOperationDescendantsHelper_=function(o,t,s,a){var u=this,e=t.get(Cu.Empty);null==s&&null!=e&&(s=e.getCompleteServerCache(Cu.Empty));var c=[];return t.children.inorderTraversal(function(t,e){var n=s?s.getImmediateChild(t):null,r=a.child(t),i=o.operationForChild(t);i&&(c=c.concat(u.applyOperationDescendantsHelper_(i,e,n,r)))}),e&&(c=c.concat(e.applyOperation(o,a,s))),c},dl.nextQueryTag_=1,dl);function dl(t){this.listenProvider_=t,this.syncPointTree_=Ah.Empty,this.pendingWriteTree_=new ul,this.tagToQueryMap=new Map,this.queryToTagMap=new Map}var vl=(yl.prototype.getNode=function(t){return this.rootNode_.getChild(t)},yl.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},yl);function yl(){this.rootNode_=Kc.EMPTY_NODE}var gl=(ml.prototype.getToken=function(t){return this.auth_?this.auth_.getToken(t).catch(function(t){return t&&"auth/token-not-initialized"===t.code?(Za("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)}):Promise.resolve(null)},ml.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout(function(){return e(null)},0),this.authProvider_.get().then(function(t){return t.addAuthTokenListener(e)}))},ml.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(t){return t.removeAuthTokenListener(e)})},ml.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ru(t)},ml);function ml(t,e){var n=this;this.app_=t,this.authProvider_=e,this.auth_=null,this.auth_=e.getImmediate({optional:!0}),this.auth_||e.get().then(function(t){return n.auth_=t})}var wl=(bl.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),$s(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},bl.prototype.get=function(){return Ls(this.counters_)},bl);function bl(){this.counters_={}}var _l=(El.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new wl),this.collections_[e]},El.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},El.collections_={},El.reporters_={},El);function El(){}var Il=(Tl.prototype.get=function(){var t=this.collection_.get(),n=Es({},t);return this.last_&&bu(this.last_,function(t,e){n[t]=n[t]-e}),this.last_=t,n},Tl);function Tl(t){this.collection_=t,this.last_=null}var Sl=(Cl.prototype.includeStat=function(t){this.statsToReport_[t]=!0},Cl.prototype.reportStats_=function(){var n=this,t=this.statsListener_.get(),r={},i=!1;bu(t,function(t,e){0<e&&$s(n.statsToReport_,t)&&(r[t]=e,i=!0)}),i&&this.server_.reportStats(r),Iu(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},Cl);function Cl(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new Il(t);var n=1e4+2e4*Math.random();Iu(this.reportStats_.bind(this),Math.floor(n))}var Nl=(Al.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new kl(i)),e.add(r)}e&&this.eventLists_.push(e)},Al.prototype.raiseEventsAtPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.equals(e)})},Al.prototype.raiseEventsForChangedPath=function(e,t){this.queueEvents(t),this.raiseQueuedEventsMatchingPredicate_(function(t){return t.contains(e)||e.contains(t)})},Al.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];r&&(t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1)}e&&(this.eventLists_=[]),this.recursionDepth_--},Al);function Al(){this.eventLists_=[],this.recursionDepth_=0}var kl=(Rl.prototype.add=function(t){this.events_.push(t)},Rl.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();du&&Za("event: "+e.toString()),Eu(n)}}},Rl.prototype.getPath=function(){return this.path_},Rl);function Rl(t){this.path_=t,this.events_=[]}var Ol=(Pl.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=Ns(this.listeners_[t]),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},Pl.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},Pl.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},Pl.prototype.validateEventType_=function(e){Ps(this.allowedEvents_.find(function(t){return t===e}),"Unknown event: "+e)},Pl);function Pl(t){this.allowedEvents_=t,this.listeners_={},Ps(Array.isArray(t)&&0<t.length,"Requires a non-empty array")}var Dl,xl=(_s(Ll,Dl=Ol),Ll.getInstance=function(){return new Ll},Ll.prototype.getInitialEvent=function(t){return Ps("visible"===t,"Unknown event type: "+t),[this.visible_]},Ll);function Ll(){var e,t,n=Dl.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),n.visible_=!0,t&&document.addEventListener(t,function(){var t=!document[e];t!==n.visible_&&(n.visible_=t,n.trigger("visible",t))},!1),n}var Ml,Ul=(_s(Fl,Ml=Ol),Fl.getInstance=function(){return new Fl},Fl.prototype.getInitialEvent=function(t){return Ps("online"===t,"Unknown event type: "+t),[this.online_]},Fl.prototype.currentlyOnline=function(){return this.online_},Fl);function Fl(){var t=Ml.call(this,["online"])||this;return t.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||qs()||(window.addEventListener("online",function(){t.online_||(t.online_=!0,t.trigger("online",!0))},!1),window.addEventListener("offline",function(){t.online_&&(t.online_=!1,t.trigger("online",!1))},!1)),t}var jl=(ql.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},ql.prototype.handleResponse=function(t,e){var r=this;this.pendingResponses[t]=e;for(var n=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&Eu(function(){r.onMessage_(e[t])})},n=0;n<e.length;++n)t(n);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum]&&"break"!==n(););},ql);function ql(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}var Vl=(Bl.prototype.open=function(t,e){var s=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new jl(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){s.log_("Timed out trying to connect."),s.onClosed_(),s.connectTimeoutTimer_=null},Math.floor(3e4)),function(t){if("complete"===document.readyState)t();else{var e=!1,n=function(){document.body?e||(e=!0,t()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}}(function(){if(!s.isClosed_){s.scriptTagHolder=new Wl(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Cs(t,5),r=n[0],i=n[1],o=n[2];if(n[3],n[4],s.incrementIncomingBytes_(t),s.scriptTagHolder)if(s.connectTimeoutTimer_&&(clearTimeout(s.connectTimeoutTimer_),s.connectTimeoutTimer_=null),s.everConnected_=!0,"start"===r)s.id=i,s.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(s.scriptTagHolder.sendNewPolls=!1,s.myPacketOrderer.closeAfter(i,function(){s.onClosed_()})):s.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Cs(t,2),r=n[0],i=n[1];s.incrementIncomingBytes_(t),s.myPacketOrderer.handleResponse(r,i)},function(){s.onClosed_()},s.urlFn);var t={start:"t"};t.ser=Math.floor(1e8*Math.random()),s.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=s.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",s.transportSessionId&&(t.s=s.transportSessionId),s.lastSessionId&&(t.ls=s.lastSessionId),"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Ru)&&(t.r="f");var e=s.urlFn(t);s.log_("Connecting via long-poll to "+e),s.scriptTagHolder.addTag(e,function(){})}})},Bl.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},Bl.forceAllow=function(){Bl.forceAllow_=!0},Bl.forceDisallow=function(){Bl.forceDisallow_=!0},Bl.isAvailable=function(){return!!Bl.forceAllow_||!(Bl.forceDisallow_||"undefined"==typeof document||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI)},Bl.prototype.markConnectionHealthy=function(){},Bl.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},Bl.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},Bl.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},Bl.prototype.send=function(t){var e=Xs(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=function(t){var e=ks(t);return xs.encodeByteArray(e,!0)}(e),r=au(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},Bl.prototype.addDisconnectPingFrame=function(t,e){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},Bl.prototype.incrementIncomingBytes_=function(t){var e=Xs(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},Bl);function Bl(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=tu(t),this.stats_=_l.getCollection(e),this.urlFn=function(t){return e.connectionURL(Pu,t)}}var Wl=(Hl.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Za("No IE domain setting required")}catch(t){var n=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+n+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},Hl.prototype.close=function(){var t=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==t.myIFrame&&(document.body.removeChild(t.myIFrame),t.myIFrame=null)},Math.floor(0)));var e=this.onDisconnect;e&&(this.onDisconnect=null,e())},Hl.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},Hl.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(0<this.pendingSegs.length?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;0<this.pendingSegs.length&&this.pendingSegs[0].d.length+30+n.length<=1870;){var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},Hl.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},Hl.prototype.addLongPollTag_=function(t,e){var n=this;function r(){n.outstandingRequests.delete(e),n.newRequest_()}this.outstandingRequests.add(e);var i=setTimeout(r,Math.floor(25e3));this.addTag(t,function(){clearTimeout(i),r()})},Hl.prototype.addTag=function(t,n){var r=this;setTimeout(function(){try{if(!r.sendNewPolls)return;var e=r.myIFrame.doc.createElement("script");e.type="text/javascript",e.async=!0,e.src=t,e.onload=e.onreadystatechange=function(){var t=e.readyState;t&&"loaded"!==t&&"complete"!==t||(e.onload=e.onreadystatechange=null,e.parentNode&&e.parentNode.removeChild(e),n())},e.onerror=function(){Za("Long-poll script failed to load: "+t),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(e)}catch(t){}},Math.floor(1))},Hl);function Hl(t,e,n,r){this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,this.uniqueCallbackIdentifier=fu(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=e,this.myIFrame=Hl.createIFrame_();var i="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)&&(i='<script>document.domain="'+document.domain+'";<\/script>');var o="<html><body>"+i+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(t){Za("frame writing exception"),t.stack&&Za(t.stack),Za(t)}}var Gl="";var Kl=null;"undefined"!=typeof MozWebSocket?Kl=MozWebSocket:"undefined"!=typeof WebSocket&&(Kl=WebSocket);var zl=(Ql.connectionURL_=function(t,e,n){var r={v:"5"};return"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(Ru)&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL(Ou,r)},Ql.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,cu.set("previous_websocket_failure",!0);try{if(Bs()){var r=Os.NODE_ADMIN?"AdminNode":"Node",i={headers:{"User-Agent":"Firebase/5/"+Gl+"/"+process.platform+"/"+r}},o=process.env,s=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;s&&(i.proxy={origin:s}),this.mySock=new Kl(this.connURL,[],i)}else this.mySock=new Kl(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var a=t.message||t.data;return a&&this.log_(a),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},Ql.prototype.start=function(){},Ql.forceDisallow=function(){Ql.forceDisallow_=!0},Ql.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);e&&1<e.length&&parseFloat(e[1])<4.4&&(t=!0)}return!t&&null!==Kl&&!Ql.forceDisallow_},Ql.previouslyFailed=function(){return cu.isInMemoryStorage||!0===cu.get("previous_websocket_failure")},Ql.prototype.markConnectionHealthy=function(){cu.remove("previous_websocket_failure")},Ql.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length===this.totalFrames){var e=this.frames.join("");this.frames=null;var n=Ys(e);this.onMessage(n)}},Ql.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},Ql.prototype.extractFrameCount_=function(t){if(Ps(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},Ql.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},Ql.prototype.send=function(t){this.resetKeepAlive();var e=Xs(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=au(e,16384);1<n.length&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},Ql.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},Ql.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},Ql.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},Ql.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},Ql.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},Ql.responsesRequiredToBeHealthy=2,Ql.healthyTimeout=3e4,Ql);function Ql(t,e,n,r){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=tu(this.connId),this.stats_=_l.getCollection(e),this.connURL=Ql.connectionURL_(e,n,r)}var Yl=(Object.defineProperty(Xl,"ALL_TRANSPORTS",{get:function(){return[Vl,zl]},enumerable:!0,configurable:!0}),Xl.prototype.initTransports_=function(t){var e,n,r=zl&&zl.isAvailable(),i=r&&!zl.previouslyFailed();if(t.webSocketOnly&&(r||ru("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[zl];else{var o=this.transports_=[];try{for(var s=Ss(Xl.ALL_TRANSPORTS),a=s.next();!a.done;a=s.next()){var u=a.value;u&&u.isAvailable()&&o.push(u)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}}},Xl.prototype.initialTransport=function(){if(0<this.transports_.length)return this.transports_[0];throw new Error("No transports available")},Xl.prototype.upgradeTransport=function(){return 1<this.transports_.length?this.transports_[1]:null},Xl);function Xl(t){this.initTransports_(t)}var Jl=($l.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;0<i&&(this.healthyTimeout_=Iu(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&102400<t.conn_.bytesReceived?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&10240<t.conn_.bytesSent?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},$l.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},$l.prototype.disconnReceiver_=function(e){var n=this;return function(t){e===n.conn_?n.onConnectionLost_(t):e===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},$l.prototype.connReceiver_=function(e){var n=this;return function(t){2!==n.state_&&(e===n.rx_?n.onPrimaryMessageReceived_(t):e===n.secondaryConn_?n.onSecondaryMessageReceived_(t):n.log_("message on old connection"))}},$l.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},$l.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},$l.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},$l.prototype.onSecondaryMessageReceived_=function(t){var e=su("t",t),n=su("d",t);if("c"===e)this.onSecondaryControl_(n);else{if("d"!==e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},$l.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},$l.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},$l.prototype.onPrimaryMessageReceived_=function(t){var e=su("t",t),n=su("d",t);"c"===e?this.onControl_(n):"d"===e&&this.onDataMessage_(n)},$l.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},$l.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},$l.prototype.onControl_=function(t){var e=su("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?eu("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):eu("Unknown control packet command: "+e)}},$l.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&ru("Protocol version mismatch detected"),this.tryStartUpgrade_())},$l.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},$l.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),Iu(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},$l.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},$l.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Iu(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},$l.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},$l.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},$l.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(cu.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},$l.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},$l.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},$l.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},$l.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},$l);function $l(t,e,n,r,i,o,s){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=tu("c:"+this.id+":"),this.transportManager_=new Yl(e),this.log_("Connection created"),this.start_()}var Zl=(tf.prototype.put=function(t,e,n,r){},tf.prototype.merge=function(t,e,n,r){},tf.prototype.refreshAuthToken=function(t){},tf.prototype.onDisconnectPut=function(t,e,n){},tf.prototype.onDisconnectMerge=function(t,e,n){},tf.prototype.onDisconnectCancel=function(t,e){},tf.prototype.reportStats=function(t){},tf);function tf(){}var ef,nf=(_s(rf,ef=Zl),rf.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(Xs(i)),Ps(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},rf.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens.has(o)||this.listens.set(o,new Map),Ps(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),Ps(!this.listens.get(o).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:e,query:t,tag:n};this.listens.get(o).set(i,s),this.connected_&&this.sendListen_(s)},rf.prototype.sendListen_=function(r){var i=this,o=r.query,s=o.path.toString(),a=o.queryIdentifier();this.log_("Listen on "+s+" for "+a);var t={p:s};r.tag&&(t.q=o.queryObject(),t.t=r.tag),t.h=r.hashFn(),this.sendRequest("q",t,function(t){var e=t.d,n=t.s;rf.warnOnListenWarnings_(e,o),(i.listens.get(s)&&i.listens.get(s).get(a))===r&&(i.log_("listen response",t),"ok"!==n&&i.removeListen_(s,a),r.onComplete&&r.onComplete(n,e))})},rf.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&$s(t,"w")){var n=Zs(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();ru("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},rf.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},rf.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||function(t){var e=Js(t).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},rf.prototype.tryAuth=function(){var r=this;if(this.connected_&&this.authToken_){var i=this.authToken_,t=function(t){var e=Js(t).claims;return!!e&&"object"==typeof e&&e.hasOwnProperty("iat")}(i)?"auth":"gauth",e={cred:i};null===this.authOverride_?e.noauth=!0:"object"==typeof this.authOverride_&&(e.authvar=this.authOverride_),this.sendRequest(t,e,function(t){var e=t.s,n=t.d||"error";r.authToken_===i&&("ok"===e?r.invalidAuthTokenCount_=0:r.onAuthRevoked_(e,n))})}},rf.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),Ps(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},rf.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},rf.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},rf.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},rf.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},rf.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},rf.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},rf.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},rf.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var s=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(s):this.log_("Buffering put: "+e)},rf.prototype.sendPut_=function(e){var n=this,r=this.outstandingPuts_[e].action,t=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(r,t,function(t){n.log_(r+" response",t),delete n.outstandingPuts_[e],n.outstandingPutCount_--,0===n.outstandingPutCount_&&(n.outstandingPuts_=[]),i&&i(t.s,t.d)})},rf.prototype.reportStats=function(t){var n=this;if(this.connected_){var e={c:t};this.log_("reportStats",e),this.sendRequest("s",e,function(t){if("ok"!==t.s){var e=t.d;n.log_("reportStats","Error sending stats: "+e)}})}},rf.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+Xs(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},rf.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):eu("Unrecognized action received from server: "+Xs(t)+"\nAre you using the latest client?")},rf.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},rf.prototype.scheduleConnect_=function(t){var e=this;Ps(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},rf.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},rf.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},rf.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&(3e4<(new Date).getTime()-this.lastConnectionEstablishedTime_&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());var t=(new Date).getTime()-this.lastConnectionAttemptTime_,e=Math.max(0,this.reconnectDelay_-t);e=Math.random()*e,this.log_("Trying to reconnect in "+e+"ms"),this.scheduleConnect_(e),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},rf.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var e=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+rf.nextConnectionId_++,o=this,s=this.lastSessionId,a=!1,u=null,c=function(){u?u.close():(a=!0,r())};this.realtime_={close:c,sendRequest:function(t){Ps(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)}};var t=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(t).then(function(t){a?Za("getToken() completed but was canceled"):(Za("getToken() completed. Creating connection."),o.authToken_=t&&t.accessToken,u=new Jl(i,o.repoInfo_,e,n,r,function(t){ru(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},s))}).then(null,function(t){o.log_("Failed to get token: "+t),a||c()})}},rf.prototype.interrupt=function(t){Za("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},rf.prototype.resume=function(t){Za("Resuming connection for reason: "+t),delete this.interruptReasons_[t],ta(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))},rf.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},rf.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},rf.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return wu(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},rf.prototype.removeListen_=function(t,e){var n,r=new Cu(t).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(e),i.delete(e),0===i.size&&this.listens.delete(r)}else n=void 0;return n},rf.prototype.onAuthRevoked_=function(t,e){Za("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||(this.invalidAuthTokenCount_++,3<=this.invalidAuthTokenCount_&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},rf.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},rf.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=Ss(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,Ss(s.values())),u=a.next();!u.done;u=a.next()){var c=u.value;this.sendListen_(c)}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var h=0;h<this.outstandingPuts_.length;h++)this.outstandingPuts_[h]&&this.sendPut_(h);for(;this.onDisconnectRequestQueue_.length;){var l=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(l.action,l.pathString,l.data,l.onComplete)}},rf.prototype.sendConnectStats_=function(){var t={};t["sdk.js."+Gl.replace(/\./g,"-")]=1,qs()?t["framework.cordova"]=1:Vs()&&(t["framework.reactnative"]=1),this.reportStats(t)},rf.prototype.shouldReconnect_=function(){var t=Ul.getInstance().currentlyOnline();return ta(this.interruptReasons_)&&t},rf.nextPersistentConnectionId_=0,rf.nextConnectionId_=0,rf);function rf(t,e,n,r,i,o){var s=ef.call(this)||this;if(s.repoInfo_=t,s.onDataUpdate_=e,s.onConnectStatus_=n,s.onServerInfoUpdate_=r,s.authTokenProvider_=i,s.authOverride_=o,s.id=rf.nextPersistentConnectionId_++,s.log_=tu("p:"+s.id+":"),s.interruptReasons_={},s.listens=new Map,s.outstandingPuts_=[],s.outstandingPutCount_=0,s.onDisconnectRequestQueue_=[],s.connected_=!1,s.reconnectDelay_=1e3,s.maxReconnectDelay_=3e5,s.securityDebugCallback_=null,s.lastSessionId=null,s.establishConnectionTimer_=null,s.visible_=!1,s.requestCBHash_={},s.requestNumber_=0,s.realtime_=null,s.authToken_=null,s.forceTokenRefresh_=!1,s.invalidAuthTokenCount_=0,s.firstConnection_=!0,s.lastConnectionAttemptTime_=null,s.lastConnectionEstablishedTime_=null,o&&!Bs())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return s.scheduleConnect_(0),xl.getInstance().on("visible",s.onVisible_,s),-1===t.host.indexOf("fblocal")&&Ul.getInstance().on("online",s.onOnline_,s),s}var of,sf=(_s(af,of=Zl),af.prototype.reportStats=function(t){throw new Error("Method not implemented.")},af.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(Ps(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},af.prototype.listen=function(t,e,r,i){var o=this,s=t.path.toString();this.log_("Listen called for "+s+" "+t.queryIdentifier());var a=af.getListenId_(t,r),u={};this.listens_[a]=u;var n=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(s+".json",n,function(t,e){var n=e;404===t&&(t=n=null),null===t&&o.onDataUpdate_(s,n,!1,r),Zs(o.listens_,a)===u&&i(t?401===t?"permission_denied":"rest_error:"+t:"ok",null)})},af.prototype.unlisten=function(t,e){var n=af.getListenId_(t,e);delete this.listens_[n]},af.prototype.refreshAuthToken=function(t){},af.prototype.restRequest_=function(i,o,s){var a=this;void 0===o&&(o={}),o.format="export",this.authTokenProvider_.getToken(!1).then(function(t){var e=t&&t.accessToken;e&&(o.auth=e);var n=(a.repoInfo_.secure?"https://":"http://")+a.repoInfo_.host+i+"?ns="+a.repoInfo_.namespace+function(t){for(var n=[],e=function(e,t){Array.isArray(t)?t.forEach(function(t){n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))}):n.push(encodeURIComponent(e)+"="+encodeURIComponent(t))},r=0,i=Object.entries(t);r<i.length;r++){var o=i[r];e(o[0],o[1])}return n.length?"&"+n.join("&"):""}(o);a.log_("Sending REST request for "+n);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(s&&4===r.readyState){a.log_("REST Response for "+n+" received. status:",r.status,"response:",r.responseText);var t=null;if(200<=r.status&&r.status<300){try{t=Ys(r.responseText)}catch(t){ru("Failed to parse JSON response for "+n+": "+r.responseText)}s(null,t)}else 401!==r.status&&404!==r.status&&ru("Got unsuccessful REST response for "+n+" Status: "+r.status),s(r.status);s=null}},r.open("GET",n,!0),r.send()})},af);function af(t,e,n){var r=of.call(this)||this;return r.repoInfo_=t,r.onDataUpdate_=e,r.authTokenProvider_=n,r.log_=tu("p:rest:"),r.listens_={},r}var uf="repo_interrupt",cf=(hf.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},hf.prototype.name=function(){return this.repoInfo_.namespace},hf.prototype.serverTime=function(){var t=this.infoData_.getNode(new Cu(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t},hf.prototype.generateServerValues=function(){return function(t){return(t=t||{}).timestamp=t.timestamp||(new Date).getTime(),t}({timestamp:this.serverTime()})},hf.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new Cu(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var s=ea(e,function(t){return $c(t)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,s,r)}else{var a=$c(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,a,r)}else if(n){var u=ea(e,function(t){return $c(t)});o=this.serverSyncTree_.applyServerMerge(i,u)}else{var c=$c(e);o=this.serverSyncTree_.applyServerOverwrite(i,c)}var h=i;0<o.length&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},hf.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},hf.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},hf.prototype.onServerInfoUpdate_=function(t){var n=this;bu(t,function(t,e){n.updateInfo_(t,e)})},hf.prototype.updateInfo_=function(t,e){var n=new Cu("/.info/"+t),r=$c(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},hf.prototype.getNextWriteId_=function(){return this.nextWriteId_++},hf.prototype.setWithPriority=function(i,t,e,o){var s=this;this.log_("set",{path:i.toString(),value:t,priority:e});var n=this.generateServerValues(),r=$c(t,e),a=Eh(r,n),u=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserOverwrite(i,a,u,!0);this.eventQueue_.queueEvents(c),this.server_.put(i.toString(),r.val(!0),function(t,e){var n="ok"===t;n||ru("set at "+i+" failed: "+t);var r=s.serverSyncTree_.ackUserWrite(u,!n);s.eventQueue_.raiseEventsForChangedPath(i,r),s.callOnCompleteCallback(o,t,e)});var h=this.abortTransactions_(i);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},hf.prototype.update=function(o,t,s){var a=this;this.log_("update",{path:o.toString(),value:t});var r=!0,i=this.generateServerValues(),u={};if(bu(t,function(t,e){r=!1;var n=$c(e);u[t]=Eh(n,i)}),r)Za("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(s,"ok");else{var c=this.getNextWriteId_(),e=this.serverSyncTree_.applyUserMerge(o,u,c);this.eventQueue_.queueEvents(e),this.server_.merge(o.toString(),t,function(t,e){var n="ok"===t;n||ru("update at "+o+" failed: "+t);var r=a.serverSyncTree_.ackUserWrite(c,!n),i=0<r.length?a.rerunTransactions_(o):o;a.eventQueue_.raiseEventsForChangedPath(i,r),a.callOnCompleteCallback(s,t,e)}),bu(t,function(t){var e=a.abortTransactions_(o.child(t));a.rerunTransactions_(e)}),this.eventQueue_.raiseEventsForChangedPath(o,[])}},hf.prototype.runOnDisconnectEvents_=function(){var r=this;this.log_("onDisconnectEvents");var t=this.generateServerValues(),e=function(t,n){var r=new gh;return t.forEachTree(new Cu(""),function(t,e){r.remember(t,Eh(e,n))}),r}(this.onDisconnect_,t),i=[];e.forEachTree(Cu.Empty,function(t,e){i=i.concat(r.serverSyncTree_.applyServerOverwrite(t,e));var n=r.abortTransactions_(t);r.rerunTransactions_(n)}),this.onDisconnect_=new gh,this.eventQueue_.raiseEventsForChangedPath(Cu.Empty,i)},hf.prototype.onDisconnectCancel=function(n,r){var i=this;this.server_.onDisconnectCancel(n.toString(),function(t,e){"ok"===t&&i.onDisconnect_.forget(n),i.callOnCompleteCallback(r,t,e)})},hf.prototype.onDisconnectSet=function(n,t,r){var i=this,o=$c(t);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(t,e){"ok"===t&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,t,e)})},hf.prototype.onDisconnectSetWithPriority=function(n,t,e,r){var i=this,o=$c(t,e);this.server_.onDisconnectPut(n.toString(),o.val(!0),function(t,e){"ok"===t&&i.onDisconnect_.remember(n,o),i.callOnCompleteCallback(r,t,e)})},hf.prototype.onDisconnectUpdate=function(r,n,i){var o=this;if(ta(n))return Za("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(i,"ok");this.server_.onDisconnectMerge(r.toString(),n,function(t,e){"ok"===t&&bu(n,function(t,e){var n=$c(e);o.onDisconnect_.remember(r.child(t),n)}),o.callOnCompleteCallback(i,t,e)})},hf.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},hf.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},hf.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt(uf)},hf.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume(uf)},hf.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;e=t?(this.statsListener_||(this.statsListener_=new Il(this.stats_)),this.statsListener_.get()):this.stats_.get();var i=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);bu(e,function(t,e){for(var n=t,r=t.length;r<i+2;r++)n+=" ";console.log(n+e)})}},hf.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},hf.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),Za.apply(void 0,Ns([n],t))},hf.prototype.callOnCompleteCallback=function(r,i,o){r&&Eu(function(){if("ok"===i)r(null);else{var t=(i||"error").toUpperCase(),e=t;o&&(e+=": "+o);var n=new Error(e);n.code=t,r(n)}})},Object.defineProperty(hf.prototype,"database",{get:function(){return this.__database||(this.__database=new kf(this))},enumerable:!0,configurable:!0}),hf);function hf(t,e,n,r){var s=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Nl,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new gh,this.persistentConnection_=null;var i=new gl(n,r);if(this.stats_=_l.getCollection(t),e||0<=("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i))this.server_=new sf(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if(null!=o){if("object"!=typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Xs(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new nf(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){s.server_.refreshAuthToken(t)}),this.statsReporter_=_l.getOrCreateReporter(t,function(){return new Sl(s.stats_,s.server_)}),this.transactionsInit_(),this.infoData_=new vl,this.infoSyncTree_=new pl({startListening:function(t,e,n,r){var i=[],o=s.infoData_.getNode(t.path);return o.isEmpty()||(i=s.infoSyncTree_.applyServerOverwrite(t.path,o),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new pl({startListening:function(r,t,e,i){return s.server_.listen(r,e,t,function(t,e){var n=i(t,e);s.eventQueue_.raiseEventsForChangedPath(r.path,n)}),[]},stopListening:function(t,e){s.server_.unlisten(t,e)}})}var lf=(ff.prototype.getStartPost=function(){return this.startPost_},ff.prototype.getEndPost=function(){return this.endPost_},ff.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},ff.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new sc(e,n))||(n=Kc.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},ff.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Kc.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Kc.EMPTY_NODE);var i=this;return e.forEachChild(Sc,function(t,e){i.matches(new sc(t,e))||(r=r.updateImmediateChild(t,Kc.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},ff.prototype.updatePriority=function(t,e){return t},ff.prototype.filtersNodes=function(){return!0},ff.prototype.getIndexedFilter=function(){return this.indexedFilter_},ff.prototype.getIndex=function(){return this.index_},ff.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},ff.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},ff);function ff(t){this.indexedFilter_=new Bh(t.getIndex()),this.index_=t.getIndex(),this.startPost_=ff.getStartPost_(t),this.endPost_=ff.getEndPost_(t)}var pf=(df.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new sc(e,n))||(n=Kc.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},df.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Kc.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Kc.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var s=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(s.name,s.node),o++}}else{r=(r=e.withIndex(this.index_)).updatePriority(Kc.EMPTY_NODE);var a=void 0,u=void 0,c=void 0;if(i=void 0,this.reverse_){i=r.getReverseIterator(this.index_),a=this.rangedFilter_.getEndPost(),u=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();c=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),a=this.rangedFilter_.getStartPost(),u=this.rangedFilter_.getEndPost(),c=this.index_.getCompare();o=0;for(var l=!1;i.hasNext();)s=i.getNext(),!l&&c(a,s)<=0&&(l=!0),l&&o<this.limit_&&c(s,u)<=0?o++:r=r.updateImmediateChild(s.name,Kc.EMPTY_NODE)}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},df.prototype.updatePriority=function(t,e){return t},df.prototype.filtersNodes=function(){return!0},df.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},df.prototype.getIndex=function(){return this.index_},df.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var s=this.index_.getCompare();o=function(t,e){return s(e,t)}}else o=this.index_.getCompare();var a=t;Ps(a.numChildren()===this.limit_,"");var u=new sc(e,n),c=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),h=this.rangedFilter_.matches(u);if(a.hasChild(e)){for(var l=a.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name===e||a.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var p=null==f?1:o(f,u);if(h&&!n.isEmpty()&&0<=p)return null!=i&&i.trackChildChange(qh.childChangedChange(e,n,l)),a.updateImmediateChild(e,n);null!=i&&i.trackChildChange(qh.childRemovedChange(e,l));var d=a.updateImmediateChild(e,Kc.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(qh.childAddedChange(f.name,f.node)),d.updateImmediateChild(f.name,f.node)):d}return n.isEmpty()?t:h&&0<=o(c,u)?(null!=i&&(i.trackChildChange(qh.childRemovedChange(c.name,c.node)),i.trackChildChange(qh.childAddedChange(e,n))),a.updateImmediateChild(e,n).updateImmediateChild(c.name,Kc.EMPTY_NODE)):t},df);function df(t){this.rangedFilter_=new lf(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}var vf=(yf.prototype.hasStart=function(){return this.startSet_},yf.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===yf.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},yf.prototype.getIndexStartValue=function(){return Ps(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},yf.prototype.getIndexStartName=function(){return Ps(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yu},yf.prototype.hasEnd=function(){return this.endSet_},yf.prototype.getIndexEndValue=function(){return Ps(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},yf.prototype.getIndexEndName=function(){return Ps(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:gu},yf.prototype.hasLimit=function(){return this.limitSet_},yf.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},yf.prototype.getLimit=function(){return Ps(this.limitSet_,"Only valid if limit has been set"),this.limit_},yf.prototype.getIndex=function(){return this.index_},yf.prototype.copy_=function(){var t=new yf;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},yf.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},yf.prototype.limitToFirst=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_=yf.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,e},yf.prototype.limitToLast=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_=yf.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,e},yf.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},yf.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},yf.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},yf.prototype.getQueryObject=function(){var t=yf.WIRE_PROTOCOL_CONSTANTS_,e={};if(this.startSet_&&(e[t.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(e[t.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(e[t.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(e[t.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){e[t.LIMIT]=this.limit_;var n=this.viewFrom_;""===n&&(n=this.isViewFromLeft()?t.VIEW_FROM_LEFT:t.VIEW_FROM_RIGHT),e[t.VIEW_FROM]=n}return this.index_!==Sc&&(e[t.INDEX]=this.index_.toString()),e},yf.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},yf.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Sc},yf.prototype.getNodeFilter=function(){return this.loadsAllData()?new Bh(this.getIndex()):this.hasLimit()?new pf(this):new lf(this)},yf.prototype.toRestQueryStringParameters=function(){var t,e=yf.REST_QUERY_CONSTANTS_,n={};return this.isDefault()||(t=this.index_===Sc?e.PRIORITY_INDEX:this.index_===eh?e.VALUE_INDEX:this.index_===vc?e.KEY_INDEX:(Ps(this.index_ instanceof nh,"Unrecognized index type!"),this.index_.toString()),n[e.ORDER_BY]=Xs(t),this.startSet_&&(n[e.START_AT]=Xs(this.indexStartValue_),this.startNameSet_&&(n[e.START_AT]+=","+Xs(this.indexStartName_))),this.endSet_&&(n[e.END_AT]=Xs(this.indexEndValue_),this.endNameSet_&&(n[e.END_AT]+=","+Xs(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[e.LIMIT_TO_FIRST]=this.limit_:n[e.LIMIT_TO_LAST]=this.limit_)),n},yf.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},yf.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},yf.DEFAULT=new yf,yf);function yf(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Sc}var gf,mf=(_s(wf,gf=vh),wf.prototype.getKey=function(){return ua("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},wf.prototype.child=function(t){return ua("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof Cu||(null===this.path.getFront()?function(t,e,n,r){n=n&&n.replace(/^\/*\.info(\/|$)/,"/"),Hu(t,e,n,r)}("Reference.child",1,t,!1):Hu("Reference.child",1,t,!1)),new wf(this.repo,this.path.child(t))},wf.prototype.getParent=function(){ua("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new wf(this.repo,t)},wf.prototype.getRoot=function(){ua("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},wf.prototype.databaseProp=function(){return this.repo.database},wf.prototype.set=function(t,e){ua("Reference.set",1,2,arguments.length),Gu("Reference.set",this.path),ju("Reference.set",1,t,this.path,!1),ha("Reference.set",2,e,!0);var n=new Us;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},wf.prototype.update=function(t,e){if(ua("Reference.update",1,2,arguments.length),Gu("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,ru("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}qu("Reference.update",1,t,this.path,!1),ha("Reference.update",2,e,!0);var i=new Us;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},wf.prototype.setWithPriority=function(t,e,n){if(ua("Reference.setWithPriority",2,3,arguments.length),Gu("Reference.setWithPriority",this.path),ju("Reference.setWithPriority",1,t,this.path,!1),Vu("Reference.setWithPriority",2,e,!1),ha("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new Us;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},wf.prototype.remove=function(t){return ua("Reference.remove",0,1,arguments.length),Gu("Reference.remove",this.path),ha("Reference.remove",1,t,!0),this.set(null,t)},wf.prototype.transaction=function(t,r,e){if(ua("Reference.transaction",1,3,arguments.length),Gu("Reference.transaction",this.path),ha("Reference.transaction",1,t,!1),ha("Reference.transaction",2,r,!0),function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw new Error(ca(t,e,r)+"must be a boolean.")}("Reference.transaction",3,e,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===e&&(e=!0);var i=new Us;return"function"==typeof r&&i.promise.catch(function(){}),this.repo.startTransaction(this.path,t,function(t,e,n){t?i.reject(t):i.resolve(new tc(e,n)),"function"==typeof r&&r(t,e,n)},e),i.promise},wf.prototype.setPriority=function(t,e){ua("Reference.setPriority",1,2,arguments.length),Gu("Reference.setPriority",this.path),Vu("Reference.setPriority",1,t,!1),ha("Reference.setPriority",2,e,!0);var n=new Us;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},wf.prototype.push=function(t,e){ua("Reference.push",0,2,arguments.length),Gu("Reference.push",this.path),ju("Reference.push",1,t,this.path,!0),ha("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=oc(r),o=this.child(i),s=this.child(i);return n=null!=t?o.set(t,e).then(function(){return s}):Promise.resolve(s),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),o},wf.prototype.onDisconnect=function(){return Gu("Reference.onDisconnect",this.path),new $u(this.repo,this.path)},Object.defineProperty(wf.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(wf.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(wf.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(wf.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),wf);function wf(t,e){if(!(t instanceof cf))throw new Error("new Reference() no longer supported - use app.database().");return gf.call(this,t,e,vf.DEFAULT,!1)||this}vh.__referenceConstructor=mf,il.__referenceConstructor=mf;var bf,_f,Ef=function(){this.children={},this.childCount=0,this.value=null},If=(Tf.prototype.subTree=function(t){for(var e=t instanceof Cu?t:new Cu(t),n=this,r=e.getFront();null!==r;)n=new Tf(r,n,Zs(n.node_.children,r)||new Ef),r=(e=e.popFront()).getFront();return n},Tf.prototype.getValue=function(){return this.node_.value},Tf.prototype.setValue=function(t){Ps(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},Tf.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},Tf.prototype.hasChildren=function(){return 0<this.node_.childCount},Tf.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},Tf.prototype.forEachChild=function(n){var r=this;bu(this.node_.children,function(t,e){n(new Tf(t,r,e))})},Tf.prototype.forEachDescendant=function(e,t,n){t&&!n&&e(this),this.forEachChild(function(t){t.forEachDescendant(e,!0,n)}),t&&n&&e(this)},Tf.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},Tf.prototype.forEachImmediateDescendantWithValue=function(e){this.forEachChild(function(t){null!==t.getValue()?e(t):t.forEachImmediateDescendantWithValue(e)})},Tf.prototype.path=function(){return new Cu(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},Tf.prototype.name=function(){return this.name_},Tf.prototype.parent=function(){return this.parent_},Tf.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},Tf.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=$s(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},Tf);function Tf(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new Ef),this.name_=t,this.parent_=e,this.node_=n}(_f=bf=bf||{})[_f.RUN=0]="RUN",_f[_f.SENT=1]="SENT",_f[_f.COMPLETED=2]="COMPLETED",_f[_f.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",_f[_f.NEEDS_ABORT=4]="NEEDS_ABORT",cf.MAX_TRANSACTION_RETRIES_=25,cf.prototype.transactionsInit_=function(){this.transactionQueueTree_=new If},cf.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);function i(){}var o=new mf(this,t);o.on("value",i);var s={path:t,update:e,onComplete:n,status:null,order:fu(),applyLocally:r,retryCount:0,unwatcher:function(){o.off("value",i)},abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=this.getLatestState_(t);s.currentInputSnapshot=a;var u=s.update(a.val());if(void 0===u){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var c=new ih(s.currentInputSnapshot,new mf(this,s.path),Sc);s.onComplete(null,!1,c)}}else{Ju("transaction failed: Data returned ",u,s.path),s.status=bf.RUN;var h=this.transactionQueueTree_.subTree(t),l=h.getValue()||[];l.push(s),h.setValue(l);var f=void 0;if("object"==typeof u&&null!==u&&$s(u,".priority"))f=Zs(u,".priority"),Ps(Fu(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else f=(this.serverSyncTree_.calcCompleteEventCache(t)||Kc.EMPTY_NODE).getPriority().val();f=f;var p=this.generateServerValues(),d=$c(u,f),v=Eh(d,p);s.currentOutputSnapshotRaw=d,s.currentOutputSnapshotResolved=v,s.currentWriteId=this.getNextWriteId_();var y=this.serverSyncTree_.applyUserOverwrite(t,v,s.currentWriteId,s.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,y),this.sendReadyTransactions_()}},cf.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Kc.EMPTY_NODE},cf.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);Ps(0<n.length,"Sending zero length transaction queue"),n.every(function(t){return t.status===bf.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},cf.prototype.sendTransactionQueue_=function(a,u){for(var c=this,t=u.map(function(t){return t.currentWriteId}),e=this.getLatestState_(a,t),n=e,r=e.hash(),i=0;i<u.length;i++){var o=u[i];Ps(o.status===bf.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),o.status=bf.SENT,o.retryCount++;var s=Cu.relativePath(a,o.path);n=n.updateChild(s,o.currentOutputSnapshotRaw)}var h=n.val(!0),l=a;this.server_.put(l.toString(),h,function(t){c.log_("transaction put response",{path:l.toString(),status:t});var e=[];if("ok"===t){for(var n=[],r=0;r<u.length;r++){if(u[r].status=bf.COMPLETED,e=e.concat(c.serverSyncTree_.ackUserWrite(u[r].currentWriteId)),u[r].onComplete){var i=u[r].currentOutputSnapshotResolved,o=new mf(c,u[r].path),s=new ih(i,o,Sc);n.push(u[r].onComplete.bind(null,null,!0,s))}u[r].unwatcher()}c.pruneCompletedTransactionsBelowNode_(c.transactionQueueTree_.subTree(a)),c.sendReadyTransactions_(),c.eventQueue_.raiseEventsForChangedPath(a,e);for(r=0;r<n.length;r++)Eu(n[r])}else{if("datastale"===t)for(r=0;r<u.length;r++)u[r].status===bf.SENT_NEEDS_ABORT?u[r].status=bf.NEEDS_ABORT:u[r].status=bf.RUN;else{ru("transaction at "+l.toString()+" failed: "+t);for(r=0;r<u.length;r++)u[r].status=bf.NEEDS_ABORT,u[r].abortReason=t}c.rerunTransactions_(a)}},r)},cf.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},cf.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n,r=[],i=[],o=t.filter(function(t){return t.status===bf.RUN}).map(function(t){return t.currentWriteId}),s=0;s<t.length;s++){var a=t[s],u=Cu.relativePath(e,a.path),c=!1,h=void 0;if(Ps(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),a.status===bf.NEEDS_ABORT)c=!0,h=a.abortReason,i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else if(a.status===bf.RUN)if(a.retryCount>=cf.MAX_TRANSACTION_RETRIES_)c=!0,h="maxretry",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0));else{var l=this.getLatestState_(a.path,o);a.currentInputSnapshot=l;var f=t[s].update(l.val());if(void 0!==f){Ju("transaction failed: Data returned ",f,a.path);var p=$c(f);"object"==typeof f&&null!=f&&$s(f,".priority")||(p=p.updatePriority(l.getPriority()));var d=a.currentWriteId,v=this.generateServerValues(),y=Eh(p,v);a.currentOutputSnapshotRaw=p,a.currentOutputSnapshotResolved=y,a.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(d),1),i=(i=i.concat(this.serverSyncTree_.applyUserOverwrite(a.path,y,a.currentWriteId,a.applyLocally))).concat(this.serverSyncTree_.ackUserWrite(d,!0))}else c=!0,h="nodata",i=i.concat(this.serverSyncTree_.ackUserWrite(a.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,i),i=[],c&&(t[s].status=bf.COMPLETED,n=t[s].unwatcher,setTimeout(n,Math.floor(0)),t[s].onComplete))if("nodata"===h){var g=new mf(this,t[s].path),m=t[s].currentInputSnapshot,w=new ih(m,g,Sc);r.push(t[s].onComplete.bind(null,null,!1,w))}else r.push(t[s].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(s=0;s<r.length;s++)Eu(r[s]);this.sendReadyTransactions_()}},cf.prototype.getAncestorTransactionNode_=function(t){var e,n=this.transactionQueueTree_;for(e=t.getFront();null!==e&&null===n.getValue();)n=n.subTree(e),e=(t=t.popFront()).getFront();return n},cf.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},cf.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},cf.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==bf.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(0<n.length?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},cf.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},cf.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===bf.SENT_NEEDS_ABORT);else if(e[o].status===bf.SENT)Ps(i===o-1,"All SENT items should be at beginning of queue."),e[i=o].status=bf.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(Ps(e[o].status===bf.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(o=0;o<n.length;o++)Eu(n[o])}};var Sf,Cf="databaseURL",Nf=(Af.getInstance=function(){return Sf=Sf||new Af},Af.prototype.interrupt=function(){var e,t,n,r;try{for(var i=Ss(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,Ss(Object.keys(this.repos_[s]))),u=a.next();!u.done;u=a.next()){var c=u.value;this.repos_[s][c].interrupt()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Af.prototype.resume=function(){var e,t,n,r;try{for(var i=Ss(Object.keys(this.repos_)),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var a=(n=void 0,Ss(Object.keys(this.repos_[s]))),u=a.next();!u.done;u=a.next()){var c=u.value;this.repos_[s][c].resume()}}catch(t){n={error:t}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}},Af.prototype.databaseFromApp=function(t,e,n){var r=n||t.options[Cf];void 0===r&&nu("Can't determine Firebase Database URL.  Be sure to include "+Cf+" option when calling firebase.initializeApp().");var i=Lu(r),o=i.repoInfo,s=void 0;return"undefined"!=typeof process&&(s=process.env.FIREBASE_DATABASE_EMULATOR_HOST),s&&(r="http://"+s+"?ns="+o.namespace,o=(i=Lu(r)).repoInfo),Ku("Invalid Firebase Database URL",1,i),i.path.isEmpty()||nu("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(o,t,e).database},Af.prototype.deleteRepo=function(t){var e=Zs(this.repos_,t.app.name);e&&Zs(e,t.repoInfo_.toURLString())===t||nu("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},Af.prototype.createRepo=function(t,e,n){var r=Zs(this.repos_,e.name);r||(r={},this.repos_[e.name]=r);var i=Zs(r,t.toURLString());return i&&nu("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),i=new cf(t,this.useRestClient_,e,n),r[t.toURLString()]=i},Af.prototype.forceRestClient=function(t){this.useRestClient_=t},Af);function Af(){this.repos_={},this.useRestClient_=!1}var kf=(Object.defineProperty(Rf.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),Rf.prototype.ref=function(t){return this.checkDeleted_("ref"),ua("database.ref",0,1,arguments.length),t instanceof mf?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},Rf.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),ua(e,1,1,arguments.length);var n=Lu(t);Ku(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&nu(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},Rf.prototype.checkDeleted_=function(t){null===this.repo_&&nu("Cannot call "+t+" on a deleted database.")},Rf.prototype.goOffline=function(){ua("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},Rf.prototype.goOnline=function(){ua("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},Rf.ServerValue={TIMESTAMP:{".sv":"timestamp"}},Rf);function Rf(t){(this.repo_=t)instanceof cf||nu("Don't call new Database() directly - please use firebase.database()."),this.root_=new mf(t,Cu.Empty),this.INTERNAL=new Of(this)}var Of=(Pf.prototype.delete=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return this.database.checkDeleted_("delete"),Nf.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},Pf);function Pf(t){this.database=t}var Df=Object.freeze({__proto__:null,forceLongPolling:function(){zl.forceDisallow(),Vl.forceAllow()},forceWebSockets:function(){Vl.forceDisallow()},isWebSocketsAvailable:function(){return zl.isAvailable()},setSecurityDebugCallback:function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},stats:function(t,e){t.repo.stats(e)},statsIncrementCounter:function(t,e){t.repo.statsIncrementCounter(e)},dataUpdateCount:function(t){return t.repo.dataUpdateCount},interceptServerData:function(t,e){return t.repo.interceptServerData_(e)}}),xf=nf;nf.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},nf.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Lf,Mf,Uf=Jl,Ff=Du,jf=Object.freeze({__proto__:null,DataConnection:xf,RealTimeConnection:Uf,hijackHash:function(i){var o=nf.prototype.put;return nf.prototype.put=function(t,e,n,r){void 0!==r&&(r=i()),o.call(this,t,e,n,r)},function(){nf.prototype.put=o}},ConnectionTarget:Ff,queryIdentifier:function(t){return t.queryIdentifier()},forceRestClient:function(t){Nf.getInstance().forceRestClient(t)}}),qf=kf.ServerValue;Lf=(Mf=fl).SDK_VERSION,Gl=Lf,Mf.INTERNAL.registerComponent(new pa("database",function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return Nf.getInstance().databaseFromApp(n,r,e)},"PUBLIC").setServiceProps({Reference:mf,Query:vh,Database:kf,DataSnapshot:ih,enableLogging:$a,INTERNAL:Df,ServerValue:qf,TEST_ACCESS:jf}).setMultipleInstances(!0)),Mf.registerVersion("@firebase/database","0.5.21");var Vf,Bf="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Wf=Wf||{},Hf=Bf;function Gf(t){return"string"==typeof t}function Kf(t){return"number"==typeof t}function zf(t,e){t=t.split("."),e=e||Hf;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function Qf(){}function Yf(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e}function Xf(t){return"array"==Yf(t)}function Jf(t){var e=Yf(t);return"array"==e||"object"==e&&"number"==typeof t.length}function $f(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var Zf="closure_uid_"+(1e9*Math.random()>>>0),tp=0;function ep(t,e,n){return t.call.apply(t.bind,arguments)}function np(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function rp(t,e,n){return(rp=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ep:np).apply(null,arguments)}function ip(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var op=Date.now||function(){return+new Date};function sp(t,o){function e(){}e.prototype=o.prototype,t.N=o.prototype,t.prototype=new e,(t.prototype.constructor=t).xb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function ap(){this.j=this.j,this.i=this.i}ap.prototype.j=!1,ap.prototype.la=function(){if(!this.j&&(this.j=!0,this.G(),0))this[Zf]||(this[Zf]=++tp)},ap.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var up=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(Gf(t))return Gf(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},cp=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=Gf(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function hp(){return Array.prototype.concat.apply([],arguments)}function lp(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function fp(t){return/^[\s\xa0]*$/.test(t)}var pp,dp=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function vp(t,e){return-1!=t.indexOf(e)}function yp(t,e){return t<e?-1:e<t?1:0}t:{var gp=Hf.navigator;if(gp){var mp=gp.userAgent;if(mp){pp=mp;break t}}pp=""}function wp(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function bp(t){var e,n={};for(e in t)n[e]=t[e];return n}var _p="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Ep(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<_p.length;i++)e=_p[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Ip(t){return Ip[" "](t),t}Ip[" "]=Qf;var Tp,Sp,Cp=vp(pp,"Opera"),Np=vp(pp,"Trident")||vp(pp,"MSIE"),Ap=vp(pp,"Edge"),kp=Ap||Np,Rp=vp(pp,"Gecko")&&!(vp(pp.toLowerCase(),"webkit")&&!vp(pp,"Edge"))&&!(vp(pp,"Trident")||vp(pp,"MSIE"))&&!vp(pp,"Edge"),Op=vp(pp.toLowerCase(),"webkit")&&!vp(pp,"Edge");function Pp(){var t=Hf.document;return t?t.documentMode:void 0}t:{var Dp="",xp=(Sp=pp,Rp?/rv:([^\);]+)(\)|;)/.exec(Sp):Ap?/Edge\/([\d\.]+)/.exec(Sp):Np?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Sp):Op?/WebKit\/(\S+)/.exec(Sp):Cp?/(?:Version)[ \/]?(\S+)/.exec(Sp):void 0);if(xp&&(Dp=xp?xp[1]:""),Np){var Lp=Pp();if(null!=Lp&&Lp>parseFloat(Dp)){Tp=String(Lp);break t}}Tp=Dp}var Mp,Up={};function Fp(a){return function(t,e){var n=Up;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}(a,function(){for(var t=0,e=dp(String(Tp)).split("."),n=dp(String(a)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++){var o=e[i]||"",s=n[i]||"";do{if(o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==o[0].length&&0==s[0].length)break;t=yp(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||yp(0==o[2].length,0==s[2].length)||yp(o[2],s[2]),o=o[3],s=s[3]}while(0==t)}return 0<=t})}var jp=Hf.document;Mp=jp&&Np?Pp()||("CSS1Compat"==jp.compatMode?parseInt(Tp,10):5):void 0;var qp=!Np||9<=Number(Mp),Vp=Np&&!Fp("9"),Bp=function(){if(!Hf.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{Hf.addEventListener("test",Qf,e),Hf.removeEventListener("test",Qf,e)}catch(t){}return t}();function Wp(t,e){this.type=t,this.a=this.target=e,this.Ia=!0}function Hp(t,e){if(Wp.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Rp){t:{try{Ip(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=Gf(t.pointerType)?t.pointerType:Gp[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}Wp.prototype.b=function(){this.Ia=!1},sp(Hp,Wp);var Gp={2:"touch",3:"pen",4:"mouse"};Hp.prototype.b=function(){Hp.N.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,Vp)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var Kp="closure_listenable_"+(1e6*Math.random()|0),zp=0;function Qp(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.da=i,this.key=++zp,this.X=this.Z=!1}function Yp(t){t.X=!0,t.listener=null,t.proxy=null,t.src=null,t.da=null}function Xp(t){this.src=t,this.a={},this.b=0}function Jp(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=up(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(Yp(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function $p(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.X&&o.listener==e&&o.capture==!!n&&o.da==r)return i}return-1}Xp.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=$p(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new Qp(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Zp="closure_lm_"+(1e6*Math.random()|0),td={};function ed(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Xf(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}r=cd(r);return e&&e[Kp]?e.Aa(n,r,$f(i)?!!i.capture:!!i,o):nd(e,n,r,!0,i,o)}(t,e,n,r,i);if(Xf(e)){for(var o=0;o<e.length;o++)ed(t,e[o],n,r,i);return null}return n=cd(n),t&&t[Kp]?t.za(e,n,$f(r)?!!r.capture:!!r,i):nd(t,e,n,!1,r,i)}function nd(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=$f(i)?!!i.capture:!!i;if(s&&!qp)return null;var a=ad(t);if(a||(t[Zp]=a=new Xp(t)),(n=a.add(e,n,r,s,o)).proxy)return n;if(r=function(){var e=sd,n=qp?function(t){return e.call(n.src,n.listener,t)}:function(t){if(!(t=e.call(n.src,n.listener,t)))return t};return n}(),(n.proxy=r).src=t,r.listener=n,t.addEventListener)Bp||(i=s),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(id(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function rd(t){if(!Kf(t)&&t&&!t.X){var e=t.src;if(e&&e[Kp])Jp(e.c,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(id(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=ad(e))?(Jp(n,t),0==n.b&&(n.src=null,e[Zp]=null)):Yp(t)}}}function id(t){return t in td?td[t]:td[t]="on"+t}function od(t,e){var n=t.listener,r=t.da||t.src;return t.Z&&rd(t),n.call(r,e)}function sd(t,e){return!!t.X||(qp?od(t,new Hp(e,this)):od(t,e=new Hp(e||zf("window.event"),this)))}function ad(t){return(t=t[Zp])instanceof Xp?t:null}var ud="__closure_events_fn_"+(1e9*Math.random()>>>0);function cd(e){return"function"==Yf(e)?e:(e[ud]||(e[ud]=function(t){return e.handleEvent(t)}),e[ud])}function hd(){ap.call(this),this.c=new Xp(this),(this.J=this).B=null}function ld(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s=e[o];if(s&&!s.X&&s.capture==n){var a=s.listener,u=s.da||s.src;s.Z&&Jp(t.c,s),i=!1!==a.call(u,r)&&i}}return i&&0!=r.Ia}sp(hd,ap),hd.prototype[Kp]=!0,(Vf=hd.prototype).addEventListener=function(t,e,n,r){ed(this,t,e,n,r)},Vf.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Xf(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=$f(i)?!!i.capture:!!i,r=cd(r),e&&e[Kp]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=$p(s=e.a[n],r,i,o))&&(Yp(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&ad(e))&&(n=e.a[n.toString()],e=-1,n&&(e=$p(n,r,i,o)),(r=-1<e?n[e]:null)&&rd(r))}(this,t,e,n,r)},Vf.dispatchEvent=function(t){var e,n=this.B;if(n)for(e=[];n;n=n.B)e.push(n);n=this.J;var r=t.type||t;if(Gf(t))t=new Wp(t,n);else if(t instanceof Wp)t.target=t.target||n;else{var i=t;Ep(t=new Wp(r,n),i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var s=t.a=e[o];i=ld(s,r,!0,t)&&i}if(i=ld(s=t.a=n,r,!0,t)&&i,i=ld(s,r,!1,t)&&i,e)for(o=0;o<e.length;o++)i=ld(s=t.a=e[o],r,!1,t)&&i;return i},Vf.G=function(){if(hd.N.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Yp(n[r]);delete e.a[t],e.b--}}this.B=null},Vf.za=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},Vf.Aa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var fd=Hf.JSON.stringify;function pd(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function dd(){this.b=this.a=null}pd.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var vd,yd=new pd(function(){return new gd},function(t){t.reset()});function gd(){this.next=this.b=this.a=null}function md(t){Hf.setTimeout(function(){throw t},0)}function wd(t,e){vd||function(){var t=Hf.Promise.resolve(void 0);vd=function(){t.then(Ed)}}(),bd||(vd(),bd=!0),_d.add(t,e)}dd.prototype.add=function(t,e){var n=yd.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},gd.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var bd=!(gd.prototype.reset=function(){this.next=this.b=this.a=null}),_d=new dd;function Ed(){for(var t;r=n=void 0,r=null,(n=_d).a&&(r=n.a,n.a=n.a.next,n.a||(n.b=null),r.next=null),t=r;){try{t.a.call(t.b)}catch(t){md(t)}var e=yd;e.f(t),e.b<100&&(e.b++,t.next=e.a,e.a=t)}var n,r;bd=!1}function Id(t,e){hd.call(this),this.b=t||1,this.a=e||Hf,this.f=rp(this.fb,this),this.g=op()}function Td(t){t.ba=!1,t.L&&(t.a.clearTimeout(t.L),t.L=null)}function Sd(t,e,n){if("function"==Yf(t))n&&(t=rp(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=rp(t.handleEvent,t)}return 2147483647<Number(e)?-1:Hf.setTimeout(t,e||0)}function Cd(t,e,n){ap.call(this),this.f=null!=n?rp(t,n):t,this.c=e,this.b=rp(this.$a,this),this.a=[]}function Nd(t){t.U=Sd(t.b,t.c),t.f.apply(null,t.a)}function Ad(t){ap.call(this),this.b=t,this.a={}}sp(Id,hd),(Vf=Id.prototype).ba=!1,Vf.L=null,Vf.fb=function(){if(this.ba){var t=op()-this.g;0<t&&t<.8*this.b?this.L=this.a.setTimeout(this.f,this.b-t):(this.L&&(this.a.clearTimeout(this.L),this.L=null),this.dispatchEvent("tick"),this.ba&&(Td(this),this.start()))}},Vf.start=function(){this.ba=!0,this.L||(this.L=this.a.setTimeout(this.f,this.b),this.g=op())},Vf.G=function(){Id.N.G.call(this),Td(this),delete this.a},sp(Cd,ap),(Vf=Cd.prototype).ea=!1,Vf.U=null,Vf.Ta=function(t){this.a=arguments,this.U?this.ea=!0:Nd(this)},Vf.G=function(){Cd.N.G.call(this),this.U&&(Hf.clearTimeout(this.U),this.U=null,this.ea=!1,this.a=[])},Vf.$a=function(){this.U=null,this.ea&&(this.ea=!1,Nd(this))},sp(Ad,ap);var kd=[];function Rd(t,e,n,r){Xf(n)||(n&&(kd[0]=n.toString()),n=kd);for(var i=0;i<n.length;i++){var o=ed(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function Od(t){wp(t.a,function(t,e){this.a.hasOwnProperty(e)&&rd(t)},t),t.a={}}function Pd(){}Ad.prototype.G=function(){Ad.N.G.call(this),Od(this)},Ad.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dd=new hd;function xd(t){Wp.call(this,"serverreachability",t)}function Ld(t){Dd.dispatchEvent(new xd(Dd,t))}function Md(t){Wp.call(this,"statevent",t)}function Ud(t){Dd.dispatchEvent(new Md(Dd,t))}function Fd(t){Wp.call(this,"timingevent",t)}function jd(t,e){if("function"!=Yf(t))throw Error("Fn must not be null and must be a function");return Hf.setTimeout(function(){t()},e)}sp(xd,Wp),sp(Md,Wp),sp(Fd,Wp);var qd={NO_ERROR:0,gb:1,nb:2,mb:3,jb:4,lb:5,ob:6,La:7,TIMEOUT:8,rb:9},Vd={ib:"complete",vb:"success",Ma:"error",La:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",kb:"downloadprogress",wb:"uploadprogress"};function Bd(){}function Wd(t){var e;return(e=t.a)||(e=t.a={}),e}function Hd(){}Bd.prototype.a=null;var Gd,Kd={OPEN:"a",hb:"b",Ma:"c",qb:"d"};function zd(){Wp.call(this,"d")}function Qd(){Wp.call(this,"c")}function Yd(){}function Xd(t,e,n){this.g=t,this.W=e,this.V=n||1,this.I=new Ad(this),this.O=Jd,t=kp?125:void 0,this.P=new Id(t),this.h=null,this.b=!1,this.l=this.D=this.f=this.F=this.v=this.R=this.i=null,this.j=[],this.a=null,this.A=0,this.c=this.w=null,this.o=-1,this.m=!1,this.J=0,this.B=null,this.s=this.S=this.H=!1}sp(zd,Wp),sp(Qd,Wp),sp(Yd,Bd),Gd=new Yd;var Jd=45e3,$d={},Zd={};function tv(t,e,n){t.F=1,t.f=Sv(mv(e)),t.l=n,t.H=!0,nv(t,null)}function ev(t,e,n,r){t.F=1,t.f=Sv(mv(e)),t.l=null,t.H=n,nv(t,r)}function nv(t,e){t.v=op(),ov(t),t.D=mv(t.f),Tv(t.D,"t",t.V),t.A=0,t.a=t.g.$(t.g.Y()?e:null),0<t.J&&(t.B=new Cd(rp(t.Ja,t,t.a),t.J)),Rd(t.I,t.a,"readystatechange",t.cb),e=t.h?bp(t.h):{},t.l?(t.w||(t.w="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ca(t.D,t.w,t.l,e)):(t.w="GET",t.a.ca(t.D,t.w,null,e)),Ld(1)}function rv(t,e,n){for(var r=!0;!t.m&&t.A<n.length;){var i=iv(t,n);if(i==Zd){4==e&&(t.c=4,Ud(14),r=!1);break}if(i==$d){t.c=4,Ud(15),r=!1;break}hv(t,i)}4==e&&0==n.length&&(t.c=1,Ud(16),r=!1),t.b=t.b&&r,r||(cv(t),uv(t))}function iv(t,e){var n=t.A,r=e.indexOf("\n",n);return-1==r?Zd:(n=Number(e.substring(n,r)),isNaN(n)?$d:(r+=1)+n>e.length?Zd:(e=e.substr(r,n),t.A=r+n,e))}function ov(t){t.R=op()+t.O,sv(t,t.O)}function sv(t,e){if(null!=t.i)throw Error("WatchDog timer not null");t.i=jd(rp(t.ab,t),e)}function av(t){t.i&&(Hf.clearTimeout(t.i),t.i=null)}function uv(t){t.g.Ca()||t.m||t.g.na(t)}function cv(t){av(t);var e=t.B;e&&"function"==typeof e.la&&e.la(),t.B=null,Td(t.P),Od(t.I),t.a&&(e=t.a,t.a=null,e.abort(),e.la())}function hv(t,e){try{t.g.Fa(t,e),Ld(4)}catch(t){}}function lv(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(Jf(t)||Gf(t))cp(t,e,void 0);else{if(t.K&&"function"==typeof t.K)var n=t.K();else if(t.C&&"function"==typeof t.C)n=void 0;else if(Jf(t)||Gf(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.C&&"function"==typeof t.C)return t.C();if(Gf(t))return t.split("");if(Jf(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function fv(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof fv)for(n=t.K(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function pv(t,e){vv(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&dv(t))}function dv(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];vv(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)vv(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function vv(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(Vf=Xd.prototype).setTimeout=function(t){this.O=t},Vf.cb=function(t){t=t.target;var e=this.B;e&&3==gy(t)?e.Ta():this.Ja(t)},Vf.Ja=function(t){try{if(t==this.a)t:{var e=gy(this.a),n=this.a.ya(),r=this.a.T();if(!(e<3||3==e&&!kp&&!this.a.aa())){this.m||4!=e||7==n||Ld(8==n||r<=0?3:2),av(this);var i=this.a.T();this.o=i;var o=this.a.aa();if(this.b=200==i){if(this.S&&!this.s){e:{if(this.a){var s=my(this.a,"X-HTTP-Initial-Response");if(s&&!fp(s)){var a=s;break e}}a=null}if(!a){this.b=!1,this.c=3,Ud(12),cv(this),uv(this);break t}this.s=!0,hv(this,a)}this.H?(rv(this,e,o),kp&&this.b&&3==e&&(Rd(this.I,this.P,"tick",this.bb),this.P.start())):hv(this,o),4==e&&cv(this),this.b&&!this.m&&(4==e?this.g.na(this):(this.b=!1,ov(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.c=3,Ud(12)):(this.c=0,Ud(13)),cv(this),uv(this)}}}catch(t){}},Vf.bb=function(){if(this.a){var t=gy(this.a),e=this.a.aa();this.A<e.length&&(av(this),rv(this,t,e),this.b&&4!=t&&ov(this))}},Vf.cancel=function(){this.m=!0,cv(this)},Vf.ab=function(){this.i=null;var t=op();0<=t-this.R?(2!=this.F&&(Ld(3),Ud(17)),cv(this),this.c=2,uv(this)):sv(this,this.R-t)},(Vf=fv.prototype).C=function(){dv(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},Vf.K=function(){return dv(this),this.a.concat()},Vf.get=function(t,e){return vv(this.b,t)?this.b[t]:e},Vf.set=function(t,e){vv(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},Vf.forEach=function(t,e){for(var n=this.K(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var yv=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^/?#]*)@)?([^/#?]*?)(?::([0-9]+))?(?=[/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function gv(t,e){var n;this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1,t instanceof gv?(this.h=void 0!==e?e:t.h,wv(this,t.f),this.j=t.j,bv(this,t.b),_v(this,t.i),this.a=t.a,Ev(this,jv(t.c)),this.g=t.g):t&&(n=String(t).match(yv))?(this.h=!!e,wv(this,n[1]||"",!0),this.j=Cv(n[2]||""),bv(this,n[3]||"",!0),_v(this,n[4]),this.a=Cv(n[5]||"",!0),Ev(this,n[6]||"",!0),this.g=Cv(n[7]||"")):(this.h=!!e,this.c=new xv(null,this.h))}function mv(t){return new gv(t)}function wv(t,e,n){t.f=n?Cv(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function bv(t,e,n){t.b=n?Cv(e,!0):e}function _v(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.i=e}else t.i=null}function Ev(t,e,n){e instanceof xv?(t.c=e,function(t,e){e&&!t.f&&(Lv(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Mv(this,e),Fv(this,n,t))},t)),t.f=e}(t.c,t.h)):(n||(e=Nv(e,Pv)),t.c=new xv(e,t.h))}function Iv(t,e,n){t.c.set(e,n)}function Tv(t,e,n){Xf(n)||(n=[String(n)]),Fv(t.c,e,n)}function Sv(t){return Iv(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^op()).toString(36)),t}function Cv(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Nv(t,e,n){return Gf(t)?(t=encodeURI(t).replace(e,Av),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Av(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}gv.prototype.toString=function(){var t=[],e=this.f;e&&t.push(Nv(e,kv,!0),":");var n=this.b;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(Nv(e,kv,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(Nv(n,"/"==n.charAt(0)?Ov:Rv,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",Nv(n,Dv)),t.join("")},gv.prototype.resolve=function(t){var e=mv(this),n=!!t.f;n?wv(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?bv(e,t.b):n=null!=t.i;var r=t.a;if(n)_v(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(vp(i,"./")||vp(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],s=0;s<i.length;){var a=i[s++];"."==a?r&&s==i.length&&o.push(""):".."==a?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&s==i.length&&o.push("")):(o.push(a),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?Ev(e,jv(t.c)):n=!!t.g,n&&(e.g=t.g),e};var kv=/[#\/\?@]/g,Rv=/[#\?:]/g,Ov=/[#\?]/g,Pv=/[#\?@]/g,Dv=/#/g;function xv(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function Lv(n){n.a||(n.a=new fv,n.b=0,n.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(n.c,function(t,e){n.add(decodeURIComponent(t.replace(/\+/g," ")),e)}))}function Mv(t,e){Lv(t),e=qv(t,e),vv(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,pv(t.a,e))}function Uv(t,e){return Lv(t),e=qv(t,e),vv(t.a.b,e)}function Fv(t,e,n){Mv(t,e),0<n.length&&(t.c=null,t.a.set(qv(t,e),lp(n)),t.b+=n.length)}function jv(t){var e=new xv;return e.c=t.c,t.a&&(e.a=new fv(t.a),e.b=t.b),e}function qv(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Vv(t){this.a=t,this.b=this.h=null,this.g=!1,this.i=null,this.c=-1,this.l=this.f=null}function Bv(t){var e=t.a.F.a;if(null!=e)Ud(4),e?(Ud(10),Ry(t.a,t,!1)):(Ud(11),Ry(t.a,t,!0));else{t.b=new Xd(t,void 0,void 0),t.b.h=t.h,e=Ly(e=t.a,e.Y()?t.f:null,t.i),Ud(4),Tv(e,"TYPE","xmlhttp");var n=t.a.j,r=t.a.I;n&&r&&Iv(e,n,r),ev(t.b,e,!1,t.f)}}function Wv(){this.a=this.b=null}function Hv(){this.a=new fv}function Gv(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[Zf]||(t[Zf]=++tp)):e.charAt(0)+t}function Kv(t,e){this.b=t,this.a=e}function zv(t){this.g=t||Qv,t=Hf.PerformanceNavigationTiming?0<(t=Hf.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(Hf.ka&&Hf.ka.Da&&Hf.ka.Da()&&Hf.ka.Da().yb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Hv),this.b=null,this.c=[]}(Vf=xv.prototype).add=function(t,e){Lv(this),this.c=null,t=qv(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},Vf.forEach=function(n,r){Lv(this),this.a.forEach(function(t,e){cp(t,function(t){n.call(r,t,e,this)},this)},this)},Vf.K=function(){Lv(this);for(var t=this.a.C(),e=this.a.K(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},Vf.C=function(t){Lv(this);var e=[];if(Gf(t))Uv(this,t)&&(e=hp(e,this.a.get(qv(this,t))));else{t=this.a.C();for(var n=0;n<t.length;n++)e=hp(e,t[n])}return e},Vf.set=function(t,e){return Lv(this),this.c=null,Uv(this,t=qv(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},Vf.get=function(t,e){return t&&0<(t=this.C(t)).length?String(t[0]):e},Vf.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.K(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.C(r);for(var o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}}return this.c=t.join("&")},sp(function(){},function(){}),(Vf=Vv.prototype).M=null,Vf.$=function(t){return this.a.$(t)},Vf.abort=function(){this.b&&(this.b.cancel(),this.b=null),this.c=-1},Vf.Ca=function(){return!1},Vf.Fa=function(t,e){if(this.c=t.o,0==this.M){if(!this.a.o&&(t=t.a)){var n=my(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&(t=my(t,"X-HTTP-Session-Id"))&&(this.a.I=t)}if(e){try{var r=this.a.ja.a.parse(e)}catch(t){return(e=this.a).m=this.c,void Dy(e,2)}this.f=r[0]}else(e=this.a).m=this.c,Dy(e,2)}else 1==this.M&&(this.g?Ud(6):"11111"==e?(Ud(5),this.g=!0,(!Np||10<=Number(Mp))&&(this.c=200,this.b.cancel(),Ud(11),Ry(this.a,this,!0))):(Ud(7),this.g=!1))},Vf.na=function(){if(this.c=this.b.o,this.b.b)0==this.M?(this.M=1,Bv(this)):1==this.M&&(this.g?(Ud(11),Ry(this.a,this,!0)):(Ud(10),Ry(this.a,this,!1)));else{0==this.M?Ud(8):1==this.M&&Ud(9);var t=this.a;t.m=this.c,Dy(t,2)}},Vf.Y=function(){return this.a.Y()},Vf.ma=function(){return this.a.ma()},Hv.prototype.add=function(t){this.a.set(Gv(t),t)},Hv.prototype.C=function(){return this.a.C()};var Qv=10;function Yv(t,e){!t.a&&(vp(e,"spdy")||vp(e,"quic")||vp(e,"h2"))&&(t.f=t.g,t.a=new Hv,t.b&&(Zv(t,t.b),t.b=null))}function Xv(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function Jv(t){return t.b?1:t.a?t.a.a.c:0}function $v(t,e){return t=t.b?t.b==e:!!t.a&&(e=Gv(e),vv(t.a.a.b,e))}function Zv(t,e){t.a?t.a.add(e):t.b=e}function ty(t,e){var n;t.b&&t.b==e?t.b=null:((n=t.a)&&(n=Gv(e),n=vv(t.a.a.b,n)),n&&pv(t.a.a,Gv(e)))}function ey(t){if(null!=t.b)return t.c.concat(t.b.j);if(null==t.a||0==t.a.a.c)return lp(t.c);var e=t.c;return cp(t.a.C(),function(t){e=e.concat(t.j)}),e}function ny(){}function ry(){this.a=new ny}function iy(t,r,e){var i=e||"";try{lv(t,function(t,e){var n=t;$f(t)&&(n=fd(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}function oy(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}zv.prototype.cancel=function(){this.c=ey(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(cp(this.a.C(),function(t){t.cancel()}),function(t){t.b={},t.a.length=0,t.c=0}(this.a.a))},ny.prototype.stringify=function(t){return Hf.JSON.stringify(t,void 0)},ny.prototype.parse=function(t){return Hf.JSON.parse(t,void 0)};var sy=Hf.JSON.parse;function ay(t){hd.call(this),this.headers=new fv,this.H=t||null,this.b=!1,this.s=this.a=null,this.A="",this.h=0,this.f="",this.g=this.w=this.l=this.v=!1,this.o=0,this.m=null,this.I=uy,this.D=this.F=!1}sp(ay,hd);var uy="",cy=/^https?$/i,hy=["POST","PUT"];function ly(t){return"content-type"==t.toLowerCase()}function fy(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,py(t),vy(t)}function py(t){t.v||(t.v=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function dy(t){if(t.b&&void 0!==Wf&&(!t.s[1]||4!=gy(t)||2!=t.T()))if(t.l&&4==gy(t))Sd(t.Ea,0,t);else if(t.dispatchEvent("readystatechange"),4==gy(t)){t.b=!1;try{var e,n=t.T();t:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}if(!(e=r)){var i;if(i=0===n){var o=String(t.A).match(yv)[1]||null;if(!o&&Hf.self&&Hf.self.location){var s=Hf.self.location.protocol;o=s.substr(0,s.length-1)}i=!cy.test(o?o.toLowerCase():"")}e=i}if(e)t.dispatchEvent("complete"),t.dispatchEvent("success");else{t.h=6;try{var a=2<gy(t)?t.a.statusText:""}catch(t){a=""}t.f=a+" ["+t.T()+"]",py(t)}}finally{vy(t)}}}function vy(t,e){if(t.a){yy(t);var n=t.a,r=t.s[0]?Qf:null;t.a=null,t.s=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(t){}}}function yy(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(Hf.clearTimeout(t.m),t.m=null)}function gy(t){return t.a?t.a.readyState:0}function my(t,e){return t.a?t.a.getResponseHeader(e):null}function wy(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=function(t){var n="";return wp(t,function(t,e){n+=e,n+=":",n+=t,n+="\r\n"}),n}(n),Gf(t)){if(e=encodeURIComponent(String(e)),e+=n=null!=n?"="+encodeURIComponent(String(n)):""){if((n=t.indexOf("#"))<0&&(n=t.length),(r=t.indexOf("?"))<0||n<r){r=n;var i=""}else i=t.substring(r+1,n);n=(t=[t.substr(0,r),i,t.substr(n)])[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return Iv(t,e,n),t}function by(t){this.f=[],this.F=new Wv,this.ga=this.pa=this.B=this.ha=this.a=this.I=this.j=this.V=this.g=this.J=this.i=null,this.Qa=this.P=0,this.Oa=!!zf("internalChannelParams.failFast",t),this.ia=this.w=this.s=this.l=this.h=this.c=null,this.oa=!0,this.m=this.ra=this.O=-1,this.S=this.v=this.A=0,this.Na=zf("internalChannelParams.baseRetryDelayMs",t)||5e3,this.Ra=zf("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Pa=zf("internalChannelParams.forwardChannelMaxRetries",t)||2,this.qa=zf("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ka=t&&t.zb||void 0,this.D=void 0,this.R=t&&t.supportsCrossDomainXhr||!1,this.H="",this.b=new zv(t&&t.concurrentRequestLimit),this.ja=new ry,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.W=t&&t.fastHandshake||!1)&&!this.o&&(this.o=!0),t&&t.forceLongPolling&&(this.oa=!1),this.fa=void 0}function _y(t){if(Ey(t),3==t.u){var e=t.P++,n=mv(t.B);Iv(n,"SID",t.H),Iv(n,"RID",e),Iv(n,"TYPE","terminate"),Cy(t,n),(e=new Xd(t,e,void 0)).F=2,e.f=Sv(mv(n)),n=!1,Hf.navigator&&Hf.navigator.sendBeacon&&(n=Hf.navigator.sendBeacon(e.f.toString(),"")),!n&&Hf.Image&&((new Image).src=e.f,n=!0),n||(e.a=e.g.$(null),e.a.ca(e.f)),e.v=op(),ov(e)}xy(t)}function Ey(t){t.w&&(t.w.abort(),t.w=null),t.a&&(t.a.cancel(),t.a=null),t.l&&(Hf.clearTimeout(t.l),t.l=null),Oy(t),t.b.cancel(),t.h&&(Kf(t.h)&&Hf.clearTimeout(t.h),t.h=null)}function Iy(t,e){t.f.push(new Kv(t.Qa++,e)),3==t.u&&Ty(t)}function Ty(t){Xv(t.b)||t.h||(t.h=!0,wd(t.Ha,t),t.A=0)}function Sy(t,e){var n;n=e?e.W:t.P++;var r=mv(t.B);Iv(r,"SID",t.H),Iv(r,"RID",n),Iv(r,"AID",t.O),Cy(t,r),t.g&&t.i&&wy(r,t.g,t.i),n=new Xd(t,n,t.A+1),null===t.g&&(n.h=t.i),e&&(t.f=e.j.concat(t.f)),e=Ny(t,n,1e3),n.setTimeout(Math.round(.5*t.qa)+Math.round(.5*t.qa*Math.random())),Zv(t.b,n),tv(n,r,e)}function Cy(t,n){t.c&&lv({},function(t,e){Iv(n,e,t)})}function Ny(t,e,n){n=Math.min(t.f.length,n);var r=t.c?rp(t.c.Sa,t.c,t):null;t:for(var i=t.f,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var a=!0,u=0;u<n;u++){var c=i[u].b,h=i[u].a;if((c-=o)<0)o=Math.max(0,i[u].b-100),a=!1;else try{iy(h,s,"req"+c+"_")}catch(t){r&&r(h)}}if(a){r=s.join("&");break t}}return t=t.f.splice(0,n),e.j=t,r}function Ay(t){t.a||t.l||(t.S=1,wd(t.Ga,t),t.v=0)}function ky(t){return!(t.a||t.l||3<=t.v)&&(t.S++,t.l=jd(rp(t.Ga,t),Py(t,t.v)),t.v++,!0)}function Ry(t,e,n){var r=e.l;r&&Yv(t.b,r),t.ia=t.oa&&n,t.m=e.c,t.B=Ly(t,null,t.ha),Ty(t)}function Oy(t){null!=t.s&&(Hf.clearTimeout(t.s),t.s=null)}function Py(t,e){var n=t.Na+Math.floor(Math.random()*t.Ra);return t.ma()||(n*=2),n*e}function Dy(t,e){if(2==e){var n=null;t.c&&(n=null);var r=rp(t.eb,t);n||(n=new gv("//www.google.com/images/cleardot.gif"),Hf.location&&"http"==Hf.location.protocol||wv(n,"https"),Sv(n)),function(t,e){var n=new Pd;if(Hf.Image){var r=new Image;r.onload=ip(oy,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ip(oy,n,r,"TestLoadImage: error",!1,e),r.onabort=ip(oy,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ip(oy,n,r,"TestLoadImage: timeout",!1,e),Hf.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}(n.toString(),r)}else Ud(2);t.u=0,t.c&&t.c.ta(e),xy(t),Ey(t)}function xy(t){t.u=0,t.m=-1,t.c&&(0==ey(t.b).length&&0==t.f.length||(t.b.c.length=0,lp(t.f),t.f.length=0),t.c.sa())}function Ly(t,e,n){var r=function(t){return t instanceof gv?mv(t):new gv(t,void 0)}(n);if(""!=r.b)e&&bv(r,e+"."+r.b),_v(r,r.i);else{var i,o=Hf.location;i=e?e+"."+o.hostname:o.hostname,r=function(t,e,n,r){var i=new gv(null,void 0);return t&&wv(i,t),e&&bv(i,e),n&&_v(i,n),r&&(i.a=r),i}(o.protocol,i,+o.port,n)}return t.V&&wp(t.V,function(t,e){Iv(r,e,t)}),e=t.j,n=t.I,e&&n&&Iv(r,e,n),Iv(r,"VER",t.wa),Cy(t,r),r}function My(){}function Uy(){if(Np&&!(10<=Number(Mp)))throw Error("Environmental error: no available transport.")}function Fy(t,e){hd.call(this),this.a=new by(e),this.g=t,this.m=e&&e.testUrl?e.testUrl:function(t){for(var e=t,n=1;n<arguments.length;n++){var r,i=arguments[n];if(0==i.lastIndexOf("/",0))e=i;else(r=""==e)||(r=0<=(r=e.length-1)&&e.indexOf("/",r)==r),e+=r?i:"/"+i}return e}(this.g,"test"),this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.xa&&(t?t["X-WebChannel-Client-Profile"]=e.xa:t={"X-WebChannel-Client-Profile":e.xa}),this.a.J=t,(t=e&&e.httpHeadersOverwriteParam)&&!fp(t)&&(this.a.g=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.h=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!fp(e)&&(this.a.j=e,null!==(t=this.b)&&e in t&&(e in(t=this.b)&&delete t[e])),this.f=new Vy(this)}function jy(t){zd.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function qy(){Qd.call(this),this.status=1}function Vy(t){this.a=t}(Vf=ay.prototype).ca=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.A+"; newUri="+t);e=e?e.toUpperCase():"GET",this.A=t,this.f="",this.h=0,this.v=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Wd(this.H):Wd(Gd),this.a.onreadystatechange=rp(this.Ea,this);try{this.w=!0,this.a.open(e,String(t),!0),this.w=!1}catch(t){return void fy(this,t)}t=n||"";var i=new fv(this.headers);r&&lv(r,function(t,e){i.set(e,t)}),r=function(t){t:{for(var e=ly,n=t.length,r=Gf(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:Gf(t)?t.charAt(e):t[e]}(i.K()),n=Hf.FormData&&t instanceof Hf.FormData,0<=up(hy,e)&&!r&&!n&&i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{yy(this),0<this.o&&((this.D=function(t){return Np&&Fp(9)&&Kf(t.timeout)&&void 0!==t.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=rp(this.Ba,this)):this.m=Sd(this.Ba,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){fy(this,t)}},Vf.Ba=function(){void 0!==Wf&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,this.dispatchEvent("timeout"),this.abort(8))},Vf.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),vy(this))},Vf.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),vy(this,!0)),ay.N.G.call(this)},Vf.Ea=function(){this.j||(this.w||this.l||this.g?dy(this):this.Za())},Vf.Za=function(){dy(this)},Vf.T=function(){try{return 2<gy(this)?this.a.status:-1}catch(t){return-1}},Vf.aa=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},Vf.Ua=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),sy(e)}},Vf.ya=function(){return this.h},Vf.Xa=function(){return Gf(this.f)?this.f:String(this.f)},(Vf=by.prototype).wa=8,Vf.u=1,Vf.Ca=function(){return 0==this.u},Vf.Ha=function(t){if(this.h)if(this.h=null,1==this.u){if(!t){this.P=Math.floor(1e5*Math.random()),t=this.P++;var e,n=new Xd(this,t,void 0),r=this.i;if(this.J&&(r?Ep(r=bp(r),this.J):r=this.J),null===this.g&&(n.h=r),this.W)t:{for(var i=e=0;i<this.f.length;i++){var o=this.f[i];if(void 0===(o="__data__"in o.a&&Gf(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.f.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Ny(this,n,e),Iv(i=mv(this.B),"RID",t),Iv(i,"CVER",22),this.o&&this.j&&Iv(i,"X-HTTP-Session-Id",this.j),Cy(this,i),this.g&&r&&wy(i,this.g,r),Zv(this.b,n),this.W?(Iv(i,"$req",e),Iv(i,"SID","null"),n.S=!0,tv(n,i,null)):tv(n,i,e),this.u=2}}else 3==this.u&&(t?Sy(this,t):0==this.f.length||Xv(this.b)||Sy(this))},Vf.Ga=function(){this.l=null,this.a=new Xd(this,"rpc",this.S),null===this.g&&(this.a.h=this.i),this.a.J=0;var t=mv(this.pa);Iv(t,"RID","rpc"),Iv(t,"SID",this.H),Iv(t,"CI",this.ia?"0":"1"),Iv(t,"AID",this.O),Cy(this,t),Iv(t,"TYPE","xmlhttp"),this.g&&this.i&&wy(t,this.g,this.i),this.D&&this.a.setTimeout(this.D),ev(this.a,t,!0,this.ga)},Vf.Fa=function(t,e){if(0!=this.u&&(this.a==t||$v(this.b,t)))if(this.m=t.o,!t.s&&$v(this.b,t)&&3==this.u){try{var n=this.ja.a.parse(e)}catch(t){n=null}if(Xf(n)&&3==n.length){if(0==(e=n)[0]){t:if(!this.l){if(this.a){if(!(this.a.v+3e3<t.v))break t;Oy(this),this.a.cancel(),this.a=null}ky(this),Ud(18)}}else this.ra=e[1],0<this.ra-this.O&&e[2]<37500&&this.ia&&0==this.v&&!this.s&&(this.s=jd(rp(this.Ya,this),6e3));if(Jv(this.b)<=1&&this.fa){try{this.fa()}catch(t){}this.fa=void 0}}else Dy(this,11)}else if(!t.s&&this.a!=t||Oy(this),!fp(e))for(e=n=this.ja.a.parse(e),n=0;n<e.length;n++){var r=e[n];if(this.O=r[0],r=r[1],2==this.u)if("c"==r[0]){this.H=r[1],this.ga=r[2];var i=r[3];null!=i&&(this.wa=i),null!=(r=r[5])&&Kf(r)&&0<r&&(this.D=1.5*r),this.o&&(r=t.a)&&((i=my(r,"X-Client-Wire-Protocol"))&&Yv(this.b,i),this.j&&(r=my(r,"X-HTTP-Session-Id")))&&(this.I=r,Iv(this.B,this.j,r)),this.u=3,this.c&&this.c.va(),r=t,this.pa=Ly(this,this.Y()?this.ga:null,this.ha),r.s?(ty(this.b,r),(i=this.D)&&r.setTimeout(i),r.i&&(av(r),ov(r)),this.a=r):Ay(this),0<this.f.length&&Ty(this)}else"stop"!=r[0]&&"close"!=r[0]||Dy(this,7);else 3==this.u&&("stop"==r[0]||"close"==r[0]?"stop"==r[0]?Dy(this,7):_y(this):"noop"!=r[0]&&this.c&&this.c.ua(r),this.v=0)}},Vf.Ya=function(){null!=this.s&&(this.s=null,this.a.cancel(),this.a=null,ky(this),Ud(19))},Vf.na=function(t){var e=null;if(this.a==t){Oy(this),this.a=null;var n=2}else{if(!$v(this.b,t))return;e=t.j,ty(this.b,t),n=1}if(this.m=t.o,0!=this.u)if(t.b)1==n?(e=op()-t.v,Dd.dispatchEvent(new Fd(Dd,t.l?t.l.length:0,e,this.A)),Ty(this)):Ay(this);else{var r=t.c;if(3==r||0==r&&0<this.m||!(1==n&&function(t,e){return!(Jv(t.b)>=t.b.f-(t.h?1:0))&&(t.h?(t.f=e.j.concat(t.f),!0):!(1==t.u||2==t.u||t.A>=(t.Oa?0:t.Pa))&&(t.h=jd(rp(t.Ha,t,e),Py(t,t.A)),t.A++,!0))}(this,t)||2==n&&ky(this)))switch(e&&0<e.length&&(t=this.b,t.c=t.c.concat(e)),r){case 1:Dy(this,5);break;case 4:Dy(this,10);break;case 3:Dy(this,6);break;default:Dy(this,2)}}},Vf.eb=function(t){Ud(t?2:1)},Vf.$=function(t){if(t&&!this.R)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new ay(this.Ka)).F=this.R,t},Vf.ma=function(){return!!this.c&&!0},Vf.Y=function(){return this.R},(Vf=My.prototype).va=function(){},Vf.ua=function(){},Vf.ta=function(){},Vf.sa=function(){},Vf.Sa=function(){},Uy.prototype.a=function(t,e){return new Fy(t,e)},sp(Fy,hd),(Vf=Fy.prototype).addEventListener=function(t,e,n,r){Fy.N.addEventListener.call(this,t,e,n,r)},Vf.removeEventListener=function(t,e,n,r){Fy.N.removeEventListener.call(this,t,e,n,r)},Vf.Va=function(){this.a.c=this.f,this.l&&(this.a.R=!0);var t=this.a,e=this.m,n=this.g,r=this.b||void 0;Ud(0),t.ha=n,t.V=r||{},t.o&&(t.F.b=[],t.F.a=!1),t.w=new Vv(t),null===t.g&&(t.w.h=t.i),n=e,t.g&&t.i&&(n=wy(e,t.g,t.i)),(t=t.w).i=n,e=Ly(t.a,null,t.i),Ud(3),null!=(n=t.a.F.b)?(t.f=n[0],t.M=1,Bv(t)):(Tv(e,"MODE","init"),!t.a.o&&t.a.j&&Tv(e,"X-HTTP-Session-Id",t.a.j),t.b=new Xd(t,void 0,void 0),t.b.h=t.h,ev(t.b,e,!1,null),t.M=0)},Vf.close=function(){_y(this.a)},Vf.Wa=function(t){if(Gf(t)){var e={};e.__data__=t,Iy(this.a,e)}else this.h?((e={}).__data__=fd(t),Iy(this.a,e)):Iy(this.a,t)},Vf.G=function(){this.a.c=null,delete this.f,_y(this.a),delete this.a,Fy.N.G.call(this)},sp(jy,zd),sp(qy,Qd),sp(Vy,My),Vy.prototype.va=function(){this.a.dispatchEvent("a")},Vy.prototype.ua=function(t){this.a.dispatchEvent(new jy(t))},Vy.prototype.ta=function(t){this.a.dispatchEvent(new qy(t))},Vy.prototype.sa=function(){this.a.dispatchEvent("b")};var By=ip(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Uy);Uy.prototype.createWebChannel=Uy.prototype.a,Fy.prototype.send=Fy.prototype.Wa,Fy.prototype.open=Fy.prototype.Va,Fy.prototype.close=Fy.prototype.close,qd.NO_ERROR=0,qd.TIMEOUT=8,qd.HTTP_ERROR=6,Vd.COMPLETE="complete",(Hd.EventType=Kd).OPEN="a",Kd.CLOSE="b",Kd.ERROR="c",Kd.MESSAGE="d",hd.prototype.listen=hd.prototype.za,ay.prototype.listenOnce=ay.prototype.Aa,ay.prototype.getLastError=ay.prototype.Xa,ay.prototype.getLastErrorCode=ay.prototype.ya,ay.prototype.getStatus=ay.prototype.T,ay.prototype.getResponseJson=ay.prototype.Ua,ay.prototype.getResponseText=ay.prototype.aa,ay.prototype.send=ay.prototype.ca;var Wy,Hy,Gy={createWebChannelTransport:By,ErrorCode:qd,EventType:Vd,WebChannel:Hd,XhrIo:ay},Ky=Gy.createWebChannelTransport,zy=Gy.ErrorCode,Qy=Gy.EventType,Yy=Gy.WebChannel,Xy=Gy.XhrIo,Jy=fl.SDK_VERSION,$y=new Ca("@firebase/firestore");function Zy(){return $y.logLevel===ma.DEBUG?Wy.DEBUG:$y.logLevel===ma.SILENT?Wy.SILENT:Wy.ERROR}function tg(t){switch(t){case Wy.DEBUG:$y.logLevel=ma.DEBUG;break;case Wy.ERROR:$y.logLevel=ma.ERROR;break;case Wy.SILENT:$y.logLevel=ma.SILENT;break;default:$y.error("Firestore ("+Jy+"): Invalid value passed to `setLogLevel`")}}function eg(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if($y.logLevel<=ma.DEBUG){var i=n.map(rg);$y.debug.apply($y,As(["Firestore ("+Jy+") ["+t+"]: "+e],i))}}function ng(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if($y.logLevel<=ma.ERROR){var r=e.map(rg);$y.error.apply($y,As(["Firestore ("+Jy+"): "+t],r))}}function rg(t){if("string"==typeof t)return t;var e=uE.t();try{return e.i(t)}catch(e){return t}}function ig(t){var e="FIRESTORE ("+Jy+") INTERNAL ASSERTION FAILED: "+t;throw ng(e),new Error(e)}function og(t,e){t||ig(e)}(Hy=Wy=Wy||{})[Hy.DEBUG=0]="DEBUG",Hy[Hy.ERROR=1]="ERROR",Hy[Hy.SILENT=2]="SILENT";var sg=(ag.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return og(20===e.length,"Invalid auto ID: "+e),e},ag);function ag(){}function ug(t,e){return t<e?-1:e<t?1:0}function cg(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function hg(t){return t+"\0"}function lg(t,e,n,r,i){this.s=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i}function fg(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}var pg,dg="(default)",vg=(Object.defineProperty(kg.prototype,"o",{get:function(){return this.database===dg},enumerable:!0,configurable:!0}),kg.prototype.isEqual=function(t){return t instanceof kg&&t.projectId===this.projectId&&t.database===this.database},kg.prototype.h=function(t){return ug(this.projectId,t.projectId)||ug(this.database,t.database)},kg),yg=(Ag.prototype.l=function(){return null!=this.uid},Ag.prototype.v=function(){return this.l()?"uid:"+this.uid:"anonymous-user"},Ag.prototype.isEqual=function(t){return t.uid===this.uid},Ag.UNAUTHENTICATED=new Ag(null),Ag.m=new Ag("google-credentials-uid"),Ag.p=new Ag("first-party-uid"),Ag),gg={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},mg=(_s(Ng,pg=Error),Ng),wg=(Cg.prototype.getToken=function(){return Promise.resolve(null)},Cg.prototype.I=function(){},Cg.prototype.T=function(t){og(!this._,"Can only call setChangeListener() once."),(this._=t)(yg.UNAUTHENTICATED)},Cg.prototype.R=function(){og(null!==this._,"removeChangeListener() when no listener registered"),this._=null},Cg),bg=(Sg.prototype.getToken=function(){var e=this;og(null!=this.A,"getToken cannot be called after listener removed.");var n=this.P,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){if(e.P!==n)throw new mg(gg.ABORTED,"getToken aborted due to token change.");return t?(og("string"==typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new fg(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Sg.prototype.I=function(){this.forceRefresh=!0},Sg.prototype.T=function(t){og(!this._,"Can only call setChangeListener() once."),this._=t,this.D&&t(this.currentUser)},Sg.prototype.R=function(){og(null!=this.A,"removeChangeListener() called twice"),og(null!==this._,"removeChangeListener() called when no listener registered"),this.auth&&this.auth.removeAuthTokenListener(this.A),this.A=null,this._=null},Sg.prototype.S=function(){var t=this.auth&&this.auth.getUid();return og(null===t||"string"==typeof t,"Received invalid UID: "+t),new yg(t)},Sg),_g=(Object.defineProperty(Tg.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.V},e=this.C.auth.N([]);return e&&(t.Authorization=e),t},enumerable:!0,configurable:!0}),Tg),Eg=(Ig.prototype.getToken=function(){return Promise.resolve(new _g(this.C,this.V))},Ig.prototype.T=function(t){t(yg.p)},Ig.prototype.R=function(){},Ig.prototype.I=function(){},Ig);function Ig(t,e){this.C=t,this.V=e}function Tg(t,e){this.C=t,this.V=e,this.type="FirstParty",this.user=yg.p}function Sg(t){var e=this;this.A=null,this.currentUser=yg.UNAUTHENTICATED,this.D=!1,this.P=0,this._=null,this.forceRefresh=!1,this.A=function(){e.P++,e.currentUser=e.S(),e.D=!0,e._&&e._(e.currentUser)},this.P=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.A):(this.A(null),t.get().then(function(t){e.auth=t,e.A&&e.auth.addAuthTokenListener(e.A)},function(){}))}function Cg(){this._=null}function Ng(t,e){var n=pg.call(this,e)||this;return n.code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Ag(t){this.uid=t}function kg(t,e){this.projectId=t,this.database=e||dg}function Rg(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Og(t,e){return void 0!==t?t:e}function Pg(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function Dg(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function xg(t){for(var e in og(null!=t&&"object"==typeof t,"isEmpty() expects object parameter."),t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Lg(t,e){if(0!==e.length)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() does not support arguments, but was called with "+$g(e.length,"argument")+".")}function Mg(t,e,n){if(e.length!==n)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires "+$g(n,"argument")+", but was called with "+$g(e.length,"argument")+".")}function Ug(t,e,n){if(e.length<n)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires at least "+$g(n,"argument")+", but was called with "+$g(e.length,"argument")+".")}function Fg(t,e,n,r){if(e.length<n||e.length>r)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+$g(e.length,"argument")+".")}function jg(t,e,n,r){Hg(t,e,Jg(n)+" argument",r)}function qg(t,e,n,r){void 0!==r&&jg(t,e,n,r)}function Vg(t,e,n,r){Hg(t,e,n+" option",r)}function Bg(t,e,n,r){void 0!==r&&Vg(t,e,n,r)}function Wg(t,e,n,r,c){void 0!==r&&function(t,e,n,r){for(var i=[],o=0,s=c;o<s.length;o++){var a=s[o];if(a===r)return;i.push(Kg(a))}var u=Kg(r);throw new mg(gg.INVALID_ARGUMENT,"Invalid value "+u+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+i.join(", "))}(t,0,n,r)}function Hg(t,e,n,r){if(!("object"===e?Gg(r):"non-empty string"===e?"string"==typeof r&&""!==r:typeof r===e)){var i=Kg(r);throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function Gg(t){return"object"==typeof t&&null!==t&&(Object.getPrototypeOf(t)===Object.prototype||null===Object.getPrototypeOf(t))}function Kg(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":ig("Unknown wrong type: "+typeof t);if(t instanceof Array)return"an array";var e=function(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}(t);return e?"a custom "+e+" object":"an object"}function zg(t,e,n){if(void 0===n)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+Jg(e)+" argument, but it was undefined.")}function Qg(n,t,r){Dg(t,function(t,e){if(r.indexOf(t)<0)throw new mg(gg.INVALID_ARGUMENT,"Unknown option '"+t+"' passed to function "+n+"(). Available options: "+r.join(", "))})}function Yg(t,e,n,r){var i=Kg(r);return new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires its "+Jg(n)+" argument to be a "+e+", but it was: "+i)}function Xg(t,e,n){if(n<=0)throw new mg(gg.INVALID_ARGUMENT,'Function "'+t+'()" requires its '+Jg(e)+" argument to be a positive number, but it was: "+n+".")}function Jg(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function $g(t,e){return t+" "+e+(1===t?"":"s")}var Zg,tm,em=(Object.defineProperty(Im.prototype,"latitude",{get:function(){return this.O},enumerable:!0,configurable:!0}),Object.defineProperty(Im.prototype,"longitude",{get:function(){return this.F},enumerable:!0,configurable:!0}),Im.prototype.isEqual=function(t){return this.O===t.O&&this.F===t.F},Im.prototype.j=function(t){return ug(this.O,t.O)||ug(this.F,t.F)},Im),nm=(Em.now=function(){return Em.fromMillis(Date.now())},Em.fromDate=function(t){return Em.fromMillis(t.getTime())},Em.fromMillis=function(t){var e=Math.floor(t/1e3);return new Em(e,1e6*(t-1e3*e))},Em.prototype.toDate=function(){return new Date(this.toMillis())},Em.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},Em.prototype.j=function(t){return this.seconds===t.seconds?ug(this.nanoseconds,t.nanoseconds):ug(this.seconds,t.seconds)},Em.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},Em.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},Em),rm=(_m.U=function(t){var e=Math.floor(t/1e6);return new _m(new nm(e,t%1e6*1e3))},_m.L=function(t){return new _m(t)},_m.B=function(){return _m.MIN},_m.prototype.h=function(t){return this.timestamp.j(t.timestamp)},_m.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},_m.prototype.M=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},_m.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},_m.prototype.q=function(){return this.timestamp},_m.MIN=new _m(new nm(0,0)),_m),im=(Object.defineProperty(bm.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),bm.prototype.isEqual=function(t){return 0===bm.G(this,t)},bm.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof bm?t.forEach(function(t){e.push(t)}):e.push(t),this.W(e)},bm.prototype.limit=function(){return this.offset+this.length},bm.prototype.K=function(t){return t=void 0===t?1:t,og(this.length>=t,"Can't call popFirst() with less segments"),this.W(this.segments,this.offset+t,this.length-t)},bm.prototype.H=function(){return og(!this.J(),"Can't call popLast() on empty path"),this.W(this.segments,this.offset,this.length-1)},bm.prototype.Y=function(){return og(!this.J(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},bm.prototype.X=function(){return this.get(this.length-1)},bm.prototype.get=function(t){return og(t<this.length,"Index out of range"),this.segments[this.offset+t]},bm.prototype.J=function(){return 0===this.length},bm.prototype.$=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},bm.prototype.Z=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},bm.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},bm.prototype.tt=function(){return this.segments.slice(this.offset,this.limit())},bm.G=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},bm),om=(_s(wm,tm=im),wm.prototype.W=function(t,e,n){return new wm(t,e,n)},wm.prototype.nt=function(){return this.tt().join("/")},wm.prototype.toString=function(){return this.nt()},wm.it=function(t){if(0<=t.indexOf("//"))throw new mg(gg.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new wm(t.split("/").filter(function(t){return 0<t.length}))},wm.et=new wm([]),wm),sm=/^[_a-zA-Z][_a-zA-Z0-9]*$/,am=(_s(mm,Zg=im),mm.prototype.W=function(t,e,n){return new mm(t,e,n)},mm.rt=function(t){return sm.test(t)},mm.prototype.nt=function(){return this.tt().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),mm.rt(t)||(t="`"+t+"`"),t}).join(".")},mm.prototype.toString=function(){return this.nt()},mm.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},mm.st=function(){return new mm(["__name__"])},mm.ot=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new mg(gg.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new mg(gg.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var a=t[r+1];if("\\"!==a&&"."!==a&&"`"!==a)throw new mg(gg.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=a,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new mg(gg.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new mm(e)},mm.et=new mm([]),mm),um=(gm.prototype.ct=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},gm.prototype.isEqual=function(t){return null!==t&&0===om.G(this.path,t.path)},gm.prototype.toString=function(){return this.path.toString()},gm.G=function(t,e){return om.G(t.path,e.path)},gm.ht=function(t){return t.length%2==0},gm.at=function(t){return new gm(new om(t.slice()))},gm.ft=function(t){return new gm(om.it(t))},gm.EMPTY=new gm(new om([])),gm),cm=(ym.prototype.lt=function(t,e){return new ym(this.G,this.root.lt(t,e,this.G).copy(null,null,lm.dt,null,null))},ym.prototype.remove=function(t){return new ym(this.G,this.root.remove(t,this.G).copy(null,null,lm.dt,null,null))},ym.prototype.get=function(t){for(var e=this.root;!e.J();){var n=this.G(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},ym.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.J();){var r=this.G(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},ym.prototype.J=function(){return this.root.J()},Object.defineProperty(ym.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),ym.prototype.vt=function(){return this.root.vt()},ym.prototype.wt=function(){return this.root.wt()},ym.prototype.pt=function(t){return this.root.pt(t)},ym.prototype.forEach=function(n){this.pt(function(t,e){return n(t,e),!1})},ym.prototype.toString=function(){var n=[];return this.pt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},ym.prototype.gt=function(t){return this.root.gt(t)},ym.prototype.bt=function(){return new hm(this.root,null,this.G,!1)},ym.prototype.yt=function(t){return new hm(this.root,t,this.G,!1)},ym.prototype._t=function(){return new hm(this.root,null,this.G,!0)},ym.prototype.It=function(t){return new hm(this.root,t,this.G,!0)},ym),hm=(vm.prototype.Rt=function(){og(0<this.Et.length,"getNext() called on iterator when hasNext() is false.");var t=this.Et.pop(),e={key:t.key,value:t.value};if(this.Tt)for(t=t.left;!t.J();)this.Et.push(t),t=t.right;else for(t=t.right;!t.J();)this.Et.push(t),t=t.left;return e},vm.prototype.At=function(){return 0<this.Et.length},vm.prototype.Dt=function(){if(0===this.Et.length)return null;var t=this.Et[this.Et.length-1];return{key:t.key,value:t.value}},vm),lm=(dm.prototype.copy=function(t,e,n,r,i){return new dm(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},dm.prototype.J=function(){return!1},dm.prototype.pt=function(t){return this.left.pt(t)||t(this.key,this.value)||this.right.pt(t)},dm.prototype.gt=function(t){return this.right.gt(t)||t(this.key,this.value)||this.left.gt(t)},dm.prototype.min=function(){return this.left.J()?this:this.left.min()},dm.prototype.vt=function(){return this.min().key},dm.prototype.wt=function(){return this.right.J()?this.key:this.right.wt()},dm.prototype.lt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.lt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.lt(t,e,n))).Pt()},dm.prototype.St=function(){if(this.left.J())return dm.EMPTY;var t=this;return t.left.Ct()||t.left.left.Ct()||(t=t.Vt()),(t=t.copy(null,null,null,t.left.St(),null)).Pt()},dm.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r.left.J()||r.left.Ct()||r.left.left.Ct()||(r=r.Vt()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.Ct()&&(r=r.Nt()),r.right.J()||r.right.Ct()||r.right.left.Ct()||(r=r.kt()),0===e(t,r.key)){if(r.right.J())return dm.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.St())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.Pt()},dm.prototype.Ct=function(){return this.color},dm.prototype.Pt=function(){var t=this;return t.right.Ct()&&!t.left.Ct()&&(t=t.Ot()),t.left.Ct()&&t.left.left.Ct()&&(t=t.Nt()),t.left.Ct()&&t.right.Ct()&&(t=t.Ft()),t},dm.prototype.Vt=function(){var t=this.Ft();return t.right.left.Ct()&&(t=(t=(t=t.copy(null,null,null,null,t.right.Nt())).Ot()).Ft()),t},dm.prototype.kt=function(){var t=this.Ft();return t.left.left.Ct()&&(t=(t=t.Nt()).Ft()),t},dm.prototype.Ot=function(){var t=this.copy(null,null,dm.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},dm.prototype.Nt=function(){var t=this.copy(null,null,dm.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},dm.prototype.Ft=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},dm.prototype.xt=function(){var t=this.jt();return Math.pow(2,t)<=this.size+1},dm.prototype.jt=function(){if(this.Ct()&&this.left.Ct())throw ig("Red node has red child("+this.key+","+this.value+")");if(this.right.Ct())throw ig("Right child of ("+this.key+","+this.value+") is red");var t=this.left.jt();if(t!==this.right.jt())throw ig("Black depths differ");return t+(this.Ct()?0:1)},dm.EMPTY=null,dm.RED=!0,dm.dt=!1,dm),fm=(Object.defineProperty(pm.prototype,"key",{get:function(){throw ig("LLRBEmptyNode has no key.")},enumerable:!0,configurable:!0}),Object.defineProperty(pm.prototype,"value",{get:function(){throw ig("LLRBEmptyNode has no value.")},enumerable:!0,configurable:!0}),Object.defineProperty(pm.prototype,"color",{get:function(){throw ig("LLRBEmptyNode has no color.")},enumerable:!0,configurable:!0}),Object.defineProperty(pm.prototype,"left",{get:function(){throw ig("LLRBEmptyNode has no left child.")},enumerable:!0,configurable:!0}),Object.defineProperty(pm.prototype,"right",{get:function(){throw ig("LLRBEmptyNode has no right child.")},enumerable:!0,configurable:!0}),pm.prototype.copy=function(t,e,n,r,i){return this},pm.prototype.lt=function(t,e,n){return new lm(t,e)},pm.prototype.remove=function(t,e){return this},pm.prototype.J=function(){return!0},pm.prototype.pt=function(t){return!1},pm.prototype.gt=function(t){return!1},pm.prototype.vt=function(){return null},pm.prototype.wt=function(){return null},pm.prototype.Ct=function(){return!1},pm.prototype.xt=function(){return!0},pm.prototype.jt=function(){return 0},pm);function pm(){this.size=0}function dm(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:dm.RED,this.left=null!=r?r:dm.EMPTY,this.right=null!=i?i:dm.EMPTY,this.size=this.left.size+1+this.right.size}function vm(t,e,n,r){this.Tt=r,this.Et=[];for(var i=1;!t.J();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.Tt?t.left:t.right;else{if(0===i){this.Et.push(t);break}this.Et.push(t),t=this.Tt?t.right:t.left}}function ym(t,e){this.G=t,this.root=e||lm.EMPTY}function gm(t){this.path=t,og(gm.ht(t),"Invalid DocumentKey with an odd number of segments: "+t.tt().join("/"))}function mm(){return null!==Zg&&Zg.apply(this,arguments)||this}function wm(){return null!==tm&&tm.apply(this,arguments)||this}function bm(t,e,n){void 0===e?e=0:e>t.length&&ig("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&ig("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n}function _m(t){this.timestamp=t}function Em(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new mg(gg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new mg(gg.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new mg(gg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new mg(gg.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function Im(t,e){if(Mg("GeoPoint",arguments,2),jg("GeoPoint","number",1,t),jg("GeoPoint","number",2,e),!isFinite(t)||t<-90||90<t)throw new mg(gg.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new mg(gg.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.O=t,this.F=e}lm.EMPTY=new fm;var Tm=(Lm.Ut=function(t){var e=new Lm(t.G);return t.forEach(function(t){e=e.add(t)}),e},Lm.prototype.has=function(t){return null!==this.data.get(t)},Lm.prototype.first=function(){return this.data.vt()},Lm.prototype.last=function(){return this.data.wt()},Object.defineProperty(Lm.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),Lm.prototype.indexOf=function(t){return this.data.indexOf(t)},Lm.prototype.forEach=function(n){this.data.pt(function(t,e){return n(t),!1})},Lm.prototype.Lt=function(t,e){for(var n=this.data.yt(t[0]);n.At();){var r=n.Rt();if(0<=this.G(r.key,t[1]))return;e(r.key)}},Lm.prototype.Bt=function(t,e){var n;for(n=void 0!==e?this.data.yt(e):this.data.bt();n.At();)if(!t(n.Rt().key))return},Lm.prototype.Mt=function(t){var e=this.data.yt(t);return e.At()?e.Rt().key:null},Lm.prototype.bt=function(){return new Sm(this.data.bt())},Lm.prototype.yt=function(t){return new Sm(this.data.yt(t))},Lm.prototype.add=function(t){return this.copy(this.data.remove(t).lt(t,!0))},Lm.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},Lm.prototype.J=function(){return this.data.J()},Lm.prototype.qt=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},Lm.prototype.isEqual=function(t){if(!(t instanceof Lm))return!1;if(this.size!==t.size)return!1;for(var e=this.data.bt(),n=t.data.bt();e.At();){var r=e.Rt().key,i=n.Rt().key;if(0!==this.G(r,i))return!1}return!0},Lm.prototype.tt=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},Lm.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},Lm.prototype.copy=function(t){var e=new Lm(this.G);return e.data=t,e},Lm),Sm=(xm.prototype.Rt=function(){return this.Qt.Rt().key},xm.prototype.At=function(){return this.Qt.At()},xm),Cm=(Dm.prototype.Gt=function(t,e){return new Hw(e,t)},Dm.prototype.Wt=function(t,e){return e},Dm.prototype.zt=function(t){return null},Dm.prototype.isEqual=function(t){return t instanceof Dm},Dm.instance=new Dm,Dm),Nm=(Pm.prototype.Gt=function(t,e){return this.apply(t)},Pm.prototype.Wt=function(t,e){return this.apply(t)},Pm.prototype.apply=function(t){for(var n=Mm(t),e=function(e){n.find(function(t){return t.isEqual(e)})||n.push(e)},r=0,i=this.elements;r<i.length;r++)e(i[r]);return new Yw(n)},Pm.prototype.zt=function(t){return null},Pm.prototype.isEqual=function(t){return t instanceof Pm&&cg(t.elements,this.elements)},Pm),Am=(Om.prototype.Gt=function(t,e){return this.apply(t)},Om.prototype.Wt=function(t,e){return this.apply(t)},Om.prototype.apply=function(t){for(var n=Mm(t),e=function(e){n=n.filter(function(t){return!t.isEqual(e)})},r=0,i=this.elements;r<i.length;r++)e(i[r]);return new Yw(n)},Om.prototype.zt=function(t){return null},Om.prototype.isEqual=function(t){return t instanceof Om&&cg(t.elements,this.elements)},Om),km=(Rm.prototype.Gt=function(t,e){var n=this.zt(t);if(n instanceof qw&&this.Kt instanceof qw){var r=n.Ht+this.Kt.Ht;return new qw(r)}return r=n.Ht+this.Kt.Ht,new Vw(r)},Rm.prototype.Wt=function(t,e){return og(null!==e,"Didn't receive transformResult for NUMERIC_ADD transform"),e},Rm.prototype.zt=function(t){return t instanceof bw?t:new qw(0)},Rm.prototype.isEqual=function(t){return t instanceof Rm&&this.Kt.isEqual(t.Kt)},Rm);function Rm(t){this.Kt=t}function Om(t){this.elements=t}function Pm(t){this.elements=t}function Dm(){}function xm(t){this.Qt=t}function Lm(t){this.G=t,this.data=new cm(this.G)}function Mm(t){return t instanceof Yw?t.Ht.slice():[]}function Um(t,e){this.version=t,this.transformResults=e}var Fm,jm,qm=(Wm.Jt=function(t){return new Wm(t)},Wm.Yt=function(t){var e=new Tm(am.G);return t.forEach(function(t){return e=e.add(t)}),new Wm(e)},Wm.prototype.Xt=function(e){var n=!1;return this.fields.forEach(function(t){t.$(e)&&(n=!0)}),n},Wm.prototype.isEqual=function(t){return this.fields.isEqual(t.fields)},Wm),Vm=(Bm.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},Bm);function Bm(t,e){this.field=t,this.transform=e}function Wm(t){this.fields=t}(jm=Fm=Fm||{})[jm.Set=0]="Set",jm[jm.$t=1]="__PRIVATE_Patch",jm[jm.Transform=2]="Transform",jm[jm.Zt=3]="__PRIVATE_Delete",jm[jm.Verify=4]="Verify";var Hm,Gm,Km,zm,Qm,Ym,Xm,Jm,$m,Zm=(fw.exists=function(t){return new fw(void 0,t)},fw.updateTime=function(t){return new fw(t)},Object.defineProperty(fw.prototype,"tn",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),fw.prototype.nn=function(t){return void 0!==this.updateTime?t instanceof Jw&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists===t instanceof Jw:(og(this.tn,"Precondition should be empty"),!0)},fw.prototype.isEqual=function(t){return e=this.updateTime,n=t.updateTime,(null!=e?!(!n||!e.isEqual(n)):e===n)&&this.exists===t.exists;var e,n},fw.NONE=new fw,fw),tw=(lw.prototype.in=function(t){null!=t&&og(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},lw.en=function(t){return t instanceof Jw?t.version:rm.MIN},lw),ew=(_s(hw,$m=tw),hw.prototype.Wt=function(t,e){this.in(t),og(null==e.transformResults,"Transform results received by SetMutation.");var n=e.version;return new Jw(this.key,n,{hasCommittedMutations:!0},this.value)},hw.prototype.Gt=function(t,e,n){if(this.in(t),!this.rn.nn(t))return t;var r=tw.en(t);return new Jw(this.key,r,{un:!0},this.value)},hw.prototype.sn=function(t){return null},hw.prototype.isEqual=function(t){return t instanceof hw&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.rn.isEqual(t.rn)},hw),nw=(_s(cw,Jm=tw),cw.prototype.Wt=function(t,e){if(this.in(t),og(null==e.transformResults,"Transform results received by PatchMutation."),!this.rn.nn(t))return new Zw(this.key,e.version);var n=this.hn(t);return new Jw(this.key,e.version,{hasCommittedMutations:!0},n)},cw.prototype.Gt=function(t,e,n){if(this.in(t),!this.rn.nn(t))return t;var r=tw.en(t),i=this.hn(t);return new Jw(this.key,r,{un:!0},i)},cw.prototype.sn=function(t){return null},cw.prototype.isEqual=function(t){return t instanceof cw&&this.key.isEqual(t.key)&&this.on.isEqual(t.on)&&this.rn.isEqual(t.rn)},cw.prototype.hn=function(t){var e;return e=t instanceof Jw?t.data():Qw.EMPTY,this.cn(e)},cw.prototype.cn=function(n){var r=this;return this.on.fields.forEach(function(t){if(!t.J()){var e=r.data.field(t);n=null!==e?n.set(t,e):n.delete(t)}}),n},cw),rw=(_s(uw,Xm=tw),uw.prototype.Wt=function(t,e){if(this.in(t),og(null!=e.transformResults,"Transform results missing for TransformMutation."),!this.rn.nn(t))return new Zw(this.key,e.version);var n=this.an(t),r=this.fn(t,e.transformResults),i=e.version,o=this.ln(n.data(),r);return new Jw(this.key,i,{hasCommittedMutations:!0},o)},uw.prototype.Gt=function(t,e,n){if(this.in(t),!this.rn.nn(t))return t;var r=this.an(t),i=this.dn(n,t,e),o=this.ln(r.data(),i);return new Jw(this.key,r.version,{un:!0},o)},uw.prototype.sn=function(t){for(var e=null,n=0,r=this.fieldTransforms;n<r.length;n++){var i=r[n],o=t instanceof Jw?t.field(i.field):void 0,s=i.transform.zt(o||null);null!=s&&(e=null==e?Qw.EMPTY.set(i.field,s):e.set(i.field,s))}return e},uw.prototype.isEqual=function(t){return t instanceof uw&&this.key.isEqual(t.key)&&cg(this.fieldTransforms,t.fieldTransforms)&&this.rn.isEqual(t.rn)},uw.prototype.an=function(t){return og(t instanceof Jw,"Unknown MaybeDocument type "+t),og(t.key.isEqual(this.key),"Can only transform a document with the same key"),t},uw.prototype.fn=function(t,e){var n=[];og(this.fieldTransforms.length===e.length,"server transform result count ("+e.length+") should match field transform count ("+this.fieldTransforms.length+")");for(var r=0;r<e.length;r++){var i=this.fieldTransforms[r],o=i.transform,s=null;t instanceof Jw&&(s=t.field(i.field)),n.push(o.Wt(s,e[r]))}return n},uw.prototype.dn=function(t,e,n){for(var r=[],i=0,o=this.fieldTransforms;i<o.length;i++){var s=o[i],a=s.transform,u=null;e instanceof Jw&&(u=e.field(s.field)),null===u&&n instanceof Jw&&(u=n.field(s.field)),r.push(a.Gt(u,t))}return r},uw.prototype.ln=function(t,e){og(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n].field;t=t.set(r,e[n])}return t},uw),iw=(_s(aw,Ym=tw),aw.prototype.Wt=function(t,e){return this.in(t),og(null==e.transformResults,"Transform results received by DeleteMutation."),new $w(this.key,e.version,{hasCommittedMutations:!0})},aw.prototype.Gt=function(t,e,n){return this.in(t),this.rn.nn(t)?(t&&og(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new $w(this.key,rm.B())):t},aw.prototype.sn=function(t){return null},aw.prototype.isEqual=function(t){return t instanceof aw&&this.key.isEqual(t.key)&&this.rn.isEqual(t.rn)},aw),ow=(_s(sw,Qm=tw),sw.prototype.Wt=function(t,e){ig("VerifyMutation should only be used in Transactions.")},sw.prototype.Gt=function(t,e,n){ig("VerifyMutation should only be used in Transactions.")},sw.prototype.sn=function(t){ig("VerifyMutation should only be used in Transactions.")},sw.prototype.isEqual=function(t){return t instanceof sw&&this.key.isEqual(t.key)&&this.rn.isEqual(t.rn)},sw);function sw(t,e){var n=Qm.call(this)||this;return n.key=t,n.rn=e,n.type=Fm.Verify,n}function aw(t,e){var n=Ym.call(this)||this;return n.key=t,n.rn=e,n.type=Fm.Zt,n}function uw(t,e){var n=Xm.call(this)||this;return n.key=t,n.fieldTransforms=e,n.type=Fm.Transform,n.rn=Zm.exists(!0),n}function cw(t,e,n,r){var i=Jm.call(this)||this;return i.key=t,i.data=e,i.on=n,i.rn=r,i.type=Fm.$t,i}function hw(t,e,n){var r=$m.call(this)||this;return r.key=t,r.value=e,r.rn=n,r.type=Fm.Set,r}function lw(){}function fw(t,e){this.updateTime=t,this.exists=e,og(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}(Gm=Hm=Hm||{})[Gm.vn=0]="__PRIVATE_NullValue",Gm[Gm.wn=1]="__PRIVATE_BooleanValue",Gm[Gm.mn=2]="__PRIVATE_NumberValue",Gm[Gm.pn=3]="__PRIVATE_TimestampValue",Gm[Gm.gn=4]="__PRIVATE_StringValue",Gm[Gm.bn=5]="__PRIVATE_BlobValue",Gm[Gm.yn=6]="__PRIVATE_RefValue",Gm[Gm._n=7]="__PRIVATE_GeoPointValue",Gm[Gm.ArrayValue=8]="ArrayValue",Gm[Gm.In=9]="__PRIVATE_ObjectValue",(zm=Km=Km||{})[zm.Tn=0]="__PRIVATE_Default",zm[zm.En=1]="__PRIVATE_Estimate",zm[zm.Rn=2]="__PRIVATE_Previous";var pw,dw,vw,yw=(Sw.Dn=function(t,e){switch(t.serverTimestamps){case"estimate":return new Sw(Km.En,e);case"previous":return new Sw(Km.Rn,e);case"none":case void 0:return new Sw(Km.Tn,e);default:return ig("fromSnapshotOptions() called with invalid options.")}},Sw),gw=(Tw.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},Tw.prototype.Pn=function(t){return og(this.Sn!==t.Sn,"Default compareTo should not be used for values of same type."),ug(this.Sn,t.Sn)},Tw),mw=(_s(Iw,vw=gw),Iw.prototype.value=function(t){return null},Iw.prototype.isEqual=function(t){return t instanceof Iw},Iw.prototype.h=function(t){return t instanceof Iw?0:this.Pn(t)},Iw.prototype.Cn=function(){return 4},Iw.Vn=new Iw,Iw),ww=(_s(Ew,dw=gw),Ew.prototype.value=function(t){return this.Ht},Ew.prototype.isEqual=function(t){return t instanceof Ew&&this.Ht===t.Ht},Ew.prototype.h=function(t){return t instanceof Ew?ug(this,t):this.Pn(t)},Ew.prototype.Cn=function(){return 4},Ew.of=function(t){return t?Ew.Nn:Ew.kn},Ew.Nn=new Ew(!0),Ew.kn=new Ew(!1),Ew),bw=(_s(_w,pw=gw),_w.prototype.value=function(t){return this.Ht},_w.prototype.h=function(t){return t instanceof _w?(e=this.Ht)<(n=t.Ht)?-1:n<e?1:e===n?0:isNaN(e)?isNaN(n)?0:-1:1:this.Pn(t);var e,n},_w.prototype.Cn=function(){return 8},_w);function _w(t){var e=pw.call(this)||this;return e.Ht=t,e.Sn=Hm.mn,e}function Ew(t){var e=dw.call(this)||this;return e.Ht=t,e.Sn=Hm.wn,e}function Iw(){var t=vw.call(this)||this;return t.Sn=Hm.vn,t.Ht=null,t}function Tw(){}function Sw(t,e){this.An=t,this.timestampsInSnapshots=e}function Cw(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}var Nw,Aw,kw,Rw,Ow,Pw,Dw,xw,Lw,Mw,Uw,Fw,jw,qw=(_s(gb,jw=bw),gb.prototype.isEqual=function(t){return t instanceof gb&&Cw(this.Ht,t.Ht)},gb),Vw=(_s(yb,Fw=bw),yb.prototype.isEqual=function(t){return t instanceof yb&&Cw(this.Ht,t.Ht)},yb.On=new yb(NaN),yb.POSITIVE_INFINITY=new yb(1/0),yb.NEGATIVE_INFINITY=new yb(-1/0),yb),Bw=(_s(vb,Uw=gw),vb.prototype.value=function(t){return this.Ht},vb.prototype.isEqual=function(t){return t instanceof vb&&this.Ht===t.Ht},vb.prototype.h=function(t){return t instanceof vb?ug(this.Ht,t.Ht):this.Pn(t)},vb.prototype.Cn=function(){return 2*this.Ht.length},vb),Ww=(_s(db,Mw=gw),db.prototype.value=function(t){return!t||t.timestampsInSnapshots?this.Ht:this.Ht.toDate()},db.prototype.isEqual=function(t){return t instanceof db&&this.Ht.isEqual(t.Ht)},db.prototype.h=function(t){return t instanceof db?this.Ht.j(t.Ht):t instanceof Hw?-1:this.Pn(t)},db.prototype.Cn=function(){return 16},db),Hw=(_s(pb,Lw=gw),pb.prototype.value=function(t){return t&&t.An===Km.En?new Ww(this.Fn).value(t):t&&t.An===Km.Rn&&this.previousValue?this.previousValue.value(t):null},pb.prototype.isEqual=function(t){return t instanceof pb&&this.Fn.isEqual(t.Fn)},pb.prototype.h=function(t){return t instanceof pb?this.Fn.j(t.Fn):t instanceof Ww?1:this.Pn(t)},pb.prototype.toString=function(){return"<ServerTimestamp localTime="+this.Fn.toString()+">"},pb.prototype.Cn=function(){return 16+(this.previousValue?this.previousValue.Cn():0)},pb),Gw=(_s(fb,xw=gw),fb.prototype.value=function(t){return this.Ht},fb.prototype.isEqual=function(t){return t instanceof fb&&this.Ht.isEqual(t.Ht)},fb.prototype.h=function(t){return t instanceof fb?this.Ht.j(t.Ht):this.Pn(t)},fb.prototype.Cn=function(){return this.Ht.xn()},fb),Kw=(_s(lb,Dw=gw),lb.prototype.value=function(t){return this.key},lb.prototype.isEqual=function(t){return t instanceof lb&&this.key.isEqual(t.key)&&this.s.isEqual(t.s)},lb.prototype.h=function(t){if(t instanceof lb){var e=this.s.h(t.s);return 0!==e?e:um.G(this.key,t.key)}return this.Pn(t)},lb.prototype.Cn=function(){return this.s.projectId.length+this.s.database.length+this.key.toString().length},lb),zw=(_s(hb,Pw=gw),hb.prototype.value=function(t){return this.Ht},hb.prototype.isEqual=function(t){return t instanceof hb&&this.Ht.isEqual(t.Ht)},hb.prototype.h=function(t){return t instanceof hb?this.Ht.j(t.Ht):this.Pn(t)},hb.prototype.Cn=function(){return 16},hb),Qw=(_s(cb,Ow=gw),cb.prototype.value=function(n){var r={};return this.Ht.pt(function(t,e){r[t]=e.value(n)}),r},cb.prototype.forEach=function(t){this.Ht.pt(t)},cb.prototype.isEqual=function(t){if(t instanceof cb){for(var e=this.Ht.bt(),n=t.Ht.bt();e.At()&&n.At();){var r=e.Rt(),i=n.Rt();if(r.key!==i.key||!r.value.isEqual(i.value))return!1}return!e.At()&&!n.At()}return!1},cb.prototype.h=function(t){if(t instanceof cb){for(var e=this.Ht.bt(),n=t.Ht.bt();e.At()&&n.At();){var r=e.Rt(),i=n.Rt(),o=ug(r.key,i.key)||r.value.h(i.value);if(o)return o}return ug(e.At(),n.At())}return this.Pn(t)},cb.prototype.set=function(t,e){if(og(!t.J(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.jn(t.Y(),e);var n=this.child(t.Y());n instanceof cb||(n=cb.EMPTY);var r=n.set(t.K(),e);return this.jn(t.Y(),r)},cb.prototype.delete=function(t){if(og(!t.J(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new cb(this.Ht.remove(t.Y()));var e=this.child(t.Y());if(e instanceof cb){var n=e.delete(t.K());return new cb(this.Ht.lt(t.Y(),n))}return this},cb.prototype.contains=function(t){return null!==this.field(t)},cb.prototype.field=function(t){og(!t.J(),"Can't get field of empty path");var e=this;return t.forEach(function(t){e=e instanceof cb?e.Ht.get(t):null}),e},cb.prototype.on=function(){var i=new Tm(am.G);return this.Ht.forEach(function(t,e){var n=new am([t]);if(e instanceof cb){var r=e.on().fields;r.J()?i=i.add(n):r.forEach(function(t){i=i.add(n.child(t))})}else i=i.add(n)}),qm.Jt(i)},cb.prototype.Cn=function(){var n=0;return this.Ht.pt(function(t,e){n+=t.length+e.Cn()}),n},cb.prototype.toString=function(){return this.Ht.toString()},cb.prototype.child=function(t){return this.Ht.get(t)||void 0},cb.prototype.jn=function(t,e){return new cb(this.Ht.lt(t,e))},cb.EMPTY=new cb(new cm(ug)),cb),Yw=(_s(ub,Rw=gw),ub.prototype.value=function(e){return this.Ht.map(function(t){return t.value(e)})},ub.prototype.contains=function(t){for(var e=0,n=this.Ht;e<n.length;e++)if(n[e].isEqual(t))return!0;return!1},ub.prototype.forEach=function(t){this.Ht.forEach(t)},ub.prototype.isEqual=function(t){if(t instanceof ub){if(this.Ht.length!==t.Ht.length)return!1;for(var e=0;e<this.Ht.length;e++)if(!this.Ht[e].isEqual(t.Ht[e]))return!1;return!0}return!1},ub.prototype.h=function(t){if(t instanceof ub){for(var e=Math.min(this.Ht.length,t.Ht.length),n=0;n<e;n++){var r=this.Ht[n].h(t.Ht[n]);if(r)return r}return ug(this.Ht.length,t.Ht.length)}return this.Pn(t)},ub.prototype.Cn=function(){return this.Ht.reduce(function(t,e){return t+e.Cn()},0)},ub.prototype.toString=function(){return"["+this.Ht.map(function(t){return t.toString()}).join(",")+"]"},ub),Xw=(ab.Un=function(t,e){return um.G(t.key,e.key)},ab),Jw=(_s(sb,kw=Xw),sb.prototype.field=function(t){if(this.Ln)return this.Ln.field(t);this.Bn||(this.Bn=new Map);var e=t.nt(),n=this.Bn.get(e);if(void 0===n){var r=this.Mn(t);n=void 0===r?null:this.converter(r),this.Bn.set(e,n)}return n},sb.prototype.data=function(){var n=this;if(!this.Ln){var r=Qw.EMPTY;Dg(this.proto.fields||{},function(t,e){r=r.set(new am([t]),n.converter(e))}),this.Ln=r,this.Bn=void 0}return this.Ln},sb.prototype.value=function(){return this.data().value()},sb.prototype.isEqual=function(t){return t instanceof sb&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.un===t.un&&this.hasCommittedMutations===t.hasCommittedMutations&&this.data().isEqual(t.data())},sb.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data().toString()+", {hasLocalMutations: "+this.un+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(sb.prototype,"hasPendingWrites",{get:function(){return this.un||this.hasCommittedMutations},enumerable:!0,configurable:!0}),sb.prototype.Mn=function(t){og(void 0!==this.proto,"Can only call getProtoField() when proto is defined");for(var e=this.proto.fields?this.proto.fields[t.Y()]:void 0,n=1;n<t.length;++n){if(!e||!e.mapValue||!e.mapValue.fields)return;e=e.mapValue.fields[t.get(n)]}return e},sb.qn=function(t,e,n){var r=e.field(t),i=n.field(t);return null!==r&&null!==i?r.h(i):ig("Trying to compare documents on fields that don't exist")},sb),$w=(_s(ob,Aw=Xw),ob.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(ob.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!0,configurable:!0}),ob.prototype.isEqual=function(t){return t instanceof ob&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ob),Zw=(_s(ib,Nw=Xw),ib.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(ib.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!0,configurable:!0}),ib.prototype.isEqual=function(t){return t instanceof ib&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},ib),tb=Number,eb=tb.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),nb=tb.MAX_SAFE_INTEGER||Math.pow(2,53)-1,rb=tb.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t};function ib(){return null!==Nw&&Nw.apply(this,arguments)||this}function ob(t,e,n){var r=Aw.call(this,t,e)||this;return r.hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function sb(t,e,n,r,i,o){var s=kw.call(this,t,e)||this;return s.Ln=r,s.proto=i,s.converter=o,og(void 0!==s.Ln||void 0!==s.proto&&void 0!==s.converter,"If objectValue is not defined, proto and converter need to be set."),s.un=!!n.un,s.hasCommittedMutations=!!n.hasCommittedMutations,s}function ab(t,e){this.key=t,this.version=e}function ub(t){var e=Rw.call(this)||this;return e.Ht=t,e.Sn=Hm.ArrayValue,e}function cb(t){var e=Ow.call(this)||this;return e.Ht=t,e.Sn=Hm.In,e}function hb(t){var e=Pw.call(this)||this;return e.Ht=t,e.Sn=Hm._n,e}function lb(t,e){var n=Dw.call(this)||this;return n.s=t,n.key=e,n.Sn=Hm.yn,n}function fb(t){var e=xw.call(this)||this;return e.Ht=t,e.Sn=Hm.bn,e}function pb(t,e){var n=Lw.call(this)||this;return n.Fn=t,n.previousValue=e,n.Sn=Hm.pn,n}function db(t){var e=Mw.call(this)||this;return e.Ht=t,e.Sn=Hm.pn,e}function vb(t){var e=Uw.call(this)||this;return e.Ht=t,e.Sn=Hm.gn,e}function yb(){return null!==Fw&&Fw.apply(this,arguments)||this}function gb(){return null!==jw&&jw.apply(this,arguments)||this}function mb(t){return null==t}function wb(t){return rb(t)&&t<=nb&&eb<=t}var bb,_b,Eb=(Ib.prototype.canonicalId=function(){if(null===this.Qn){var t=this.path.nt();null!==this.collectionGroup&&(t+="|cg:"+this.collectionGroup),t+="|f:";for(var e=0,n=this.filters;e<n.length;e++)t+=n[e].canonicalId(),t+=",";t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++)t+=i[r].canonicalId(),t+=",";mb(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.Qn=t}return this.Qn},Ib.prototype.toString=function(){var t=this.path.nt();return null!==this.collectionGroup&&(t+=" collectionGroup="+this.collectionGroup),0<this.filters.length&&(t+=", filters: ["+this.filters.join(", ")+"]"),mb(this.limit)||(t+=", limit: "+this.limit),0<this.orderBy.length&&(t+=", orderBy: ["+this.orderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),"Target("+t+")"},Ib.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return this.collectionGroup===t.collectionGroup&&!!this.path.isEqual(t.path)&&!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt)},Ib.prototype.Gn=function(){return um.ht(this.path)&&null===this.collectionGroup&&0===this.filters.length},Ib);function Ib(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.Qn=null}(_b=bb=bb||{}).Wn="F",_b.zn="L";var Tb,Sb,Cb,Nb,Ab,kb,Rb,Ob,Pb,Db,xb=(r_.$n=function(t){return new r_(t)},Object.defineProperty(r_.prototype,"orderBy",{get:function(){if(null===this.Jn){var t=this.Zn(),e=this.ti();if(null!==t&&null===e)t.ut()?this.Jn=[Gb]:this.Jn=[new Hb(t),Gb];else{og(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field.");for(var n=!(this.Jn=[]),r=0,i=this.Kn;r<i.length;r++){var o=i[r];this.Jn.push(o),o.field.ut()&&(n=!0)}if(!n){var s=0<this.Kn.length?this.Kn[this.Kn.length-1].dir:Bb.ASCENDING;this.Jn.push(s===Bb.ASCENDING?Gb:Kb)}}}return this.Jn},enumerable:!0,configurable:!0}),r_.prototype.ni=function(t){og(null==this.Zn()||!(t instanceof Mb)||!t.ii()||t.field.isEqual(this.Zn()),"Query must only have one inequality field."),og(!this.Gn(),"No filtering allowed for document query");var e=this.filters.concat([t]);return new r_(this.path,this.collectionGroup,this.Kn.slice(),e,this.limit,this.Hn,this.startAt,this.endAt)},r_.prototype.ei=function(t){og(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var e=this.Kn.concat([t]);return new r_(this.path,this.collectionGroup,e,this.filters.slice(),this.limit,this.Hn,this.startAt,this.endAt)},r_.prototype.ri=function(t){return new r_(this.path,this.collectionGroup,this.Kn.slice(),this.filters.slice(),t,bb.Wn,this.startAt,this.endAt)},r_.prototype.ui=function(t){return new r_(this.path,this.collectionGroup,this.Kn.slice(),this.filters.slice(),t,bb.zn,this.startAt,this.endAt)},r_.prototype.si=function(t){return new r_(this.path,this.collectionGroup,this.Kn.slice(),this.filters.slice(),this.limit,this.Hn,t,this.endAt)},r_.prototype.oi=function(t){return new r_(this.path,this.collectionGroup,this.Kn.slice(),this.filters.slice(),this.limit,this.Hn,this.startAt,t)},r_.prototype.hi=function(t){return new r_(t,null,this.Kn.slice(),this.filters.slice(),this.limit,this.Hn,this.startAt,this.endAt)},r_.prototype.ci=function(){return 0===this.filters.length&&null===this.limit&&null==this.startAt&&null==this.endAt&&(0===this.Kn.length||1===this.Kn.length&&this.Kn[0].field.ut())},r_.prototype.canonicalId=function(){return this.ai().canonicalId()+"|lt:"+this.Hn},r_.prototype.toString=function(){return"Query(target="+this.ai().toString()+"; limitType="+this.Hn+")"},r_.prototype.isEqual=function(t){return this.ai().isEqual(t.ai())&&this.Hn===t.Hn},r_.prototype.fi=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],s=o.compare(t,e);if(0!==s)return s;n=n||o.field.ut()}return og(n,"orderBy used that doesn't compare on key field"),0},r_.prototype.matches=function(t){return this.li(t)&&this.di(t)&&this.vi(t)&&this.wi(t)},r_.prototype.mi=function(){return!mb(this.limit)&&this.Hn===bb.Wn},r_.prototype.pi=function(){return!mb(this.limit)&&this.Hn===bb.zn},r_.prototype.ti=function(){return 0<this.Kn.length?this.Kn[0].field:null},r_.prototype.Zn=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Mb&&n.ii())return n.field}return null},r_.prototype.gi=function(t){for(var e=0,n=this.filters;e<n.length;e++){var r=n[e];if(r instanceof Mb&&0<=t.indexOf(r.op))return r.op}return null},r_.prototype.Gn=function(){return this.ai().Gn()},r_.prototype.bi=function(){return null!==this.collectionGroup},r_.prototype.ai=function(){if(!this.Yn)if(this.Hn===bb.Wn)this.Yn=new Eb(this.path,this.collectionGroup,this.orderBy,this.filters,this.limit,this.startAt,this.endAt);else{for(var t=[],e=0,n=this.orderBy;e<n.length;e++){var r=n[e],i=r.dir===Bb.DESCENDING?Bb.ASCENDING:Bb.DESCENDING;t.push(new Hb(r.field,i))}var o=this.endAt?new Wb(this.endAt.position,!this.endAt.before):null,s=this.startAt?new Wb(this.startAt.position,!this.startAt.before):null;this.Yn=new Eb(this.path,this.collectionGroup,t,this.filters,this.limit,o,s)}return this.Yn},r_.prototype.li=function(t){var e=t.key.path;return null!==this.collectionGroup?t.key.ct(this.collectionGroup)&&this.path.$(e):um.ht(this.path)?this.path.isEqual(e):this.path.Z(e)},r_.prototype.di=function(t){for(var e=0,n=this.Kn;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return!1}return!0},r_.prototype.vi=function(t){for(var e=0,n=this.filters;e<n.length;e++)if(!n[e].matches(t))return!1;return!0},r_.prototype.wi=function(t){return!(this.startAt&&!this.startAt.yi(this.orderBy,t)||this.endAt&&this.endAt.yi(this.orderBy,t))},r_.prototype.Xn=function(t){og(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},r_),Lb=(n_.it=function(t){switch(t){case"<":return n_.LESS_THAN;case"<=":return n_.LESS_THAN_OR_EQUAL;case"==":return n_.EQUAL;case">=":return n_.GREATER_THAN_OR_EQUAL;case">":return n_.GREATER_THAN;case"array-contains":return n_.ARRAY_CONTAINS;case"in":return n_.IN;case"array-contains-any":return n_.ARRAY_CONTAINS_ANY;default:return ig("Unknown FieldFilter operator: "+t)}},n_.prototype.toString=function(){return this.name},n_.prototype.isEqual=function(t){return this.name===t.name},n_.LESS_THAN=new n_("<"),n_.LESS_THAN_OR_EQUAL=new n_("<="),n_.EQUAL=new n_("=="),n_.GREATER_THAN=new n_(">"),n_.GREATER_THAN_OR_EQUAL=new n_(">="),n_.ARRAY_CONTAINS=new n_("array-contains"),n_.IN=new n_("in"),n_.ARRAY_CONTAINS_ANY=new n_("array-contains-any"),n_),Mb=(_s(e_,Db=function(){}),e_.create=function(t,e,n){if(t.ut())return e===Lb.IN?(og(n instanceof Yw,"Comparing on key with IN, but filter value not an ArrayValue"),og(n.Ht.every(function(t){return t instanceof Kw}),"Comparing on key with IN, but an array value was not a RefValue"),new Fb(t,n)):(og(n instanceof Kw,"Comparing on key, but filter value not a RefValue"),og(e!==Lb.ARRAY_CONTAINS&&e!==Lb.ARRAY_CONTAINS_ANY,"'"+e.toString()+"' queries don't make sense on document keys."),new Ub(t,e,n));if(n.isEqual(mw.Vn)){if(e!==Lb.EQUAL)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. Null supports only equality comparisons.");return new e_(t,e,n)}if(n.isEqual(Vw.On)){if(e!==Lb.EQUAL)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. NaN supports only equality comparisons.");return new e_(t,e,n)}return e===Lb.ARRAY_CONTAINS?new jb(t,n):e===Lb.IN?(og(n instanceof Yw,"IN filter has invalid value: "+n.toString()),new qb(t,n)):e===Lb.ARRAY_CONTAINS_ANY?(og(n instanceof Yw,"ARRAY_CONTAINS_ANY filter has invalid value: "+n.toString()),new Vb(t,n)):new e_(t,e,n)},e_.prototype.matches=function(t){var e=t.field(this.field);return null!==e&&this.value.Sn===e.Sn&&this._i(e.h(this.value))},e_.prototype._i=function(t){switch(this.op){case Lb.LESS_THAN:return t<0;case Lb.LESS_THAN_OR_EQUAL:return t<=0;case Lb.EQUAL:return 0===t;case Lb.GREATER_THAN:return 0<t;case Lb.GREATER_THAN_OR_EQUAL:return 0<=t;default:return ig("Unknown FieldFilter operator: "+this.op)}},e_.prototype.ii=function(){return 0<=[Lb.LESS_THAN,Lb.LESS_THAN_OR_EQUAL,Lb.GREATER_THAN,Lb.GREATER_THAN_OR_EQUAL].indexOf(this.op)},e_.prototype.canonicalId=function(){return this.field.nt()+this.op.toString()+this.value.toString()},e_.prototype.isEqual=function(t){return t instanceof e_&&this.op.isEqual(t.op)&&this.field.isEqual(t.field)&&this.value.isEqual(t.value)},e_.prototype.toString=function(){return this.field.nt()+" "+this.op+" "+this.value.value()},e_),Ub=(_s(t_,Pb=Mb),t_.prototype.matches=function(t){var e=this.value,n=um.G(t.key,e.key);return this._i(n)},t_),Fb=(_s(Zb,Ob=Mb),Zb.prototype.matches=function(e){return this.value.Ht.some(function(t){return e.key.isEqual(t.key)})},Zb),jb=(_s($b,Rb=Mb),$b.prototype.matches=function(t){var e=t.field(this.field);return e instanceof Yw&&e.contains(this.value)},$b),qb=(_s(Jb,kb=Mb),Jb.prototype.matches=function(t){var e=this.value,n=t.field(this.field);return null!==n&&e.contains(n)},Jb),Vb=(_s(Xb,Ab=Mb),Xb.prototype.matches=function(t){var e=this,n=t.field(this.field);return n instanceof Yw&&n.Ht.some(function(t){return e.value.contains(t)})},Xb),Bb=(Yb.prototype.toString=function(){return this.name},Yb.ASCENDING=new Yb("asc"),Yb.DESCENDING=new Yb("desc"),Yb),Wb=(Qb.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++)t+=n[e].toString();return t},Qb.prototype.yi=function(t,e){og(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.ut())og(o instanceof Kw,"Bound has a non-key value where the key path is being used."),n=um.G(o.key,e.key);else{var s=e.field(i.field);og(null!==s,"Field should exist since document matched the orderBy already."),n=o.h(s)}if(i.dir===Bb.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},Qb.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];if(!n.isEqual(r))return!1}return!0},Qb),Hb=(zb.prototype.compare=function(t,e){var n=this.Ii?Jw.Un(t,e):Jw.qn(this.field,t,e);switch(this.dir){case Bb.ASCENDING:return n;case Bb.DESCENDING:return-1*n;default:return ig("Unknown direction: "+this.dir)}},zb.prototype.canonicalId=function(){return this.field.nt()+this.dir.toString()},zb.prototype.toString=function(){return this.field.nt()+" ("+this.dir+")"},zb.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},zb),Gb=new Hb(am.st(),Bb.ASCENDING),Kb=new Hb(am.st(),Bb.DESCENDING);function zb(t,e){this.field=t,void 0===e&&(e=Bb.ASCENDING),this.dir=e,this.Ii=t.ut()}function Qb(t,e){this.position=t,this.before=e}function Yb(t){this.name=t}function Xb(t,e){var n=Ab.call(this,t,Lb.ARRAY_CONTAINS_ANY,e)||this;return n.value=e,n}function Jb(t,e){var n=kb.call(this,t,Lb.IN,e)||this;return n.value=e,n}function $b(t,e){return Rb.call(this,t,Lb.ARRAY_CONTAINS,e)||this}function Zb(t,e){var n=Ob.call(this,t,Lb.IN,e)||this;return n.value=e,n}function t_(){return null!==Pb&&Pb.apply(this,arguments)||this}function e_(t,e,n){var r=Db.call(this)||this;return r.field=t,r.op=e,r.value=n,r}function n_(t){this.name=t}function r_(t,e,n,r,i,o,s,a){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=bb.Wn),void 0===s&&(s=null),void 0===a&&(a=null),this.path=t,this.collectionGroup=e,this.Kn=n,this.filters=r,this.limit=i,this.Hn=o,this.startAt=s,this.endAt=a,this.Jn=null,this.Yn=null,this.startAt&&this.Xn(this.startAt),this.endAt&&this.Xn(this.endAt)}(Sb=Tb=Tb||{})[Sb.Ti=0]="__PRIVATE_Unknown",Sb[Sb.Ei=1]="__PRIVATE_Online",Sb[Sb.Ri=2]="__PRIVATE_Offline",(Nb=Cb=Cb||{})[Nb.Ai=0]="__PRIVATE_RemoteStore",Nb[Nb.Di=1]="__PRIVATE_SharedClientState";var i_,o_,s_=(a_.fromBase64String=function(t){return new a_(uE.t().atob(t))},a_.fromUint8Array=function(t){return new a_(u_(t))},a_.prototype.toBase64=function(){return uE.t().btoa(this.Pi)},a_.prototype.toUint8Array=function(){return c_(this.Pi)},a_.prototype.Cn=function(){return 2*this.Pi.length},a_.prototype.isEqual=function(t){return this.Pi===t.Pi},a_.Si=new a_(""),a_);function a_(t){this.Pi=t}function u_(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}function c_(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(o_=i_=i_||{})[o_.Ci=0]="__PRIVATE_Listen",o_[o_.Vi=1]="__PRIVATE_ExistenceFilterMismatch",o_[o_.Ni=2]="__PRIVATE_LimboResolution";var h_,l_,f_=(v_.prototype.Fi=function(t){return new v_(this.target,this.targetId,this.ki,t,this.Oi,this.lastLimboFreeSnapshotVersion,this.resumeToken)},v_.prototype.xi=function(t,e){return new v_(this.target,this.targetId,this.ki,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},v_.prototype.ji=function(t){return new v_(this.target,this.targetId,this.ki,this.sequenceNumber,this.Oi,t,this.resumeToken)},v_.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.ki===t.ki&&this.sequenceNumber===t.sequenceNumber&&this.Oi.isEqual(t.Oi)&&this.lastLimboFreeSnapshotVersion.isEqual(t.lastLimboFreeSnapshotVersion)&&this.resumeToken.isEqual(t.resumeToken)&&this.target.isEqual(t.target)},v_),p_=(d_.prototype.isEqual=function(t){return t&&t.count===this.count},d_);function d_(t){this.count=t}function v_(t,e,n,r,i,o,s){void 0===i&&(i=rm.MIN),void 0===o&&(o=rm.MIN),void 0===s&&(s=s_.Si),this.target=t,this.targetId=e,this.ki=n,this.sequenceNumber=r,this.Oi=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function y_(t){switch(t){case gg.OK:return ig("Treated status OK as error");case gg.CANCELLED:case gg.UNKNOWN:case gg.DEADLINE_EXCEEDED:case gg.RESOURCE_EXHAUSTED:case gg.INTERNAL:case gg.UNAVAILABLE:case gg.UNAUTHENTICATED:return!1;case gg.INVALID_ARGUMENT:case gg.NOT_FOUND:case gg.ALREADY_EXISTS:case gg.PERMISSION_DENIED:case gg.FAILED_PRECONDITION:case gg.ABORTED:case gg.OUT_OF_RANGE:case gg.UNIMPLEMENTED:case gg.DATA_LOSS:return!0;default:return ig("Unknown status code: "+t)}}function g_(t){if(void 0===t)return ng("GRPC error has no .code"),gg.UNKNOWN;switch(t){case h_.OK:return gg.OK;case h_.CANCELLED:return gg.CANCELLED;case h_.UNKNOWN:return gg.UNKNOWN;case h_.DEADLINE_EXCEEDED:return gg.DEADLINE_EXCEEDED;case h_.RESOURCE_EXHAUSTED:return gg.RESOURCE_EXHAUSTED;case h_.INTERNAL:return gg.INTERNAL;case h_.UNAVAILABLE:return gg.UNAVAILABLE;case h_.UNAUTHENTICATED:return gg.UNAUTHENTICATED;case h_.INVALID_ARGUMENT:return gg.INVALID_ARGUMENT;case h_.NOT_FOUND:return gg.NOT_FOUND;case h_.ALREADY_EXISTS:return gg.ALREADY_EXISTS;case h_.PERMISSION_DENIED:return gg.PERMISSION_DENIED;case h_.FAILED_PRECONDITION:return gg.FAILED_PRECONDITION;case h_.ABORTED:return gg.ABORTED;case h_.OUT_OF_RANGE:return gg.OUT_OF_RANGE;case h_.UNIMPLEMENTED:return gg.UNIMPLEMENTED;case h_.DATA_LOSS:return gg.DATA_LOSS;default:return ig("Unknown status code: "+t)}}(l_=h_=h_||{})[l_.OK=0]="OK",l_[l_.CANCELLED=1]="CANCELLED",l_[l_.UNKNOWN=2]="UNKNOWN",l_[l_.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",l_[l_.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",l_[l_.NOT_FOUND=5]="NOT_FOUND",l_[l_.ALREADY_EXISTS=6]="ALREADY_EXISTS",l_[l_.PERMISSION_DENIED=7]="PERMISSION_DENIED",l_[l_.UNAUTHENTICATED=16]="UNAUTHENTICATED",l_[l_.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",l_[l_.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",l_[l_.ABORTED=10]="ABORTED",l_[l_.OUT_OF_RANGE=11]="OUT_OF_RANGE",l_[l_.UNIMPLEMENTED=12]="UNIMPLEMENTED",l_[l_.INTERNAL=13]="INTERNAL",l_[l_.UNAVAILABLE=14]="UNAVAILABLE",l_[l_.DATA_LOSS=15]="DATA_LOSS";var m_=new cm(um.G);function w_(){return m_}function b_(){return w_()}var __=new cm(um.G);function E_(){return __}var I_=new cm(um.G);function T_(){return I_}var S_=new Tm(um.G);function C_(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=S_,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var N_=new Tm(ug);function A_(){return N_}var k_,R_,O_,P_,D_=(x_.Bi=function(t){return new x_(t.G)},x_.prototype.has=function(t){return null!=this.Ui.get(t)},x_.prototype.get=function(t){return this.Ui.get(t)},x_.prototype.first=function(){return this.Li.vt()},x_.prototype.last=function(){return this.Li.wt()},x_.prototype.J=function(){return this.Li.J()},x_.prototype.indexOf=function(t){var e=this.Ui.get(t);return e?this.Li.indexOf(e):-1},Object.defineProperty(x_.prototype,"size",{get:function(){return this.Li.size},enumerable:!0,configurable:!0}),x_.prototype.forEach=function(n){this.Li.pt(function(t,e){return n(t),!1})},x_.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.Ui.lt(t.key,t),e.Li.lt(t,null))},x_.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.Ui.remove(t),this.Li.remove(e)):this},x_.prototype.isEqual=function(t){if(!(t instanceof x_))return!1;if(this.size!==t.size)return!1;for(var e=this.Li.bt(),n=t.Li.bt();e.At();){var r=e.Rt().key,i=n.Rt().key;if(!r.isEqual(i))return!1}return!0},x_.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},x_.prototype.copy=function(t,e){var n=new x_;return n.G=this.G,n.Ui=t,n.Li=e,n},x_);function x_(n){this.G=n?function(t,e){return n(t,e)||um.G(t.key,e.key)}:function(t,e){return um.G(t.key,e.key)},this.Ui=E_(),this.Li=new cm(this.G)}(R_=k_=k_||{})[R_.Mi=0]="__PRIVATE_Added",R_[R_.qi=1]="__PRIVATE_Removed",R_[R_.Qi=2]="__PRIVATE_Modified",R_[R_.Gi=3]="__PRIVATE_Metadata",(P_=O_=O_||{})[P_.Wi=0]="__PRIVATE_Local",P_[P_.zi=1]="__PRIVATE_Synced";function L_(t,e,n,r){this.ae=t,this.removedTargetIds=e,this.key=n,this.fe=r}function M_(t,e){this.targetId=t,this.le=e}var U_,F_,j_=(K_.prototype.track=function(t){var e=t.doc.key,n=this.Ki.get(e);n?t.type!==k_.Mi&&n.type===k_.Gi?this.Ki=this.Ki.lt(e,t):t.type===k_.Gi&&n.type!==k_.qi?this.Ki=this.Ki.lt(e,{type:n.type,doc:t.doc}):t.type===k_.Qi&&n.type===k_.Qi?this.Ki=this.Ki.lt(e,{type:k_.Qi,doc:t.doc}):t.type===k_.Qi&&n.type===k_.Mi?this.Ki=this.Ki.lt(e,{type:k_.Mi,doc:t.doc}):t.type===k_.qi&&n.type===k_.Mi?this.Ki=this.Ki.remove(e):t.type===k_.qi&&n.type===k_.Qi?this.Ki=this.Ki.lt(e,{type:k_.qi,doc:n.doc}):t.type===k_.Mi&&n.type===k_.qi?this.Ki=this.Ki.lt(e,{type:k_.Qi,doc:t.doc}):ig("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n)):this.Ki=this.Ki.lt(e,t)},K_.prototype.Hi=function(){var n=[];return this.Ki.pt(function(t,e){n.push(e)}),n},K_),q_=(G_.Zi=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:k_.Mi,doc:t})}),new G_(t,e,D_.Bi(e),i,n,r,!0,!1)},Object.defineProperty(G_.prototype,"hasPendingWrites",{get:function(){return!this.Yi.J()},enumerable:!0,configurable:!0}),G_.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Xi===t.Xi&&this.Yi.isEqual(t.Yi)&&this.query.isEqual(t.query)&&this.docs.isEqual(t.docs)&&this.Ji.isEqual(t.Ji)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},G_),V_=(H_.re=function(t,e){var n,r=((n={})[t]=B_.ue(t,e),n);return new H_(rm.MIN,r,A_(),w_(),C_())},H_),B_=(W_.ue=function(t,e){return new W_(s_.Si,e,C_(),C_(),C_())},W_);function W_(t,e,n,r,i){this.resumeToken=t,this.se=e,this.oe=n,this.he=r,this.ce=i}function H_(t,e,n,r,i){this.Oi=t,this.te=e,this.ne=n,this.ie=r,this.ee=i}function G_(t,e,n,r,i,o,s,a){this.query=t,this.docs=e,this.Ji=n,this.docChanges=r,this.Yi=i,this.fromCache=o,this.Xi=s,this.$i=a}function K_(){this.Ki=new cm(um.G)}(F_=U_=U_||{})[F_.de=0]="__PRIVATE_NoChange",F_[F_.Mi=1]="__PRIVATE_Added",F_[F_.qi=2]="__PRIVATE_Removed",F_[F_.ve=3]="__PRIVATE_Current",F_[F_.we=4]="__PRIVATE_Reset";function z_(t,e,n,r){void 0===n&&(n=s_.Si),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}var Q_=(Object.defineProperty(J_.prototype,"se",{get:function(){return this.be},enumerable:!0,configurable:!0}),Object.defineProperty(J_.prototype,"resumeToken",{get:function(){return this.ge},enumerable:!0,configurable:!0}),Object.defineProperty(J_.prototype,"_e",{get:function(){return 0!==this.me},enumerable:!0,configurable:!0}),Object.defineProperty(J_.prototype,"Ie",{get:function(){return this.ye},enumerable:!0,configurable:!0}),J_.prototype.Te=function(t){0<t.Cn()&&(this.ye=!0,this.ge=t)},J_.prototype.Ee=function(){var n=C_(),r=C_(),i=C_();return this.pe.forEach(function(t,e){switch(e){case k_.Mi:n=n.add(t);break;case k_.Qi:r=r.add(t);break;case k_.qi:i=i.add(t);break;default:ig("Encountered invalid change type: "+e)}}),new B_(this.ge,this.be,n,r,i)},J_.prototype.Re=function(){this.ye=!1,this.pe=Z_()},J_.prototype.Ae=function(t,e){this.ye=!0,this.pe=this.pe.lt(t,e)},J_.prototype.De=function(t){this.ye=!0,this.pe=this.pe.remove(t)},J_.prototype.Pe=function(){this.me+=1},J_.prototype.Se=function(){this.me-=1},J_.prototype.Ce=function(){this.ye=!0,this.be=!0},J_),Y_=(X_.prototype.xe=function(t){for(var e=0,n=t.ae;e<n.length;e++){var r=n[e];t.fe instanceof Jw?this.je(r,t.fe):t.fe instanceof $w&&this.Ue(r,t.key,t.fe)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.Ue(r,t.key,t.fe)},X_.prototype.Le=function(n){var r=this;this.Be(n,function(t){var e=r.Me(t);switch(n.state){case U_.de:r.qe(t)&&e.Te(n.resumeToken);break;case U_.Mi:e.Se(),e._e||e.Re(),e.Te(n.resumeToken);break;case U_.qi:e.Se(),e._e||r.removeTarget(t),og(!n.cause,"WatchChangeAggregator does not handle errored targets");break;case U_.ve:r.qe(t)&&(e.Ce(),e.Te(n.resumeToken));break;case U_.we:r.qe(t)&&(r.Qe(t),e.Te(n.resumeToken));break;default:ig("Unknown target watch change state: "+n.state)}})},X_.prototype.Be=function(t,e){0<t.targetIds.length?t.targetIds.forEach(e):Pg(this.Ne,e)},X_.prototype.Ge=function(t){var e=t.targetId,n=t.le.count,r=this.We(e);if(r){var i=r.target;if(i.Gn())if(0===n){var o=new um(i.path);this.Ue(e,o,new $w(o,rm.B()))}else og(1===n,"Single document existence filter with count: "+n);else this.ze(e)!==n&&(this.Qe(e),this.Fe=this.Fe.add(e))}},X_.prototype.Ke=function(i){var o=this,s={};Pg(this.Ne,function(t,e){var n=o.We(t);if(n){if(e.se&&n.target.Gn()){var r=new um(n.target.path);null!==o.ke.get(r)||o.He(t,r)||o.Ue(t,r,new $w(r,i))}e.Ie&&(s[t]=e.Ee(),e.Re())}});var r=C_();this.Oe.forEach(function(t,e){var n=!0;e.Bt(function(t){var e=o.We(t);return!e||e.ki===i_.Ni||(n=!1)}),n&&(r=r.add(t))});var t=new V_(i,s,this.Fe,this.ke,r);return this.ke=w_(),this.Oe=$_(),this.Fe=new Tm(ug),t},X_.prototype.je=function(t,e){if(this.qe(t)){var n=this.He(t,e.key)?k_.Qi:k_.Mi;this.Me(t).Ae(e.key,n),this.ke=this.ke.lt(e.key,e),this.Oe=this.Oe.lt(e.key,this.Je(e.key).add(t))}},X_.prototype.Ue=function(t,e,n){if(this.qe(t)){var r=this.Me(t);this.He(t,e)?r.Ae(e,k_.qi):r.De(e),this.Oe=this.Oe.lt(e,this.Je(e).delete(t)),n&&(this.ke=this.ke.lt(e,n))}},X_.prototype.removeTarget=function(t){delete this.Ne[t]},X_.prototype.ze=function(t){var e=this.Me(t).Ee();return this.Ve.Ye(t).size+e.oe.size-e.ce.size},X_.prototype.Pe=function(t){this.Me(t).Pe()},X_.prototype.Me=function(t){return this.Ne[t]||(this.Ne[t]=new Q_),this.Ne[t]},X_.prototype.Je=function(t){var e=this.Oe.get(t);return e||(e=new Tm(ug),this.Oe=this.Oe.lt(t,e)),e},X_.prototype.qe=function(t){var e=null!==this.We(t);return e||eg("WatchChangeAggregator","Detected inactive target",t),e},X_.prototype.We=function(t){var e=this.Ne[t];return e&&e._e?null:this.Ve.Xe(t)},X_.prototype.Qe=function(e){var n=this;og(!this.Ne[e]._e,"Should only reset active targets"),this.Ne[e]=new Q_,this.Ve.Ye(e).forEach(function(t){n.Ue(e,t,null)})},X_.prototype.He=function(t,e){return this.Ve.Ye(t).has(e)},X_);function X_(t){this.Ve=t,this.Ne={},this.ke=w_(),this.Oe=$_(),this.Fe=new Tm(ug)}function J_(){this.me=0,this.pe=Z_(),this.ge=s_.Si,this.be=!1,this.ye=!0}function $_(){return new cm(um.G)}function Z_(){return new cm(um.G)}var tE,eE,nE=((tE={})[Bb.ASCENDING.name]="ASCENDING",tE[Bb.DESCENDING.name]="DESCENDING",tE),rE=((eE={})[Lb.LESS_THAN.name]="LESS_THAN",eE[Lb.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",eE[Lb.GREATER_THAN.name]="GREATER_THAN",eE[Lb.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",eE[Lb.EQUAL.name]="EQUAL",eE[Lb.ARRAY_CONTAINS.name]="ARRAY_CONTAINS",eE[Lb.IN.name]="IN",eE[Lb.ARRAY_CONTAINS_ANY.name]="ARRAY_CONTAINS_ANY",eE),iE=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function oE(t,e){og(!mb(t),e+" is missing")}function sE(t){return"number"==typeof t?t:"string"==typeof t?Number(t):ig("can't parse "+t)}var aE=(hE.prototype.$e=function(t){var e=void 0===t.code?gg.UNKNOWN:g_(t.code);return new mg(e,t.message||"")},hE.prototype.Ze=function(t){return this.options.tr||mb(t)?t:{value:t}},hE.prototype.nr=function(t){var e;return mb(e="object"==typeof t?t.value:t)?null:e},hE.prototype.q=function(t){return this.options.tr?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}},hE.prototype.L=function(t){if("string"==typeof t)return this.ir(t);og(!!t,"Cannot deserialize null or undefined timestamp.");var e=sE(t.seconds||"0"),n=t.nanos||0;return new nm(e,n)},hE.prototype.ir=function(t){var e=0,n=iE.exec(t);if(og(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new nm(o,e)},hE.prototype.er=function(t){return this.options.tr?t.toBase64():t.toUint8Array()},hE.prototype.rr=function(t){return this.options.tr?(og(void 0===t||"string"==typeof t,"value must be undefined or a string when using proto3 Json"),s_.fromBase64String(t||"")):(og(void 0===t||t instanceof Uint8Array,"value must be undefined or Uint8Array"),s_.fromUint8Array(t||new Uint8Array))},hE.prototype.ur=function(t){return"string"==typeof t?(og(this.options.tr,"Expected bytes to be passed in as Uint8Array, but got a string instead."),gE.fromBase64String(t)):(og(!this.options.tr,"Expected bytes to be passed in as Uint8Array, but got a string instead."),gE.fromUint8Array(t))},hE.prototype.toVersion=function(t){return this.q(t.q())},hE.prototype.fromVersion=function(t){return og(!!t,"Trying to deserialize version that isn't set"),rm.L(this.L(t))},hE.prototype.sr=function(t,e){return this.or(t).child("documents").child(e).nt()},hE.prototype.hr=function(t){var e=om.it(t);return og(this.cr(e),"Tried to deserialize invalid key "+e.toString()),e},hE.prototype.ar=function(t){return this.sr(this.s,t.path)},hE.prototype.lr=function(t){var e=this.hr(t);return og(e.get(1)===this.s.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.s.projectId),og(!e.get(3)&&!this.s.database||e.get(3)===this.s.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.s.database),new um(this.dr(e))},hE.prototype.vr=function(t){return this.sr(this.s,t)},hE.prototype.wr=function(t){var e=this.hr(t);return 4===e.length?om.et:this.dr(e)},Object.defineProperty(hE.prototype,"mr",{get:function(){return new om(["projects",this.s.projectId,"databases",this.s.database]).nt()},enumerable:!0,configurable:!0}),hE.prototype.or=function(t){return new om(["projects",t.projectId,"databases",t.database])},hE.prototype.dr=function(t){return og(4<t.length&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.K(5)},hE.prototype.cr=function(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)},hE.prototype.pr=function(t){if(t instanceof mw)return{nullValue:"NULL_VALUE"};if(t instanceof ww)return{booleanValue:t.value()};if(t instanceof qw)return{integerValue:""+t.value()};if(t instanceof Vw){var e=t.value();if(this.options.tr){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof Bw?{stringValue:t.value()}:t instanceof Qw?{mapValue:this.gr(t)}:t instanceof Yw?{arrayValue:this.br(t)}:t instanceof Ww?{timestampValue:this.q(t.Ht)}:t instanceof zw?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Gw?{bytesValue:this.er(t.value())}:t instanceof Kw?{referenceValue:this.sr(t.s,t.key.path)}:ig("Unknown FieldValue "+JSON.stringify(t))},hE.prototype.yr=function(t){var e=this;if("nullValue"in t)return mw.Vn;if("booleanValue"in t)return ww.of(t.booleanValue);if("integerValue"in t)return new qw(sE(t.integerValue));if("doubleValue"in t){if(this.options.tr){if("NaN"===t.doubleValue)return Vw.On;if("Infinity"===t.doubleValue)return Vw.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Vw.NEGATIVE_INFINITY}return new Vw(t.doubleValue)}if("stringValue"in t)return new Bw(t.stringValue);if("mapValue"in t)return this._r(t.mapValue.fields||{});if("arrayValue"in t){oE(t.arrayValue,"arrayValue");var n=t.arrayValue.values||[];return new Yw(n.map(function(t){return e.yr(t)}))}if("timestampValue"in t)return oE(t.timestampValue,"timestampValue"),new Ww(this.L(t.timestampValue));if("geoPointValue"in t){oE(t.geoPointValue,"geoPointValue");var r=t.geoPointValue.latitude||0,i=t.geoPointValue.longitude||0;return new zw(new em(r,i))}if("bytesValue"in t){oE(t.bytesValue,"bytesValue");var o=this.ur(t.bytesValue);return new Gw(o)}if("referenceValue"in t){oE(t.referenceValue,"referenceValue");var s=this.hr(t.referenceValue),a=new vg(s.get(1),s.get(3)),u=new um(this.dr(s));return new Kw(a,u)}return ig("Unknown Value proto "+JSON.stringify(t))},hE.prototype.Ir=function(t,e){return{name:this.ar(t),fields:this.Tr(e)}},hE.prototype.Er=function(t){return og(!t.un,"Can't serialize documents with mutations."),{name:this.ar(t.key),fields:this.Tr(t.data()),updateTime:this.q(t.version.q())}},hE.prototype.Rr=function(t,e){var n=this,r=this.lr(t.name),i=this.fromVersion(t.updateTime);return new Jw(r,i,{hasCommittedMutations:!!e},void 0,t,function(t){return n.yr(t)})},hE.prototype.Tr=function(t){var n=this,r={};return t.forEach(function(t,e){r[t]=n.pr(e)}),r},hE.prototype._r=function(t){var n=this,e=t,r=Qw.EMPTY;return Dg(e,function(t,e){r=r.set(new am([t]),n.yr(e))}),r},hE.prototype.gr=function(t){return{fields:this.Tr(t)}},hE.prototype.br=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.pr(t))}),{values:n}},hE.prototype.Ar=function(t){var e=this;og(!!t.found,"Tried to deserialize a found document from a missing document."),oE(t.found.name,"doc.found.name"),oE(t.found.updateTime,"doc.found.updateTime");var n=this.lr(t.found.name),r=this.fromVersion(t.found.updateTime);return new Jw(n,r,{},void 0,t.found,function(t){return e.yr(t)})},hE.prototype.Dr=function(t){og(!!t.missing,"Tried to deserialize a missing document from a found document."),og(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.lr(t.missing),n=this.fromVersion(t.readTime);return new $w(e,n)},hE.prototype.Pr=function(t){return"found"in t?this.Ar(t):"missing"in t?this.Dr(t):ig("invalid batch get response: "+JSON.stringify(t))},hE.prototype.Sr=function(t){switch(t){case U_.Mi:return"ADD";case U_.ve:return"CURRENT";case U_.de:return"NO_CHANGE";case U_.qi:return"REMOVE";case U_.we:return"RESET";default:return ig("Unknown WatchTargetChangeState: "+t)}},hE.prototype.Cr=function(t){if(t instanceof M_)return{filter:{count:t.le.count,targetId:t.targetId}};if(t instanceof L_){if(t.fe instanceof Jw){var e=t.fe;return{documentChange:{document:{name:this.ar(e.key),fields:this.Tr(e.data()),updateTime:this.toVersion(e.version)},targetIds:t.ae,removedTargetIds:t.removedTargetIds}}}if(t.fe instanceof $w)return e=t.fe,{documentDelete:{document:this.ar(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}};if(null===t.fe)return{documentRemove:{document:this.ar(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof z_){var n=void 0;return t.cause&&(n={code:function(t){if(void 0===t)return h_.OK;switch(t){case gg.OK:return h_.OK;case gg.CANCELLED:return h_.CANCELLED;case gg.UNKNOWN:return h_.UNKNOWN;case gg.DEADLINE_EXCEEDED:return h_.DEADLINE_EXCEEDED;case gg.RESOURCE_EXHAUSTED:return h_.RESOURCE_EXHAUSTED;case gg.INTERNAL:return h_.INTERNAL;case gg.UNAVAILABLE:return h_.UNAVAILABLE;case gg.UNAUTHENTICATED:return h_.UNAUTHENTICATED;case gg.INVALID_ARGUMENT:return h_.INVALID_ARGUMENT;case gg.NOT_FOUND:return h_.NOT_FOUND;case gg.ALREADY_EXISTS:return h_.ALREADY_EXISTS;case gg.PERMISSION_DENIED:return h_.PERMISSION_DENIED;case gg.FAILED_PRECONDITION:return h_.FAILED_PRECONDITION;case gg.ABORTED:return h_.ABORTED;case gg.OUT_OF_RANGE:return h_.OUT_OF_RANGE;case gg.UNIMPLEMENTED:return h_.UNIMPLEMENTED;case gg.DATA_LOSS:return h_.DATA_LOSS;default:return ig("Unknown status code: "+t)}}(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.Sr(t.state),targetIds:t.targetIds,resumeToken:this.er(t.resumeToken),cause:n}}}return ig("Unrecognized watch change: "+JSON.stringify(t))},hE.prototype.Vr=function(t){var e,n=this;if("targetChange"in t){oE(t.targetChange,"targetChange");var r=this.Nr(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=this.rr(t.targetChange.resumeToken),s=t.targetChange.cause,a=s&&this.$e(s);e=new z_(r,i,o,a||null)}else if("documentChange"in t){oE(t.documentChange,"documentChange");var u=t.documentChange;oE(u.document,"documentChange.name"),oE(u.document.name,"documentChange.document.name"),oE(u.document.updateTime,"documentChange.document.updateTime");var c=this.lr(u.document.name),h=this.fromVersion(u.document.updateTime),l=new Jw(c,h,{},void 0,u.document,function(t){return n.yr(t)}),f=u.targetIds||[],p=u.removedTargetIds||[];e=new L_(f,p,l.key,l)}else if("documentDelete"in t){oE(t.documentDelete,"documentDelete");var d=t.documentDelete;oE(d.document,"documentDelete.document"),c=this.lr(d.document),h=d.readTime?this.fromVersion(d.readTime):rm.B(),l=new $w(c,h),p=d.removedTargetIds||[],e=new L_([],p,l.key,l)}else if("documentRemove"in t){oE(t.documentRemove,"documentRemove");var v=t.documentRemove;oE(v.document,"documentRemove"),c=this.lr(v.document),p=v.removedTargetIds||[],e=new L_([],p,c,null)}else{if(!("filter"in t))return ig("Unknown change type "+JSON.stringify(t));oE(t.filter,"filter");var y=t.filter;oE(y.targetId,"filter.targetId");var g=y.count||0,m=new p_(g),w=y.targetId;e=new M_(w,m)}return e},hE.prototype.Nr=function(t){return"NO_CHANGE"===t?U_.de:"ADD"===t?U_.Mi:"REMOVE"===t?U_.qi:"CURRENT"===t?U_.ve:"RESET"===t?U_.we:ig("Got unexpected TargetChange.state: "+t)},hE.prototype.kr=function(t){if(!("targetChange"in t))return rm.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?rm.MIN:e.readTime?this.fromVersion(e.readTime):rm.MIN},hE.prototype.Or=function(t){var e,n=this;if(t instanceof ew)e={update:this.Ir(t.key,t.value)};else if(t instanceof iw)e={delete:this.ar(t.key)};else if(t instanceof nw)e={update:this.Ir(t.key,t.data),updateMask:this.Fr(t.on)};else if(t instanceof rw)e={transform:{document:this.ar(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.xr(t)})}};else{if(!(t instanceof ow))return ig("Unknown mutation type "+t.type);e={verify:this.ar(t.key)}}return t.rn.tn||(e.currentDocument=this.jr(t.rn)),e},hE.prototype.Ur=function(t){var e=this,n=t.currentDocument?this.Lr(t.currentDocument):Zm.NONE;if(t.update){oE(t.update.name,"name");var r=this.lr(t.update.name),i=this._r(t.update.fields||{});if(t.updateMask){var o=this.Br(t.updateMask);return new nw(r,i,o,n)}return new ew(r,i,n)}if(t.delete)return r=this.lr(t.delete),new iw(r,n);if(t.transform){r=this.lr(t.transform.document);var s=t.transform.fieldTransforms.map(function(t){return e.Mr(t)});return og(!0===n.exists,'Transforms only support precondition "exists == true"'),new rw(r,s)}return t.verify?(r=this.lr(t.verify),new ow(r,n)):ig("unknown mutation proto: "+JSON.stringify(t))},hE.prototype.jr=function(t){return og(!t.tn,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:ig("Unknown precondition")},hE.prototype.Lr=function(t){return void 0!==t.updateTime?Zm.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?Zm.exists(t.exists):Zm.NONE},hE.prototype.qr=function(t,e){var n=this,r=t.updateTime?this.fromVersion(t.updateTime):this.fromVersion(e);r.isEqual(rm.MIN)&&(r=this.fromVersion(e));var i=null;return t.transformResults&&0<t.transformResults.length&&(i=t.transformResults.map(function(t){return n.yr(t)})),new Um(r,i)},hE.prototype.Qr=function(t,e){var n=this;return t&&0<t.length?(og(void 0!==e,"Received a write result without a commit time"),t.map(function(t){return n.qr(t,e)})):[]},hE.prototype.xr=function(t){var e=this,n=t.transform;if(n instanceof Cm)return{fieldPath:t.field.nt(),setToServerValue:"REQUEST_TIME"};if(n instanceof Nm)return{fieldPath:t.field.nt(),appendMissingElements:{values:n.elements.map(function(t){return e.pr(t)})}};if(n instanceof Am)return{fieldPath:t.field.nt(),removeAllFromArray:{values:n.elements.map(function(t){return e.pr(t)})}};if(n instanceof km)return{fieldPath:t.field.nt(),increment:this.pr(n.Kt)};throw ig("Unknown transform: "+t.transform)},hE.prototype.Mr=function(t){var e=this,n=null;if("setToServerValue"in t)og("REQUEST_TIME"===t.setToServerValue,"Unknown server value transform proto: "+JSON.stringify(t)),n=Cm.instance;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Nm(r.map(function(t){return e.yr(t)}))}else if("removeAllFromArray"in t)r=t.removeAllFromArray.values||[],n=new Am(r.map(function(t){return e.yr(t)}));else if("increment"in t){var i=this.yr(t.increment);og(i instanceof bw,"NUMERIC_ADD transform requires a NumberValue"),n=new km(i)}else ig("Unknown transform proto: "+JSON.stringify(t));var o=am.ot(t.fieldPath);return new Vm(o,n)},hE.prototype.Gr=function(t){return{documents:[this.vr(t.path)]}},hE.prototype.Wr=function(t){var e=t.documents.length;og(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return xb.$n(this.wr(n)).ai()},hE.prototype.zr=function(t){var e={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(og(n.length%2==0,"Collection Group queries should be within a document path or root."),e.parent=this.vr(n),e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(og(n.length%2!=0,"Document queries with filters are not supported."),e.parent=this.vr(n.H()),e.structuredQuery.from=[{collectionId:n.X()}]);var r=this.Kr(t.filters);r&&(e.structuredQuery.where=r);var i=this.Hr(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.Ze(t.limit);return null!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.Jr(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.Jr(t.endAt)),e},hE.prototype.Yr=function(t){var e=this.wr(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,i=null;if(0<r){og(1===r,"StructuredQuery.from with more than one collection is not supported.");var o=n.from[0];o.allDescendants?i=o.collectionId:e=e.child(o.collectionId)}var s=[];n.where&&(s=this.Xr(n.where));var a=[];n.orderBy&&(a=this.$r(n.orderBy));var u=null;n.limit&&(u=this.nr(n.limit));var c=null;n.startAt&&(c=this.Zr(n.startAt));var h=null;return n.endAt&&(h=this.Zr(n.endAt)),new xb(e,i,a,s,u,bb.Wn,c,h).ai()},hE.prototype.tu=function(t){var e=this.nu(t.ki);return null==e?null:{"goog-listen-tags":e}},hE.prototype.nu=function(t){switch(t){case i_.Ci:return null;case i_.Vi:return"existence-filter-mismatch";case i_.Ni:return"limbo-document";default:return ig("Unrecognized query purpose: "+t)}},hE.prototype.ai=function(t){var e,n=t.target;return(e=n.Gn()?{documents:this.Gr(n)}:{query:this.zr(n)}).targetId=t.targetId,0<t.resumeToken.Cn()&&(e.resumeToken=this.er(t.resumeToken)),e},hE.prototype.Kr=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Mb?e.iu(t):ig("Unrecognized filter: "+JSON.stringify(t))});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},hE.prototype.Xr=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.eu(t)]:void 0!==t.fieldFilter?[this.ru(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.Xr(t)}).reduce(function(t,e){return t.concat(e)}):ig("Unknown filter: "+JSON.stringify(t)):[]},hE.prototype.Hr=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.uu(t)})},hE.prototype.$r=function(t){var e=this;return t.map(function(t){return e.su(t)})},hE.prototype.Jr=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.pr(t)})}},hE.prototype.Zr=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.yr(t)});return new Wb(r,n)},hE.prototype.ou=function(t){return nE[t.name]},hE.prototype.hu=function(t){switch(t){case"ASCENDING":return Bb.ASCENDING;case"DESCENDING":return Bb.DESCENDING;default:return}},hE.prototype.cu=function(t){return rE[t.name]},hE.prototype.au=function(t){switch(t){case"EQUAL":return Lb.EQUAL;case"GREATER_THAN":return Lb.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Lb.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Lb.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Lb.LESS_THAN_OR_EQUAL;case"ARRAY_CONTAINS":return Lb.ARRAY_CONTAINS;case"IN":return Lb.IN;case"ARRAY_CONTAINS_ANY":return Lb.ARRAY_CONTAINS_ANY;case"OPERATOR_UNSPECIFIED":return ig("Unspecified operator");default:return ig("Unknown operator")}},hE.prototype.fu=function(t){return{fieldPath:t.nt()}},hE.prototype.lu=function(t){return am.ot(t.fieldPath)},hE.prototype.uu=function(t){return{field:this.fu(t.field),direction:this.ou(t.dir)}},hE.prototype.su=function(t){return new Hb(this.lu(t.field),this.hu(t.direction))},hE.prototype.ru=function(t){return Mb.create(this.lu(t.fieldFilter.field),this.au(t.fieldFilter.op),this.yr(t.fieldFilter.value))},hE.prototype.iu=function(t){if(t.op===Lb.EQUAL){if(t.value.isEqual(Vw.On))return{unaryFilter:{field:this.fu(t.field),op:"IS_NAN"}};if(t.value.isEqual(mw.Vn))return{unaryFilter:{field:this.fu(t.field),op:"IS_NULL"}}}return{fieldFilter:{field:this.fu(t.field),op:this.cu(t.op),value:this.pr(t.value)}}},hE.prototype.eu=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.lu(t.unaryFilter.field);return Mb.create(e,Lb.EQUAL,Vw.On);case"IS_NULL":var n=this.lu(t.unaryFilter.field);return Mb.create(n,Lb.EQUAL,mw.Vn);case"OPERATOR_UNSPECIFIED":return ig("Unspecified filter");default:return ig("Unknown filter")}},hE.prototype.Fr=function(t){var e=[];return t.fields.forEach(function(t){return e.push(t.nt())}),{fieldPaths:e}},hE.prototype.Br=function(t){var e=(t.fieldPaths||[]).map(function(t){return am.ot(t)});return qm.Yt(e)},hE),uE=(cE.du=function(t){cE.platform&&ig("Platform already defined"),cE.platform=t},cE.t=function(){return cE.platform||ig("Platform not set"),cE.platform},cE);function cE(){}function hE(t,e){this.s=t,this.options=e}function lE(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new mg(gg.INVALID_ARGUMENT,t)}return n.prototype=t.prototype,Object.assign(n,t),n}function fE(){if("undefined"==typeof Uint8Array)throw new mg(gg.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function pE(){if(!uE.t().vu)throw new mg(gg.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function dE(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})}var vE,yE,gE=(_E.fromBase64String=function(t){Mg("Blob.fromBase64String",arguments,1),jg("Blob.fromBase64String","string",1,t),pE();try{return new _E(uE.t().atob(t))}catch(t){throw new mg(gg.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},_E.fromUint8Array=function(t){if(Mg("Blob.fromUint8Array",arguments,1),fE(),!(t instanceof Uint8Array))throw Yg("Blob.fromUint8Array","Uint8Array",1,t);return new _E(u_(t))},_E.prototype.toBase64=function(){return Mg("Blob.toBase64",arguments,0),pE(),uE.t().btoa(this.Pi)},_E.prototype.toUint8Array=function(){return Mg("Blob.toUint8Array",arguments,0),fE(),c_(this.Pi)},_E.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},_E.prototype.isEqual=function(t){return this.Pi===t.Pi},_E.prototype.xn=function(){return 2*this.Pi.length},_E.prototype.j=function(t){return ug(this.Pi,t.Pi)},_E),mE=lE(gE,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),wE=(bE.prototype.mu=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},bE.prototype.next=function(){var t=++this.previousValue;return this.pu&&this.pu(t),t},bE.bu=-1,bE);function bE(t,e){var n=this;this.previousValue=t,e&&(e.wu=function(t){return n.mu(t)},this.pu=function(t){return e.gu(t)})}function _E(t){pE(),this.Pi=t}(yE=vE=vE||{}).yu="all",yE._u="listen_stream_idle",yE.Iu="listen_stream_connection_backoff",yE.Tu="write_stream_idle",yE.Eu="write_stream_connection_backoff",yE.Ru="online_state_timeout",yE.Au="client_metadata_refresh",yE.Du="lru_garbage_collection",yE.Pu="retry_transaction";var EE=(kE.Ou=function(t,e,n,r,i){var o=new kE(t,e,Date.now()+n,r,i);return o.start(n),o},kE.prototype.start=function(t){var e=this;this.Fu=setTimeout(function(){return e.xu()},t)},kE.prototype.ju=function(){return this.xu()},kE.prototype.cancel=function(t){null!==this.Fu&&(this.clearTimeout(),this.ku.reject(new mg(gg.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},kE.prototype.xu=function(){var e=this;this.Su.Uu(function(){return null!==e.Fu?(e.clearTimeout(),e.op().then(function(t){return e.ku.resolve(t)})):Promise.resolve()})},kE.prototype.clearTimeout=function(){null!==this.Fu&&(this.Nu(this),clearTimeout(this.Fu),this.Fu=null)},kE),IE=(Object.defineProperty(AE.prototype,"Wu",{get:function(){return this.Bu},enumerable:!0,configurable:!0}),AE.prototype.Uu=function(t){this.enqueue(t)},AE.prototype.zu=function(t){this.Ku(),this.Hu(t)},AE.prototype.Ju=function(t){return this.Ku(),this.Hu(t)},AE.prototype.Yu=function(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.Ku(),this.Bu?[3,2]:(this.Bu=!0,[4,this.Ju(e)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},AE.prototype.enqueue=function(t){return this.Ku(),this.Bu?new Promise(function(t){}):this.Hu(t)},AE.prototype.Hu=function(t){var n=this,e=this.Lu.then(function(){return n.Qu=!0,t().catch(function(t){n.qu=t,n.Qu=!1;var e=t.stack||t.message||"";throw ng("INTERNAL UNHANDLED ERROR: ",e),e.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return n.Qu=!1,t})});return this.Lu=e},AE.prototype.Xu=function(t,e,n){var r=this;this.Ku(),og(0<=e,"Attempted to schedule an operation with a negative delay of "+e),-1<this.Gu.indexOf(t)&&(e=0);var i=EE.Ou(this,t,e,n,function(t){return r.$u(t)});return this.Mu.push(i),i},AE.prototype.Ku=function(){this.qu&&ig("AsyncQueue is already failed: "+(this.qu.stack||this.qu.message))},AE.prototype.Zu=function(){og(this.Qu,"verifyOpInProgress() called when no op in progress on this queue.")},AE.prototype.ts=function(){return this.Ju(function(){return Promise.resolve()})},AE.prototype.ns=function(t){for(var e=0,n=this.Mu;e<n.length;e++)if(n[e].Cu===t)return!0;return!1},AE.prototype.es=function(r){var i=this;return this.ts().then(function(){og(r===vE.yu||i.ns(r),"Attempted to drain to missing operation "+r),i.Mu.sort(function(t,e){return t.Vu-e.Vu});for(var t=0,e=i.Mu;t<e.length;t++){var n=e[t];if(n.ju(),r!==vE.yu&&n.Cu===r)break}return i.ts()})},AE.prototype.rs=function(t){this.Gu.push(t)},AE.prototype.$u=function(t){var e=this.Mu.indexOf(t);og(0<=e,"Delayed operation not found."),this.Mu.splice(e,1)},AE),TE="",SE="",CE="",NE="";function AE(){this.Lu=Promise.resolve(),this.Bu=!1,this.Mu=[],this.qu=null,this.Qu=!1,this.Gu=[]}function kE(t,e,n,r,i){this.Su=t,this.Cu=e,this.Vu=n,this.op=r,this.Nu=i,this.ku=new dE,this.then=this.ku.promise.then.bind(this.ku.promise),this.catch=this.ku.promise.catch.bind(this.ku.promise),this.ku.promise.catch(function(t){})}function RE(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=PE(e)),e=OE(t.get(n),e);return PE(e)}function OE(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=TE+CE;break;case TE:n+=TE+NE;break;default:n+=o}}return n}function PE(t){return t+TE+SE}function DE(t){var e=t.length;if(og(2<=e,"Invalid path "+t),2===e)return og(t.charAt(0)===TE&&t.charAt(1)===SE,"Non-empty path "+t+" had length 2"),om.et;for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf(TE,o);switch((s<0||n<s)&&ig('Invalid encoded resource path: "'+t+'"'),t.charAt(s+1)){case SE:var a=t.substring(o,s),u=void 0;0===i.length?u=a:(u=i+=a,i=""),r.push(u);break;case CE:i+=t.substring(o,s),i+="\0";break;case NE:i+=t.substring(o,s+1);break;default:ig('Invalid encoded resource path: "'+t+'"')}o=s+2}return new om(r)}var xE=(iI.prototype.Wt=function(t,e,n){e&&og(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.us;og(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var s=r[i];e=o.Wt(e,s)}}return e},iI.prototype.Gt=function(t,e){e&&og(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=0,r=this.baseMutations;n<r.length;n++)(a=r[n]).key.isEqual(t)&&(e=a.Gt(e,e,this.Fn));for(var i=e,o=0,s=this.mutations;o<s.length;o++){var a;(a=s[o]).key.isEqual(t)&&(e=a.Gt(e,i,this.Fn))}return e},iI.prototype.ss=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Gt(t.key,n.get(t.key));e&&(i=i.lt(t.key,e))}),i},iI.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},C_())},iI.prototype.isEqual=function(t){return this.batchId===t.batchId&&cg(this.mutations,t.mutations)&&cg(this.baseMutations,t.baseMutations)},iI),LE=(rI.from=function(t,e,n,r){og(t.mutations.length===n.length,"Mutations sent "+t.mutations.length+" must equal results received "+n.length);for(var i=T_(),o=t.mutations,s=0;s<o.length;s++)i=i.lt(o[s].key,n[s].version);return new rI(t,e,n,r,i)},rI),ME=(nI.prototype.J=function(){return this.cs.J()},nI.prototype.ls=function(t,e){var n=new UE(t,e);this.cs=this.cs.add(n),this.as=this.as.add(n)},nI.prototype.ds=function(t,e){var n=this;t.forEach(function(t){return n.ls(t,e)})},nI.prototype.vs=function(t,e){this.ws(new UE(t,e))},nI.prototype.ms=function(t,e){var n=this;t.forEach(function(t){return n.vs(t,e)})},nI.prototype.ps=function(t){var e=this,n=um.EMPTY,r=new UE(n,t),i=new UE(n,t+1),o=[];return this.as.Lt([r,i],function(t){e.ws(t),o.push(t.key)}),o},nI.prototype.gs=function(){var e=this;this.cs.forEach(function(t){return e.ws(t)})},nI.prototype.ws=function(t){this.cs=this.cs.delete(t),this.as=this.as.delete(t)},nI.prototype.bs=function(t){var e=um.EMPTY,n=new UE(e,t),r=new UE(e,t+1),i=C_();return this.as.Lt([n,r],function(t){i=i.add(t.key)}),i},nI.prototype.ys=function(t){var e=new UE(t,0),n=this.cs.Mt(e);return null!==n&&t.isEqual(n.key)},nI),UE=(eI.Un=function(t,e){return um.G(t.key,e.key)||ug(t._s,e._s)},eI.fs=function(t,e){return ug(t._s,e._s)||um.G(t.key,e.key)},eI),FE=(tI.prototype.get=function(t){var e=this.Is(t),n=this.Ts[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],s=o[0],a=o[1];if(s.isEqual(t))return a}},tI.prototype.has=function(t){return void 0!==this.get(t)},tI.prototype.set=function(t,e){var n=this.Is(t),r=this.Ts[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])}else this.Ts[n]=[[t,e]]},tI.prototype.delete=function(t){var e=this.Is(t),n=this.Ts[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.Ts[e]:n.splice(r,1),!0;return!1},tI.prototype.forEach=function(a){Dg(this.Ts,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n],o=i[0],s=i[1];a(o,s)}})},tI.prototype.J=function(){return xg(this.Ts)},tI),jE=(ZE.prototype.catch=function(t){return this.next(void 0,t)},ZE.prototype.next=function(r,i){var o=this;return this.Ds&&ig("Called next() or catch() twice for PersistencePromise"),this.Ds=!0,this.As?this.error?this.Ps(i,this.error):this.Ss(r,this.result):new ZE(function(e,n){o.Es=function(t){o.Ss(r,t).next(e,n)},o.Rs=function(t){o.Ps(i,t).next(e,n)}})},ZE.prototype.Cs=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},ZE.prototype.Vs=function(t){try{var e=t();return e instanceof ZE?e:ZE.resolve(e)}catch(t){return ZE.reject(t)}},ZE.prototype.Ss=function(t,e){return t?this.Vs(function(){return t(e)}):ZE.resolve(e)},ZE.prototype.Ps=function(t,e){return t?this.Vs(function(){return t(e)}):ZE.reject(e)},ZE.resolve=function(n){return new ZE(function(t,e){t(n)})},ZE.reject=function(n){return new ZE(function(t,e){e(n)})},ZE.Ns=function(t){return new ZE(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},ZE.ks=function(t){for(var n=ZE.resolve(!1),e=function(e){n=n.next(function(t){return t?ZE.resolve(t):e()})},r=0,i=t;r<i.length;r++)e(i[r]);return n},ZE.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Ns(i)},ZE),qE=(Object.defineProperty($E.prototype,"readTime",{get:function(){return og(void 0!==this.xs,"Read time is not set. All removeEntry() calls must include a readTime if `trackRemovals` is used."),this.xs},set:function(t){og(void 0===this.xs||this.xs.isEqual(t),"All changes in a RemoteDocumentChangeBuffer must have the same read time"),this.xs=t},enumerable:!0,configurable:!0}),$E.prototype.js=function(t,e){this.Us(),this.readTime=e,this.Os.set(t.key,t)},$E.prototype.Ls=function(t,e){this.Us(),e&&(this.readTime=e),this.Os.set(t,null)},$E.prototype.Bs=function(t,e){this.Us();var n=this.Os.get(e);return void 0!==n?jE.resolve(n):this.Ms(t,e)},$E.prototype.getEntries=function(t,e){return this.qs(t,e)},$E.prototype.apply=function(t){return this.Us(),this.Fs=!0,this.Qs(t)},$E.prototype.Us=function(){og(!this.Fs,"Changes have already been applied.")},$E),VE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",BE=(JE.prototype.Ws=function(t){this.Gs.push(t)},JE.prototype.zs=function(){this.Gs.forEach(function(t){return t()})},JE),WE=(XE.Hs=function(o,t,s){return og(XE.Js(),"IndexedDB not supported in current environment."),eg("SimpleDb","Opening database:",o),new jE(function(n,r){var i=window.indexedDB.open(o,t);i.onsuccess=function(t){var e=t.target.result;n(new XE(e))},i.onblocked=function(){r(new mg(gg.FAILED_PRECONDITION,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var e=t.target.error;"VersionError"===e.name?r(new mg(gg.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(e)},i.onupgradeneeded=function(t){eg("SimpleDb",'Database "'+o+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;s.createOrUpgrade(e,i.transaction,t.oldVersion,ZI).next(function(){eg("SimpleDb","Database upgrade to version "+ZI+" complete")})}}).Cs()},XE.delete=function(t){return eg("SimpleDb","Removing database:",t),oI(window.indexedDB.deleteDatabase(t)).Cs()},XE.Js=function(){if("undefined"==typeof window||null==window.indexedDB)return!1;if(XE.Ys())return!0;if(void 0===window.navigator)return!1;var t=js(),e=XE.Ks(t),n=0<e&&e<10,r=XE.Xs(t),i=0<r&&r<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||n||i)},XE.Ys=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.$s)},XE.Zs=function(t,e){return t.store(e)},XE.Ks=function(t){var e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(n)},XE.Xs=function(t){var e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)},XE.prototype.to=function(e){this.db.onversionchange=function(t){return e(t)}},XE.prototype.runTransaction=function(r,c,h){return Is(this,void 0,void 0,function(){var o,s,a,e,u,n;return Ts(this,function(t){switch(t.label){case 0:o=r.startsWith("readonly"),s=r.endsWith("idempotent"),a=0,e=function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:++a,e=GE.open(u.db,o?"readonly":"readwrite",c),t.label=1;case 1:return t.trys.push([1,3,,4]),(n=h(e).catch(function(t){return e.abort(t),jE.reject(t)}).Cs()).catch(function(){}),[4,e.no];case 2:return t.sent(),[2,{value:n}];case 3:return r=t.sent(),i=s&&"FirebaseError"!==r.name&&a<3,eg("SimpleDb","Transaction failed with error: %s. Retrying: %s.",r.message,i),i?[3,4]:[2,{value:Promise.reject(r)}];case 4:return[2]}})},u=this,t.label=1;case 1:return[5,e()];case 2:return"object"==typeof(n=t.sent())?[2,n.value]:[3,1];case 3:return[2]}})})},XE.prototype.close=function(){this.db.close()},XE),HE=(Object.defineProperty(YE.prototype,"As",{get:function(){return this.eo},enumerable:!0,configurable:!0}),Object.defineProperty(YE.prototype,"uo",{get:function(){return this.ro},enumerable:!0,configurable:!0}),Object.defineProperty(YE.prototype,"cursor",{set:function(t){this.io=t},enumerable:!0,configurable:!0}),YE.prototype.done=function(){this.eo=!0},YE.prototype.so=function(t){this.ro=t},YE.prototype.delete=function(){return oI(this.io.delete())},YE),GE=(QE.open=function(t,e,n){return new QE(t.transaction(n,e))},Object.defineProperty(QE.prototype,"no",{get:function(){return this.oo.promise},enumerable:!0,configurable:!0}),QE.prototype.abort=function(t){t&&this.oo.reject(t),this.aborted||(eg("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},QE.prototype.store=function(t){var e=this.transaction.objectStore(t);return og(!!e,"Object store not part of transaction: "+t),new KE(e)},QE),KE=(zE.prototype.put=function(t,e){return oI(void 0!==e?(eg("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(eg("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},zE.prototype.add=function(t){return eg("SimpleDb","ADD",this.store.name,t,t),oI(this.store.add(t))},zE.prototype.get=function(e){var n=this;return oI(this.store.get(e)).next(function(t){return void 0===t&&(t=null),eg("SimpleDb","GET",n.store.name,e,t),t})},zE.prototype.delete=function(t){return eg("SimpleDb","DELETE",this.store.name,t),oI(this.store.delete(t))},zE.prototype.count=function(){return eg("SimpleDb","COUNT",this.store.name),oI(this.store.count())},zE.prototype.ho=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.co(n,function(t,e){r.push(e)}).next(function(){return r})},zE.prototype.ao=function(t,e){eg("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.fo=!1;var r=this.cursor(n);return this.co(r,function(t,e,n){return n.delete()})},zE.prototype.lo=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.co(r,e)},zE.prototype.do=function(i){var t=this.cursor({});return new jE(function(n,r){t.onerror=function(t){var e=aI(t.target.error);r(e)},t.onsuccess=function(t){var e=t.target.result;e?i(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},zE.prototype.co=function(t,s){var a=[];return new jE(function(o,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e=t.target.result;if(e){var n=new HE(e),r=s(e.primaryKey,e.value,n);if(r instanceof jE){var i=r.catch(function(t){return n.done(),jE.reject(t)});a.push(i)}n.As?o():null===n.uo?e.continue():e.continue(n.uo)}else o()}}).next(function(){return jE.Ns(a)})},zE.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"==typeof t?n=t:(og(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},zE.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.fo?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},zE);function zE(t){this.store=t}function QE(t){var n=this;this.transaction=t,this.aborted=!1,this.oo=new dE,this.transaction.oncomplete=function(){n.oo.resolve()},this.transaction.onabort=function(){t.error?n.oo.reject(t.error):n.oo.resolve()},this.transaction.onerror=function(t){var e=aI(t.target.error);n.oo.reject(e)}}function YE(t){this.io=t,this.eo=!1,this.ro=null}function XE(t){this.db=t,12.2===XE.Ks(js())&&ng("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function JE(){this.Gs=[]}function $E(){this.Os=new FE(function(t){return t.toString()}),this.Fs=!1}function ZE(t){var e=this;this.Es=null,this.Rs=null,this.result=void 0,this.error=void 0,this.As=!1,this.Ds=!1,t(function(t){e.As=!0,e.result=t,e.Es&&e.Es(t)},function(t){e.As=!0,e.error=t,e.Rs&&e.Rs(t)})}function tI(t){this.Is=t,this.Ts={}}function eI(t,e){this.key=t,this._s=e}function nI(){this.cs=new Tm(UE.Un),this.as=new Tm(UE.fs)}function rI(t,e,n,r,i){this.batch=t,this.os=e,this.us=n,this.streamToken=r,this.hs=i}function iI(t,e,n,r){this.batchId=t,this.Fn=e,this.baseMutations=n,og(0<(this.mutations=r).length,"Cannot create an empty mutation batch")}function oI(t){return new jE(function(n,r){t.onsuccess=function(t){var e=t.target.result;n(e)},t.onerror=function(t){var e=aI(t.target.error);r(e)}})}var sI=!1;function aI(t){var e=WE.Ks(js());if(12.2<=e&&e<13){var n="An internal error was encountered in the Indexed Database server";if(0<=t.message.indexOf(n)){var r=new mg("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return sI||(sI=!0,setTimeout(function(){throw r},0)),r}}return t}var uI=(cI.po=function(t,e,n,r){return og(""!==t.uid,"UserID must not be an empty string."),new cI(t.l()?t.uid:"",e,n,r)},cI.prototype.bo=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fI(t).lo({index:uT.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},cI.prototype.yo=function(e,t,n){return this._o(e).next(function(t){return t.lastStreamToken=n.toBase64(),dI(e).put(t)})},cI.prototype.Io=function(t){return this._o(t).next(function(t){return s_.fromBase64String(t.lastStreamToken)})},cI.prototype.To=function(e,n){return this._o(e).next(function(t){return t.lastStreamToken=n.toBase64(),dI(e).put(t)})},cI.prototype.Eo=function(c,h,l,f){var p=this,d=pI(c),v=fI(c);return v.add({}).next(function(t){og("number"==typeof t,"Auto-generated key is not a number");for(var e=new xE(t,h,l,f),n=p.serializer.Ro(p.userId,e),r=[],i=new Tm(function(t,e){return ug(t.nt(),e.nt())}),o=0,s=f;o<s.length;o++){var a=s[o],u=lT.key(p.userId,a.key.path,t);i=i.add(a.key.path.H()),r.push(v.put(n)),r.push(d.put(u,lT.PLACEHOLDER))}return i.forEach(function(t){r.push(p.vo.Ao(c,t))}),c.Ws(function(){p.mo[t]=e.keys()}),jE.Ns(r).next(function(){return e})})},cI.prototype.Do=function(t,e){var n=this;return fI(t).get(e).next(function(t){return t?(og(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),n.serializer.Po(t)):null})},cI.prototype.So=function(t,n){var r=this;return this.mo[n]?jE.resolve(this.mo[n]):this.Do(t,n).next(function(t){if(t){var e=t.keys();return r.mo[n]=e}return null})},cI.prototype.Co=function(t,e){var r=this,i=e+1,n=IDBKeyRange.lowerBound([this.userId,i]),o=null;return fI(t).lo({index:uT.userMutationsIndex,range:n},function(t,e,n){e.userId===r.userId&&(og(e.batchId>=i,"Should have found mutation after "+i),o=r.serializer.Po(e)),n.done()}).next(function(){return o})},cI.prototype.Vo=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return fI(t).lo({index:uT.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},cI.prototype.No=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return fI(t).ho(uT.userMutationsIndex,n).next(function(t){return t.map(function(t){return e.serializer.Po(t)})})},cI.prototype.ko=function(a,u){var c=this,t=lT.prefixForPath(this.userId,u.path),e=IDBKeyRange.lowerBound(t),h=[];return pI(a).lo({range:e},function(e,t,n){var r=e[0],i=e[1],o=e[2],s=DE(i);if(r===c.userId&&u.path.isEqual(s))return fI(a).get(o).next(function(t){if(!t)throw ig("Dangling document-mutation reference found: "+e+" which points to "+o);og(t.userId===c.userId,"Unexpected user '"+t.userId+"' for mutation batch "+o),h.push(c.serializer.Po(t))});n.done()}).next(function(){return h})},cI.prototype.Oo=function(r,t){var u=this,c=new Tm(ug),i=[];return t.forEach(function(a){var t=lT.prefixForPath(u.userId,a.path),e=IDBKeyRange.lowerBound(t),n=pI(r).lo({range:e},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=DE(i);r===u.userId&&a.path.isEqual(s)?c=c.add(o):n.done()});i.push(n)}),jE.Ns(i).next(function(){return u.Fo(r,c)})},cI.prototype.xo=function(t,e){var a=this;og(!e.Gn(),"Document queries shouldn't go down this path"),og(!e.bi(),"CollectionGroup queries should be handled in LocalDocumentsView");var u=e.path,c=u.length+1,n=lT.prefixForPath(this.userId,u),r=IDBKeyRange.lowerBound(n),h=new Tm(ug);return pI(t).lo({range:r},function(t,e,n){var r=t[0],i=t[1],o=t[2],s=DE(i);r===a.userId&&u.$(s)?s.length===c&&(h=h.add(o)):n.done()}).next(function(){return a.Fo(t,h)})},cI.prototype.Fo=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(fI(t).get(e).next(function(t){if(null===t)throw ig("Dangling document-mutation reference found, which points to "+e);og(t.userId===n.userId,"Unexpected user '"+t.userId+"' for mutation batch "+e),r.push(n.serializer.Po(t))}))}),jE.Ns(i).next(function(){return r})},cI.prototype.jo=function(e,n){var r=this;return lI(e.Uo,this.userId,n).next(function(t){return e.Ws(function(){r.Lo(n.batchId)}),jE.forEach(t,function(t){return r.wo.Bo(e,t)})})},cI.prototype.Lo=function(t){delete this.mo[t]},cI.prototype.Mo=function(n){var o=this;return this.bo(n).next(function(t){if(!t)return jE.resolve();var e=IDBKeyRange.lowerBound(lT.prefixForUser(o.userId)),i=[];return pI(n).lo({range:e},function(t,e,n){if(t[0]===o.userId){var r=DE(t[1]);i.push(r)}else n.done()}).next(function(){og(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.nt()}))})})},cI.prototype.ys=function(t,e){return hI(t,this.userId,e)},cI.prototype._o=function(t){var e=this;return dI(t).get(this.userId).next(function(t){return t||new aT(e.userId,-1,"")})},cI);function cI(t,e,n,r){this.userId=t,this.serializer=e,this.vo=n,this.wo=r,this.mo={}}function hI(t,o,e){var n=lT.prefixForPath(o,e.path),s=n[1],r=IDBKeyRange.lowerBound(n),a=!1;return pI(t).lo({range:r,fo:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(a=!0),n.done()}).next(function(){return a})}function lI(t,e,n){var r=t.store(uT.store),i=t.store(lT.store),o=[],s=IDBKeyRange.only(n.batchId),a=0,u=r.lo({range:s},function(t,e,n){return a++,n.delete()});o.push(u.next(function(){og(1===a,"Dangling document-mutation reference found: Missing batch "+n.batchId)}));for(var c=[],h=0,l=n.mutations;h<l.length;h++){var f=l[h],p=lT.key(e,f.key.path,n.batchId);o.push(i.delete(p)),c.push(f.key)}return jE.Ns(o).next(function(){return c})}function fI(t){return jT.Zs(t,uT.store)}function pI(t){return jT.Zs(t,lT.store)}function dI(t){return jT.Zs(t,aT.store)}var vI,yI;(yI=vI=vI||{})[yI.qo=0]="__PRIVATE_QueryCache",yI[yI.Qo=1]="__PRIVATE_SyncEngine";var gI=(SI.prototype.next=function(){var t=this.zo;return this.zo+=2,t},SI.prototype.after=function(t){return this.Wo(t+2),this.next()},SI.prototype.Wo=function(t){og((1&t)===this.Go,"Cannot supply target ID from different generator ID"),this.zo=t},SI.Ko=function(){return new SI(vI.qo,2)},SI.Ho=function(){return new SI(vI.Qo)},SI),mI=(TI.prototype.Xo=function(e,n){var r=this;return this.Yo.ko(e,n).next(function(t){return r.$o(e,n,t)})},TI.prototype.$o=function(t,r,i){return this.Jo.Bs(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Gt(r,t);return t})},TI.prototype.Zo=function(t,e,i){var o=b_();return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Gt(t,e);o=o.lt(t,e)}),o},TI.prototype.th=function(e,t){var n=this;return this.Jo.getEntries(e,t).next(function(t){return n.nh(e,t)})},TI.prototype.nh=function(r,i){var o=this;return this.Yo.Oo(r,i).next(function(t){var e=o.Zo(r,i,t),n=w_();return e.forEach(function(t,e){e=e||new $w(t,rm.B()),n=n.lt(t,e)}),n})},TI.prototype.ih=function(t,e,n){return e.Gn()?this.eh(t,e.path):e.bi()?this.rh(t,e,n):this.uh(t,e,n)},TI.prototype.eh=function(t,e){return this.Xo(t,new um(e)).next(function(t){var e=E_();return t instanceof Jw&&(e=e.lt(t.key,t)),e})},TI.prototype.rh=function(n,r,i){var o=this;og(r.path.J(),"Currently we only support collection group queries at the root.");var s=r.collectionGroup,a=E_();return this.vo.sh(n,s).next(function(t){return jE.forEach(t,function(t){var e=r.hi(t.child(s));return o.uh(n,e,i).next(function(t){t.forEach(function(t,e){a=a.lt(t,e)})})}).next(function(){return a})})},TI.prototype.uh=function(e,n,t){var h,l,r=this;return this.Jo.ih(e,n,t).next(function(t){return h=t,r.Yo.xo(e,n)}).next(function(t){return l=t,r.oh(e,l,h).next(function(t){h=t;for(var e=0,n=l;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],a=s.key,u=h.get(a),c=s.Gt(u,u,r.Fn);h=c instanceof Jw?h.lt(a,c):h.remove(a)}})}).next(function(){return h.forEach(function(t,e){n.matches(e)||(h=h.remove(t))}),h})},TI.prototype.oh=function(t,e,n){for(var r=C_(),i=0,o=e;i<o.length;i++)for(var s=0,a=o[i].mutations;s<a.length;s++){var u=a[s];u instanceof nw&&null===n.get(u.key)&&(r=r.add(u.key))}var c=n;return this.Jo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Jw&&(c=c.lt(t,e))}),c})},TI),wI=(II.fh=function(t,e){for(var n=C_(),r=C_(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case k_.Mi:n=n.add(s.doc.key);break;case k_.qi:r=r.add(s.doc.key)}}return new II(t,e.fromCache,n,r)},II),bI="LocalStore",_I=(EI.prototype.start=function(){return this.Dh()},EI.prototype.Ph=function(i){return Is(this,void 0,void 0,function(){var e,y,n,r=this;return Ts(this,function(t){switch(t.label){case 0:return e=this.Yo,y=this.Eh,[4,this.persistence.runTransaction("Handle user change","readonly-idempotent",function(d){var v;return r.Yo.No(d).next(function(t){return v=t,e=r.persistence.bh(i),y=new mI(r.yh,e,r.persistence.Rh()),e.No(d)}).next(function(t){for(var e=[],n=[],r=C_(),i=0,o=v;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var a=0,u=s.mutations;a<u.length;a++){var c=u[a];r=r.add(c.key)}}for(var h=0,l=t;h<l.length;h++){s=l[h],n.push(s.batchId);for(var f=0,p=s.mutations;f<p.length;f++)c=p[f],r=r.add(c.key)}return y.th(d,r).next(function(t){return{Sh:t,Ch:e,Vh:n}})})})];case 1:return n=t.sent(),this.Yo=e,this.Eh=y,this.lh.Ah(this.Eh),[2,n]}})})},EI.prototype.Nh=function(a){var u,c=this,h=nm.now(),t=a.reduce(function(t,e){return t.add(e.key)},C_());return this.persistence.runTransaction("Locally write mutations","readwrite-idempotent",function(s){return c.Eh.th(s,t).next(function(t){u=t;for(var e=[],n=0,r=a;n<r.length;n++){var i=r[n],o=i.sn(u.get(i.key));null!=o&&e.push(new nw(i.key,o,o.on(),Zm.exists(!0)))}return c.Yo.Eo(s,h,e,a)})}).then(function(t){var e=t.ss(u);return{batchId:t.batchId,Os:e}})},EI.prototype.kh=function(t){var n=this;return this.persistence.runTransaction("Lookup mutation documents","readonly-idempotent",function(e){return n.Yo.So(e,t).next(function(t){return t?n.Eh.th(e,t):jE.resolve(null)})})},EI.prototype.yo=function(r){var i=this;return this.persistence.runTransaction("Acknowledge batch","readwrite-primary-idempotent",function(t){var e=r.batch.keys(),n=i.yh.Oh({Fh:!0});return i.Yo.yo(t,r.batch,r.streamToken).next(function(){return i.xh(t,r,n)}).next(function(){return n.apply(t)}).next(function(){return i.Yo.Mo(t)}).next(function(){return i.Eh.th(t,e)})})},EI.prototype.jh=function(t){var r=this;return this.persistence.runTransaction("Reject batch","readwrite-primary-idempotent",function(e){var n;return r.Yo.Do(e,t).next(function(t){return og(null!==t,"Attempt to reject nonexistent batch!"),n=t.keys(),r.Yo.jo(e,t)}).next(function(){return r.Yo.Mo(e)}).next(function(){return r.Eh.th(e,n)})})},EI.prototype.Vo=function(){var e=this;return this.persistence.runTransaction("Get highest unacknowledged batch id","readonly-idempotent",function(t){return e.Yo.Vo(t)})},EI.prototype.Io=function(){var e=this;return this.persistence.runTransaction("Get last stream token","readonly-idempotent",function(t){return e.Yo.Io(t)})},EI.prototype.To=function(e){var n=this;return this.persistence.runTransaction("Set last stream token","readwrite-primary-idempotent",function(t){return n.Yo.To(t,e)})},EI.prototype.Uh=function(){var e=this;return this.persistence.runTransaction("Get last remote snapshot version","readonly-idempotent",function(t){return e.Ih.Uh(t)})},EI.prototype.Lh=function(u){var c=this,h=u.Oi,l=this.vh;return this.persistence.runTransaction("Apply remote event","readwrite-primary-idempotent",function(o){var i=c.yh.Oh({Fh:!0});l=c.vh;var s=[];Pg(u.te,function(t,e){var n=l.get(t);if(n){s.push(c.Ih.Bh(o,e.ce,t).next(function(){return c.Ih.Mh(o,e.oe,t)}));var r=e.resumeToken;if(0<r.Cn()){var i=n.xi(r,h).Fi(o.qh);l=l.lt(t,i),EI.Qh(n,i,e)&&s.push(c.Ih.Gh(o,i))}}});var a=w_(),n=C_();if(u.ie.forEach(function(t,e){n=n.add(t)}),s.push(i.getEntries(o,n).next(function(r){u.ie.forEach(function(t,e){var n=r.get(t);e instanceof $w&&e.version.isEqual(rm.MIN)?(i.Ls(t,h),a=a.lt(t,e)):null==n||0<e.version.h(n.version)||0===e.version.h(n.version)&&n.hasPendingWrites?(og(!rm.MIN.isEqual(h),"Cannot add a document when the remote version is zero"),i.js(e,h),a=a.lt(t,e)):eg(bI,"Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version),u.ee.has(t)&&s.push(c.persistence.wo.Wh(o,t))})})),!h.isEqual(rm.MIN)){var t=c.Ih.Uh(o).next(function(t){return og(0<=h.h(t),"Watch stream reverted to previous snapshot?? "+h+" < "+t),c.Ih.zh(o,o.qh,h)});s.push(t)}return jE.Ns(s).next(function(){return i.apply(o)}).next(function(){return c.Eh.nh(o,a)})}).then(function(t){return c.vh=l,t})},EI.Qh=function(t,e,n){return og(0<e.resumeToken.Cn(),"Attempted to persist target data with no resume token"),0===t.resumeToken.Cn()||e.Oi.M()-t.Oi.M()>=this.Kh||0<n.oe.size+n.he.size+n.ce.size},EI.prototype.Hh=function(t){for(var n=this,e=0,r=t;e<r.length;e++){var i=r[e],o=i.targetId;if(this.dh.ds(i.hh,o),this.dh.ms(i.ah,o),!i.fromCache){var s=this.vh.get(o);og(null!==s,"Can't set limbo-free snapshot version for unknown target: "+o);var a=s.Oi,u=s.ji(a);this.vh=this.vh.lt(o,u)}}return this.persistence.runTransaction("notifyLocalViewChanges","readwrite-idempotent",function(e){return jE.forEach(t,function(t){return jE.forEach(t.ah,function(t){return n.persistence.wo.vs(e,t)})})})},EI.prototype.Jh=function(e){var n=this;return this.persistence.runTransaction("Get next mutation batch","readonly-idempotent",function(t){return void 0===e&&(e=-1),n.Yo.Co(t,e)})},EI.prototype.Yh=function(e){var n=this;return this.persistence.runTransaction("read document","readonly-idempotent",function(t){return n.Eh.Xo(t,e)})},EI.prototype.Xh=function(r){var i=this;return this.persistence.runTransaction("Allocate target","readwrite-idempotent",function(e){var n;return i.Ih.$h(e,r).next(function(t){return t?(n=t,jE.resolve(n)):i.Ih.Zh(e).next(function(t){return n=new f_(r,t,i_.Ci,e.qh),i.Ih.tc(e,n).next(function(){return n})})})}).then(function(t){return null===i.vh.get(t.targetId)&&(i.vh=i.vh.lt(t.targetId,t),i.wh.set(r,t.targetId)),t})},EI.prototype.$h=function(t,e){var n=this.wh.get(e);return void 0!==n?jE.resolve(this.vh.get(n)):this.Ih.$h(t,e)},EI.prototype.nc=function(n,r){var i=this,o=this.vh.get(n);og(null!==o,"Tried to release nonexistent target: "+n);var t=r?"readwrite-idempotent":"readwrite-primary-idempotent";return this.persistence.runTransaction("Release target",t,function(e){var t=i.dh.ps(n);return r?jE.resolve():jE.forEach(t,function(t){return i.persistence.wo.vs(e,t)}).next(function(){i.persistence.wo.removeTarget(e,o)})}).then(function(){i.vh=i.vh.remove(n),i.wh.delete(o.target)})},EI.prototype.ic=function(t,n){var r=this,i=rm.MIN,o=C_();return this.persistence.runTransaction("Execute query","readonly-idempotent",function(e){return r.$h(e,t.ai()).next(function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ih.ec(e,t.targetId).next(function(t){o=t})}).next(function(){return r.lh.ih(e,t,n?i:rm.MIN,n?o:C_())}).next(function(t){return{documents:t,rc:o}})})},EI.prototype.uc=function(e){var n=this;return this.persistence.runTransaction("Remote document keys","readonly-idempotent",function(t){return n.Ih.ec(t,e)})},EI.prototype.sc=function(){return this.persistence.sc()},EI.prototype.oc=function(t){this.Yo.Lo(t)},EI.prototype.hc=function(t){this.persistence.hc(t)},EI.prototype.xh=function(t,i,o){var e=this,s=i.batch,n=s.keys(),a=jE.resolve();return n.forEach(function(r){a=a.next(function(){return o.Bs(t,r)}).next(function(t){var e=t,n=i.hs.get(r);og(null!==n,"ackVersions should contain every doc in the write."),(!e||e.version.h(n)<0)&&((e=s.Wt(r,e,i))?o.js(e,i.os):og(!t,"Mutation batch "+s+" applied to document "+t+" resulted in null"))})}),a.next(function(){return e.Yo.jo(t,s)})},EI.prototype.cc=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary-idempotent",function(t){return e.ac(t,n.vh)})},EI.prototype.fc=function(e){var n=this,t=this.vh.get(e);return t?Promise.resolve(t.target):this.persistence.runTransaction("Get target data","readonly-idempotent",function(t){return n.Ih.Xe(t,e).next(function(t){return t?t.target:null})})},EI.prototype.lc=function(){var r=this;return this.persistence.runTransaction("Get new document changes","readonly-idempotent",function(t){return r.yh.lc(t,r.mh)}).then(function(t){var e=t.dc,n=t.readTime;return r.mh=n,e})},EI.prototype.Dh=function(){return Is(this,void 0,void 0,function(){var e,n=this;return Ts(this,function(t){switch(t.label){case 0:return[4,(e=this).persistence.runTransaction("Synchronize last document change read time","readonly-idempotent",function(t){return n.yh.vc(t)})];case 1:return e.mh=t.sent(),[2]}})})},EI.Kh=3e8,EI);function EI(t,e,n){this.persistence=t,this.lh=e,this.dh=new ME,this.vh=new cm(ug),this.wh=new FE(function(t){return t.canonicalId()}),this.mh=rm.MIN,og(t.ph,"LocalStore was passed an unstarted persistence implementation"),this.persistence.wo.gh(this.dh),this.Yo=t.bh(n),this.yh=t._h(),this.Ih=t.Th(),this.Eh=new mI(this.yh,this.Yo,this.persistence.Rh()),this.lh.Ah(this.Eh)}function II(t,e,n,r){this.targetId=t,this.fromCache=e,this.hh=n,this.ah=r}function TI(t,e,n){this.Jo=t,this.Yo=e,this.vo=n}function SI(t,e){og((1&(this.Go=t))===t,"Generator ID "+t+" contains more than 1 reserved bits"),this.Wo(void 0!==e?e:this.Go)}function CI(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){if(e.code!==gg.FAILED_PRECONDITION||e.message!==VE)throw e;return eg(bI,"Unexpectedly lost primary lease"),[2]})})}function NI(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],s=ug(n,i);return 0===s?ug(r,o):s}var AI=(FI.prototype.pc=function(){return++this.mc},FI.prototype.gc=function(t){var e=[t,this.pc()];if(this.buffer.size<this.wc)this.buffer=this.buffer.add(e);else{var n=this.buffer.last();NI(e,n)<0&&(this.buffer=this.buffer.delete(n).add(e))}},Object.defineProperty(FI.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!0,configurable:!0}),FI),kI={bc:!1,yc:0,_c:0,Ic:0},RI=(UI.Ac=function(t){return new UI(t,UI.Dc,UI.Pc)},UI.Sc=-1,UI.Cc=1048576,UI.Nc=new UI(UI.Vc=41943040,UI.Dc=10,UI.Pc=1e3),UI.DISABLED=new UI(UI.Sc,0,0),UI),OI=(MI.prototype.start=function(){og(null===this.xc,"Cannot start an already started LruScheduler"),this.kc.params.Tc!==RI.Sc&&this.jc()},MI.prototype.stop=function(){this.xc&&(this.xc.cancel(),this.xc=null)},Object.defineProperty(MI.prototype,"ph",{get:function(){return null!==this.xc},enumerable:!0,configurable:!0}),MI.prototype.jc=function(){var t=this;og(null===this.xc,"Cannot schedule GC while a task is pending");var e=this.Fc?3e5:6e4;eg("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.xc=this.Su.Xu(vE.Du,e,function(){return t.xc=null,t.Fc=!0,t.Oc.cc(t.kc).then(function(){return t.jc()}).catch(CI)})},MI),PI=(LI.prototype.Lc=function(t,e){return this.Uc.Bc(t).next(function(t){return Math.floor(e/100*t)})},LI.prototype.Mc=function(t,e){var n=this;if(0===e)return jE.resolve(wE.bu);var r=new AI(e);return this.Uc.Be(t,function(t){return r.gc(t.sequenceNumber)}).next(function(){return n.Uc.qc(t,function(t){return r.gc(t)})}).next(function(){return r.maxValue})},LI.prototype.Qc=function(t,e,n){return this.Uc.Qc(t,e,n)},LI.prototype.Gc=function(t,e){return this.Uc.Gc(t,e)},LI.prototype.ac=function(e,n){var r=this;return this.params.Tc===RI.Sc?(eg("LruGarbageCollector","Garbage collection skipped; disabled"),jE.resolve(kI)):this.Wc(e).next(function(t){return t<r.params.Tc?(eg("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.Tc),kI):r.zc(e,n)})},LI.prototype.Wc=function(t){return this.Uc.Wc(t)},LI.prototype.zc=function(e,n){var r,i,o,s,a,u,c,h=this,l=Date.now();return this.Lc(e,this.params.Ec).next(function(t){return i=t>h.params.Rc?(eg("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Rc+" from "+t),h.params.Rc):t,s=Date.now(),h.Mc(e,i)}).next(function(t){return r=t,a=Date.now(),h.Qc(e,r,n)}).next(function(t){return o=t,u=Date.now(),h.Gc(e,r)}).next(function(t){return c=Date.now(),Zy()<=Wy.DEBUG&&eg("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-l)+"ms\n\tDetermined least recently used "+i+" in "+(a-s)+"ms\n\tRemoved "+o+" targets in "+(u-a)+"ms\n\tRemoved "+t+" documents in "+(c-u)+"ms\nTotal Duration: "+(c-l)+"ms"),jE.resolve({bc:!0,yc:i,_c:o,Ic:t})})},LI),DI=(xI.prototype.Zh=function(e){var n=this;return this.Hc(e).next(function(t){return t.highestTargetId=n.Kc.after(t.highestTargetId),n.Jc(e,t).next(function(){return t.highestTargetId})})},xI.prototype.Uh=function(t){return this.Hc(t).next(function(t){return rm.L(new nm(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},xI.prototype.Yc=function(t){return VI(t.Uo)},xI.prototype.zh=function(e,n,r){var i=this;return this.Hc(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.q()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Jc(e,t)})},xI.prototype.tc=function(e,n){var r=this;return this.Xc(e,n).next(function(){return r.Hc(e).next(function(t){return t.targetCount+=1,r.$c(n,t),r.Jc(e,t)})})},xI.prototype.Gh=function(t,e){return this.Xc(t,e)},xI.prototype.Zc=function(e,t){var n=this;return this.ta(e,t.targetId).next(function(){return jI(e).delete(t.targetId)}).next(function(){return n.Hc(e)}).next(function(t){return og(0<t.targetCount,"Removing from an empty target cache"),t.targetCount-=1,n.Jc(e,t)})},xI.prototype.Qc=function(r,i,o){var s=this,a=0,u=[];return jI(r).lo(function(t,e){var n=s.serializer.na(e);n.sequenceNumber<=i&&null===o.get(n.targetId)&&(a++,u.push(s.Zc(r,n)))}).next(function(){return jE.Ns(u)}).next(function(){return a})},xI.prototype.Be=function(t,r){var i=this;return jI(t).lo(function(t,e){var n=i.serializer.na(e);r(n)})},xI.prototype.Hc=function(t){return qI(t.Uo)},xI.prototype.Jc=function(t,e){return(n=t,jT.Zs(n,_T.store)).put(_T.key,e);var n},xI.prototype.Xc=function(t,e){return jI(t).put(this.serializer.ia(e))},xI.prototype.$c=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},xI.prototype.ea=function(t){return this.Hc(t).next(function(t){return t.targetCount})},xI.prototype.$h=function(t,i){var o=this,e=i.canonicalId(),n=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),s=null;return jI(t).lo({range:n,index:wT.queryTargetsIndexName},function(t,e,n){var r=o.serializer.na(e);i.isEqual(r.target)&&(s=r,n.done())}).next(function(){return s})},xI.prototype.Mh=function(n,t,r){var i=this,o=[],s=BI(n);return t.forEach(function(t){var e=RE(t.path);o.push(s.put(new bT(r,e))),o.push(i.wo.ls(n,t))}),jE.Ns(o)},xI.prototype.Bh=function(n,t,r){var i=this,o=BI(n);return jE.forEach(t,function(t){var e=RE(t.path);return jE.Ns([o.delete([r,e]),i.wo.vs(n,t)])})},xI.prototype.ta=function(t,e){var n=BI(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return n.delete(r)},xI.prototype.ec=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=BI(t),o=C_();return r.lo({range:n,fo:!0},function(t,e,n){var r=DE(t[1]),i=new um(r);o=o.add(i)}).next(function(){return o})},xI.prototype.ys=function(t,e){var n=RE(e.path),r=IDBKeyRange.bound([n],[hg(n)],!1,!0),i=0;return BI(t).lo({index:bT.documentTargetsIndex,fo:!0,range:r},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},xI.prototype.Xe=function(t,e){var n=this;return jI(t).get(e).next(function(t){return t?n.serializer.na(t):null})},xI);function xI(t,e){this.wo=t,this.serializer=e,this.Kc=gI.Ko()}function LI(t,e){this.Uc=t,this.params=e}function MI(t,e,n){this.kc=t,this.Su=e,this.Oc=n,this.Fc=!1,this.xc=null}function UI(t,e,n){this.Tc=t,this.Ec=e,this.Rc=n}function FI(t){this.wc=t,this.buffer=new Tm(NI),this.mc=0}function jI(t){return jT.Zs(t,wT.store)}function qI(t){return WE.Zs(t,_T.store).get(_T.key).next(function(t){return og(null!==t,"Missing metadata row."),t})}function VI(t){return qI(t).next(function(t){return t.highestListenSequenceNumber})}function BI(t){return jT.Zs(t,bT.store)}var WI,HI=(GI.prototype.js=function(t,e,n){return QI(t).put(YI(e),n)},GI.prototype.Ls=function(t,e){var n=QI(t),r=YI(e);return n.delete(r)},GI.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.ra(e,t)})},GI.prototype.Bs=function(t,e){var n=this;return QI(t).get(YI(e)).next(function(t){return n.ua(t)})},GI.prototype.sa=function(t,e){var n=this;return QI(t).get(YI(e)).next(function(t){var e=n.ua(t);return e?{oa:e,size:XI(t)}:null})},GI.prototype.getEntries=function(t,e){var r=this,i=b_();return this.ha(t,e,function(t,e){var n=r.ua(e);i=i.lt(t,n)}).next(function(){return i})},GI.prototype.ca=function(t,e){var r=this,i=b_(),o=new cm(um.G);return this.ha(t,e,function(t,e){var n=r.ua(e);o=n?(i=i.lt(t,n),o.lt(t,XI(e))):(i=i.lt(t,null),o.lt(t,0))}).next(function(){return{aa:i,fa:o}})},GI.prototype.ha=function(t,e,i){if(e.J())return jE.resolve();var n=IDBKeyRange.bound(e.first().path.tt(),e.last().path.tt()),o=e.bt(),s=o.Rt();return QI(t).lo({range:n},function(t,e,n){for(var r=um.at(t);s&&um.G(s,r)<0;)i(s,null),s=o.Rt();s&&s.isEqual(r)&&(i(s,e),s=o.At()?o.Rt():null),s?n.so(s.path.tt()):n.done()}).next(function(){for(;s;)i(s,null),s=o.At()?o.Rt():null})},GI.prototype.ih=function(t,i,e){var o=this;og(!i.bi(),"CollectionGroup queries should be handled in LocalDocumentsView");var s=E_(),a=i.path.length+1,n={};if(e.isEqual(rm.MIN)){var r=i.path.tt();n.range=IDBKeyRange.lowerBound(r)}else{var u=i.path.tt(),c=this.serializer.la(e);n.range=IDBKeyRange.lowerBound([u,c],!0),n.index=vT.collectionReadTimeIndex}return QI(t).lo(n,function(t,e,n){if(t.length===a){var r=o.serializer.da(e);i.path.$(r.key.path)?r instanceof Jw&&i.matches(r)&&(s=s.lt(r.key,r)):n.done()}}).next(function(){return s})},GI.prototype.lc=function(t,e){var r=this,i=w_(),o=this.serializer.la(e),n=QI(t),s=IDBKeyRange.lowerBound(o,!0);return n.lo({index:vT.readTimeIndex,range:s},function(t,e){var n=r.serializer.da(e);i=i.lt(n.key,n),o=e.readTime}).next(function(){return{dc:i,readTime:r.serializer.va(o)}})},GI.prototype.vc=function(t){var r=this,e=QI(t),i=rm.MIN;return e.lo({index:vT.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(i=r.serializer.va(e.readTime)),n.done()}).next(function(){return i})},GI.prototype.Oh=function(t){return new GI.wa(this,!!t&&t.Fh)},GI.prototype.ma=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},GI.prototype.getMetadata=function(t){return zI(t).get(yT.key).next(function(t){return og(!!t,"Missing document cache metadata"),t})},GI.prototype.ra=function(t,e){return zI(t).put(yT.key,e)},GI.prototype.ua=function(t){if(t){var e=this.serializer.da(t);return e instanceof $w&&e.version.isEqual(rm.B())?null:e}return null},GI.wa=(_s(KI,WI=qE),KI.prototype.Qs=function(s){var a=this,u=[],c=0,h=new Tm(function(t,e){return ug(t.nt(),e.nt())});return this.Os.forEach(function(t,e){var n=a.ga.get(t);if(og(void 0!==n,"Cannot modify a document that wasn't read (for "+t+")"),e){og(!a.readTime.isEqual(rm.MIN),"Cannot add a document with a read time of zero");var r=a.pa.serializer.ba(e,a.readTime);h=h.add(t.path.H());var i=XI(r);c+=i-n,u.push(a.pa.js(s,t,r))}else if(c-=n,a.Fh){var o=a.pa.serializer.ba(new $w(t,rm.B()),a.readTime);u.push(a.pa.js(s,t,o))}else u.push(a.pa.Ls(s,t))}),h.forEach(function(t){u.push(a.pa.vo.Ao(s,t))}),u.push(this.pa.updateMetadata(s,c)),jE.Ns(u)},KI.prototype.Ms=function(t,e){var n=this;return this.pa.sa(t,e).next(function(t){return null===t?(n.ga.set(e,0),null):(n.ga.set(e,t.size),t.oa)})},KI.prototype.qs=function(t,e){var n=this;return this.pa.ca(t,e).next(function(t){var e=t.aa;return t.fa.forEach(function(t,e){n.ga.set(t,e)}),e})},KI),GI);function GI(t,e){this.serializer=t,this.vo=e}function KI(t,e){var n=WI.call(this)||this;return n.pa=t,n.Fh=e,n.ga=new FE(function(t){return t.toString()}),n}function zI(t){return jT.Zs(t,yT.store)}function QI(t){return jT.Zs(t,vT.store)}function YI(t){return t.path.tt()}function XI(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ig("Unknown remote document type");e=t.noDocument}return JSON.stringify(e).length}var JI=(rT.prototype.Ao=function(t,e){return this.ya.add(e),jE.resolve()},rT.prototype.sh=function(t,e){return jE.resolve(this.ya.getEntries(e))},rT),$I=(nT.prototype.add=function(t){og(t.length%2==1,"Expected a collection path.");var e=t.X(),n=t.H(),r=this.index[e]||new Tm(om.G),i=!r.has(n);return this.index[e]=r.add(n),i},nT.prototype.has=function(t){var e=t.X(),n=t.H(),r=this.index[e];return r&&r.has(n)},nT.prototype.getEntries=function(t){return(this.index[t]||new Tm(om.G)).tt()},nT),ZI=9,tT=(eT.prototype.createOrUpgrade=function(n,r,t,e){var i=this;og(t<e&&0<=t&&e<=ZI,"Unexpected schema upgrade from v"+t+" to v{toVersion}.");var o,s=new GE(r);t<1&&1<=e&&(n.createObjectStore(oT.store),(o=n).createObjectStore(aT.store,{keyPath:aT.keyPath}),o.createObjectStore(uT.store,{keyPath:uT.keyPath,autoIncrement:!0}).createIndex(uT.userMutationsIndex,uT.userMutationsKeyPath,{unique:!0}),o.createObjectStore(lT.store),NT(n),n.createObjectStore(vT.store));var a,u=jE.resolve();return t<3&&3<=e&&(0!==t&&((a=n).deleteObjectStore(bT.store),a.deleteObjectStore(wT.store),a.deleteObjectStore(_T.store),NT(n)),u=u.next(function(){return t=s.store(_T.store),e=new _T(0,0,rm.MIN.q(),0),t.put(_T.key,e);var t,e})),t<4&&4<=e&&(0!==t&&(u=u.next(function(){return r=n,(i=s).store(uT.store).ho().next(function(t){r.deleteObjectStore(uT.store),r.createObjectStore(uT.store,{keyPath:uT.keyPath,autoIncrement:!0}).createIndex(uT.userMutationsIndex,uT.userMutationsKeyPath,{unique:!0});var e=i.store(uT.store),n=t.map(function(t){return e.put(t)});return jE.Ns(n)});var r,i})),u=u.next(function(){n.createObjectStore(AT.store,{keyPath:AT.keyPath})})),t<5&&5<=e&&(u=u.next(function(){return i.removeAcknowledgedMutations(s)})),t<6&&6<=e&&(u=u.next(function(){return n.createObjectStore(yT.store),i.addDocumentGlobal(s)})),t<7&&7<=e&&(u=u.next(function(){return i.ensureSequenceNumbers(s)})),t<8&&8<=e&&(u=u.next(function(){return i.createCollectionParentIndex(n,s)})),t<9&&9<=e&&(u=u.next(function(){var t,e;(e=n).objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges"),(t=r.objectStore(vT.store)).createIndex(vT.readTimeIndex,vT.readTimeIndexPath,{unique:!1}),t.createIndex(vT.collectionReadTimeIndex,vT.collectionReadTimeIndexPath,{unique:!1})})),u},eT.prototype.addDocumentGlobal=function(e){var n=0;return e.store(vT.store).lo(function(t,e){n+=XI(e)}).next(function(){var t=new yT(n);return e.store(yT.store).put(yT.key,t)})},eT.prototype.removeAcknowledgedMutations=function(r){var i=this,t=r.store(aT.store),e=r.store(uT.store);return t.ho().next(function(t){return jE.forEach(t,function(n){var t=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return e.ho(uT.userMutationsIndex,t).next(function(t){return jE.forEach(t,function(t){og(t.userId===n.userId,"Cannot process batch "+t.batchId+" from unexpected user");var e=i.serializer.Po(t);return lI(r,n.userId,e).next(function(){})})})})})},eT.prototype.ensureSequenceNumbers=function(t){var s=t.store(bT.store),e=t.store(vT.store);return VI(t).next(function(i){var o=[];return e.lo(function(t,e){var n=new om(t),r=[0,RE(n)];o.push(s.get(r).next(function(t){return t?jE.resolve():(e=n,s.put(new bT(0,RE(e),i)));var e}))}).next(function(){return jE.Ns(o)})})},eT.prototype.createCollectionParentIndex=function(t,e){function i(t){if(o.add(t)){var e=t.X(),n=t.H();return r.put({collectionId:e,parent:RE(n)})}}t.createObjectStore(ET.store,{keyPath:ET.keyPath});var r=e.store(ET.store),o=new $I;return e.store(vT.store).lo({fo:!0},function(t,e){var n=new om(t);return i(n.H())}).next(function(){return e.store(lT.store).lo({fo:!0},function(t,e){t[0];var n=t[1],r=(t[2],DE(n));return i(r.H())})})},eT);function eT(t){this.serializer=t}function nT(){this.index={}}function rT(){this.ya=new $I}function iT(t,e){this.seconds=t,this.nanoseconds=e}var oT=(sT.store="owner",sT.key="owner",sT);function sT(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var aT=(hT.store="mutationQueues",hT.keyPath="userId",hT),uT=(cT.store="mutations",cT.keyPath="batchId",cT.userMutationsIndex="userMutationsIndex",cT.userMutationsKeyPath=["userId","batchId"],cT);function cT(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}function hT(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}var lT=(fT.prefixForUser=function(t){return[t]},fT.prefixForPath=function(t,e){return[t,RE(e)]},fT.key=function(t,e,n){return[t,RE(e),n]},fT.store="documentMutations",fT.PLACEHOLDER=new fT,fT);function fT(){}function pT(t,e){this.path=t,this.readTime=e}function dT(t,e){this.path=t,this.version=e}var vT=(mT.store="remoteDocuments",mT.readTimeIndex="readTimeIndex",mT.readTimeIndexPath="readTime",mT.collectionReadTimeIndex="collectionReadTimeIndex",mT.collectionReadTimeIndexPath=["parentPath","readTime"],mT),yT=(gT.store="remoteDocumentGlobal",gT.key="remoteDocumentGlobalKey",gT);function gT(t){this.byteSize=t}function mT(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o}var wT=(CT.store="targets",CT.keyPath="targetId",CT.queryTargetsIndexName="queryTargetsIndex",CT.queryTargetsKeyPath=["canonicalId","targetId"],CT),bT=(ST.store="targetDocuments",ST.keyPath=["targetId","path"],ST.documentTargetsIndex="documentTargetsIndex",ST.documentTargetsKeyPath=["path","targetId"],ST),_T=(TT.key="targetGlobalKey",TT.store="targetGlobal",TT),ET=(IT.store="collectionParents",IT.keyPath=["collectionId","parent"],IT);function IT(t,e){this.collectionId=t,this.parent=e}function TT(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function ST(t,e,n){this.targetId=t,this.path=e,og(0===t==(void 0!==(this.sequenceNumber=n)),"A target-document row must either have targetId == 0 and a defined sequence number, or a non-zero targetId and no sequence number")}function CT(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}function NT(t){t.createObjectStore(bT.store,{keyPath:bT.keyPath}).createIndex(bT.documentTargetsIndex,bT.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(wT.store,{keyPath:wT.keyPath}).createIndex(wT.queryTargetsIndexName,wT.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(_T.store)}var AT=(kT.store="clientMetadata",kT.keyPath="clientId",kT);function kT(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}var RT=As(As(As([aT.store,uT.store,lT.store,vT.store,wT.store,oT.store,_T.store,bT.store],[AT.store]),[yT.store]),[ET.store]),OT=(PT.prototype.Ao=function(t,e){var n=this;if(og(e.length%2==1,"Expected a collection path."),this._a.has(e))return jE.resolve();var r=e.X(),i=e.H();t.Ws(function(){n._a.add(e)});var o={collectionId:r,parent:RE(i)};return DT(t).put(o)},PT.prototype.sh=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[hg(i),""],!1,!0);return DT(t).ho(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(DE(r.parent))}return o})},PT);function PT(){this._a=new $I}function DT(t){return jT.Zs(t,ET.store)}var xT=(LT.prototype.da=function(t){if(t.document)return this.Ia.Rr(t.document,!!t.hasCommittedMutations);if(t.noDocument){var e=um.at(t.noDocument.path),n=this.Ta(t.noDocument.readTime);return new $w(e,n,{hasCommittedMutations:!!t.hasCommittedMutations})}return t.unknownDocument?(e=um.at(t.unknownDocument.path),n=this.Ta(t.unknownDocument.version),new Zw(e,n)):ig("Unexpected DbRemoteDocument")},LT.prototype.ba=function(t,e){var n=this.la(e),r=t.key.path.H().tt();if(t instanceof Jw){var i=t.proto?t.proto:this.Ia.Er(t),o=t.hasCommittedMutations;return new vT(null,null,i,o,n,r)}if(t instanceof $w){var s=t.key.path.tt(),a=this.Ea(t.version);return o=t.hasCommittedMutations,new vT(null,new pT(s,a),null,o,n,r)}if(t instanceof Zw){s=t.key.path.tt();var u=this.Ea(t.version);return new vT(new dT(s,u),null,null,!0,n,r)}return ig("Unexpected MaybeDocument")},LT.prototype.la=function(t){var e=t.q();return[e.seconds,e.nanoseconds]},LT.prototype.va=function(t){var e=new nm(t[0],t[1]);return rm.L(e)},LT.prototype.Ea=function(t){var e=t.q();return new iT(e.seconds,e.nanoseconds)},LT.prototype.Ta=function(t){var e=new nm(t.seconds,t.nanoseconds);return rm.L(e)},LT.prototype.Ro=function(t,e){var n=this,r=e.baseMutations.map(function(t){return n.Ia.Or(t)}),i=e.mutations.map(function(t){return n.Ia.Or(t)});return new uT(t,e.batchId,e.Fn.toMillis(),r,i)},LT.prototype.Po=function(t){var e=this,n=(t.baseMutations||[]).map(function(t){return e.Ia.Ur(t)}),r=t.mutations.map(function(t){return e.Ia.Ur(t)}),i=nm.fromMillis(t.localWriteTimeMs);return new xE(t.batchId,i,n,r)},LT.prototype.Ra=function(t){var e=[];return t.forEach(function(t){e.push(RE(t.path))}),e},LT.prototype.Aa=function(t){for(var e=C_(),n=0,r=t;n<r.length;n++){var i=r[n];e=e.add(new um(DE(i)))}return e},LT.prototype.na=function(t){var e,n=this.Ta(t.readTime),r=void 0!==t.lastLimboFreeSnapshotVersion?this.Ta(t.lastLimboFreeSnapshotVersion):rm.MIN;return e=void 0!==t.query.documents?this.Ia.Wr(t.query):this.Ia.Yr(t.query),new f_(e,t.targetId,i_.Ci,t.lastListenSequenceNumber,n,r,s_.fromBase64String(t.resumeToken))},LT.prototype.ia=function(t){og(i_.Ci===t.ki,"Only queries with purpose "+i_.Ci+" may be stored, got "+t.ki);var e,n=this.Ea(t.Oi),r=this.Ea(t.lastLimboFreeSnapshotVersion);e=t.target.Gn()?this.Ia.Gr(t.target):this.Ia.zr(t.target);var i=t.resumeToken.toBase64();return new wT(t.targetId,t.target.canonicalId(),n,i,t.sequenceNumber,r,e)},LT);function LT(t){this.Ia=t}var MT,UT="Another tab has exclusive access to the persistence layer. To allow shared access, make sure to invoke `enablePersistence()` with `synchronizeTabs:true` in all tabs.",FT=(_s(VT,MT=BE),VT),jT=(qT.Zs=function(t,e){if(t instanceof FT)return WE.Zs(t.Uo,e);throw ig("IndexedDbPersistence must use instances of IndexedDbTransaction")},qT.Ua=function(n){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:if(!qT.Js())throw new mg(gg.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");return[4,(e=new qT(n.allowTabSynchronization,n.persistenceKey,n.clientId,n.platform,n.La,n.Da,n.serializer,n.Pa)).start()];case 1:return t.sent(),[2,e]}})})},qT.prototype.start=function(){var e=this;return og(!this.ph,"IndexedDbPersistence double-started!"),og(null!==this.window,"Expected 'window' to be defined"),WE.Hs(this.Fa,ZI,new tT(this.serializer)).then(function(t){return e.Ba=t,e.Ma()}).then(function(){return e.qa(),e.Qa(),e.Ga(),e.Ba.runTransaction("readonly-idempotent",[_T.store],function(t){return VI(t)})}).then(function(t){e.Wa=new wE(t,e.Pa)}).then(function(){e.Sa=!0}).catch(function(t){return e.Ba&&e.Ba.close(),Promise.reject(t)})},qT.prototype.za=function(n){var t=this;return this.Oa=function(e){return Is(t,void 0,void 0,function(){return Ts(this,function(t){return this.ph?[2,n(e)]:[2]})})},n(this.isPrimary)},qT.prototype.Ka=function(n){var t=this;this.Ba.to(function(e){return Is(t,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return null!==e.newVersion?[3,2]:[4,n()];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},qT.prototype.hc=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Da.Uu(function(){return Is(e,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.ph?[4,this.Ma()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},qT.prototype.Ma=function(){var n=this;return this.Ba.runTransaction("readwrite-idempotent",RT,function(e){return WT(e).put(new AT(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Ha(e).next(function(t){t||(n.isPrimary=!1,n.Da.Uu(function(){return n.Oa(!1)}))})}).next(function(){return n.Ja(e)}).next(function(t){return n.isPrimary&&!t?n.Ya(e).next(function(){return!1}):!!t&&n.Xa(e).next(function(){return!0})})}).catch(function(t){if(!n.allowTabSynchronization)throw t;return eg("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Da.Uu(function(){return n.Oa(t)}),n.isPrimary=t})},qT.prototype.Ha=function(t){var e=this;return BT(t).get(oT.key).next(function(t){return jE.resolve(e.$a(t))})},qT.prototype.Za=function(t){return WT(t).delete(this.clientId)},qT.prototype.tf=function(){return Is(this,void 0,void 0,function(){var i=this;return Ts(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.nf(this.ka,18e5)?[3,2]:(this.ka=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary-idempotent",function(t){var r=qT.Zs(t,AT.store);return r.ho().next(function(t){var e=i.if(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return jE.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:t.sent().forEach(function(t){i.window.localStorage.removeItem(i.ef(t.clientId))}),t.label=2;case 2:return[2]}})})},qT.prototype.Ga=function(){var t=this;this.Na=this.Da.Xu(vE.Au,4e3,function(){return t.Ma().then(function(){return t.tf()}).then(function(){return t.Ga()})})},qT.prototype.$a=function(t){return!!t&&t.ownerId===this.clientId},qT.prototype.Ja=function(e){var i=this;return BT(e).get(oT.key).next(function(t){if(null!==t&&i.nf(t.leaseTimestampMs,5e3)&&!i.rf(t.ownerId)){if(i.$a(t)&&i.networkEnabled)return!0;if(!i.$a(t)){if(!t.allowTabSynchronization)throw new mg(gg.FAILED_PRECONDITION,UT);return!1}}return!(!i.networkEnabled||!i.inForeground)||WT(e).ho().next(function(t){return void 0===i.if(t,5e3).find(function(t){if(i.clientId!==t.clientId){var e=!i.networkEnabled&&t.networkEnabled,n=!i.inForeground&&t.inForeground,r=i.networkEnabled===t.networkEnabled;if(e||n&&r)return!0}return!1})})}).next(function(t){return i.isPrimary!==t&&eg("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},qT.prototype.shutdown=function(){return Is(this,void 0,void 0,function(){var e=this;return Ts(this,function(t){switch(t.label){case 0:return this.Sa=!1,this.uf(),this.Na&&(this.Na.cancel(),this.Na=null),this.sf(),this.hf(),[4,this.Ba.runTransaction("readwrite-idempotent",[oT.store,AT.store],function(t){return e.Ya(t).next(function(){return e.Za(t)})})];case 1:return t.sent(),this.Ba.close(),this.cf(),[2]}})})},qT.prototype.if=function(t,e){var n=this;return t.filter(function(t){return n.nf(t.updateTimeMs,e)&&!n.rf(t.clientId)})},qT.prototype.sc=function(){var e=this;return this.Ba.runTransaction("readonly-idempotent",[AT.store],function(t){return WT(t).ho().next(function(t){return e.if(t,18e5).map(function(t){return t.clientId})})})},qT.clearPersistence=function(n){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return qT.Js()?(e=n+qT.xa,[4,WE.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})},Object.defineProperty(qT.prototype,"ph",{get:function(){return this.Sa},enumerable:!0,configurable:!0}),qT.prototype.bh=function(t){return og(this.ph,"Cannot initialize MutationQueue before persistence is started."),uI.po(t,this.serializer,this.vo,this.wo)},qT.prototype.Th=function(){return og(this.ph,"Cannot initialize TargetCache before persistence is started."),this.Ih},qT.prototype._h=function(){return og(this.ph,"Cannot initialize RemoteDocumentCache before persistence is started."),this.Jo},qT.prototype.Rh=function(){return og(this.ph,"Cannot initialize IndexManager before persistence is started."),this.vo},qT.prototype.runTransaction=function(n,t,r){var i=this;eg("IndexedDbPersistence","Starting transaction:",n);var o,e=t.endsWith("idempotent"),s=t.startsWith("readonly")?e?"readonly-idempotent":"readonly":e?"readwrite-idempotent":"readwrite";return this.Ba.runTransaction(s,RT,function(e){return o=new FT(e,i.Wa.next()),"readwrite-primary"===t||"readwrite-primary-idempotent"===t?i.Ha(e).next(function(t){return!!t||i.Ja(e)}).next(function(t){if(!t)throw ng("Failed to obtain primary lease for action '"+n+"'."),i.isPrimary=!1,i.Da.Uu(function(){return i.Oa(!1)}),new mg(gg.FAILED_PRECONDITION,VE);return r(o)}).next(function(t){return i.Xa(e).next(function(){return t})}):i.af(e).next(function(){return r(o)})}).then(function(t){return o.zs(),t})},qT.prototype.af=function(t){var e=this;return BT(t).get(oT.key).next(function(t){if(null!==t&&e.nf(t.leaseTimestampMs,5e3)&&!e.rf(t.ownerId)&&!e.$a(t)&&!t.allowTabSynchronization)throw new mg(gg.FAILED_PRECONDITION,UT)})},qT.prototype.Xa=function(t){var e=new oT(this.clientId,this.allowTabSynchronization,Date.now());return BT(t).put(oT.key,e)},qT.Js=function(){return WE.Js()},qT.ff=function(t){var e=t.s.projectId;return t.s.o||(e+="."+t.s.database),"firestore/"+t.persistenceKey+"/"+e+"/"},qT.prototype.Ya=function(t){var e=this,n=BT(t);return n.get(oT.key).next(function(t){return e.$a(t)?(eg("IndexedDbPersistence","Releasing primary lease."),n.delete(oT.key)):jE.resolve()})},qT.prototype.nf=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(ng("Detected an update time that is in the future: "+t+" > "+n),1))},qT.prototype.qa=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Va=function(){t.Da.Uu(function(){return t.inForeground="visible"===t.document.visibilityState,t.Ma()})},this.document.addEventListener("visibilitychange",this.Va),this.inForeground="visible"===this.document.visibilityState)},qT.prototype.sf=function(){this.Va&&(og(null!==this.document&&"function"==typeof this.document.addEventListener,"Expected 'document.addEventListener' to be a function"),this.document.removeEventListener("visibilitychange",this.Va),this.Va=null)},qT.prototype.Qa=function(){var t=this;"function"==typeof this.window.addEventListener&&(this.Ca=function(){t.uf(),t.Da.Uu(function(){return t.shutdown()})},this.window.addEventListener("unload",this.Ca))},qT.prototype.hf=function(){this.Ca&&(og("function"==typeof this.window.removeEventListener,"Expected 'window.removeEventListener' to be a function"),this.window.removeEventListener("unload",this.Ca),this.Ca=null)},qT.prototype.rf=function(t){try{var e=null!==this.ja.getItem(this.ef(t));return eg("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return ng("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},qT.prototype.uf=function(){try{this.ja.setItem(this.ef(this.clientId),String(Date.now()))}catch(t){ng("Failed to set zombie client id.",t)}},qT.prototype.cf=function(){try{this.ja.removeItem(this.ef(this.clientId))}catch(t){}},qT.prototype.ef=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},qT.xa="main",qT);function qT(t,e,n,r,i,o,s,a){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Da=o,this.Pa=a,this.Sa=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ca=null,this.inForeground=!1,this.Va=null,this.Na=null,this.ka=Number.NEGATIVE_INFINITY,this.Oa=function(t){return Promise.resolve()},this.wo=new HT(this,i),this.Fa=e+qT.xa,this.serializer=new xT(s),this.document=r.document,this.Ih=new DI(this.wo,this.serializer),this.vo=new OT,this.Jo=new HI(this.serializer,this.vo),!r.window||!r.window.localStorage)throw new mg(gg.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");this.window=r.window,this.ja=this.window.localStorage}function VT(t,e){var n=MT.call(this)||this;return n.Uo=t,n.qh=e,n}function BT(t){return t.store(oT.store)}function WT(t){return t.store(AT.store)}var HT=(GT.prototype.Bc=function(t){var n=this.df(t);return this.db.Th().ea(t).next(function(e){return n.next(function(t){return e+t})})},GT.prototype.df=function(t){var e=0;return this.qc(t,function(t){e++}).next(function(){return e})},GT.prototype.Be=function(t,e){return this.db.Th().Be(t,e)},GT.prototype.qc=function(t,n){return this.vf(t,function(t,e){return n(e)})},GT.prototype.gh=function(t){this.lf=t},GT.prototype.ls=function(t,e){return KT(t,e)},GT.prototype.vs=function(t,e){return KT(t,e)},GT.prototype.Qc=function(t,e,n){return this.db.Th().Qc(t,e,n)},GT.prototype.Bo=function(t,e){return KT(t,e)},GT.prototype.wf=function(t,e){return this.lf.ys(e)?jE.resolve(!0):(r=e,i=!1,dI(n=t).do(function(t){return hI(n,t,r).next(function(t){return t&&(i=!0),jE.resolve(!t)})}).next(function(){return i}));var n,r,i},GT.prototype.Gc=function(r,i){var o=this,s=this.db._h().Oh(),a=[],u=0;return this.vf(r,function(e,t){if(t<=i){var n=o.wf(r,e).next(function(t){if(!t)return u++,s.Bs(r,e).next(function(){return s.Ls(e),BI(r).delete([0,RE(e.path)])})});a.push(n)}}).next(function(){return jE.Ns(a)}).next(function(){return s.apply(r)}).next(function(){return u})},GT.prototype.removeTarget=function(t,e){var n=e.Fi(t.qh);return this.db.Th().Gh(t,n)},GT.prototype.Wh=function(t,e){return KT(t,e)},GT.prototype.vf=function(t,o){var s,e=BI(t),a=wE.bu;return e.lo({index:bT.documentTargetsIndex},function(t,e){var n=t[0],r=(t[1],e.path),i=e.sequenceNumber;0===n?(a!==wE.bu&&o(new um(DE(s)),a),a=i,s=r):a=wE.bu}).next(function(){a!==wE.bu&&o(new um(DE(s)),a)})},GT.prototype.Wc=function(t){return this.db._h().ma(t)},GT);function GT(t,e){this.db=t,this.lf=null,this.kc=new PI(this,e)}function KT(t,e){return BI(t).put((n=e,r=t.qh,new bT(0,RE(n.path),r)));var n,r}var zT=(XT.prototype.Ah=function(t){this.mf=t},XT.prototype.ih=function(e,r,i,o){var s=this;return og(void 0!==this.mf,"setLocalDocumentsView() not called"),r.ci()?this.pf(e,r):i.isEqual(rm.MIN)?this.pf(e,r):this.mf.th(e,o).next(function(t){var n=s.gf(r,t);return(r.mi()||r.pi())&&s.bf(r.Hn,n,o,i)?s.pf(e,r):(Zy()<=Wy.DEBUG&&eg("IndexFreeQueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),r.toString()),s.mf.ih(e,r,i).next(function(e){return n.forEach(function(t){e=e.lt(t.key,t)}),e}))})},XT.prototype.gf=function(n,t){var r=new Tm(function(t,e){return n.fi(t,e)});return t.forEach(function(t,e){e instanceof Jw&&n.matches(e)&&(r=r.add(e))}),r},XT.prototype.bf=function(t,e,n,r){if(n.size!==e.size)return!0;var i=t===bb.Wn?e.last():e.first();return!!i&&(i.hasPendingWrites||0<i.version.h(r))},XT.prototype.pf=function(t,e){return Zy()<=Wy.DEBUG&&eg("IndexFreeQueryEngine","Using full collection scan to execute query: %s",e.toString()),this.mf.ih(t,e,rm.MIN)},XT),QT=(YT.prototype.bo=function(t){return jE.resolve(0===this.Yo.length)},YT.prototype.yo=function(t,e,n){var r=e.batchId,i=this.If(r,"acknowledged");og(0===i,"Can only acknowledge the first batch in the mutation queue");var o=this.Yo[i];return og(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),this.lastStreamToken=n,jE.resolve()},YT.prototype.Io=function(t){return jE.resolve(this.lastStreamToken)},YT.prototype.To=function(t,e){return this.lastStreamToken=e,jE.resolve()},YT.prototype.Eo=function(t,e,n,r){og(0!==r.length,"Mutation batches should not be empty");var i=this.yf;this.yf++,0<this.Yo.length&&og(this.Yo[this.Yo.length-1].batchId<i,"Mutation batchIDs must be monotonically increasing order");var o=new xE(i,e,n,r);this.Yo.push(o);for(var s=0,a=r;s<a.length;s++){var u=a[s];this._f=this._f.add(new UE(u.key,i)),this.vo.Ao(t,u.key.path.H())}return jE.resolve(o)},YT.prototype.Do=function(t,e){return jE.resolve(this.Tf(e))},YT.prototype.So=function(t,e){var n=this.Tf(e);return og(null!=n,"Failed to find local mutation batch."),jE.resolve(n.keys())},YT.prototype.Co=function(t,e){var n=e+1,r=this.Ef(n),i=r<0?0:r;return jE.resolve(this.Yo.length>i?this.Yo[i]:null)},YT.prototype.Vo=function(){return jE.resolve(0===this.Yo.length?-1:this.yf-1)},YT.prototype.No=function(t){return jE.resolve(this.Yo.slice())},YT.prototype.ko=function(t,n){var r=this,e=new UE(n,0),i=new UE(n,Number.POSITIVE_INFINITY),o=[];return this._f.Lt([e,i],function(t){og(n.isEqual(t.key),"Should only iterate over a single key's batches");var e=r.Tf(t._s);og(null!==e,"Batches in the index must exist in the main table"),o.push(e)}),jE.resolve(o)},YT.prototype.Oo=function(t,e){var r=this,i=new Tm(ug);return e.forEach(function(e){var t=new UE(e,0),n=new UE(e,Number.POSITIVE_INFINITY);r._f.Lt([t,n],function(t){og(e.isEqual(t.key),"For each key, should only iterate over a single key's batches"),i=i.add(t._s)})}),jE.resolve(this.Rf(i))},YT.prototype.xo=function(t,e){og(!e.bi(),"CollectionGroup queries should be handled in LocalDocumentsView");var n=e.path,r=n.length+1,i=n;um.ht(i)||(i=i.child(""));var o=new UE(new um(i),0),s=new Tm(ug);return this._f.Bt(function(t){var e=t.key.path;return!!n.$(e)&&(e.length===r&&(s=s.add(t._s)),!0)},o),jE.resolve(this.Rf(s))},YT.prototype.Rf=function(t){var n=this,r=[];return t.forEach(function(t){var e=n.Tf(t);null!==e&&r.push(e)}),r},YT.prototype.jo=function(n,r){var i=this;og(0===this.If(r.batchId,"removed"),"Can only remove the first entry of the mutation queue"),this.Yo.shift();var o=this._f;return jE.forEach(r.mutations,function(t){var e=new UE(t.key,r.batchId);return o=o.delete(e),i.wo.Bo(n,t.key)}).next(function(){i._f=o})},YT.prototype.Lo=function(t){},YT.prototype.ys=function(t,e){var n=new UE(e,0),r=this._f.Mt(n);return jE.resolve(e.isEqual(r&&r.key))},YT.prototype.Mo=function(t){return 0===this.Yo.length&&og(this._f.J(),"Document leak -- detected dangling mutation references when queue is empty."),jE.resolve()},YT.prototype.If=function(t,e){var n=this.Ef(t);return og(0<=n&&n<this.Yo.length,"Batches must exist to be "+e),n},YT.prototype.Ef=function(t){return 0===this.Yo.length?0:t-this.Yo[0].batchId},YT.prototype.Tf=function(t){var e=this.Ef(t);if(e<0||e>=this.Yo.length)return null;var n=this.Yo[e];return og(n.batchId===t,"If found batch must match"),n},YT);function YT(t,e){this.vo=t,this.wo=e,this.Yo=[],this.yf=1,this.lastStreamToken=s_.Si,this._f=new Tm(UE.Un)}function XT(){}var JT,$T,ZT,tS,eS=(dS.prototype.js=function(t,e,n){og(!n.isEqual(rm.MIN),"Cannot add a document with a read time of zero");var r=e.key,i=this.docs.get(r),o=i?i.size:0,s=this.Af(e);return this.docs=this.docs.lt(r,{oa:e,size:s,readTime:n}),this.size+=s-o,this.vo.Ao(t,r.path.H())},dS.prototype.Ls=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},dS.prototype.Bs=function(t,e){var n=this.docs.get(e);return jE.resolve(n?n.oa:null)},dS.prototype.getEntries=function(t,e){var n=this,r=b_();return e.forEach(function(t){var e=n.docs.get(t);r=r.lt(t,e?e.oa:null)}),jE.resolve(r)},dS.prototype.ih=function(t,e,n){og(!e.bi(),"CollectionGroup queries should be handled in LocalDocumentsView");for(var r=E_(),i=new um(e.path.child("")),o=this.docs.yt(i);o.At();){var s=o.Rt(),a=s.key,u=s.value,c=u.oa,h=u.readTime;if(!e.path.$(a.path))break;h.h(n)<=0||c instanceof Jw&&e.matches(c)&&(r=r.lt(c.key,c))}return jE.resolve(r)},dS.prototype.Df=function(t,e){return jE.forEach(this.docs,function(t){return e(t)})},dS.prototype.lc=function(t,e){throw new Error("getNewDocumentChanges() is not supported with MemoryPersistence")},dS.prototype.vc=function(t){return jE.resolve(rm.MIN)},dS.prototype.Oh=function(t){return new dS.wa(this)},dS.prototype.ma=function(t){return jE.resolve(this.size)},dS.wa=(_s(vS,tS=qE),vS.prototype.Qs=function(n){var r=this,i=[];return this.Os.forEach(function(t,e){e?i.push(r.pa.js(n,e,r.readTime)):r.pa.Ls(t)}),jE.Ns(i)},vS.prototype.Ms=function(t,e){return this.pa.Bs(t,e)},vS.prototype.qs=function(t,e){return this.pa.getEntries(t,e)},vS),dS),nS=(pS.prototype.Be=function(t,n){return this.Pf.forEach(function(t,e){return n(e)}),jE.resolve()},pS.prototype.Uh=function(t){return jE.resolve(this.lastRemoteSnapshotVersion)},pS.prototype.Yc=function(t){return jE.resolve(this.Sf)},pS.prototype.Zh=function(t){var e=this.Kc.after(this.highestTargetId);return this.highestTargetId=e,jE.resolve(e)},pS.prototype.zh=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.Sf&&(this.Sf=e),jE.resolve()},pS.prototype.Xc=function(t){this.Pf.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e),t.sequenceNumber>this.Sf&&(this.Sf=t.sequenceNumber)},pS.prototype.tc=function(t,e){return og(!this.Pf.has(e.target),"Adding a target that already exists"),this.Xc(e),this.targetCount+=1,jE.resolve()},pS.prototype.Gh=function(t,e){return og(this.Pf.has(e.target),"Updating a non-existent target"),this.Xc(e),jE.resolve()},pS.prototype.Zc=function(t,e){return og(0<this.targetCount,"Removing a target from an empty cache"),og(this.Pf.has(e.target),"Removing a non-existent target from the cache"),this.Pf.delete(e.target),this.Cf.ps(e.targetId),this.targetCount-=1,jE.resolve()},pS.prototype.Qc=function(n,r,i){var o=this,s=0,a=[];return this.Pf.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Pf.delete(t),a.push(o.ta(n,e.targetId)),s++)}),jE.Ns(a).next(function(){return s})},pS.prototype.ea=function(t){return jE.resolve(this.targetCount)},pS.prototype.$h=function(t,e){var n=this.Pf.get(e)||null;return jE.resolve(n)},pS.prototype.Xe=function(t,e){return ig("Not yet implemented.")},pS.prototype.Mh=function(e,t,n){this.Cf.ds(t,n);var r=this.persistence.wo,i=[];return r&&t.forEach(function(t){i.push(r.ls(e,t))}),jE.Ns(i)},pS.prototype.Bh=function(e,t,n){this.Cf.ms(t,n);var r=this.persistence.wo,i=[];return r&&t.forEach(function(t){i.push(r.vs(e,t))}),jE.Ns(i)},pS.prototype.ta=function(t,e){return this.Cf.ps(e),jE.resolve()},pS.prototype.ec=function(t,e){var n=this.Cf.bs(e);return jE.resolve(n)},pS.prototype.ys=function(t,e){return jE.resolve(this.Cf.ys(e))},pS),rS=(fS.kf=function(t,e){return new fS(t,function(t){return new sS(t,e)})},fS.Of=function(t){return new fS(t,function(t){return new oS(t)})},fS.prototype.shutdown=function(){return this.Sa=!1,Promise.resolve()},Object.defineProperty(fS.prototype,"ph",{get:function(){return this.Sa},enumerable:!0,configurable:!0}),fS.prototype.sc=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return[2,[this.clientId]]})})},fS.prototype.za=function(t){return t(!0)},fS.prototype.Ka=function(){},fS.prototype.hc=function(t){},fS.prototype.Rh=function(){return this.vo},fS.prototype.bh=function(t){var e=this.Vf[t.v()];return e||(e=new QT(this.vo,this.wo),this.Vf[t.v()]=e),e},fS.prototype.Th=function(){return this.Ih},fS.prototype._h=function(){return this.Jo},fS.prototype.runTransaction=function(t,e,n){var r=this;eg("MemoryPersistence","Starting transaction:",t);var i=new iS(this.Wa.next());return this.wo.Ff(),n(i).next(function(t){return r.wo.xf(i).next(function(){return t})}).Cs().then(function(t){return i.zs(),t})},fS.prototype.jf=function(e,n){return jE.ks((t=this.Vf,r=[],Dg(t,function(t,e){return r.push(e)}),r).map(function(t){return function(){return t.ys(e,n)}}));var t,r},fS),iS=(_s(lS,ZT=BE),lS),oS=(Object.defineProperty(hS.prototype,"Lf",{get:function(){if(this.Uf)return this.Uf;throw ig("orphanedDocuments is only valid during a transaction.")},enumerable:!0,configurable:!0}),hS.prototype.gh=function(t){this.lf=t},hS.prototype.ls=function(t,e){return this.Lf.delete(e),jE.resolve()},hS.prototype.vs=function(t,e){return this.Lf.add(e),jE.resolve()},hS.prototype.Bo=function(t,e){return this.Lf.add(e),jE.resolve()},hS.prototype.removeTarget=function(t,e){var n=this,r=this.persistence.Th();return r.ec(t,e.targetId).next(function(t){t.forEach(function(t){return n.Lf.add(t)})}).next(function(){return r.Zc(t,e)})},hS.prototype.Ff=function(){this.Uf=new Set},hS.prototype.xf=function(t){var n=this,r=this.persistence._h().Oh();return jE.forEach(this.Lf,function(e){return n.Bf(t,e).next(function(t){t||r.Ls(e)})}).next(function(){return n.Uf=null,r.apply(t)})},hS.prototype.Wh=function(t,e){var n=this;return this.Bf(t,e).next(function(t){t?n.Lf.delete(e):n.Lf.add(e)})},hS.prototype.Nf=function(t){return 0},hS.prototype.Bf=function(t,e){var n=this;return jE.ks([function(){return n.persistence.Th().ys(t,e)},function(){return n.persistence.jf(t,e)},function(){return jE.resolve(n.lf.ys(e))}])},hS),sS=(cS.prototype.Ff=function(){},cS.prototype.xf=function(t){return jE.resolve()},cS.prototype.Be=function(t,e){return this.persistence.Th().Be(t,e)},cS.prototype.Bc=function(t){var n=this.qf(t);return this.persistence.Th().ea(t).next(function(e){return n.next(function(t){return e+t})})},cS.prototype.qf=function(t){var e=0;return this.qc(t,function(t){e++}).next(function(){return e})},cS.prototype.qc=function(n,r){var i=this;return jE.forEach(this.Mf,function(t,e){return i.wf(n,t,e).next(function(t){return t?jE.resolve():r(e)})})},cS.prototype.gh=function(t){this.lf=t},cS.prototype.Qc=function(t,e,n){return this.persistence.Th().Qc(t,e,n)},cS.prototype.Gc=function(t,n){var r=this,i=0,e=this.persistence._h(),o=e.Oh();return e.Df(t,function(e){return r.wf(t,e,n).next(function(t){t||(i++,o.Ls(e))})}).next(function(){return o.apply(t)}).next(function(){return i})},cS.prototype.Bo=function(t,e){return this.Mf.set(e,t.qh),jE.resolve()},cS.prototype.removeTarget=function(t,e){var n=e.Fi(t.qh);return this.persistence.Th().Gh(t,n)},cS.prototype.ls=function(t,e){return this.Mf.set(e,t.qh),jE.resolve()},cS.prototype.vs=function(t,e){return this.Mf.set(e,t.qh),jE.resolve()},cS.prototype.Wh=function(t,e){return this.Mf.set(e,t.qh),jE.resolve()},cS.prototype.Nf=function(t){var e=t.key.toString().length;return t instanceof Jw&&(e+=t.data().Cn()),e},cS.prototype.wf=function(t,e,n){var r=this;return jE.ks([function(){return r.persistence.jf(t,e)},function(){return jE.resolve(r.lf.ys(e))},function(){return r.persistence.Th().ys(t,e)},function(){var t=r.Mf.get(e);return jE.resolve(void 0!==t&&n<t)}])},cS.prototype.Wc=function(t){return this.persistence._h().ma(t)},cS),aS=(uS.prototype.reset=function(){this.zf=0},uS.prototype.Jf=function(){this.zf=this.Wf},uS.prototype.Yf=function(t){var e=this;this.cancel();var n=Math.floor(this.zf+this.Xf()),r=Math.max(0,Date.now()-this.Hf),i=Math.max(0,n-r);0<this.zf&&eg("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.zf+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Kf=this.Da.Xu(this.Cu,i,function(){return e.Hf=Date.now(),t()}),this.zf*=this.Gf,this.zf<this.Qf&&(this.zf=this.Qf),this.zf>this.Wf&&(this.zf=this.Wf)},uS.prototype.cancel=function(){null!==this.Kf&&(this.Kf.cancel(),this.Kf=null)},uS.prototype.Xf=function(){return(Math.random()-.5)*this.zf},uS);function uS(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Da=t,this.Cu=e,this.Qf=n,this.Gf=r,this.Wf=i,this.zf=0,this.Kf=null,this.Hf=Date.now(),this.reset()}function cS(t,e){this.persistence=t,this.lf=null,this.Mf=new FE(function(t){return RE(t.path)}),this.kc=new PI(this,e)}function hS(t){this.persistence=t,this.lf=null,this.Uf=null}function lS(t){var e=ZT.call(this)||this;return e.qh=t,e}function fS(t,e){var n=this;this.clientId=t,this.Vf={},this.Wa=new wE(0),this.Sa=!1,this.Sa=!0,this.wo=e(this),this.Ih=new nS(this),this.vo=new JI,this.Jo=new eS(this.vo,function(t){return n.wo.Nf(t)})}function pS(t){this.persistence=t,this.Pf=new FE(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=rm.MIN,this.highestTargetId=0,this.Sf=0,this.Cf=new ME,this.targetCount=0,this.Kc=gI.Ko()}function dS(t,e){this.vo=t,this.Af=e,this.docs=new cm(um.G),this.size=0}function vS(t){var e=tS.call(this)||this;return e.pa=t,e}($T=JT=JT||{})[$T.$f=0]="__PRIVATE_Initial",$T[$T.Zf=1]="__PRIVATE_Starting",$T[$T.tl=2]="__PRIVATE_Open",$T[$T.Error=3]="Error",$T[$T.nl=4]="__PRIVATE_Backoff";var yS,gS,mS=(AS.prototype.ol=function(){return this.state===JT.Zf||this.state===JT.tl||this.state===JT.nl},AS.prototype.hl=function(){return this.state===JT.tl},AS.prototype.start=function(){this.state!==JT.Error?(og(this.state===JT.$f,"Already started"),this.auth()):this.cl()},AS.prototype.stop=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.ol()?[4,this.close(JT.$f)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},AS.prototype.al=function(){og(!this.ol(),"Can only inhibit backoff in a stopped state"),this.state=JT.$f,this.sl.reset()},AS.prototype.fl=function(){var t=this;this.hl()&&null===this.ul&&(this.ul=this.Da.Xu(this.il,6e4,function(){return t.ll()}))},AS.prototype.dl=function(t){this.vl(),this.stream.send(t)},AS.prototype.ll=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return this.hl()?[2,this.close(JT.$f)]:[2]})})},AS.prototype.vl=function(){this.ul&&(this.ul.cancel(),this.ul=null)},AS.prototype.close=function(e,n){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return og(this.ol(),"Only started streams should be closed."),og(e===JT.Error||mb(n),"Can't provide an error when not in an error state."),this.vl(),this.sl.cancel(),this.rl++,e!==JT.Error?this.sl.reset():n&&n.code===gg.RESOURCE_EXHAUSTED?(ng(n.toString()),ng("Using maximum backoff delay to prevent overloading the backend."),this.sl.Jf()):n&&n.code===gg.UNAUTHENTICATED&&this.el.I(),null!==this.stream&&(this.wl(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.ml(n)];case 1:return t.sent(),[2]}})})},AS.prototype.wl=function(){},AS.prototype.auth=function(){var n=this;og(this.state===JT.$f,"Must be in initial state to auth"),this.state=JT.Zf;var t=this.pl(this.rl),e=this.rl;this.el.getToken().then(function(t){n.rl===e&&n.gl(t)},function(e){t(function(){var t=new mg(gg.UNKNOWN,"Fetching auth token failed: "+e.message);return n.bl(t)})})},AS.prototype.gl=function(t){var e=this;og(this.state===JT.Zf,"Trying to start stream in a non-starting state");var n=this.pl(this.rl);this.stream=this.yl(t),this.stream._l(function(){n(function(){return og(e.state===JT.Zf,"Expected stream to be in state Starting, but was "+e.state),e.state=JT.tl,e.listener._l()})}),this.stream.ml(function(t){n(function(){return e.bl(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},AS.prototype.cl=function(){var t=this;og(this.state===JT.Error,"Should only perform backoff when in Error state"),this.state=JT.nl,this.sl.Yf(function(){return Is(t,void 0,void 0,function(){return Ts(this,function(t){return og(this.state===JT.nl,"Backoff elapsed but state is now: "+this.state),this.state=JT.$f,this.start(),og(this.ol(),"PersistentStream should have started"),[2]})})})},AS.prototype.bl=function(t){return og(this.ol(),"Can't handle server close on non-started stream"),eg("PersistentStream","close with error: "+t),this.stream=null,this.close(JT.Error,t)},AS.prototype.pl=function(e){var n=this;return function(t){n.Da.Uu(function(){return n.rl===e?t():(eg("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},AS),wS=(_s(NS,gS=mS),NS.prototype.yl=function(t){return this.connection.Il("Listen",t)},NS.prototype.onMessage=function(t){this.sl.reset();var e=this.serializer.Vr(t),n=this.serializer.kr(t);return this.listener.Tl(e,n)},NS.prototype.watch=function(t){var e={};e.database=this.serializer.mr,e.addTarget=this.serializer.ai(t);var n=this.serializer.tu(t);n&&(e.labels=n),this.dl(e)},NS.prototype.El=function(t){var e={};e.database=this.serializer.mr,e.removeTarget=t,this.dl(e)},NS),bS=(_s(CS,yS=mS),Object.defineProperty(CS.prototype,"Al",{get:function(){return this.Rl},enumerable:!0,configurable:!0}),CS.prototype.start=function(){this.Rl=!1,yS.prototype.start.call(this)},CS.prototype.wl=function(){this.Rl&&this.Dl([])},CS.prototype.yl=function(t){return this.connection.Il("Write",t)},CS.prototype.onMessage=function(t){if(og(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=this.serializer.rr(t.streamToken),this.Rl){this.sl.reset();var e=this.serializer.Qr(t.writeResults,t.commitTime),n=this.serializer.fromVersion(t.commitTime);return this.listener.Pl(n,e)}return og(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.Rl=!0,this.listener.Sl()},CS.prototype.Cl=function(){og(this.hl(),"Writing handshake requires an opened stream"),og(!this.Rl,"Handshake already completed");var t={};t.database=this.serializer.mr,this.dl(t)},CS.prototype.Dl=function(t){var e=this;og(this.hl(),"Writing mutations requires an opened stream"),og(this.Rl,"Handshake must be complete before writing mutations"),og(0<this.lastStreamToken.Cn(),"Trying to write mutation without a token");var n={streamToken:this.serializer.er(this.lastStreamToken),writes:t.map(function(t){return e.serializer.Or(t)})};this.dl(n)},CS),_S=(SS.prototype.Vl=function(t){return new bS(this.Da,this.connection,this.credentials,this.serializer,t)},SS.prototype.Nl=function(t){return new wS(this.Da,this.connection,this.credentials,this.serializer,t)},SS.prototype.commit=function(t){var e=this,n={database:this.serializer.mr,writes:t.map(function(t){return e.serializer.Or(t)})};return this.kl("Commit",n).then(function(t){return e.serializer.Qr(t.writeResults,t.commitTime)})},SS.prototype.lookup=function(e){var i=this,t={database:this.serializer.mr,documents:e.map(function(t){return i.serializer.ar(t)})};return this.Ol("BatchGetDocuments",t).then(function(t){var n=w_();t.forEach(function(t){var e=i.serializer.Pr(t);n=n.lt(e.key,e)});var r=[];return e.forEach(function(t){var e=n.get(t);og(!!e,"Missing entity in write response for "+t),r.push(e)}),r})},SS.prototype.kl=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.connection.kl(e,n,t)}).catch(function(t){throw t.code===gg.UNAUTHENTICATED&&r.credentials.I(),t})},SS.prototype.Ol=function(e,n){var r=this;return this.credentials.getToken().then(function(t){return r.connection.Ol(e,n,t)}).catch(function(t){throw t.code===gg.UNAUTHENTICATED&&r.credentials.I(),t})},SS),ES=(TS.documentId=function(){return TS.xl},TS.prototype.isEqual=function(t){if(!(t instanceof TS))throw Yg("isEqual","FieldPath",1,t);return this.Fl.isEqual(t.Fl)},TS.xl=new TS(am.st().nt()),TS),IS=new RegExp("[~\\*/\\[\\]]");function TS(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(){if(!(t instanceof Array)||t.length<1)throw new mg(gg.INVALID_ARGUMENT,"Function FieldPath() requires its fieldNames argument to be an array with at least "+$g(1,"element")+".")}();for(var n=0;n<t.length;++n)if(jg("FieldPath","string",n,t[n]),0===t[n].length)throw new mg(gg.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.Fl=new am(t)}function SS(t,e,n,r){this.Da=t,this.connection=e,this.credentials=n,this.serializer=r}function CS(t,e,n,r,i){var o=yS.call(this,t,vE.Eu,vE.Tu,e,n,i)||this;return o.serializer=r,o.Rl=!1,o.lastStreamToken=s_.Si,o}function NS(t,e,n,r,i){var o=gS.call(this,t,vE.Iu,vE._u,e,n,i)||this;return o.serializer=r,o}function AS(t,e,n,r,i,o){this.Da=t,this.il=n,this.connection=r,this.el=i,this.listener=o,this.state=JT.$f,this.rl=0,this.ul=null,this.stream=null,this.sl=new aS(t,e)}var kS,RS,OS,PS,DS,xS,LS,MS=(ZS.delete=function(){return Lg("FieldValue.delete",arguments),US.instance},ZS.serverTimestamp=function(){return Lg("FieldValue.serverTimestamp",arguments),FS.instance},ZS.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ug("FieldValue.arrayUnion",arguments,1),new jS(t)},ZS.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ug("FieldValue.arrayRemove",arguments,1),new qS(t)},ZS.increment=function(t){return jg("FieldValue.increment","number",1,t),Mg("FieldValue.increment",arguments,1),new VS(t)},ZS.prototype.isEqual=function(t){return this===t},ZS),US=(_s($S,LS=MS),$S.instance=new $S,$S),FS=(_s(JS,xS=MS),JS.instance=new JS,JS),jS=(_s(XS,DS=MS),XS),qS=(_s(YS,PS=MS),YS),VS=(_s(QS,OS=MS),QS),BS=lE(MS,"Use FieldValue.<field>() instead."),WS=/^__.*__$/,HS=(zS.prototype.Bl=function(t,e){var n=[];return null!==this.on?n.push(new nw(t,this.data,this.on,e)):n.push(new ew(t,this.data,e)),0<this.fieldTransforms.length&&n.push(new rw(t,this.fieldTransforms)),n},zS),GS=(KS.prototype.Bl=function(t,e){var n=[new nw(t,this.data,this.on,e)];return 0<this.fieldTransforms.length&&n.push(new rw(t,this.fieldTransforms)),n},KS);function KS(t,e,n){this.data=t,this.on=e,this.fieldTransforms=n}function zS(t,e,n){this.data=t,this.on=e,this.fieldTransforms=n}function QS(t){var e=OS.call(this,"FieldValue.increment")||this;return e.Ll=t,e}function YS(t){var e=PS.call(this,"FieldValue.arrayRemove")||this;return e.Ul=t,e}function XS(t){var e=DS.call(this,"FieldValue.arrayUnion")||this;return e.Ul=t,e}function JS(){return xS.call(this,"FieldValue.serverTimestamp")||this}function $S(){return LS.call(this,"FieldValue.delete")||this}function ZS(t){this.jl=t}function tC(t){switch(t){case kS.Set:case kS.Ml:case kS.ql:return!0;case kS.Ql:case kS.Gl:return!1;default:throw ig("Unexpected case for UserDataSource: "+t)}}(RS=kS=kS||{})[RS.Set=0]="Set",RS[RS.ql=1]="__PRIVATE_Update",RS[RS.Ml=2]="__PRIVATE_MergeSet",RS[RS.Ql=3]="__PRIVATE_Argument",RS[RS.Gl=4]="__PRIVATE_ArrayArgument";var eC=(oC.prototype.Hl=function(t){var e=null==this.path?null:this.path.child(t),n=new oC(this.Wl,this.methodName,e,!1,this.fieldTransforms,this.on);return n.Jl(t),n},oC.prototype.Yl=function(t){var e=null==this.path?null:this.path.child(t),n=new oC(this.Wl,this.methodName,e,!1,this.fieldTransforms,this.on);return n.Kl(),n},oC.prototype.Xl=function(t){return new oC(this.Wl,this.methodName,null,!0,this.fieldTransforms,this.on)},oC.prototype.$l=function(t){var e=null===this.path||this.path.J()?"":" (found in field "+this.path.toString()+")";return new mg(gg.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},oC.prototype.contains=function(e){return void 0!==this.on.find(function(t){return e.$(t)})||void 0!==this.fieldTransforms.find(function(t){return e.$(t.field)})},oC.prototype.Kl=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.Jl(this.path.get(t))},oC.prototype.Jl=function(t){if(0===t.length)throw this.$l("Document fields must not be empty");if(tC(this.Wl)&&WS.test(t))throw this.$l('Document fields cannot begin and end with "__"')},oC),nC=function(t,e){this.s=t,this.key=e},rC=(iC.prototype.td=function(t,e){var n=new eC(kS.Set,t,am.et);aC("Data must be an object, but it was:",n,e);var r=this.nd(e,n);return new HS(r,null,n.fieldTransforms)},iC.prototype.ed=function(t,e,n){var r=new eC(kS.Ml,t,am.et);aC("Data must be an object, but it was:",r,e);var i,o,s=this.nd(e,r);if(n){for(var a=new Tm(am.G),u=0,c=n;u<c.length;u++){var h=c[u],l=void 0;if(h instanceof ES)l=h.Fl;else{if("string"!=typeof h)throw ig("Expected stringOrFieldPath to be a string or a FieldPath");l=cC(t,h)}if(!r.contains(l))throw new mg(gg.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");a=a.add(l)}i=qm.Jt(a),o=r.fieldTransforms.filter(function(t){return i.Xt(t.field)})}else i=qm.Yt(r.on),o=r.fieldTransforms;return new HS(s,i,o)},iC.prototype.rd=function(o,t){var s=this,a=new eC(kS.ql,o,am.et);aC("Data must be an object, but it was:",a,t);var u=new Tm(am.G),c=Qw.EMPTY;Dg(t,function(t,e){var n=cC(o,t),r=a.Yl(n);if((e=s.ud(e,r))instanceof US)u=u.add(n);else{var i=s.nd(e,r);null!=i&&(u=u.add(n),c=c.set(n,i))}});var e=qm.Jt(u);return new GS(c,e,a.fieldTransforms)},iC.prototype.sd=function(t,e,n,r){var i=new eC(kS.ql,t,am.et),o=[uC(t,e)],s=[n];if(r.length%2!=0)throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var a=0;a<r.length;a+=2)o.push(uC(t,r[a])),s.push(r[a+1]);var u=new Tm(am.G),c=Qw.EMPTY;for(a=0;a<o.length;++a){var h=o[a],l=i.Yl(h),f=this.ud(s[a],l);if(f instanceof US)u=u.add(h);else{var p=this.nd(f,l);null!=p&&(u=u.add(h),c=c.set(h,p))}}var d=qm.Jt(u);return new GS(c,d,i.fieldTransforms)},iC.prototype.od=function(t,e,n){void 0===n&&(n=!1);var r=new eC(n?kS.Gl:kS.Ql,t,am.et),i=this.nd(e,r);return og(null!=i,"Parsed data should not be null."),og(0===r.fieldTransforms.length,"Field transforms should have been disallowed."),i},iC.prototype.ud=function(t,e){try{return this.Zl(t)}catch(t){var n=hC(t);throw e.$l(n)}},iC.prototype.nd=function(t,e){if(sC(t=this.ud(t,e)))return aC("Unsupported field value:",e,t),this.hd(t,e);if(t instanceof MS)return this.ad(t,e),null;if(e.path&&e.on.push(e.path),t instanceof Array){if(e.zl&&e.Wl!==kS.Gl)throw e.$l("Nested arrays are not supported");return this.fd(t,e)}return this.ld(t,e)},iC.prototype.hd=function(t,r){var i=this,o=new cm(ug);return xg(t)?r.path&&0<r.path.length&&r.on.push(r.path):Dg(t,function(t,e){var n=i.nd(e,r.Hl(t));null!=n&&(o=o.lt(t,n))}),new Qw(o)},iC.prototype.fd=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=o[i],a=this.nd(s,e.Xl(r));null==a&&(a=mw.Vn),n.push(a),r++}return new Yw(n)},iC.prototype.ad=function(t,e){if(!tC(e.Wl))throw e.$l(t.jl+"() can only be used with update() and set()");if(null===e.path)throw e.$l(t.jl+"() is not currently supported inside arrays");if(t instanceof US){if(e.Wl!==kS.Ml)throw e.Wl===kS.ql?(og(0<e.path.length,"FieldValue.delete() at the top level should have already been handled."),e.$l("FieldValue.delete() can only appear at the top level of your update data")):e.$l("FieldValue.delete() cannot be used with set() unless you pass {merge:true}");e.on.push(e.path)}else if(t instanceof FS)e.fieldTransforms.push(new Vm(e.path,Cm.instance));else if(t instanceof jS){var n=this.dd(t.jl,t.Ul),r=new Nm(n);e.fieldTransforms.push(new Vm(e.path,r))}else if(t instanceof qS){n=this.dd(t.jl,t.Ul);var i=new Am(n);e.fieldTransforms.push(new Vm(e.path,i))}else if(t instanceof VS){var o=this.od("FieldValue.increment",t.Ll),s=new km(o);e.fieldTransforms.push(new Vm(e.path,s))}else ig("Unknown FieldValue type: "+t)},iC.prototype.ld=function(t,e){if(null===t)return mw.Vn;if("number"==typeof t)return wb(t)?new qw(t):new Vw(t);if("boolean"==typeof t)return ww.of(t);if("string"==typeof t)return new Bw(t);if(t instanceof Date)return new Ww(nm.fromDate(t));if(t instanceof nm)return new Ww(new nm(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof em)return new zw(t);if(t instanceof gE)return new Gw(t);if(t instanceof nC)return new Kw(t.s,t.key);throw e.$l("Unsupported field value: "+Kg(t))},iC.prototype.dd=function(r,t){var i=this;return t.map(function(t,e){var n=new eC(kS.Ql,r,am.et);return i.nd(t,n.Xl(e))})},iC);function iC(t){this.Zl=t}function oC(t,e,n,r,i,o){this.Wl=t,this.methodName=e,this.path=n,this.zl=r,void 0===i&&this.Kl(),this.zl=void 0!==r&&r,this.fieldTransforms=i||[],this.on=o||[]}function sC(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof nm||t instanceof em||t instanceof gE||t instanceof nC||t instanceof MS)}function aC(t,e,n){if(!sC(n)||!Gg(n)){var r=Kg(n);throw"an object"===r?e.$l(t+" a custom object"):e.$l(t+" "+r)}}function uC(t,e){if(e instanceof ES)return e.Fl;if("string"==typeof e)return cC(t,e);throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function cC(e,t){try{return function(e){if(0<=e.search(IS))throw new mg(gg.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(ES.bind.apply(ES,As([void 0],e.split("."))))}catch(t){throw new mg(gg.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}(t).Fl}catch(t){var n=hC(t);throw new mg(gg.INVALID_ARGUMENT,"Function "+e+"() called with invalid data. "+n)}}function hC(t){return t instanceof Error?t.message:t.toString()}var lC=(mC.prototype.lookup=function(r){return Is(this,void 0,void 0,function(){var e,n=this;return Ts(this,function(t){switch(t.label){case 0:if(this.bd(),0<this.mutations.length)throw new mg(gg.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,this.vd.lookup(r)];case 1:return(e=t.sent()).forEach(function(t){t instanceof $w||t instanceof Jw?n.yd(t):ig("Document in a transaction was a "+t.constructor.name)}),[2,e]}})})},mC.prototype.set=function(t,e){this.write(e.Bl(t,this.rn(t))),this.gd.add(t)},mC.prototype.update=function(t,e){try{this.write(e.Bl(t,this._d(t)))}catch(t){this.pd=t}this.gd.add(t)},mC.prototype.delete=function(t){this.write([new iw(t,this.rn(t))]),this.gd.add(t)},mC.prototype.commit=function(){return Is(this,void 0,void 0,function(){var e,n=this;return Ts(this,function(t){switch(t.label){case 0:if(this.bd(),this.pd)throw this.pd;return e=this.wd,this.mutations.forEach(function(t){e=e.remove(t.key)}),e.forEach(function(t,e){n.mutations.push(new ow(t,n.rn(t)))}),[4,this.vd.commit(this.mutations)];case 1:return t.sent(),this.md=!0,[2]}})})},mC.prototype.yd=function(t){var e;if(t instanceof Jw)e=t.version;else{if(!(t instanceof $w))throw ig("Document in a transaction was a "+t.constructor.name);e=rm.B()}var n=this.wd.get(t.key);if(null!==n){if(!e.isEqual(n))throw new mg(gg.ABORTED,"Document version changed between two reads.")}else this.wd=this.wd.lt(t.key,e)},mC.prototype.rn=function(t){var e=this.wd.get(t);return!this.gd.has(t)&&e?Zm.updateTime(e):Zm.NONE},mC.prototype._d=function(t){var e=this.wd.get(t);if(this.gd.has(t)||!e)return Zm.exists(!0);if(e.isEqual(rm.B()))throw new mg(gg.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Zm.updateTime(e)},mC.prototype.write=function(t){this.bd(),this.mutations=this.mutations.concat(t)},mC.prototype.bd=function(){og(!this.md,"A transaction object cannot be used after its update callback has been invoked.")},mC),fC=(gC.prototype.Ad=function(){var t=this;0===this.Td&&(this.Dd(Tb.Ti),og(null===this.Ed,"onlineStateTimer shouldn't be started yet"),this.Ed=this.Su.Xu(vE.Ru,1e4,function(){return t.Ed=null,og(t.state===Tb.Ti,"Timer should be canceled if we transitioned to a different state."),t.Pd("Backend didn't respond within 10 seconds."),t.Dd(Tb.Ri),Promise.resolve()}))},gC.prototype.Sd=function(t){this.state===Tb.Ei?(this.Dd(Tb.Ti),og(0===this.Td,"watchStreamFailures must be 0"),og(null===this.Ed,"onlineStateTimer must be null")):(this.Td++,1<=this.Td&&(this.Cd(),this.Pd("Connection failed 1 times. Most recent error: "+t.toString()),this.Dd(Tb.Ri)))},gC.prototype.set=function(t){this.Cd(),this.Td=0,t===Tb.Ei&&(this.Rd=!1),this.Dd(t)},gC.prototype.Dd=function(t){t!==this.state&&(this.state=t,this.Id(t))},gC.prototype.Pd=function(t){var e="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Rd?(ng(e),this.Rd=!1):eg("OnlineStateTracker",e)},gC.prototype.Cd=function(){null!==this.Ed&&(this.Ed.cancel(),this.Ed=null)},gC),pC="RemoteStore",dC=(yC.prototype.start=function(){return this.enableNetwork()},yC.prototype.enableNetwork=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.networkEnabled=!0,this.xd()?(e=this.Qd,[4,this.Oc.Io()]):[3,3];case 1:return e.lastStreamToken=t.sent(),this.Kd()?this.Hd():this.Ud.set(Tb.Ti),[4,this.Jd()];case 2:t.sent(),t.label=3;case 3:return[2]}})})},yC.prototype.disableNetwork=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Yd()];case 1:return t.sent(),this.Ud.set(Tb.Ri),[2]}})})},yC.prototype.Yd=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return[4,this.Qd.stop()];case 1:return t.sent(),[4,this.Ld.stop()];case 2:return t.sent(),0<this.Vd.length&&(eg(pC,"Stopping write stream with "+this.Vd.length+" pending writes"),this.Vd=[]),this.Xd(),[2]}})})},yC.prototype.shutdown=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return eg(pC,"RemoteStore shutting down."),this.networkEnabled=!1,[4,this.Yd()];case 1:return t.sent(),this.Od.shutdown(),this.Ud.set(Tb.Ti),[2]}})})},yC.prototype.listen=function(t){Rg(this.Nd,t.targetId)||(this.Nd[t.targetId]=t,this.Kd()?this.Hd():this.Ld.hl()&&this.$d(t))},yC.prototype.Zd=function(t){og(Rg(this.Nd,t),"unlisten called on target no currently watched: "+t),delete this.Nd[t],this.Ld.hl()&&this.tv(t),xg(this.Nd)&&(this.Ld.hl()?this.Ld.fl():this.xd()&&this.Ud.set(Tb.Ti))},yC.prototype.Xe=function(t){return this.Nd[t]||null},yC.prototype.Ye=function(t){return this.nv.Ye(t)},yC.prototype.$d=function(t){this.kd.Pe(t.targetId),this.Ld.watch(t)},yC.prototype.tv=function(t){this.kd.Pe(t),this.Ld.El(t)},yC.prototype.Hd=function(){og(this.Kd(),"startWatchStream() called when shouldStartWatchStream() is false."),this.kd=new Y_(this),this.Ld.start(),this.Ud.Ad()},yC.prototype.Kd=function(){return this.xd()&&!this.Ld.ol()&&!xg(this.Nd)},yC.prototype.xd=function(){return this.isPrimary&&this.networkEnabled},yC.prototype.Xd=function(){this.kd=null},yC.prototype.Bd=function(){return Is(this,void 0,void 0,function(){var n=this;return Ts(this,function(t){return Pg(this.Nd,function(t,e){n.$d(e)}),[2]})})},yC.prototype.Md=function(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return void 0===e&&og(!this.Kd(),"Watch stream was stopped gracefully while still needed."),this.Xd(),this.Kd()?(this.Ud.Sd(e),this.Hd()):this.Ud.set(Tb.Ti),[2]})})},yC.prototype.qd=function(n,r){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.Ud.set(Tb.Ei),n instanceof z_&&n.state===U_.qi&&n.cause?[2,this.iv(n)]:(n instanceof L_?this.kd.xe(n):n instanceof M_?this.kd.Ge(n):(og(n instanceof z_,"Expected watchChange to be an instance of WatchTargetChange"),this.kd.Le(n)),r.isEqual(rm.MIN)?[3,3]:[4,this.Oc.Uh()]);case 1:return e=t.sent(),0<=r.h(e)?[4,this.ev(r)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})},yC.prototype.ev=function(r){var i=this;og(!r.isEqual(rm.MIN),"Can't raise event for unknown SnapshotVersion");var t=this.kd.Ke(r);return Pg(t.te,function(t,e){if(0<e.resumeToken.Cn()){var n=i.Nd[t];n&&(i.Nd[t]=n.xi(e.resumeToken,r))}}),t.ne.forEach(function(t){var e=i.Nd[t];if(e){i.Nd[t]=e.xi(s_.Si,e.Oi),i.tv(t);var n=new f_(e.target,t,i_.Vi,e.sequenceNumber);i.$d(n)}}),this.nv.Lh(t)},yC.prototype.iv=function(t){var n=this;og(!!t.cause,"Handling target error without a cause");var r=t.cause,i=Promise.resolve();return t.targetIds.forEach(function(e){i=i.then(function(){return Is(n,void 0,void 0,function(){return Ts(this,function(t){return Rg(this.Nd,e)?(delete this.Nd[e],this.kd.removeTarget(e),[2,this.nv.rv(e,r)]):[2]})})})}),i},yC.prototype.Jd=function(){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return this.uv()?(e=0<this.Vd.length?this.Vd[this.Vd.length-1].batchId:-1,[4,this.Oc.Jh(e)]):[3,4];case 1:return null!==(n=t.sent())?[3,2]:(0===this.Vd.length&&this.Qd.fl(),[3,4]);case 2:return this.sv(n),[4,this.Jd()];case 3:t.sent(),t.label=4;case 4:return this.ov()&&this.hv(),[2]}})})},yC.prototype.uv=function(){return this.xd()&&this.Vd.length<10},yC.prototype.cv=function(){return this.Vd.length},yC.prototype.sv=function(t){og(this.uv(),"addToWritePipeline called when pipeline is full"),this.Vd.push(t),this.Qd.hl()&&this.Qd.Al&&this.Qd.Dl(t.mutations)},yC.prototype.ov=function(){return this.xd()&&!this.Qd.ol()&&0<this.Vd.length},yC.prototype.hv=function(){og(this.ov(),"startWriteStream() called when shouldStartWriteStream() is false."),this.Qd.start()},yC.prototype.Gd=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return this.Qd.Cl(),[2]})})},yC.prototype.zd=function(){var r=this;return this.Oc.To(this.Qd.lastStreamToken).then(function(){for(var t=0,e=r.Vd;t<e.length;t++){var n=e[t];r.Qd.Dl(n.mutations)}}).catch(CI)},yC.prototype.Pl=function(t,e){var n=this;og(0<this.Vd.length,"Got result for empty write pipeline");var r=this.Vd.shift(),i=LE.from(r,t,e,this.Qd.lastStreamToken);return this.nv.av(i).then(function(){return n.Jd()})},yC.prototype.Wd=function(n){return Is(this,void 0,void 0,function(){var e=this;return Ts(this,function(t){return void 0===n&&og(!this.ov(),"Write stream was stopped gracefully while still needed."),n&&0<this.Vd.length?[2,(this.Qd.Al?this.fv(n):this.lv(n)).then(function(){e.ov()&&e.hv()})]:[2]})})},yC.prototype.lv=function(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return y_(e.code)?(eg(pC,"RemoteStore error before completed handshake; resetting stream token: ",this.Qd.lastStreamToken),this.Qd.lastStreamToken=s_.Si,[2,this.Oc.To(s_.Si).catch(CI)]):[2]})})},yC.prototype.fv=function(i){return Is(this,void 0,void 0,function(){var n,r=this;return Ts(this,function(t){return y_(e=i.code)&&e!==gg.ABORTED?(n=this.Vd.shift(),this.Qd.al(),[2,this.nv.dv(n.batchId,i).then(function(){return r.Jd()})]):[2];var e})})},yC.prototype.vv=function(){return new lC(this.vd)},yC.prototype.jd=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.networkEnabled=!1,[4,this.Yd()];case 1:return t.sent(),this.Ud.set(Tb.Ti),[4,this.enableNetwork()];case 2:return t.sent(),[2]}})})},yC.prototype.wv=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.xd()?(eg(pC,"RemoteStore restarting streams for new credential"),[4,this.jd()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},yC.prototype.mv=function(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return(this.isPrimary=e)&&this.networkEnabled?[4,this.enableNetwork()]:[3,2];case 1:return t.sent(),[3,4];case 2:return e?[3,4]:[4,this.Yd()];case 3:t.sent(),this.Ud.set(Tb.Ti),t.label=4;case 4:return[2]}})})},yC),vC="firestore_clients";function yC(t,e,n,r,i){var o=this;this.Oc=t,this.vd=e,this.Vd=[],this.Nd={},this.kd=null,this.networkEnabled=!1,this.isPrimary=!1,this.Od=i,this.Od.Fd(function(t){n.Uu(function(){return Is(o,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.xd()?(eg(pC,"Restarting streams for network reachability change."),[4,this.jd()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Ud=new fC(n,r),this.Ld=this.vd.Nl({_l:this.Bd.bind(this),ml:this.Md.bind(this),Tl:this.qd.bind(this)}),this.Qd=this.vd.Vl({_l:this.Gd.bind(this),ml:this.Wd.bind(this),Sl:this.zd.bind(this),Pl:this.Pl.bind(this)})}function gC(t,e){this.Su=t,this.Id=e,this.state=Tb.Ti,this.Td=0,this.Ed=null,this.Rd=!0}function mC(t){this.vd=t,this.wd=T_(),this.mutations=[],this.md=!1,this.pd=null,this.gd=new Set}function wC(t,e){return og(-1===e.indexOf("_"),"Client key cannot contain '_', but was '"+e+"'"),vC+"_"+t+"_"+e}var bC="firestore_mutations";function _C(t,e,n){var r=bC+"_"+t+"_"+n;return e.l()&&(r+="_"+e.uid),r}var EC="firestore_targets";function IC(t,e){return EC+"_"+t+"_"+e}var TC="SharedClientState",SC=(MC.pv=function(t,e,n){var r=JSON.parse(n),i="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error),o=void 0;return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(o=new mg(r.error.code,r.error.message)),i?new MC(t,e,r.state,o):(ng(TC,"Failed to parse mutation state for ID '"+e+"': "+n),null)},MC.prototype.gv=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},MC),CC=(LC.pv=function(t,e){var n=JSON.parse(e),r="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error),i=void 0;return r&&n.error&&(r="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(i=new mg(n.error.code,n.error.message)),r?new LC(t,n.state,i):(ng(TC,"Failed to parse target state for ID '"+t+"': "+e),null)},LC.prototype.gv=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},LC),NC=(xC.pv=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=A_(),o=0;r&&o<n.activeTargetIds.length;++o)r=wb(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xC(t,i):(ng(TC,"Failed to parse client data for instance '"+t+"': "+e),null)},xC),AC=(DC.pv=function(t){var e=JSON.parse(t);return"object"==typeof e&&e.onlineState in Tb&&"string"==typeof e.clientId?new DC(e.clientId,Tb[e.onlineState]):(ng(TC,"Failed to parse online state: "+t),null)},DC),kC=(PC.prototype.bv=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},PC.prototype.yv=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},PC.prototype.gv=function(){var t={activeTargetIds:this.activeTargetIds.tt(),updateTimeMs:Date.now()};return JSON.stringify(t)},PC),RC=(OC.Js=function(t){return!(!t.window||null==t.window.localStorage)},OC.prototype.start=function(){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l,f=this;return Ts(this,function(t){switch(t.label){case 0:return og(!this.ph,"WebStorageSharedClientState already started"),og(null!==this.nv,"syncEngine property must be set before calling start()"),og(null!==this.Id,"onlineStateHandler property must be set before calling start()"),[4,this.nv.sc()];case 1:for(e=t.sent(),n=0,r=e;n<r.length;n++)(i=r[n])!==this._v&&(o=this.getItem(wC(this.persistenceKey,i)))&&(s=NC.pv(i,o))&&(this.Iv[s.clientId]=s);for(this.Nv(),(a=this.storage.getItem(this.Vv))&&(u=this.kv(a))&&this.Ov(u),c=0,h=this.Rv;c<h.length;c++)l=h[c],this.Ev(l);return this.Rv=[],this.platform.window.addEventListener("unload",function(){return f.shutdown()}),this.ph=!0,[2]}})})},OC.prototype.gu=function(t){this.setItem(this.Dv,JSON.stringify(t))},OC.prototype.Fv=function(){var n=A_();return Dg(this.Iv,function(t,e){n=n.qt(e.activeTargetIds)}),n},OC.prototype.xv=function(t){for(var e in this.Iv)if(this.Iv.hasOwnProperty(e)&&this.Iv[e].activeTargetIds.has(t))return!0;return!1},OC.prototype.jv=function(t){this.Uv(t,"pending")},OC.prototype.Lv=function(t,e,n){this.Uv(t,e,n),this.Bv(t)},OC.prototype.Mv=function(t){var e="not-current";if(this.xv(t)){var n=this.storage.getItem(IC(this.persistenceKey,t));if(n){var r=CC.pv(t,n);r&&(e=r.state)}}return this.qv.bv(t),this.Nv(),e},OC.prototype.Qv=function(t){this.qv.yv(t),this.Nv()},OC.prototype.Gv=function(t){return this.qv.activeTargetIds.has(t)},OC.prototype.Wv=function(t){this.removeItem(IC(this.persistenceKey,t))},OC.prototype.zv=function(t,e,n){this.Kv(t,e,n)},OC.prototype.Ph=function(t,e,n){var r=this;e.forEach(function(t){r.Bv(t)}),this.currentUser=t,n.forEach(function(t){r.jv(t)})},OC.prototype.Hv=function(t){this.Jv(t)},OC.prototype.shutdown=function(){this.ph&&(this.platform.window.removeEventListener("storage",this.Tv),this.removeItem(this.Av),this.ph=!1)},OC.prototype.getItem=function(t){var e=this.storage.getItem(t);return eg(TC,"READ",t,e),e},OC.prototype.setItem=function(t,e){eg(TC,"SET",t,e),this.storage.setItem(t,e)},OC.prototype.removeItem=function(t){eg(TC,"REMOVE",t),this.storage.removeItem(t)},OC.prototype.Ev=function(a){var t=this;if(a.storageArea===this.storage){if(eg(TC,"EVENT",a.key,a.newValue),a.key===this.Av)return void ng("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Da.Uu(function(){return Is(t,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){if(!this.ph)return this.Rv.push(a),[2];if(null===a.key)return[2];if(this.Pv.test(a.key)){if(null==a.newValue)return n=this.Yv(a.key),[2,this.Xv(n,null)];if(e=this.$v(a.key,a.newValue))return[2,this.Xv(e.clientId,e)]}else if(this.Sv.test(a.key)){if(null!==a.newValue&&(r=this.Zv(a.key,a.newValue)))return[2,this.tw(r)]}else if(this.Cv.test(a.key)){if(null!==a.newValue&&(i=this.nw(a.key,a.newValue)))return[2,this.iw(i)]}else if(a.key===this.Vv){if(null!==a.newValue&&(o=this.kv(a.newValue)))return[2,this.Ov(o)]}else a.key===this.Dv&&(og(!!this.wu,"Missing sequenceNumberHandler"),(s=function(t){var e=wE.bu;if(null!=t)try{var n=JSON.parse(t);og("number"==typeof n,"Found non-numeric sequence number"),e=n}catch(t){ng(TC,"Failed to read sequence number from WebStorage",t)}return e}(a.newValue))!==wE.bu&&this.wu(s));return[2]})})})}},Object.defineProperty(OC.prototype,"qv",{get:function(){return this.Iv[this._v]},enumerable:!0,configurable:!0}),OC.prototype.Nv=function(){this.setItem(this.Av,this.qv.gv())},OC.prototype.Uv=function(t,e,n){var r=new SC(this.currentUser,t,e,n),i=_C(this.persistenceKey,this.currentUser,t);this.setItem(i,r.gv())},OC.prototype.Bv=function(t){var e=_C(this.persistenceKey,this.currentUser,t);this.removeItem(e)},OC.prototype.Jv=function(t){var e={clientId:this._v,onlineState:Tb[t]};this.storage.setItem(this.Vv,JSON.stringify(e))},OC.prototype.Kv=function(t,e,n){var r=IC(this.persistenceKey,t),i=new CC(t,e,n);this.setItem(r,i.gv())},OC.prototype.Yv=function(t){var e=this.Pv.exec(t);return e?e[1]:null},OC.prototype.$v=function(t,e){var n=this.Yv(t);return og(null!==n,"Cannot parse client state key '"+t+"'"),NC.pv(n,e)},OC.prototype.Zv=function(t,e){var n=this.Sv.exec(t);og(null!==n,"Cannot parse mutation batch key '"+t+"'");var r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return SC.pv(new yg(i),r,e)},OC.prototype.nw=function(t,e){var n=this.Cv.exec(t);og(null!==n,"Cannot parse query target key '"+t+"'");var r=Number(n[1]);return CC.pv(r,e)},OC.prototype.kv=function(t){return AC.pv(t)},OC.prototype.tw=function(e){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return e.user.uid!==this.currentUser.uid?(eg(TC,"Ignoring mutation for non-active user "+e.user.uid),[2]):[2,this.nv.ew(e.batchId,e.state,e.error)]})})},OC.prototype.iw=function(t){return this.nv.rw(t.targetId,t.state,t.error)},OC.prototype.Xv=function(t,e){var n=this,r=this.Fv();e?this.Iv[t]=e:delete this.Iv[t];var i=this.Fv(),o=[],s=[];return i.forEach(function(e){return Is(n,void 0,void 0,function(){return Ts(this,function(t){return r.has(e)||o.push(e),[2]})})}),r.forEach(function(e){return Is(n,void 0,void 0,function(){return Ts(this,function(t){return i.has(e)||s.push(e),[2]})})}),this.nv.uw(o,s)},OC.prototype.Ov=function(t){this.Iv[t.clientId]&&this.Id(t.onlineState)},OC);function OC(t,e,n,r,i){if(this.Da=t,this.platform=e,this.persistenceKey=n,this._v=r,this.nv=null,this.Id=null,this.wu=null,this.Iv={},this.Tv=this.Ev.bind(this),this.ph=!1,this.Rv=[],!OC.Js(this.platform))throw new mg(gg.UNIMPLEMENTED,"LocalStorage is not available on this platform.");var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.platform.window.localStorage,this.currentUser=i,this.Av=wC(this.persistenceKey,this._v),this.Dv="firestore_sequence_number_"+this.persistenceKey,this.Iv[this._v]=new kC,this.Pv=new RegExp("^"+vC+"_"+o+"_([^_]*)$"),this.Sv=new RegExp("^"+bC+"_"+o+"_(\\d+)(?:_(.*))?$"),this.Cv=new RegExp("^"+EC+"_"+o+"_(\\d+)$"),this.Vv="firestore_online_state_"+this.persistenceKey,this.platform.window.addEventListener("storage",this.Tv)}function PC(){this.activeTargetIds=A_()}function DC(t,e){this.clientId=t,this.onlineState=e}function xC(t,e){this.clientId=t,this.activeTargetIds=e}function LC(t,e,n){this.targetId=t,this.state=e,og(void 0!==(this.error=n)==("rejected"===e),"QueryTargetMetadata must contain an error iff state is 'rejected'")}function MC(t,e,n,r){this.user=t,this.batchId=e,this.state=n,og(void 0!==(this.error=r)==("rejected"===n),"MutationMetadata must contain an error iff state is 'rejected'")}function UC(t){this.key=t}function FC(t){this.key=t}var jC=(BC.prototype.jv=function(t){},BC.prototype.Lv=function(t,e,n){},BC.prototype.Mv=function(t){return this.sw.bv(t),this.ow[t]||"not-current"},BC.prototype.zv=function(t,e,n){this.ow[t]=e},BC.prototype.Qv=function(t){this.sw.yv(t)},BC.prototype.Gv=function(t){return this.sw.activeTargetIds.has(t)},BC.prototype.Wv=function(t){delete this.ow[t]},BC.prototype.Fv=function(){return this.sw.activeTargetIds},BC.prototype.xv=function(t){return this.sw.activeTargetIds.has(t)},BC.prototype.start=function(){return this.sw=new kC,Promise.resolve()},BC.prototype.Ph=function(t,e,n){},BC.prototype.Hv=function(t){},BC.prototype.shutdown=function(){},BC.prototype.gu=function(t){},BC),qC=(Object.defineProperty(VC.prototype,"lw",{get:function(){return this.hw},enumerable:!0,configurable:!0}),VC.prototype.dw=function(t,e){var a=this,u=e?e.vw:new j_,c=e?e.fw:this.fw,h=e?e.Yi:this.Yi,l=c,f=!1,p=this.query.mi()&&c.size===this.query.limit?c.last():null,d=this.query.pi()&&c.size===this.query.limit?c.first():null;if(t.pt(function(t,e){var n=c.get(t),r=e instanceof Jw?e:null;r&&(og(t.isEqual(r.key),"Mismatching keys found in document changes: "+t+" != "+r.key),r=a.query.matches(r)?r:null);var i=!!n&&a.Yi.has(n.key),o=!!r&&(r.un||a.Yi.has(r.key)&&r.hasCommittedMutations),s=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:k_.Gi,doc:r}),s=!0):a.ww(n,r)||(u.track({type:k_.Qi,doc:r}),s=!0,(p&&0<a.query.fi(r,p)||d&&a.query.fi(r,d)<0)&&(f=!0)):!n&&r?(u.track({type:k_.Mi,doc:r}),s=!0):n&&!r&&(u.track({type:k_.qi,doc:n}),s=!0,(p||d)&&(f=!0)),s&&(h=r?(l=l.add(r),o?h.add(t):h.delete(t)):(l=l.delete(t),h.delete(t)))}),this.query.mi()||this.query.pi())for(;l.size>this.query.limit;){var n=this.query.mi()?l.last():l.first();l=l.delete(n.key),h=h.delete(n.key),u.track({type:k_.qi,doc:n})}return og(!f||!e,"View was refilled using docs that themselves needed refilling."),{fw:l,vw:u,bf:f,Yi:h}},VC.prototype.ww=function(t,e){return t.un&&e.hasCommittedMutations&&!e.un},VC.prototype.Qs=function(t,e,n){var o=this;og(!t.bf,"Cannot apply changes that need a refill");var r=this.fw;this.fw=t.fw,this.Yi=t.Yi;var i=t.vw.Hi();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.query.fi(t.doc,e.doc);function n(t){switch(t){case k_.Mi:return 1;case k_.Qi:case k_.Gi:return 2;case k_.qi:return 0;default:return ig("Unknown ChangeType: "+t)}}var r,i}),this.mw(n);var s=e?this.pw():[],a=0===this.aw.size&&this.se?O_.zi:O_.Wi,u=a!==this.cw;return this.cw=a,0!==i.length||u?{snapshot:new q_(this.query,t.fw,r,i,t.Yi,a===O_.Wi,u,!1),gw:s}:{gw:s}},VC.prototype.bw=function(t){return this.se&&t===Tb.Ri?(this.se=!1,this.Qs({fw:this.fw,vw:new j_,Yi:this.Yi,bf:!1},!1)):{gw:[]}},VC.prototype.yw=function(t){return!this.hw.has(t)&&!!this.fw.has(t)&&!this.fw.get(t).un},VC.prototype.mw=function(t){var e=this;t&&(t.oe.forEach(function(t){return e.hw=e.hw.add(t)}),t.he.forEach(function(t){return og(e.hw.has(t),"Modified document "+t+" not found in view.")}),t.ce.forEach(function(t){return e.hw=e.hw.delete(t)}),this.se=t.se)},VC.prototype.pw=function(){var e=this;if(!this.se)return[];var n=this.aw;this.aw=C_(),this.fw.forEach(function(t){e.yw(t.key)&&(e.aw=e.aw.add(t.key))});var r=[];return n.forEach(function(t){e.aw.has(t)||r.push(new FC(t))}),this.aw.forEach(function(t){n.has(t)||r.push(new UC(t))}),r},VC.prototype._w=function(t){this.hw=t.rc,this.aw=C_();var e=this.dw(t.documents);return this.Qs(e,!0)},VC.prototype.Iw=function(){return q_.Zi(this.query,this.fw,this.Yi,this.cw===O_.Wi)},VC);function VC(t,e){this.query=t,this.hw=e,this.cw=null,this.se=!1,this.aw=C_(),this.Yi=C_(),this.fw=new D_(t.fi.bind(t))}function BC(){this.sw=new kC,this.ow={},this.nv=null,this.Id=null,this.wu=null}function WC(t,e,n){this.query=t,this.targetId=e,this.view=n}function HC(t){this.key=t,this.Sw=!1}function GC(){this.sm=null,this.targetId=0,this.listeners=[]}function KC(){}var zC=(sN.prototype.run=function(){this.Rw()},sN.prototype.Rw=function(){var t=this;this.sl.Yf(function(){return Is(t,void 0,void 0,function(){var e,n,r=this;return Ts(this,function(t){return e=this.Tw.vv(),(n=this.Aw(e))&&n.then(function(t){r.Su.Uu(function(){return e.commit().then(function(){r.ku.resolve(t)}).catch(function(t){r.Dw(t)})})}).catch(function(t){r.Dw(t)}),[2]})})})},sN.prototype.Aw=function(t){try{var e=this.updateFunction(t);return!mb(e)&&e.catch&&e.then?e:(this.ku.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.ku.reject(t),null}},sN.prototype.Dw=function(t){var e=this;0<this.Ew&&this.Pw(t)?(this.Ew-=1,this.Su.Uu(function(){return e.Rw(),Promise.resolve()})):this.ku.reject(t)},sN.prototype.Pw=function(t){if("FirebaseError"!==t.name)return!1;var e=t.code;return"aborted"===e||"failed-precondition"===e||!y_(e)},sN),QC=(Object.defineProperty(oN.prototype,"Bw",{get:function(){return!0===this.isPrimary},enumerable:!0,configurable:!0}),oN.prototype.subscribe=function(t){og(null!==t,"SyncEngine listener cannot be null"),og(null===this.Vw,"SyncEngine already has a subscriber."),this.Vw=t},oN.prototype.listen=function(s){return Is(this,void 0,void 0,function(){var e,n,r,i,o;return Ts(this,function(t){switch(t.label){case 0:return this.Mw("listen()"),(r=this.Nw.get(s))?(e=r.targetId,this.Cw.Mv(e),n=r.view.Iw(),[3,4]):[3,1];case 1:return[4,this.Oc.Xh(s.ai())];case 2:return i=t.sent(),o=this.Cw.Mv(i.targetId),e=i.targetId,[4,this.qw(s,e,"current"===o)];case 3:n=t.sent(),this.isPrimary&&this.Tw.listen(i),t.label=4;case 4:return this.Vw.Tl([n]),[2,e]}})})},oN.prototype.qw=function(a,u,c){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return[4,this.Oc.ic(a,!0)];case 1:return e=t.sent(),n=new qC(a,e.rc),r=n.dw(e.documents),i=B_.ue(u,c&&this.onlineState!==Tb.Ri),og(0===(o=n.Qs(r,!0===this.isPrimary,i)).gw.length,"View returned limbo docs before target ack from the server."),og(!!o.snapshot,"applyChanges for new view should always return a snapshot"),s=new WC(a,u,n),this.Nw.set(a,s),this.kw[u]||(this.kw[u]=[]),this.kw[u].push(a),[2,o.snapshot]}})})},oN.prototype.Qw=function(r){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,this.Oc.ic(r.query,!0)];case 1:return e=t.sent(),n=r.view._w(e),this.isPrimary&&this.Gw(r.targetId,n.gw),[2,n]}})})},oN.prototype.Zd=function(i){return Is(this,void 0,void 0,function(){var e,n,r=this;return Ts(this,function(t){switch(t.label){case 0:return this.Mw("unlisten()"),og(!!(e=this.Nw.get(i)),"Trying to unlisten on query not found:"+i),1<(n=this.kw[e.targetId]).length?(this.kw[e.targetId]=n.filter(function(t){return!t.isEqual(i)}),this.Nw.delete(i),[2]):this.isPrimary?(this.Cw.Qv(e.targetId),this.Cw.xv(e.targetId)?[3,2]:[4,this.Oc.nc(e.targetId,!1).then(function(){r.Cw.Wv(e.targetId),r.Tw.Zd(e.targetId),r.Ww(e.targetId)}).catch(CI)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return this.Ww(e.targetId),[4,this.Oc.nc(e.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})},oN.prototype.write=function(n,r){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.Mw("write()"),[4,this.Oc.Nh(n)];case 1:return e=t.sent(),this.Cw.jv(e.batchId),this.zw(e.batchId,r),[4,this.Kw(e.Os)];case 2:return t.sent(),[4,this.Tw.Jd()];case 3:return t.sent(),[2]}})})},oN.prototype.runTransaction=function(t,e,n){new zC(t,this.Tw,e,n).run()},oN.prototype.Lh=function(n){return Is(this,void 0,void 0,function(){var e,r=this;return Ts(this,function(t){switch(t.label){case 0:this.Mw("applyRemoteEvent()"),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Oc.Lh(n)];case 2:return e=t.sent(),Dg(n.te,function(t,e){var n=r.Fw[Number(t)];n&&(og(e.oe.size+e.he.size+e.ce.size<=1,"Limbo resolution for single document contains multiple changes."),0<e.oe.size?n.Sw=!0:0<e.he.size?og(n.Sw,"Received change for limbo target document without add."):0<e.ce.size&&(og(n.Sw,"Received remove for limbo target document without add."),n.Sw=!1))}),[4,this.Kw(e,n)];case 3:return t.sent(),[3,6];case 4:return[4,CI(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oN.prototype.bw=function(r,t){if(this.isPrimary&&t===Cb.Ai||!this.isPrimary&&t===Cb.Di){this.Mw("applyOnlineStateChange()");var i=[];this.Nw.forEach(function(t,e){var n=e.view.bw(r);og(0===n.gw.length,"OnlineState should not affect limbo documents."),n.snapshot&&i.push(n.snapshot)}),this.Vw.Hw(r),this.Vw.Tl(i),this.onlineState=r,this.isPrimary&&this.Cw.Hv(r)}},oN.prototype.rv=function(a,u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s=this;return Ts(this,function(t){switch(t.label){case 0:return this.Mw("rejectListens()"),this.Cw.zv(a,"rejected",u),e=this.Fw[a],(n=e&&e.key)?(this.Ow=this.Ow.remove(n),delete this.Fw[a],r=(r=new cm(um.G)).lt(n,new $w(n,rm.B())),i=C_().add(n),o=new V_(rm.MIN,{},new Tm(ug),r,i),[2,this.Lh(o)]):[3,1];case 1:return[4,this.Oc.nc(a,!1).then(function(){return s.Ww(a,u)}).catch(CI)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},oN.prototype.ew=function(n,r,i){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.Mw("applyBatchState()"),[4,this.Oc.kh(n)];case 1:return null===(e=t.sent())?(eg("SyncEngine","Cannot apply mutation batch with id: "+n),[2]):"pending"!==r?[3,3]:[4,this.Tw.Jd()];case 2:return t.sent(),[3,4];case 3:"acknowledged"===r||"rejected"===r?(this.Jw(n,i||null),this.Oc.oc(n)):ig("Unknown batchState: "+r),t.label=4;case 4:return[4,this.Kw(e)];case 5:return t.sent(),[2]}})})},oN.prototype.av=function(r){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:this.Mw("applySuccessfulWrite()"),e=r.batch.batchId,this.Jw(e,null),this.Yw(e),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Oc.yo(r)];case 2:return n=t.sent(),this.Cw.Lv(e,"acknowledged"),[4,this.Kw(n)];case 3:return t.sent(),[3,6];case 4:return[4,CI(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oN.prototype.dv=function(n,r){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:this.Mw("rejectFailedWrite()"),this.Jw(n,r),this.Yw(n),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this.Oc.jh(n)];case 2:return e=t.sent(),this.Cw.Lv(n,"rejected",r),[4,this.Kw(e)];case 3:return t.sent(),[3,6];case 4:return[4,CI(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}})})},oN.prototype.Xw=function(r){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return this.Tw.xd()||eg("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),[4,this.Oc.Vo()];case 1:return-1===(e=t.sent())?r.resolve():((n=this.Uw.get(e)||[]).push(r),this.Uw.set(e,n)),[2]}})})},oN.prototype.Yw=function(t){(this.Uw.get(t)||[]).forEach(function(t){t.resolve()}),this.Uw.delete(t)},oN.prototype.$w=function(e){this.Uw.forEach(function(t){t.forEach(function(t){t.reject(new mg(gg.CANCELLED,e))})}),this.Uw.clear()},oN.prototype.zw=function(t,e){var n=this.jw[this.currentUser.v()];n=(n=n||new cm(ug)).lt(t,e),this.jw[this.currentUser.v()]=n},oN.prototype.Jw=function(t,e){var n=this.jw[this.currentUser.v()];if(n){var r=n.get(t);r&&(og(t===n.vt(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.jw[this.currentUser.v()]=n}},oN.prototype.Ww=function(t,e){var n=this;void 0===e&&(e=null),this.Cw.Qv(t),og(this.kw[t]&&0!==this.kw[t].length,"There are no queries mapped to target id "+t);for(var r=0,i=this.kw[t];r<i.length;r++){var o=i[r];this.Nw.delete(o),e&&this.Vw.Zw(o,e)}if(delete this.kw[t],this.isPrimary){var s=this.xw.bs(t);this.xw.ps(t),s.forEach(function(t){n.xw.ys(t)||n.tm(t)})}},oN.prototype.tm=function(t){var e=this.Ow.get(t);null!==e&&(this.Tw.Zd(e),this.Ow=this.Ow.remove(t),delete this.Fw[e])},oN.prototype.Gw=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof UC?(this.xw.ls(i.key,t),this.nm(i)):i instanceof FC?(eg("SyncEngine","Document no longer in limbo: "+i.key),this.xw.vs(i.key,t),this.xw.ys(i.key)||this.tm(i.key)):ig("Unknown limbo change: "+JSON.stringify(i))}},oN.prototype.nm=function(t){var e=t.key;if(!this.Ow.get(e)){eg("SyncEngine","New document in limbo: "+e);var n=this.Lw.next(),r=xb.$n(e.path);this.Fw[n]=new HC(e),this.Tw.listen(new f_(r.ai(),n,i_.Ni,wE.bu)),this.Ow=this.Ow.lt(e,n)}},oN.prototype.im=function(){return this.Ow},oN.prototype.Kw=function(r,u){return Is(this,void 0,void 0,function(){var o,s,e,a=this;return Ts(this,function(t){switch(t.label){case 0:return o=[],s=[],e=[],this.Nw.forEach(function(t,i){e.push(Promise.resolve().then(function(){var n=i.view.dw(r);return n.bf?a.Oc.ic(i.query,!1).then(function(t){var e=t.documents;return i.view.dw(e,n)}):n}).then(function(t){var e=u&&u.te[i.targetId],n=i.view.Qs(t,!0===a.isPrimary,e);if(a.Gw(i.targetId,n.gw),n.snapshot){a.isPrimary&&a.Cw.zv(i.targetId,n.snapshot.fromCache?"not-current":"current"),o.push(n.snapshot);var r=wI.fh(i.targetId,n.snapshot);s.push(r)}}))}),[4,Promise.all(e)];case 1:return t.sent(),this.Vw.Tl(o),[4,this.Oc.Hh(s)];case 2:return t.sent(),[2]}})})},oN.prototype.Mw=function(t){og(null!==this.Vw,"Trying to call "+t+" before calling subscribe().")},oN.prototype.wv=function(r){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return e=!this.currentUser.isEqual(r),this.currentUser=r,e?(this.$w("'waitForPendingWrites' promise is rejected due to a user change."),[4,this.Oc.Ph(r)]):[3,3];case 1:return n=t.sent(),this.Cw.Ph(r,n.Ch,n.Vh),[4,this.Kw(n.Sh)];case 2:t.sent(),t.label=3;case 3:return[4,this.Tw.wv()];case 4:return t.sent(),[2]}})})},oN.prototype.mv=function(u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a=this;return Ts(this,function(t){switch(t.label){case 0:return!0!==u||!0===this.isPrimary?[3,3]:(this.isPrimary=!0,[4,this.Tw.mv(!0)]);case 1:return t.sent(),o=this.Cw.Fv(),[4,this.em(o.tt())];case 2:for(e=t.sent(),n=0,r=e;n<r.length;n++)i=r[n],this.Tw.listen(i);return[3,7];case 3:return!1!==u||!1===this.isPrimary?[3,7]:(this.isPrimary=!1,o=[],s=Promise.resolve(),Pg(this.kw,function(t,e){a.Cw.Gv(t)?o.push(t):s=s.then(function(){return a.Ww(t),a.Oc.nc(t,!0)}),a.Tw.Zd(t)}),[4,s]);case 4:return t.sent(),[4,this.em(o)];case 5:return t.sent(),this.rm(),[4,this.Tw.mv(!1)];case 6:t.sent(),t.label=7;case 7:return[2]}})})},oN.prototype.rm=function(){var e=this;Pg(this.Fw,function(t){e.Tw.Zd(t)}),this.xw.gs(),this.Fw=[],this.Ow=new cm(um.G)},oN.prototype.em=function(d){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l,f,p;return Ts(this,function(t){switch(t.label){case 0:e=[],n=[],r=0,i=d,t.label=1;case 1:return r<i.length?(o=i[r],s=void 0,(a=this.kw[o])&&0!==a.length?[4,this.Oc.nc(o,!0)]:[3,8]):[3,14];case 2:return t.sent(),[4,this.Oc.Xh(a[0].ai())];case 3:s=t.sent(),u=0,c=a,t.label=4;case 4:return u<c.length?(h=c[u],og(!!(l=this.Nw.get(h)),"No query view found for "+h),[4,this.Qw(l)]):[3,7];case 5:(f=t.sent()).snapshot&&n.push(f.snapshot),t.label=6;case 6:return u++,[3,4];case 7:return[3,12];case 8:return og(!0===this.isPrimary,"A secondary tab should never have an active target without an active query."),[4,this.Oc.fc(o)];case 9:return og(!!(p=t.sent()),"Target for id "+o+" not found"),[4,this.Oc.Xh(p)];case 10:return s=t.sent(),[4,this.qw(this.um(p),o,!1)];case 11:t.sent(),t.label=12;case 12:e.push(s),t.label=13;case 13:return r++,[3,1];case 14:return this.Vw.Tl(n),[2,e]}})})},oN.prototype.um=function(t){return new xb(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,bb.Wn,t.startAt,t.endAt)},oN.prototype.sc=function(){return this.Oc.sc()},oN.prototype.rw=function(r,i,o){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:if(this.isPrimary)return eg("SyncEngine","Ignoring unexpected query state notification."),[2];if(!this.kw[r])return[3,7];switch(i){case"current":case"not-current":return[3,1];case"rejected":return[3,4]}return[3,6];case 1:return[4,this.Oc.lc()];case 2:return e=t.sent(),n=V_.re(r,"current"===i),[4,this.Kw(e,n)];case 3:return t.sent(),[3,7];case 4:return[4,this.Oc.nc(r,!0)];case 5:return t.sent(),this.Ww(r,o),[3,7];case 6:ig("Unexpected target state: "+i),t.label=7;case 7:return[2]}})})},oN.prototype.uw=function(l,f){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h=this;return Ts(this,function(t){switch(t.label){case 0:if(!this.isPrimary)return[2];e=0,n=l,t.label=1;case 1:return e<n.length?(c=n[e],og(!this.kw[c],"Trying to add an already active target"),[4,this.Oc.fc(c)]):[3,6];case 2:return og(!!(r=t.sent()),"Query data for active target "+c+" not found"),[4,this.Oc.Xh(r)];case 3:return i=t.sent(),[4,this.qw(this.um(r),i.targetId,!1)];case 4:t.sent(),this.Tw.listen(i),t.label=5;case 5:return e++,[3,1];case 6:o=function(e){return Ts(this,function(t){switch(t.label){case 0:return s.kw[e]?[4,s.Oc.nc(e,!1).then(function(){h.Tw.Zd(e),h.Ww(e)}).catch(CI)]:[2,"continue"];case 1:return t.sent(),[2]}})},s=this,a=0,u=f,t.label=7;case 7:return a<u.length?(c=u[a],[5,o(c)]):[3,10];case 8:t.sent(),t.label=9;case 9:return a++,[3,7];case 10:return[2]}})})},oN.prototype.enableNetwork=function(){return this.Oc.hc(!0),this.Tw.enableNetwork()},oN.prototype.disableNetwork=function(){return this.Oc.hc(!1),this.Tw.disableNetwork()},oN.prototype.Ye=function(t){var e=this.Fw[t];if(e&&e.Sw)return C_().add(e.key);var n=C_(),r=this.kw[t];if(!r)return n;for(var i=0,o=r;i<o.length;i++){var s=o[i],a=this.Nw.get(s);og(!!a,"No query view found for "+s),n=n.qt(a.view.lw)}return n},oN),YC=(iN.prototype.listen=function(t){var e=t.query,n=!1,r=this.om.get(e);return r||(n=!0,r=new GC,this.om.set(e,r)),r.listeners.push(t),og(!t.bw(this.onlineState),"applyOnlineStateChange() shouldn't raise an event for brand-new listeners."),r.sm&&t.cm(r.sm)&&this.am(),n?this.nv.listen(e).then(function(t){return r.targetId=t}):Promise.resolve(r.targetId)},iN.prototype.Zd=function(o){return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){return e=o.query,n=!1,(r=this.om.get(e))&&0<=(i=r.listeners.indexOf(o))&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.om.delete(e),[2,this.nv.Zd(e)]):[2]})})},iN.prototype.Tl=function(t){for(var e=!1,n=0,r=t;n<r.length;n++){var i=r[n],o=i.query,s=this.om.get(o);if(s){for(var a=0,u=s.listeners;a<u.length;a++)u[a].cm(i)&&(e=!0);s.sm=i}}e&&this.am()},iN.prototype.Zw=function(t,e){var n=this.om.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++)i[r].onError(e);this.om.delete(t)},iN.prototype.Hw=function(i){this.onlineState=i;var o=!1;this.om.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].bw(i)&&(o=!0)}),o&&this.am()},iN.prototype.fm=function(t){this.hm.add(t),t.next()},iN.prototype.lm=function(t){this.hm.delete(t)},iN.prototype.am=function(){this.hm.forEach(function(t){t.next()})},iN),XC=(rN.prototype.cm=function(t){if(og(0<t.docChanges.length||t.Xi,"We got a new snapshot with no changes?"),!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==k_.Gi&&e.push(i)}t=new q_(t.query,t.docs,t.Ji,e,t.Yi,t.fromCache,t.Xi,!0)}var o=!1;return this.vm?this.mm(t)&&(this.dm.next(t),o=!0):this.pm(t,this.onlineState)&&(this.gm(t),o=!0),this.wm=t,o},rN.prototype.onError=function(t){this.dm.error(t)},rN.prototype.bw=function(t){this.onlineState=t;var e=!1;return this.wm&&!this.vm&&this.pm(this.wm,t)&&(this.gm(this.wm),e=!0),e},rN.prototype.pm=function(t,e){if(og(!this.vm,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==Tb.Ri;return this.options.bm&&n?(og(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.J()||e===Tb.Ri},rN.prototype.mm=function(t){if(0<t.docChanges.length)return!0;var e=this.wm&&this.wm.hasPendingWrites!==t.hasPendingWrites;return!(!t.Xi&&!e)&&!0===this.options.includeMetadataChanges},rN.prototype.gm=function(t){og(!this.vm,"Trying to raise initial events for second time"),t=q_.Zi(t.query,t.docs,t.Yi,t.fromCache),this.vm=!0,this.dm.next(t)},rN),JC=(nN.prototype.La=function(){return RI.Ac(this.cacheSizeBytes)},nN),$C=(eN.prototype.start=function(t){var n=this;this._m();var r=new dE,i=new dE,o=!1;return this.credentials.T(function(e){o?n.Su.Uu(function(){return n.wv(e)}):(o=!0,n.Im(t,i,e).then(function(t){return n.Tm(e,t)}).then(r.resolve,r.reject))}),this.Su.Uu(function(){return r.promise}),i.promise},eN.prototype.enableNetwork=function(){var t=this;return this._m(),this.Su.enqueue(function(){return t.nv.enableNetwork()})},eN.prototype.Im=function(t,e,n){var r=this;return t instanceof JC?this.Em(n,t).then(function(t){return e.resolve(),t}).catch(function(t){if(e.reject(t),!r.Rm(t))throw t;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+t),r.Am()}):(e.resolve(),this.Am())},eN.prototype.Rm=function(t){return t instanceof mg?t.code===gg.FAILED_PRECONDITION||t.code===gg.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&t instanceof DOMException)||22===t.code||20===t.code||11===t.code},eN.prototype._m=function(){if(this.Su.Wu)throw new mg(gg.FAILED_PRECONDITION,"The client has already been terminated.")},eN.prototype.Em=function(r,i){var t=this,o=jT.ff(this.ym),s=new aE(this.ym.s,{tr:!0});return Promise.resolve().then(function(){return Is(t,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:if(i.synchronizeTabs&&!RC.Js(this.platform))throw new mg(gg.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");return e=i.La(),this.Cw=i.synchronizeTabs?new RC(this.Su,this.platform,o,this.clientId,r):new jC,[4,jT.Ua({allowTabSynchronization:i.synchronizeTabs,persistenceKey:o,clientId:this.clientId,platform:this.platform,Da:this.Su,serializer:s,La:e,Pa:this.Cw})];case 1:return n=t.sent(),[2,(this.persistence=n).wo.kc]}})})})},eN.prototype.Am=function(){return this.persistence=rS.Of(this.clientId),this.Cw=new jC,Promise.resolve(null)},eN.prototype.Tm=function(c,h){var t=this;return eg("FirestoreClient","Initializing. user=",c.uid),this.platform.Dm(this.ym).then(function(u){return Is(t,void 0,void 0,function(){var e,n,r,i,o,s,a=this;return Ts(this,function(t){switch(t.label){case 0:return e=new zT,this.Oc=new _I(this.persistence,e,c),[4,this.Oc.start()];case 1:return t.sent(),h&&(this.Pm=new OI(h,this.Su,this.Oc)),n=this.platform.Sm(),r=this.platform.Cm(this.ym.s),i=new _S(this.Su,u,this.credentials,r),o=function(t){return a.nv.bw(t,Cb.Ai)},s=function(t){return a.nv.bw(t,Cb.Di)},this.Tw=new dC(this.Oc,i,this.Su,o,n),this.nv=new QC(this.Oc,this.Tw,this.Cw,c),this.Cw.Id=s,this.Tw.nv=this.nv,this.Cw.nv=this.nv,this.Vm=new YC(this.nv),[4,this.Cw.start()];case 2:return t.sent(),[4,this.Tw.start()];case 3:return t.sent(),[4,this.persistence.za(function(e){return Is(a,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return[4,this.nv.mv(e)];case 1:return t.sent(),this.Pm&&(e&&!this.Pm.ph?this.Pm.start():e||this.Pm.stop()),[2]}})})})];case 4:return t.sent(),[4,this.persistence.Ka(function(){return Is(a,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return[4,this.terminate()];case 1:return t.sent(),[2]}})})})];case 5:return t.sent(),[2]}})})})},eN.prototype.wv=function(t){return this.Su.Zu(),eg("FirestoreClient","Credential Changed. Current user: "+t.uid),this.nv.wv(t)},eN.prototype.disableNetwork=function(){var t=this;return this._m(),this.Su.enqueue(function(){return t.nv.disableNetwork()})},eN.prototype.terminate=function(){var t=this;return this.Su.Yu(function(){return Is(t,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.Pm&&this.Pm.stop(),[4,this.Tw.shutdown()];case 1:return t.sent(),[4,this.Cw.shutdown()];case 2:return t.sent(),[4,this.persistence.shutdown()];case 3:return t.sent(),this.credentials.R(),[2]}})})})},eN.prototype.waitForPendingWrites=function(){var t=this;this._m();var e=new dE;return this.Su.Uu(function(){return t.nv.Xw(e)}),e.promise},eN.prototype.listen=function(t,e,n){var r=this;this._m();var i=new XC(t,e,n);return this.Su.Uu(function(){return r.Vm.listen(i)}),i},eN.prototype.Zd=function(t){var e=this;this.Nm||this.Su.Uu(function(){return e.Vm.Zd(t)})},eN.prototype.km=function(t){var e=this;return this._m(),this.Su.enqueue(function(){return e.Oc.Yh(t)}).then(function(t){if(t instanceof Jw)return t;if(t instanceof $w)return null;throw new mg(gg.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},eN.prototype.Om=function(i){var t=this;return this._m(),this.Su.enqueue(function(){return Is(t,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return[4,this.Oc.ic(i,!0)];case 1:return e=t.sent(),n=new qC(i,e.rc),r=n.dw(e.documents),[2,n.Qs(r,!1).snapshot]}})})})},eN.prototype.write=function(t){var e=this;this._m();var n=new dE;return this.Su.Uu(function(){return e.nv.write(t,n)}),n.promise},eN.prototype.s=function(){return this.ym.s},eN.prototype.fm=function(t){var e=this;this._m(),this.Su.Uu(function(){return e.Vm.fm(t),Promise.resolve()})},eN.prototype.lm=function(t){this.Nm||this.Vm.lm(t)},Object.defineProperty(eN.prototype,"Nm",{get:function(){return this.Su.Wu},enumerable:!0,configurable:!0}),eN.prototype.transaction=function(t){var e=this;this._m();var n=new dE;return this.Su.Uu(function(){return e.nv.runTransaction(e.Su,t,n),Promise.resolve()}),n.promise},eN),ZC=(tN.prototype.next=function(t){this.Fm(this.observer.next,t)},tN.prototype.error=function(t){this.Fm(this.observer.error,t)},tN.prototype.xm=function(){this.muted=!0},tN.prototype.Fm=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},tN);function tN(t){this.observer=t,this.muted=!1}function eN(t,e,n,r){this.platform=t,this.ym=e,this.credentials=n,this.Su=r,this.clientId=sg.u()}function nN(t,e){this.cacheSizeBytes=t,this.synchronizeTabs=e}function rN(t,e,n){this.query=t,this.dm=e,this.vm=!1,this.wm=null,this.onlineState=Tb.Ti,this.options=n||{}}function iN(t){this.nv=t,this.om=new FE(function(t){return t.canonicalId()}),this.onlineState=Tb.Ti,this.hm=new Set,this.nv.subscribe(this)}function oN(t,e,n,r){this.Oc=t,this.Tw=e,this.Cw=n,this.currentUser=r,this.Vw=null,this.Nw=new FE(function(t){return t.canonicalId()}),this.kw={},this.Ow=new cm(um.G),this.Fw={},this.xw=new ME,this.jw={},this.Uw=new Map,this.Lw=gI.Ho(),this.isPrimary=void 0,this.onlineState=Tb.Ti}function sN(t,e,n,r){this.Su=t,this.Tw=e,this.updateFunction=n,this.ku=r,this.Ew=5,this.sl=new aS(this.Su,vE.Pu)}function aN(i){return function(){if("object"!=typeof i||null===i)return!1;for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return!0}return!1}()}var uN,cN=RI.Sc,hN=(kN.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.forceLongPolling===t.forceLongPolling},kN),lN=(AN.prototype.settings=function(t){if(Mg("Firestore.settings",arguments,1),jg("Firestore.settings","object",1,t),Rg(t,"persistence"))throw new mg(gg.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new hN(t);if(this.Bm&&!this.Wm.isEqual(e))throw new mg(gg.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");void 0!==(this.Wm=e).credentials&&(this.Gm=function(t){if(!t)return new wg;switch(t.type){case"gapi":var e=t.k;return og(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty),"unexpected gapi interface"),new Eg(e,t.V||"0");case"provider":return t.k;default:throw new mg(gg.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},AN.prototype.enableNetwork=function(){return this.Lm(),this.Bm.enableNetwork()},AN.prototype.disableNetwork=function(){return this.Lm(),this.Bm.disableNetwork()},AN.prototype.enablePersistence=function(t){if(this.Bm)throw new mg(gg.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");var e=!1;return t&&(void 0!==t.experimentalTabSynchronization&&ng("The 'experimentalTabSynchronization' setting has been renamed to 'synchronizeTabs'. In a future release, the setting will be removed and it is recommended that you update your firestore.enablePersistence() call to use 'synchronizeTabs'."),e=Og(void 0!==t.synchronizeTabs?t.synchronizeTabs:t.experimentalTabSynchronization,!1)),this.Hm(new JC(this.Wm.cacheSizeBytes,e))},AN.prototype.clearPersistence=function(){var t=this,n=jT.ff(this.Jm()),r=new dE;return this.Um.zu(function(){return Is(t,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:if(t.trys.push([0,2,,3]),void 0!==this.Bm&&!this.Bm.Nm)throw new mg(gg.FAILED_PRECONDITION,"Persistence cannot be cleared after this Firestore instance is initialized.");return[4,jT.clearPersistence(n)];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise},AN.prototype.terminate=function(){return this.app._removeServiceInstance("firestore"),this.INTERNAL.delete()},Object.defineProperty(AN.prototype,"Ym",{get:function(){return this.Lm(),this.Bm.Nm},enumerable:!0,configurable:!0}),AN.prototype.waitForPendingWrites=function(){return this.Lm(),this.Bm.waitForPendingWrites()},AN.prototype.onSnapshotsInSync=function(t){if(this.Lm(),aN(t))return this.Xm(t);jg("Firestore.onSnapshotsInSync","function",1,t);var e={next:t};return this.Xm(e)},AN.prototype.Xm=function(t){var e=this,n=new ZC({next:function(){t.next&&t.next()},error:function(t){throw ig("Uncaught Error in onSnapshotsInSync")}});return this.Bm.fm(n),function(){n.xm(),e.Bm.lm(n)}},AN.prototype.Lm=function(){return this.Bm||this.Hm(new KC),this.Bm},AN.prototype.Jm=function(){return new lg(this.Mm,this.Qm,this.Wm.host,this.Wm.ssl,this.Wm.forceLongPolling)},AN.prototype.Hm=function(t){og(!!this.Wm.host,"FirestoreSettings.host is not set"),og(!this.Bm,"configureClient() called multiple times");var e=this.Jm();return this.Bm=new $C(uE.t(),e,this.Gm,this.Um),this.Bm.start(t)},AN.prototype.Km=function(r){return new rC(function(t){if(t instanceof dN){var e=r,n=t.firestore.Mm;if(!n.isEqual(e))throw new mg(gg.INVALID_ARGUMENT,"Document reference is for database "+n.projectId+"/"+n.database+" but should be for database "+e.projectId+"/"+e.database);return new nC(r,t.$m)}return t})},AN.qm=function(t){var e=t.options;if(!Rg(e,"projectId"))throw new mg(gg.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');var n=e.projectId;if(!n||"string"!=typeof n)throw new mg(gg.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new vg(n)},Object.defineProperty(AN.prototype,"app",{get:function(){if(!this.jm)throw new mg(gg.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.jm},enumerable:!0,configurable:!0}),AN.prototype.collection=function(t){return Mg("Firestore.collection",arguments,1),jg("Firestore.collection","non-empty string",1,t),this.Lm(),new ON(om.it(t),this)},AN.prototype.doc=function(t){return Mg("Firestore.doc",arguments,1),jg("Firestore.doc","non-empty string",1,t),this.Lm(),dN.Zm(om.it(t),this)},AN.prototype.collectionGroup=function(t){if(Mg("Firestore.collectionGroup",arguments,1),jg("Firestore.collectionGroup","non-empty string",1,t),0<=t.indexOf("/"))throw new mg(gg.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function Firestore.collectionGroup(). Collection IDs must not contain '/'.");return this.Lm(),new mN(new xb(om.et,t),this)},AN.prototype.runTransaction=function(e){var n=this;return Mg("Firestore.runTransaction",arguments,1),jg("Firestore.runTransaction","function",1,e),this.Lm().transaction(function(t){return e(new fN(n,t))})},AN.prototype.batch=function(){return this.Lm(),new pN(this)},Object.defineProperty(AN,"logLevel",{get:function(){switch(Zy()){case Wy.DEBUG:return"debug";case Wy.ERROR:return"error";case Wy.SILENT:return"silent";default:return ig("Unknown log level: "+Zy())}},enumerable:!0,configurable:!0}),AN.setLogLevel=function(t){switch(Mg("Firestore.setLogLevel",arguments,1),jg("Firestore.setLogLevel","non-empty string",1,t),t){case"debug":tg(Wy.DEBUG);break;case"error":tg(Wy.ERROR);break;case"silent":tg(Wy.SILENT);break;default:throw new mg(gg.INVALID_ARGUMENT,"Invalid log level: "+t)}},AN.prototype.tp=function(){return this.Wm.timestampsInSnapshots},AN),fN=(NN.prototype.get=function(t){var n=this;Mg("Transaction.get",arguments,1);var r=MN("Transaction.get",t,this.np);return this.ip.lookup([r.$m]).then(function(t){if(!t||1!==t.length)return ig("Mismatch in docs returned from document lookup.");var e=t[0];if(e instanceof $w)return new yN(n.np,r.$m,null,!1,!1,r.ep);if(e instanceof Jw)return new yN(n.np,r.$m,e,!1,!1,r.ep);throw ig("BatchGetDocumentsRequest returned unexpected document type: "+e.constructor.name)})},NN.prototype.set=function(t,e,n){Fg("Transaction.set",arguments,2,3);var r=MN("Transaction.set",t,this.np);n=DN("Transaction.set",n);var i=UN(r.ep,e,"Transaction.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.np.zm.ed(s,o,n.mergeFields):this.np.zm.td(s,o);return this.ip.set(r.$m,a),this},NN.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return i="string"==typeof e||e instanceof ES?(Ug("Transaction.update",arguments,3),r=MN("Transaction.update",t,this.np),this.np.zm.sd("Transaction.update",e,n,o)):(Mg("Transaction.update",arguments,2),r=MN("Transaction.update",t,this.np),this.np.zm.rd("Transaction.update",e)),this.ip.update(r.$m,i),this},NN.prototype.delete=function(t){Mg("Transaction.delete",arguments,1);var e=MN("Transaction.delete",t,this.np);return this.ip.delete(e.$m),this},NN),pN=(CN.prototype.set=function(t,e,n){Fg("WriteBatch.set",arguments,2,3),this.sp();var r=MN("WriteBatch.set",t,this.np);n=DN("WriteBatch.set",n);var i=UN(r.ep,e,"WriteBatch.set"),o=i[0],s=i[1],a=n.merge||n.mergeFields?this.np.zm.ed(s,o,n.mergeFields):this.np.zm.td(s,o);return this.rp=this.rp.concat(a.Bl(r.$m,Zm.NONE)),this},CN.prototype.update=function(t,e,n){for(var r,i,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return this.sp(),i="string"==typeof e||e instanceof ES?(Ug("WriteBatch.update",arguments,3),r=MN("WriteBatch.update",t,this.np),this.np.zm.sd("WriteBatch.update",e,n,o)):(Mg("WriteBatch.update",arguments,2),r=MN("WriteBatch.update",t,this.np),this.np.zm.rd("WriteBatch.update",e)),this.rp=this.rp.concat(i.Bl(r.$m,Zm.exists(!0))),this},CN.prototype.delete=function(t){Mg("WriteBatch.delete",arguments,1),this.sp();var e=MN("WriteBatch.delete",t,this.np);return this.rp=this.rp.concat(new iw(e.$m,Zm.NONE)),this},CN.prototype.commit=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){return this.sp(),this.up=!0,0<this.rp.length?[2,this.np.Lm().write(this.rp)]:[2]})})},CN.prototype.sp=function(){if(this.up)throw new mg(gg.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},CN),dN=(SN.Zm=function(t,e,n){if(t.length%2!=0)throw new mg(gg.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.nt()+" has "+t.length);return new SN(new um(t),e,n)},Object.defineProperty(SN.prototype,"id",{get:function(){return this.$m.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(SN.prototype,"parent",{get:function(){return new ON(this.$m.path.H(),this.firestore,this.ep)},enumerable:!0,configurable:!0}),Object.defineProperty(SN.prototype,"path",{get:function(){return this.$m.path.nt()},enumerable:!0,configurable:!0}),SN.prototype.collection=function(t){if(Mg("DocumentReference.collection",arguments,1),jg("DocumentReference.collection","non-empty string",1,t),!t)throw new mg(gg.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=om.it(t);return new ON(this.$m.path.child(e),this.firestore)},SN.prototype.isEqual=function(t){if(!(t instanceof SN))throw Yg("isEqual","DocumentReference",1,t);return this.firestore===t.firestore&&this.$m.isEqual(t.$m)&&this.ep===t.ep},SN.prototype.set=function(t,e){Fg("DocumentReference.set",arguments,1,2),e=DN("DocumentReference.set",e);var n=UN(this.ep,t,"DocumentReference.set"),r=n[0],i=n[1],o=e.merge||e.mergeFields?this.firestore.zm.ed(i,r,e.mergeFields):this.firestore.zm.td(i,r);return this.Bm.write(o.Bl(this.$m,Zm.NONE))},SN.prototype.update=function(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return n="string"==typeof t||t instanceof ES?(Ug("DocumentReference.update",arguments,2),this.firestore.zm.sd("DocumentReference.update",t,e,r)):(Mg("DocumentReference.update",arguments,1),this.firestore.zm.rd("DocumentReference.update",t)),this.Bm.write(n.Bl(this.$m,Zm.exists(!0)))},SN.prototype.delete=function(){return Mg("DocumentReference.delete",arguments,0),this.Bm.write([new iw(this.$m,Zm.NONE)])},SN.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Fg("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!=typeof t[i]||aN(t[i])||(Qg("DocumentReference.onSnapshot",r=t[i],["includeMetadataChanges"]),Bg("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeMetadataChanges:r.includeMetadataChanges};return n=aN(t[i])?t[i]:(jg("DocumentReference.onSnapshot","function",i,t[i]),qg("DocumentReference.onSnapshot","function",i+1,t[i+1]),qg("DocumentReference.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.hp(o,n)},SN.prototype.hp=function(t,n){var r=this,e=function(t){console.error("Uncaught Error in onSnapshot:",t)};n.error&&(e=n.error.bind(n));var i=new ZC({next:function(t){if(n.next){og(t.docs.size<=1,"Too many documents returned on a document query");var e=t.docs.get(r.$m);n.next(new yN(r.firestore,r.$m,e,t.fromCache,t.hasPendingWrites,r.ep))}},error:e}),o=this.Bm.listen(xb.$n(this.$m.path),i,t);return function(){i.xm(),r.Bm.Zd(o)}},SN.prototype.get=function(n){var r=this;return Fg("DocumentReference.get",arguments,0,1),LN("DocumentReference.get",n),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.Lm().km(r.$m).then(function(t){e(new yN(r.firestore,r.$m,t,!0,t instanceof Jw&&t.un,r.ep))},t):r.cp(e,t,n)})},SN.prototype.cp=function(e,n,r){var i=this.hp({includeMetadataChanges:!0,bm:!0},{next:function(t){i(),!t.exists&&t.metadata.fromCache?n(new mg(gg.UNAVAILABLE,"Failed to get document because the client is offline.")):t.exists&&t.metadata.fromCache&&r&&"server"===r.source?n(new mg(gg.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):e(t)},error:n})},SN.prototype.withConverter=function(t){return new SN(this.$m,this.firestore,t)},SN),vN=(TN.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},TN),yN=(IN.prototype.data=function(t){if(Fg("DocumentSnapshot.data",arguments,0,1),t=xN("DocumentSnapshot.data",t),this.ap){if(this.ep){var e=new gN(this.np,this.$m,this.ap,this.fp,this.lp);return this.ep.fromFirestore(e,t)}return this.dp(this.ap.data(),yw.Dn(t,this.np.tp()))}},IN.prototype.get=function(t,e){if(Fg("DocumentSnapshot.get",arguments,1,2),e=xN("DocumentSnapshot.get",e),this.ap){var n=this.ap.data().field(uC("DocumentSnapshot.get",t));if(null!==n)return this.vp(n,yw.Dn(e,this.np.tp()))}},Object.defineProperty(IN.prototype,"id",{get:function(){return this.$m.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(IN.prototype,"ref",{get:function(){return new dN(this.$m,this.np,this.ep)},enumerable:!0,configurable:!0}),Object.defineProperty(IN.prototype,"exists",{get:function(){return null!==this.ap},enumerable:!0,configurable:!0}),Object.defineProperty(IN.prototype,"metadata",{get:function(){return new vN(this.lp,this.fp)},enumerable:!0,configurable:!0}),IN.prototype.isEqual=function(t){if(!(t instanceof IN))throw Yg("isEqual","DocumentSnapshot",1,t);return this.np===t.np&&this.fp===t.fp&&this.$m.isEqual(t.$m)&&(null===this.ap?null===t.ap:this.ap.isEqual(t.ap))&&this.ep===t.ep},IN.prototype.dp=function(t,n){var r=this,i={};return t.forEach(function(t,e){i[t]=r.vp(e,n)}),i},IN.prototype.vp=function(t,e){if(t instanceof Qw)return this.dp(t,e);if(t instanceof Yw)return this.wp(t,e);if(t instanceof Kw){var n=t.value(e),r=this.np.Lm().s();return t.s.isEqual(r)||ng("Document "+this.$m.path+" contains a document reference within a different database ("+t.s.projectId+"/"+t.s.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new dN(n,this.np,this.ep)}return t.value(e)},IN.prototype.wp=function(t,e){var n=this;return t.Ht.map(function(t){return n.vp(t,e)})},IN),gN=(_s(EN,uN=yN),EN.prototype.data=function(t){var e=uN.prototype.data.call(this,t);return og(void 0!==e,"Document in a QueryDocumentSnapshot should exist"),e},EN),mN=(_N.prototype.where=function(t,e,n){var r;Mg("Query.where",arguments,3),zg("Query.where",3,n),function(t,e,n,r){if(!e.some(function(t){return t===r}))throw new mg(gg.INVALID_ARGUMENT,"Invalid value "+Kg(r)+" provided to function "+t+"() for its "+Jg(n)+" argument. Acceptable values: "+e.join(", "))}("Query.where",["<","<=","==",">=",">","array-contains","in","array-contains-any"],2,e);var i=uC("Query.where",t),o=Lb.it(e);if(i.ut()){if(o===Lb.ARRAY_CONTAINS||o===Lb.ARRAY_CONTAINS_ANY)throw new mg(gg.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o.toString()+"' queries on FieldPath.documentId().");if(o===Lb.IN){this.pp(n,o);for(var s=[],a=0,u=n;a<u.length;a++){var c=u[a];s.push(this.gp(c))}r=new Yw(s)}else r=this.gp(n)}else o!==Lb.IN&&o!==Lb.ARRAY_CONTAINS_ANY||this.pp(n,o),r=this.firestore.zm.od("Query.where",n,o===Lb.IN);var h=Mb.create(i,o,r);return this.bp(h),new _N(this.mp.ni(h),this.firestore,this.ep)},_N.prototype.orderBy=function(t,e){var n;if(Fg("Query.orderBy",arguments,1,2),qg("Query.orderBy","non-empty string",2,e),void 0===e||"asc"===e)n=Bb.ASCENDING;else{if("desc"!==e)throw new mg(gg.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+e+"', expected 'asc' or 'desc'.");n=Bb.DESCENDING}if(null!==this.mp.startAt)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this.mp.endAt)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var r=uC("Query.orderBy",t),i=new Hb(r,n);return this.yp(i),new _N(this.mp.ei(i),this.firestore,this.ep)},_N.prototype.limit=function(t){return Mg("Query.limit",arguments,1),jg("Query.limit","number",1,t),Xg("Query.limit",1,t),new _N(this.mp.ri(t),this.firestore,this.ep)},_N.prototype.limitToLast=function(t){return Mg("Query.limitToLast",arguments,1),jg("Query.limitToLast","number",1,t),Xg("Query.limitToLast",1,t),new _N(this.mp.ui(t),this.firestore,this.ep)},_N.prototype.startAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ug("Query.startAt",arguments,1);var r=this._p("Query.startAt",t,e,!0);return new _N(this.mp.si(r),this.firestore,this.ep)},_N.prototype.startAfter=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ug("Query.startAfter",arguments,1);var r=this._p("Query.startAfter",t,e,!1);return new _N(this.mp.si(r),this.firestore,this.ep)},_N.prototype.endBefore=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ug("Query.endBefore",arguments,1);var r=this._p("Query.endBefore",t,e,!0);return new _N(this.mp.oi(r),this.firestore,this.ep)},_N.prototype.endAt=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ug("Query.endAt",arguments,1);var r=this._p("Query.endAt",t,e,!1);return new _N(this.mp.oi(r),this.firestore,this.ep)},_N.prototype.isEqual=function(t){if(!(t instanceof _N))throw Yg("isEqual","Query",1,t);return this.firestore===t.firestore&&this.mp.isEqual(t.mp)},_N.prototype.withConverter=function(t){return new _N(this.mp,this.firestore,t)},_N.prototype._p=function(t,e,n,r){if(zg(t,1,e),e instanceof yN){if(0<n.length)throw new mg(gg.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new mg(gg.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.Ip(t,i.ap,r)}var o=[e].concat(n);return this.Tp(t,o,r)},_N.prototype.Ip=function(t,e,n){for(var r=[],i=0,o=this.mp.orderBy;i<o.length;i++){var s=o[i];if(s.field.ut())r.push(new Kw(this.firestore.Mm,e.key));else{var a=e.field(s.field);if(a instanceof Hw)throw new mg(gg.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+s.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a){var u=s.field.nt();throw new mg(gg.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(a)}}return new Wb(r,n)},_N.prototype.Tp=function(t,e,n){var r=this.mp.Kn;if(e.length>r.length)throw new mg(gg.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var s=e[o];if(r[o].field.ut()){if("string"!=typeof s)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof s);if(!this.mp.bi()&&-1!==s.indexOf("/"))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+t+"() must be a plain document ID, but '"+s+"' contains a slash.");var a=this.mp.path.child(om.it(s));if(!um.ht(a))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+t+"() must result in a valid document path, but '"+a+"' is not because it contains an odd number of segments.");var u=new um(a);i.push(new Kw(this.firestore.Mm,u))}else{var c=this.firestore.zm.od(t,s);i.push(c)}}return new Wb(i,n)},_N.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Fg("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!=typeof t[i]||aN(t[i])||(Qg("Query.onSnapshot",r=t[i],["includeMetadataChanges"]),Bg("Query.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++),n=aN(t[i])?t[i]:(jg("Query.onSnapshot","function",i,t[i]),qg("Query.onSnapshot","function",i+1,t[i+1]),qg("Query.onSnapshot","function",i+2,t[i+2]),{next:t[i],error:t[i+1],complete:t[i+2]}),this.Ep(this.mp),this.hp(r,n)},_N.prototype.hp=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new ZC({next:function(t){e.next&&e.next(new wN(n.firestore,n.mp,t,n.ep))},error:r}),o=this.firestore.Lm(),s=o.listen(this.mp,i,t);return function(){i.xm(),o.Zd(s)}},_N.prototype.Ep=function(t){if(t.pi()&&0===t.Kn.length)throw new mg(gg.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")},_N.prototype.get=function(n){var r=this;return Fg("Query.get",arguments,0,1),LN("Query.get",n),this.Ep(this.mp),new Promise(function(e,t){n&&"cache"===n.source?r.firestore.Lm().Om(r.mp).then(function(t){e(new wN(r.firestore,r.mp,t,r.ep))},t):r.cp(e,t,n)})},_N.prototype.cp=function(e,n,r){var i=this.hp({includeMetadataChanges:!0,bm:!0},{next:function(t){i(),t.metadata.fromCache&&r&&"server"===r.source?n(new mg(gg.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):e(t)},error:n})},_N.prototype.gp=function(t){if("string"==typeof t){if(""===t)throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!this.mp.bi()&&-1!==t.indexOf("/"))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+t+"' contains a '/' character.");var e=this.mp.path.child(om.it(t));if(!um.ht(e))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return new Kw(this.firestore.Mm,new um(e))}if(t instanceof dN){var n=t;return new Kw(this.firestore.Mm,n.$m)}throw new mg(gg.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Kg(t)+".")},_N.prototype.pp=function(t,e){if(!Array.isArray(t)||0===t.length)throw new mg(gg.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new mg(gg.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.");if(0<=t.indexOf(null))throw new mg(gg.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'null' in the value array.");if(0<t.filter(function(t){return Number.isNaN(t)}).length)throw new mg(gg.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters cannot contain 'NaN' in the value array.")},_N.prototype.bp=function(t){if(t instanceof Mb){var e=[Lb.ARRAY_CONTAINS,Lb.ARRAY_CONTAINS_ANY],n=[Lb.IN,Lb.ARRAY_CONTAINS_ANY],r=0<=e.indexOf(t.op),i=0<=n.indexOf(t.op);if(t.ii()){var o=this.mp.Zn();if(null!==o&&!o.isEqual(t.field))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+o.toString()+"' and '"+t.field.toString()+"'");var s=this.mp.ti();null!==s&&this.Rp(t.field,s)}else if(i||r){var a=null;if(i&&(a=this.mp.gi(n)),null===a&&r&&(a=this.mp.gi(e)),null!=a)throw a===t.op?new mg(gg.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new mg(gg.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+a.toString()+"' filters.")}}},_N.prototype.yp=function(t){if(null===this.mp.ti()){var e=this.mp.Zn();null!==e&&this.Rp(e,t.field)}},_N.prototype.Rp=function(t,e){if(!e.isEqual(t))throw new mg(gg.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},_N),wN=(Object.defineProperty(bN.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!0,configurable:!0}),Object.defineProperty(bN.prototype,"empty",{get:function(){return this.Dp.docs.J()},enumerable:!0,configurable:!0}),Object.defineProperty(bN.prototype,"size",{get:function(){return this.Dp.docs.size},enumerable:!0,configurable:!0}),bN.prototype.forEach=function(e,n){var r=this;Fg("QuerySnapshot.forEach",arguments,1,2),jg("QuerySnapshot.forEach","function",1,e),this.Dp.docs.forEach(function(t){e.call(n,r.Cp(t))})},Object.defineProperty(bN.prototype,"query",{get:function(){return new mN(this.Ap,this.np,this.ep)},enumerable:!0,configurable:!0}),bN.prototype.docChanges=function(t){t&&(Qg("QuerySnapshot.docChanges",t,["includeMetadataChanges"]),Bg("QuerySnapshot.docChanges","boolean","includeMetadataChanges",t.includeMetadataChanges));var e=!(!t||!t.includeMetadataChanges);if(e&&this.Dp.$i)throw new mg(gg.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.Pp&&this.Sp===e||(this.Pp=function(i,e,o,s){if(o.Ji.J()){var n,r=0;return o.docChanges.map(function(t){var e=new gN(i,t.doc.key,t.doc,o.fromCache,o.Yi.has(t.doc.key),s);return og(t.type===k_.Mi,"Invalid event type for first snapshot"),og(!n||o.query.fi(n,t.doc)<0,"Got added events in wrong order"),n=t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:r++}})}var a=o.Ji;return o.docChanges.filter(function(t){return e||t.type!==k_.Gi}).map(function(t){var e=new gN(i,t.doc.key,t.doc,o.fromCache,o.Yi.has(t.doc.key),s),n=-1,r=-1;return t.type!==k_.Mi&&(og(0<=(n=a.indexOf(t.doc.key)),"Index for document not found"),a=a.delete(t.doc.key)),t.type!==k_.qi&&(r=(a=a.add(t.doc)).indexOf(t.doc.key)),{type:function(t){switch(t){case k_.Mi:return"added";case k_.Qi:case k_.Gi:return"modified";case k_.qi:return"removed";default:return ig("Unknown change type: "+t)}}(t.type),doc:e,oldIndex:n,newIndex:r}})}(this.np,e,this.Dp,this.ep),this.Sp=e),this.Pp},bN.prototype.isEqual=function(t){if(!(t instanceof bN))throw Yg("isEqual","QuerySnapshot",1,t);return this.np===t.np&&this.Ap.isEqual(t.Ap)&&this.Dp.isEqual(t.Dp)&&this.ep===t.ep},bN.prototype.Cp=function(t){return new gN(this.np,t.key,t,this.metadata.fromCache,this.Dp.Yi.has(t.key),this.ep)},bN);function bN(t,e,n,r){this.np=t,this.Ap=e,this.Dp=n,this.ep=r,this.Pp=null,this.Sp=null,this.metadata=new vN(n.hasPendingWrites,n.fromCache)}function _N(t,e,n){this.mp=t,this.firestore=e,this.ep=n}function EN(){return null!==uN&&uN.apply(this,arguments)||this}function IN(t,e,n,r,i,o){this.np=t,this.$m=e,this.ap=n,this.fp=r,this.lp=i,this.ep=o}function TN(t,e){this.hasPendingWrites=t,this.fromCache=e}function SN(t,e,n){this.$m=t,this.firestore=e,this.ep=n,this.Bm=this.firestore.Lm()}function CN(t){this.np=t,this.rp=[],this.up=!1}function NN(t,e){this.np=t,this.ip=e}function AN(t,e){var n=this;if(this.jm=null,this.Um=new IE,this.INTERNAL={delete:function(){return Is(n,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return this.Lm(),[4,this.Bm.terminate()];case 1:return t.sent(),[2]}})})}},"object"==typeof t.options){var r=t;this.jm=r,this.Mm=AN.qm(r),this.Qm=r.name,this.Gm=new bg(e)}else{var i=t;if(!i.projectId)throw new mg(gg.INVALID_ARGUMENT,"Must provide projectId");this.Mm=new vg(i.projectId,i.database),this.Qm="[DEFAULT]",this.Gm=new wg}this.Wm=new hN({}),this.zm=this.Km(this.Mm)}function kN(t){if(void 0===t.host){if(void 0!==t.ssl)throw new mg(gg.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else Vg("settings","non-empty string","host",t.host),this.host=t.host,Bg("settings","boolean","ssl",t.ssl),this.ssl=Og(t.ssl,!0);if(Qg("settings",t,["host","ssl","credentials","timestampsInSnapshots","cacheSizeBytes","experimentalForceLongPolling"]),Bg("settings","object","credentials",t.credentials),this.credentials=t.credentials,Bg("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),!0===t.timestampsInSnapshots?ng("\n  The timestampsInSnapshots setting now defaults to true and you no\n  longer need to explicitly set it. In a future release, the setting\n  will be removed entirely and so it is recommended that you remove it\n  from your firestore.settings() call now."):!1===t.timestampsInSnapshots&&ng("\n  The timestampsInSnapshots setting will soon be removed. YOU MUST UPDATE\n  YOUR CODE.\n\n  To hide this warning, stop using the timestampsInSnapshots setting in your\n  firestore.settings({ ... }) call.\n\n  Once you remove the setting, Timestamps stored in Cloud Firestore will be\n  read back as Firebase Timestamp objects instead of as system Date objects.\n  So you will also need to update code expecting a Date to instead expect a\n  Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at'); const date =\n  timestamp.toDate();\n\n  Please audit all existing usages of Date when you enable the new\n  behavior."),this.timestampsInSnapshots=Og(t.timestampsInSnapshots,!0),Bg("settings","number","cacheSizeBytes",t.cacheSizeBytes),void 0===t.cacheSizeBytes)this.cacheSizeBytes=RI.Vc;else{if(t.cacheSizeBytes!==cN&&t.cacheSizeBytes<RI.Cc)throw new mg(gg.INVALID_ARGUMENT,"cacheSizeBytes must be at least "+RI.Cc);this.cacheSizeBytes=t.cacheSizeBytes}Bg("settings","boolean","experimentalForceLongPolling",t.experimentalForceLongPolling),this.forceLongPolling=void 0!==t.experimentalForceLongPolling&&t.experimentalForceLongPolling}As(["length","forEach","map"],"undefined"!=typeof Symbol?[Symbol.iterator]:[]).forEach(function(t){try{Object.defineProperty(wN.prototype.docChanges,t,{get:function(){return function(){throw new mg(gg.INVALID_ARGUMENT,'QuerySnapshot.docChanges has been changed from a property into a method, so usages like "querySnapshot.docChanges" should become "querySnapshot.docChanges()"')}()}})}catch(t){}});var RN,ON=(_s(PN,RN=mN),Object.defineProperty(PN.prototype,"id",{get:function(){return this.mp.path.X()},enumerable:!0,configurable:!0}),Object.defineProperty(PN.prototype,"parent",{get:function(){var t=this.mp.path.H();return t.J()?null:new dN(new um(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(PN.prototype,"path",{get:function(){return this.mp.path.nt()},enumerable:!0,configurable:!0}),PN.prototype.doc=function(t){if(Fg("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=sg.u()),jg("CollectionReference.doc","non-empty string",1,t),""===t)throw new mg(gg.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=om.it(t);return dN.Zm(this.mp.path.child(e),this.firestore,this.ep)},PN.prototype.add=function(t){Mg("CollectionReference.add",arguments,1),jg("CollectionReference.add","object",1,this.ep?this.ep.toFirestore(t):t);var e=this.doc();return e.set(t).then(function(){return e})},PN.prototype.withConverter=function(t){return new PN(this.Vp,this.firestore,t)},PN);function PN(t,e,n){var r=RN.call(this,xb.$n(t),e,n)||this;if((r.Vp=t).length%2!=1)throw new mg(gg.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t.nt()+" has "+t.length);return r}function DN(t,e){if(void 0===e)return{merge:!1};if(Qg(t,e,["merge","mergeFields"]),Bg(t,"boolean","merge",e.merge),function(t,e,n,r,i){void 0!==r&&function(t,e,n,r,i){if(!(r instanceof Array))throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires its "+e+" option to be an array, but it was: "+Kg(r));for(var o=0;o<r.length;++o)if(!i(r[o]))throw new mg(gg.INVALID_ARGUMENT,"Function "+t+"() requires all "+e+" elements to be "+n+", but the value at index "+o+" was: "+Kg(r[o]))}(t,e,n,r,i)}(t,"mergeFields","a string or a FieldPath",e.mergeFields,function(t){return"string"==typeof t||t instanceof ES}),void 0!==e.mergeFields&&void 0!==e.merge)throw new mg(gg.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function xN(t,e){return void 0===e?{}:(Qg(t,e,["serverTimestamps"]),Wg(t,0,"serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function LN(t,e){qg(t,"object",1,e),e&&(Qg(t,e,["source"]),Wg(t,0,"source",e.source,["default","server","cache"]))}function MN(t,e,n){if(e instanceof dN){if(e.firestore!==n)throw new mg(gg.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw Yg(t,"DocumentReference",1,e)}function UN(t,e,n){var r;return t?(r=t.toFirestore(e),n="toFirestore() in "+n):r=e,[r,n]}var FN=lE(lN,"Use firebase.firestore() instead."),jN=lE(fN,"Use firebase.firestore().runTransaction() instead."),qN=lE(pN,"Use firebase.firestore().batch() instead."),VN=lE(dN,"Use firebase.firestore().doc() instead."),BN=lE(yN),WN=lE(gN),HN=lE(mN),GN=lE(wN),KN=lE(ON,"Use firebase.firestore().collection() instead."),zN={Firestore:FN,GeoPoint:em,Timestamp:nm,Blob:mE,Transaction:jN,WriteBatch:qN,DocumentReference:VN,DocumentSnapshot:BN,Query:HN,QueryDocumentSnapshot:WN,QuerySnapshot:GN,CollectionReference:KN,FieldPath:ES,FieldValue:BS,setLogLevel:lN.setLogLevel,CACHE_SIZE_UNLIMITED:cN};var QN=(oA.prototype.Fd=function(t){},oA.prototype.shutdown=function(){},oA),YN=(iA.prototype.Fd=function(t){this.xp.push(t)},iA.prototype.shutdown=function(){window.removeEventListener("online",this.Np),window.removeEventListener("offline",this.Op)},iA.prototype.jp=function(){window.addEventListener("online",this.Np),window.addEventListener("offline",this.Op)},iA.prototype.kp=function(){eg("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.xp;t<e.length;t++)(0,e[t])(0)},iA.prototype.Fp=function(){eg("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.xp;t<e.length;t++)(0,e[t])(1)},iA.Js=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},iA),XN=(rA.prototype._l=function(t){og(!this.Bp,"Called onOpen on stream twice!"),this.Bp=t},rA.prototype.ml=function(t){og(!this.Mp,"Called onClose on stream twice!"),this.Mp=t},rA.prototype.onMessage=function(t){og(!this.qp,"Called onMessage on stream twice!"),this.qp=t},rA.prototype.close=function(){this.Lp()},rA.prototype.send=function(t){this.Up(t)},rA.prototype.Qp=function(){og(void 0!==this.Bp,"Cannot call onOpen because no callback was set"),this.Bp()},rA.prototype.Gp=function(t){og(void 0!==this.Mp,"Cannot call onClose because no callback was set"),this.Mp(t)},rA.prototype.Wp=function(t){og(void 0!==this.qp,"Cannot call onMessage because no callback was set"),this.qp(t)},rA),JN={BatchGetDocuments:"batchGet",Commit:"commit"},$N="gl-js/ fire/"+Jy,ZN=(nA.prototype.Kp=function(t,e){if(e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n]);t["X-Goog-Api-Client"]=$N},nA.prototype.kl=function(u,r,i){var c=this,h=this.Hp(u);return new Promise(function(o,s){var a=new Xy;a.listenOnce(Qy.COMPLETE,function(){try{switch(a.getLastErrorCode()){case zy.NO_ERROR:var t=a.getResponseJson();eg("Connection","XHR received:",JSON.stringify(t)),o(t);break;case zy.TIMEOUT:eg("Connection",'RPC "'+u+'" timed out'),s(new mg(gg.DEADLINE_EXCEEDED,"Request time out"));break;case zy.HTTP_ERROR:var e=a.getStatus();if(eg("Connection",'RPC "'+u+'" failed with status:',e,"response text:",a.getResponseText()),0<e){var n=a.getResponseJson().error;if(n&&n.status&&n.message){var r=(i=n.status.toLowerCase().replace("_","-"),0<=Object.values(gg).indexOf(i)?i:gg.UNKNOWN);s(new mg(r,n.message))}else s(new mg(gg.UNKNOWN,"Server responded with status "+a.getStatus()))}else eg("Connection",'RPC "'+u+'" failed'),s(new mg(gg.UNAVAILABLE,"Connection failed."));break;default:ig('RPC "'+u+'" failed with unanticipated webchannel error '+a.getLastErrorCode()+": "+a.getLastError()+", giving up.")}}finally{eg("Connection",'RPC "'+u+'" completed.')}var i});var t=Es({},r);delete t.database;var e=JSON.stringify(t);eg("Connection","XHR sending: ",h+" "+e);var n={"Content-Type":"text/plain"};c.Kp(n,i),a.send(h,"POST",e,n,15)})},nA.prototype.Ol=function(t,e,n){return this.kl(t,e,n)},nA.prototype.Il=function(t,e){var n=[this.zp,"/","google.firestore.v1.Firestore","/",t,"/channel"],r=Ky(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.s.projectId+"/databases/"+this.s.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling};this.Kp(i.initMessageHeaders,e),qs()||Vs()||0<=js().indexOf("Electron/")||function(){var t=js();return 0<=t.indexOf("MSIE ")||0<=t.indexOf("Trident/")}()||0<=js().indexOf("MSAppHost/")||function(){var t="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof t&&void 0!==t.id}()||(i.httpHeadersOverwriteParam="$httpHeaders");var o=n.join("");function s(t,e){u.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})}eg("Connection","Creating WebChannel: "+o+" "+i);var u=r.createWebChannel(o,i),a=!1,c=!1,h=new XN({Up:function(t){c?eg("Connection","Not sending because WebChannel is closed:",t):(a||(eg("Connection","Opening WebChannel transport."),u.open(),a=!0),eg("Connection","WebChannel sending:",t),u.send(t))},Lp:function(){return u.close()}});return s(Yy.EventType.OPEN,function(){c||eg("Connection","WebChannel transport opened.")}),s(Yy.EventType.CLOSE,function(){c||(c=!0,eg("Connection","WebChannel transport closed"),h.Gp())}),s(Yy.EventType.ERROR,function(t){c||(c=!0,eg("Connection","WebChannel transport errored:",t),h.Gp(new mg(gg.UNAVAILABLE,"The operation could not be completed")))}),s(Yy.EventType.MESSAGE,function(t){var e;if(!c){var n=t.data[0];og(!!n,"Got a webchannel message without data.");var r=n,i=r.error||(null===(e=r[0])||void 0===e?void 0:e.error);if(i){eg("Connection","WebChannel received error:",i);var o=i.status,s=function(){var t=h_[o];if(void 0!==t)return g_(t)}(),a=i.message;void 0===s&&(s=gg.INTERNAL,a="Unknown error status: "+o+" with message "+i.message),c=!0,h.Gp(new mg(s,a)),u.close()}else eg("Connection","WebChannel received:",n),h.Wp(n)}}),setTimeout(function(){h.Qp()},0),h},nA.prototype.Hp=function(t){var e=JN[t];return og(void 0!==e,"Unknown REST mapping for: "+t),this.zp+"/v1/projects/"+this.s.projectId+"/databases/"+this.s.database+"/documents:"+e},nA),tA=(Object.defineProperty(eA.prototype,"document",{get:function(){return"undefined"!=typeof document?document:null},enumerable:!0,configurable:!0}),Object.defineProperty(eA.prototype,"window",{get:function(){return"undefined"!=typeof window?window:null},enumerable:!0,configurable:!0}),eA.prototype.Dm=function(t){return Promise.resolve(new ZN(t))},eA.prototype.Sm=function(){return YN.Js()?new YN:new QN},eA.prototype.Cm=function(t){return new aE(t,{tr:!0})},eA.prototype.i=function(t){return JSON.stringify(t)},eA.prototype.atob=function(t){return atob(t)},eA.prototype.btoa=function(t){return btoa(t)},eA);function eA(){this.vu="undefined"!=typeof atob}function nA(t){this.s=t.s;var e=t.ssl?"https":"http";this.zp=e+"://"+t.host,this.forceLongPolling=t.forceLongPolling}function rA(t){this.Up=t.Up,this.Lp=t.Lp}function iA(){var t=this;this.Np=function(){return t.kp()},this.Op=function(){return t.Fp()},this.xp=[],this.jp()}function oA(){}uE.du(new tA);var sA,aA;(aA=fl).INTERNAL.registerComponent(new pa("firestore",function(t){var e=t.getProvider("app").getImmediate();return new lN(e,t.getProvider("auth-internal"))},"PUBLIC").setServiceProps((og((sA=zN)&&"object"==typeof sA,"shallowCopy() expects object parameter."),Es({},sA)))),aA.registerVersion("@firebase/firestore","1.11.1");var uA,cA={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},hA=(_s(lA,uA=Error),lA);function lA(t,e,n){var r=uA.call(this,e)||this;return Object.setPrototypeOf(r,lA.prototype),r.code=t,r.details=n,r}function fA(t,e,n){var r=function(t){if(200<=t&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(t),i=r,o=void 0;try{var s=e&&e.error;if(s){var a=s.status;if("string"==typeof a){if(!cA[a])return new hA("internal","internal");r=cA[a],i=a}var u=s.message;"string"==typeof u&&(i=u),void 0!==(o=s.details)&&(o=n.decode(o))}}catch(t){}return"ok"===r?null:new hA(r,i,o)}var pA=(dA.prototype.getAuthToken=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:if(!this.auth)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(e=t.sent())?[2,e.accessToken]:[2,void 0];case 3:return t.sent(),[2,void 0];case 4:return[2]}})})},dA.prototype.getInstanceIdToken=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){if(!(this.messaging&&"Notification"in self&&"granted"===Notification.permission))return[2,void 0];try{return[2,this.messaging.getToken()]}catch(t){return[2,void 0]}return[2]})})},dA.prototype.getContext=function(){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,this.getAuthToken()];case 1:return e=t.sent(),[4,this.getInstanceIdToken()];case 2:return n=t.sent(),[2,{authToken:e,instanceIdToken:n}]}})})},dA);function dA(t,e){var n=this;this.auth=null,this.messaging=null,this.auth=t.getImmediate({optional:!0}),this.messaging=e.getImmediate({optional:!0}),this.auth||t.get().then(function(t){return n.auth=t},function(){}),this.messaging||e.get().then(function(t){return n.messaging=t},function(){})}function vA(t,e){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}var yA=(gA.prototype.encode=function(t){var e=this;if(null==t)return null;if(t instanceof Number&&(t=t.valueOf()),"number"==typeof t&&isFinite(t))return t;if(!0===t||!1===t)return t;if("[object String]"===Object.prototype.toString.call(t))return t;if(Array.isArray(t))return t.map(function(t){return e.encode(t)});if("function"==typeof t||"object"==typeof t)return vA(t,function(t){return e.encode(t)});throw new Error("Data cannot be encoded in JSON: "+t)},gA.prototype.decode=function(t){var e=this;if(null==t)return t;if(t["@type"])switch(t["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(t.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+t);return n;default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(function(t){return e.decode(t)}):"function"==typeof t||"object"==typeof t?vA(t,function(t){return e.decode(t)}):t},gA);function gA(){}var mA=(Object.defineProperty(wA.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),wA.prototype._url=function(t){var e=this.app_.options.projectId,n=this.region_;return null===this.emulatorOrigin?"https://"+n+"-"+e+".cloudfunctions.net/"+t:this.emulatorOrigin+"/"+e+"/"+n+"/"+t},wA.prototype.useFunctionsEmulator=function(t){this.emulatorOrigin=t},wA.prototype.httpsCallable=function(e,n){var r=this;return function(t){return r.call(e,t,n||{})}},wA.prototype.postJSON=function(r,i,o){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:o.append("Content-Type","application/json"),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,fetch(r,{method:"POST",body:JSON.stringify(i),headers:o})];case 2:return e=t.sent(),[3,4];case 3:return t.sent(),[2,{status:0,json:null}];case 4:n=null,t.label=5;case 5:return t.trys.push([5,7,,8]),[4,e.json()];case 6:return n=t.sent(),[3,8];case 7:return t.sent(),[3,8];case 8:return[2,{status:e.status,json:n}]}})})},wA.prototype.call=function(c,h,l){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u;return Ts(this,function(t){switch(t.label){case 0:return e=this._url(c),h=this.serializer.encode(h),n={data:h},r=new Headers,[4,this.contextProvider.getContext()];case 1:return(i=t.sent()).authToken&&r.append("Authorization","Bearer "+i.authToken),i.instanceIdToken&&r.append("Firebase-Instance-ID-Token",i.instanceIdToken),o=l.timeout||7e4,[4,Promise.race([this.postJSON(e,n,r),function(n){return new Promise(function(t,e){setTimeout(function(){e(new hA("deadline-exceeded","deadline-exceeded"))},n)})}(o),this.cancelAllRequests])];case 2:if(!(s=t.sent()))throw new hA("cancelled","Firebase Functions instance was deleted.");if(a=fA(s.status,s.json,this.serializer))throw a;if(!s.json)throw new hA("internal","Response is not valid JSON object.");if(void 0===(u=s.json.data)&&(u=s.json.result),void 0===u)throw new hA("internal","Response is missing data field.");return[2,{data:this.serializer.decode(u)}]}})})},wA);function wA(t,e,n,r){var i=this;void 0===r&&(r="us-central1"),this.app_=t,this.region_=r,this.serializer=new yA,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return i.deleteService()}},this.contextProvider=new pA(e,n),this.cancelAllRequests=new Promise(function(t){i.deleteService=function(){return t()}})}function bA(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),i=t.getProvider("messaging");return new mA(n,r,i,e)}var _A;function EA(n){return new Promise(function(t,e){n.onsuccess=function(){t(n.result)},n.onerror=function(){e(n.error)}})}function IA(n,r,i){var o,t=new Promise(function(t,e){EA(o=n[r].apply(n,i)).then(t,e)});return t.request=o,t}function TA(t,n,e){e.forEach(function(e){Object.defineProperty(t.prototype,e,{get:function(){return this[n][e]},set:function(t){this[n][e]=t}})})}function SA(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return IA(this[n],t,arguments)})})}function CA(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return this[n][t].apply(this[n],arguments)})})}function NA(e,n,r,t){t.forEach(function(t){t in r.prototype&&(e.prototype[t]=function(){return function(t,e,n){var r=IA(t,e,n);return r.then(function(t){if(t)return new kA(t,r.request)})}(this[n],t,arguments)})})}function AA(t){this._index=t}function kA(t,e){this._cursor=t,this._request=e}function RA(t){this._store=t}function OA(n){this._tx=n,this.complete=new Promise(function(t,e){n.oncomplete=function(){t()},n.onerror=function(){e(n.error)},n.onabort=function(){e(n.error)}})}function PA(t,e,n){this._db=t,this.oldVersion=e,this.transaction=new OA(n)}function DA(t){this._db=t}function xA(t,e,n){var r=IA(indexedDB,"open",[t,e]),i=r.request;return i&&(i.onupgradeneeded=function(t){n&&n(new PA(i.result,t.oldVersion,i.transaction))}),r.then(function(t){return new DA(t)})}function LA(t){return IA(indexedDB,"deleteDatabase",[t])}_A={Functions:mA},fl.INTERNAL.registerComponent(new pa("functions",bA,"PUBLIC").setServiceProps(_A).setMultipleInstances(!0)),fl.registerVersion("@firebase/functions","0.4.34"),TA(AA,"_index",["name","keyPath","multiEntry","unique"]),SA(AA,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),NA(AA,"_index",IDBIndex,["openCursor","openKeyCursor"]),TA(kA,"_cursor",["direction","key","primaryKey","value"]),SA(kA,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(n){n in IDBCursor.prototype&&(kA.prototype[n]=function(){var e=this,t=arguments;return Promise.resolve().then(function(){return e._cursor[n].apply(e._cursor,t),EA(e._request).then(function(t){if(t)return new kA(t,e._request)})})})}),RA.prototype.createIndex=function(){return new AA(this._store.createIndex.apply(this._store,arguments))},RA.prototype.index=function(){return new AA(this._store.index.apply(this._store,arguments))},TA(RA,"_store",["name","keyPath","indexNames","autoIncrement"]),SA(RA,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),NA(RA,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),CA(RA,"_store",IDBObjectStore,["deleteIndex"]),OA.prototype.objectStore=function(){return new RA(this._tx.objectStore.apply(this._tx,arguments))},TA(OA,"_tx",["objectStoreNames","mode"]),CA(OA,"_tx",IDBTransaction,["abort"]),PA.prototype.createObjectStore=function(){return new RA(this._db.createObjectStore.apply(this._db,arguments))},TA(PA,"_db",["name","version","objectStoreNames"]),CA(PA,"_db",IDBDatabase,["deleteObjectStore","close"]),DA.prototype.transaction=function(){return new OA(this._db.transaction.apply(this._db,arguments))},TA(DA,"_db",["name","version","objectStoreNames"]),CA(DA,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(i){[RA,AA].forEach(function(t){i in t.prototype&&(t.prototype[i.replace("open","iterate")]=function(){var t=function(t){return Array.prototype.slice.call(t)}(arguments),e=t[t.length-1],n=this._store||this._index,r=n[i].apply(n,t.slice(0,-1));r.onsuccess=function(){e(r.result)}})})}),[AA,RA].forEach(function(t){t.prototype.getAll||(t.prototype.getAll=function(t,n){var r=this,i=[];return new Promise(function(e){r.iterateCursor(t,function(t){t?(i.push(t.value),void 0===n||i.length!=n?t.continue():e(i)):e(i)})})})});var MA,UA=1e4,FA="w:0.4.2",jA="FIS_v2",qA="https://firebaseinstallations.googleapis.com/v1",VA=36e5,BA=((MA={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',MA["not-registered"]="Firebase Installation is not registered.",MA["installation-not-found"]="Firebase Installation not found.",MA["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',MA["app-offline"]="Could not process request. Application offline.",MA["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",MA),WA=new Ks("installations","Installations",BA);function HA(t){return t instanceof Hs&&t.code.includes("request-failed")}function GA(t){var e=t.projectId;return qA+"/projects/"+e+"/installations"}function KA(t){return{token:t.token,requestStatus:2,expiresIn:function(t){return Number(t.replace("s","000"))}(t.expiresIn),creationTime:Date.now()}}function zA(r,i){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,i.json()];case 1:return e=t.sent(),n=e.error,[2,WA.create("request-failed",{requestName:r,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})]}})})}function QA(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function YA(t,e){var n=e.refreshToken,r=QA(t);return r.append("Authorization",function(t){return jA+" "+t}(n)),r}function XA(n){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,n()];case 1:return 500<=(e=t.sent()).status&&e.status<600?[2,n()]:[2,e]}})})}function JA(e){return new Promise(function(t){setTimeout(t,e)})}var $A=/^[cdef][\w-]{21}$/,ZA="";function tk(){try{var t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;var e=function(t){return function(t){return btoa(String.fromCharCode.apply(String,Ns(t))).replace(/\+/g,"-").replace(/\//g,"_")}(t).substr(0,22)}(t);return $A.test(e)?e:ZA}catch(t){return ZA}}function ek(t){return t.appName+"!"+t.appId}var nk=new Map;function rk(t,e){var n=ek(t);ik(n,e),function(t,e){var n=sk();n&&n.postMessage({key:t,fid:e});ak()}(n,e)}function ik(t,e){var n,r,i=nk.get(t);if(i)try{for(var o=Ss(i),s=o.next();!s.done;s=o.next()){(0,s.value)(e)}}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var ok=null;function sk(){return!ok&&"BroadcastChannel"in self&&((ok=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(t){ik(t.data.key,t.data.fid)}),ok}function ak(){0===nk.size&&ok&&(ok.close(),ok=null)}var uk,ck,hk="firebase-installations-database",lk=1,fk="firebase-installations-store",pk=null;function dk(){return pk=pk||xA(hk,lk,function(t){switch(t.oldVersion){case 0:t.createObjectStore(fk)}})}function vk(s,a){return Is(this,void 0,void 0,function(){var e,n,r,i,o;return Ts(this,function(t){switch(t.label){case 0:return e=ek(s),[4,dk()];case 1:return n=t.sent(),r=n.transaction(fk,"readwrite"),[4,(i=r.objectStore(fk)).get(e)];case 2:return o=t.sent(),[4,i.put(a,e)];case 3:return t.sent(),[4,r.complete];case 4:return t.sent(),o&&o.fid===a.fid||rk(s,a.fid),[2,a]}})})}function yk(i){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return e=ek(i),[4,dk()];case 1:return n=t.sent(),[4,(r=n.transaction(fk,"readwrite")).objectStore(fk).delete(e)];case 2:return t.sent(),[4,r.complete];case 3:return t.sent(),[2]}})})}function gk(a,u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return e=ek(a),[4,dk()];case 1:return n=t.sent(),r=n.transaction(fk,"readwrite"),[4,(i=r.objectStore(fk)).get(e)];case 2:return o=t.sent(),void 0!==(s=u(o))?[3,4]:[4,i.delete(e)];case 3:return t.sent(),[3,6];case 4:return[4,i.put(s,e)];case 5:t.sent(),t.label=6;case 6:return[4,r.complete];case 7:return t.sent(),!s||o&&o.fid===s.fid||rk(a,s.fid),[2,s]}})})}function mk(i){return Is(this,void 0,void 0,function(){var r,e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,gk(i,function(t){var e=function(t){return bk(t||{fid:tk(),registrationStatus:0})}(t),n=function(t,e){{if(0!==e.registrationStatus)return 1===e.registrationStatus?{installationEntry:e,registrationPromise:function(o){return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return[4,wk(o)];case 1:e=t.sent(),t.label=2;case 2:return 1!==e.registrationStatus?[3,5]:[4,JA(100)];case 3:return t.sent(),[4,wk(o)];case 4:return e=t.sent(),[3,2];case 5:return 0!==e.registrationStatus?[3,7]:[4,mk(o)];case 6:return n=t.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,e]}})})}(t)}:{installationEntry:e};if(!navigator.onLine){var n=Promise.reject(WA.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},i=function(r,i){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,7]),[4,function(a,t){var u=t.fid;return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return e=GA(a),n=QA(a),r={fid:u,authVersion:jA,appId:a.appId,sdkVersion:FA},i={method:"POST",headers:n,body:JSON.stringify(r)},[4,XA(function(){return fetch(e,i)})];case 1:return(o=t.sent()).ok?[4,o.json()]:[3,3];case 2:return s=t.sent(),[2,{fid:s.fid||u,registrationStatus:2,refreshToken:s.refreshToken,authToken:KA(s.authToken)}];case 3:return[4,zA("Create Installation",o)];case 4:throw t.sent()}})})}(r,i)];case 1:return e=t.sent(),[2,vk(r,e)];case 2:return HA(n=t.sent())&&409===n.serverCode?[4,yk(r)]:[3,4];case 3:return t.sent(),[3,6];case 4:return[4,vk(r,{fid:i.fid,registrationStatus:0})];case 5:t.sent(),t.label=6;case 6:throw n;case 7:return[2]}})})}(t,r);return{installationEntry:r,registrationPromise:i}}}(i,e);return r=n.registrationPromise,n.installationEntry})];case 1:return(e=t.sent()).fid!==ZA?[3,3]:(n={},[4,r]);case 2:return[2,(n.installationEntry=t.sent(),n)];case 3:return[2,{installationEntry:e,registrationPromise:r}]}})})}function wk(t){return gk(t,function(t){if(!t)throw WA.create("installation-not-found");return bk(t)})}function bk(t){return function(t){return 1===t.registrationStatus&&t.registrationTime+UA<Date.now()}(t)?{fid:t.fid,registrationStatus:0}:t}function _k(t,u){var c=t.appConfig,h=t.platformLoggerProvider;return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return Ts(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=e.fid;return GA(t)+"/"+n+"/authTokens:generate"}(c,u),n=YA(c,u),(r=h.getImmediate({optional:!0}))&&n.append("x-firebase-client",r.getPlatformInfoString()),i={installation:{sdkVersion:FA}},o={method:"POST",headers:n,body:JSON.stringify(i)},[4,XA(function(){return fetch(e,o)})];case 1:return(s=t.sent()).ok?[4,s.json()]:[3,3];case 2:return a=t.sent(),[2,KA(a)];case 3:return[4,zA("Generate Auth Token",s)];case 4:throw t.sent()}})})}function Ek(i,o){return void 0===o&&(o=!1),Is(this,void 0,void 0,function(){var r,e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,gk(i.appConfig,function(t){if(!Tk(t))throw WA.create("not-registered");var e=t.authToken;if(!o&&function(t){return 2===t.requestStatus&&!function(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+VA}(t)}(e))return t;if(1===e.requestStatus)return r=function(r,i){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,Ik(r.appConfig)];case 1:e=t.sent(),t.label=2;case 2:return 1!==e.authToken.requestStatus?[3,5]:[4,JA(100)];case 3:return t.sent(),[4,Ik(r.appConfig)];case 4:return e=t.sent(),[3,2];case 5:return 0===(n=e.authToken).requestStatus?[2,Ek(r,i)]:[2,n]}})})}(i,o),t;if(!navigator.onLine)throw WA.create("app-offline");var n=function(t){var e={requestStatus:1,requestTime:Date.now()};return Es(Es({},t),{authToken:e})}(t);return r=function(i,o){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,8]),[4,_k(i,o)];case 1:return e=t.sent(),r=Es(Es({},o),{authToken:e}),[4,vk(i.appConfig,r)];case 2:return t.sent(),[2,e];case 3:return!HA(n=t.sent())||401!==n.serverCode&&404!==n.serverCode?[3,5]:[4,yk(i.appConfig)];case 4:return t.sent(),[3,7];case 5:return r=Es(Es({},o),{authToken:{requestStatus:0}}),[4,vk(i.appConfig,r)];case 6:t.sent(),t.label=7;case 7:throw n;case 8:return[2]}})})}(i,n),n})];case 1:return e=t.sent(),r?[4,r]:[3,3];case 2:return n=t.sent(),[3,4];case 3:n=e.authToken,t.label=4;case 4:return[2,n]}})})}function Ik(t){return gk(t,function(t){if(!Tk(t))throw WA.create("not-registered");return function(t){return 1===t.requestStatus&&t.requestTime+UA<Date.now()}(t.authToken)?Es(Es({},t),{authToken:{requestStatus:0}}):t})}function Tk(t){return void 0!==t&&2===t.registrationStatus}function Sk(e,n){return void 0===n&&(n=!1),Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return[4,function(n){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,mk(n)];case 1:return(e=t.sent().registrationPromise)?[4,e]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e.appConfig)];case 1:return t.sent(),[4,Ek(e,n)];case 2:return[2,t.sent().token]}})})}function Ck(o,s){return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=e.fid;return GA(t)+"/"+n}(o,s),n=YA(o,s),r={method:"DELETE",headers:n},[4,XA(function(){return fetch(e,r)})];case 1:return(i=t.sent()).ok?[3,3]:[4,zA("Delete Installation",i)];case 2:throw t.sent();case 3:return[2]}})})}function Nk(t,e){var n=t.appConfig;return function(t,e){sk();var n=ek(t),r=nk.get(n);r||(r=new Set,nk.set(n,r)),r.add(e)}(n,e),function(){!function(t,e){var n=ek(t),r=nk.get(n);r&&(r.delete(e),0===r.size&&nk.delete(n),ak())}(n,e)}}function Ak(t){return WA.create("missing-app-config-values",{valueName:t})}(uk=fl).INTERNAL.registerComponent(new pa("installations",function(t){var e=t.getProvider("app").getImmediate(),n={appConfig:function(t){var e,n;if(!t||!t.options)throw Ak("App Configuration");if(!t.name)throw Ak("App Name");try{for(var r=Ss(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!t.options[o])throw Ak(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}(e),platformLoggerProvider:t.getProvider("platform-logger")};return{app:e,getId:function(){return function(i){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return[4,mk(i.appConfig)];case 1:return e=t.sent(),n=e.installationEntry,(r=e.registrationPromise)?r.catch(console.error):Ek(i).catch(console.error),[2,n.fid]}})})}(n)},getToken:function(t){return Sk(n,t)},delete:function(){return function(r){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,gk(e=r.appConfig,function(t){if(!t||0!==t.registrationStatus)return t})];case 1:if(!(n=t.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw WA.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw WA.create("app-offline");case 3:return[4,Ck(e,n)];case 4:return t.sent(),[4,yk(e)];case 5:t.sent(),t.label=6;case 6:return[2]}})})}(n)},onIdChange:function(t){return Nk(n,t)}}},"PUBLIC")),uk.registerVersion("@firebase/installations","0.4.2");var kk=((ck={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',ck["only-available-in-window"]="This method is available in a Window context.",ck["only-available-in-sw"]="This method is available in a service worker context.",ck["permission-default"]="The notification permission was not granted and dismissed instead.",ck["permission-blocked"]="The notification permission was not granted and blocked instead.",ck["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",ck["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",ck["token-subscribe-failed"]="A problem occured while subscribing the user to FCM: {$errorInfo}",ck["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",ck["token-unsubscribe-failed"]="A problem occured while unsubscribing the user from FCM: {$errorInfo}",ck["token-update-failed"]="A problem occured while updating the user from FCM: {$errorInfo}",ck["token-update-no-token"]="FCM returned no token when updating the user to push.",ck["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",ck["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",ck["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",ck["invalid-vapid-key"]="The public VAPID key must be a string.",ck["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",ck),Rk=new Ks("messaging","Messaging",kk);function Ok(t){return Rk.create("missing-app-config-values",{valueName:t})}function Pk(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(String,Ns(e))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}var Dk="fcm_token_details_db",xk=5,Lk="fcm_token_object_Store";function Mk(a){return Is(this,void 0,void 0,function(){var e,s,n=this;return Ts(this,function(t){switch(t.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(e=t.sent(),!e.map(function(t){return t.name}).includes(Dk))return[2,null];t.label=2;case 2:return s=null,[4,xA(Dk,xk,function(o){return Is(n,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return o.oldVersion<2?[2]:o.objectStoreNames.contains(Lk)?[4,(e=o.transaction.objectStore(Lk)).index("fcmSenderId").get(a)]:[2];case 1:return n=t.sent(),[4,e.clear()];case 2:if(t.sent(),!n)return[2];if(2===o.oldVersion){if(!(r=n).auth||!r.p256dh||!r.endpoint)return[2];s={token:r.fcmToken,createTime:(i=r.createTime,null!=i?i:Date.now()),subscriptionOptions:{auth:r.auth,p256dh:r.p256dh,endpoint:r.endpoint,swScope:r.swScope,vapidKey:"string"==typeof r.vapidKey?r.vapidKey:Pk(r.vapidKey)}}}else 3===o.oldVersion?s={token:(r=n).fcmToken,createTime:r.createTime,subscriptionOptions:{auth:Pk(r.auth),p256dh:Pk(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:Pk(r.vapidKey)}}:4===o.oldVersion&&(s={token:(r=n).fcmToken,createTime:r.createTime,subscriptionOptions:{auth:Pk(r.auth),p256dh:Pk(r.p256dh),endpoint:r.endpoint,swScope:r.swScope,vapidKey:Pk(r.vapidKey)}});return[2]}})})})];case 3:return t.sent().close(),[4,LA(Dk)];case 4:return t.sent(),[4,LA("fcm_vapid_details_db")];case 5:return t.sent(),[4,LA("undefined")];case 6:return t.sent(),[2,function(t){if(!t||!t.subscriptionOptions)return!1;var e=t.subscriptionOptions;return"number"==typeof t.createTime&&0<t.createTime&&"string"==typeof t.token&&0<t.token.length&&"string"==typeof e.auth&&0<e.auth.length&&"string"==typeof e.p256dh&&0<e.p256dh.length&&"string"==typeof e.endpoint&&0<e.endpoint.length&&"string"==typeof e.swScope&&0<e.swScope.length&&"string"==typeof e.vapidKey&&0<e.vapidKey.length}(s)?s:null]}})})}var Uk="firebase-messaging-database",Fk=1,jk="firebase-messaging-store",qk=null;function Vk(){return qk=qk||xA(Uk,Fk,function(t){switch(t.oldVersion){case 0:t.createObjectStore(jk)}})}function Bk(i){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return e=Hk(i),[4,Vk()];case 1:return[4,t.sent().transaction(jk).objectStore(jk).get(e)];case 2:return(n=t.sent())?[2,n]:[3,3];case 3:return[4,Mk(i.appConfig.senderId)];case 4:return(r=t.sent())?[4,Wk(i,r)]:[3,6];case 5:return t.sent(),[2,r];case 6:return[2]}})})}function Wk(i,o){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return e=Hk(i),[4,Vk()];case 1:return n=t.sent(),[4,(r=n.transaction(jk,"readwrite")).objectStore(jk).put(o,e)];case 2:return t.sent(),[4,r.complete];case 3:return t.sent(),[2,o]}})})}function Hk(t){return t.appConfig.appId}var Gk="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Kk="https://fcmregistrations.googleapis.com/v1",zk="FCM_MSG",Qk="google.c.a.c_id";function Yk(s,a){return Is(this,void 0,void 0,function(){var e,n,r,i,o;return Ts(this,function(t){switch(t.label){case 0:return[4,Jk(s)];case 1:e=t.sent(),n={method:"DELETE",headers:e},t.label=2;case 2:return t.trys.push([2,5,,6]),[4,fetch(Xk(s.appConfig)+"/"+a,n)];case 3:return[4,t.sent().json()];case 4:if((r=t.sent()).error)throw i=r.error.message,Rk.create("token-unsubscribe-failed",{errorInfo:i});return[3,6];case 5:throw o=t.sent(),Rk.create("token-unsubscribe-failed",{errorInfo:o});case 6:return[2]}})})}function Xk(t){var e=t.projectId;return Kk+"/projects/"+e+"/registrations"}function Jk(t){var n=t.appConfig,r=t.installations;return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,r.getToken()];case 1:return e=t.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n.apiKey,"x-goog-firebase-installations-auth":"FIS "+e})]}})})}function $k(t){var e=t.p256dh,n=t.auth,r=t.endpoint,i=t.vapidKey,o={web:{endpoint:r,auth:n,p256dh:e}};return i!==Gk&&(o.web.applicationPubKey=i),o}var Zk,tR;function eR(o,s,a){return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:if("granted"!==Notification.permission)throw Rk.create("permission-blocked");return[4,function(n,r){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,n.pushManager.getSubscription()];case 1:return(e=t.sent())?[2,e]:[2,n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:r})]}})})}(s,a)];case 1:return e=t.sent(),[4,Bk(o)];case 2:return n=t.sent(),r={vapidKey:a,swScope:s.scope,endpoint:e.endpoint,auth:Pk(e.getKey("auth")),p256dh:Pk(e.getKey("p256dh"))},n?[3,3]:[2,rR(o,r)];case 3:if(function(t,e){var n=e.vapidKey===t.vapidKey,r=e.endpoint===t.endpoint,i=e.auth===t.auth,o=e.p256dh===t.p256dh;return n&&r&&i&&o}(n.subscriptionOptions,r))return[3,8];t.label=4;case 4:return t.trys.push([4,6,,7]),[4,Yk(o,n.token)];case 5:return t.sent(),[3,7];case 6:return i=t.sent(),console.warn(i),[3,7];case 7:return[2,rR(o,r)];case 8:return Date.now()>=n.createTime+6048e5?[2,function(i,o,s){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,5]),[4,function(a,u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return[4,Jk(a)];case 1:e=t.sent(),n=$k(u.subscriptionOptions),r={method:"PATCH",headers:e,body:JSON.stringify(n)},t.label=2;case 2:return t.trys.push([2,5,,6]),[4,fetch(Xk(a.appConfig)+"/"+u.token,r)];case 3:return[4,t.sent().json()];case 4:return i=t.sent(),[3,6];case 5:throw o=t.sent(),Rk.create("token-update-failed",{errorInfo:o});case 6:if(i.error)throw s=i.error.message,Rk.create("token-update-failed",{errorInfo:s});if(!i.token)throw Rk.create("token-update-no-token");return[2,i.token]}})})}(o,i)];case 1:return e=t.sent(),n=Es({token:e,createTime:Date.now()},i),[4,Wk(o,n)];case 2:return t.sent(),[2,e];case 3:return r=t.sent(),[4,nR(o,s)];case 4:throw t.sent(),r;case 5:return[2]}})})}({token:n.token,createTime:Date.now(),subscriptionOptions:r},o,s)]:[2,n.token];case 9:return[2]}})})}function nR(r,i){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,Bk(r)];case 1:return(e=t.sent())?[4,Yk(r,e.token)]:[3,4];case 2:return t.sent(),[4,function(i){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return e=Hk(i),[4,Vk()];case 1:return n=t.sent(),[4,(r=n.transaction(jk,"readwrite")).objectStore(jk).delete(e)];case 2:return t.sent(),[4,r.complete];case 3:return t.sent(),[2]}})})}(r)];case 3:t.sent(),t.label=4;case 4:return[4,i.pushManager.getSubscription()];case 5:return(n=t.sent())?[2,n.unsubscribe()]:[2,!0]}})})}function rR(r,i){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,function(a,u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return[4,Jk(a)];case 1:e=t.sent(),n=$k(u),r={method:"POST",headers:e,body:JSON.stringify(n)},t.label=2;case 2:return t.trys.push([2,5,,6]),[4,fetch(Xk(a.appConfig),r)];case 3:return[4,t.sent().json()];case 4:return i=t.sent(),[3,6];case 5:throw o=t.sent(),Rk.create("token-subscribe-failed",{errorInfo:o});case 6:if(i.error)throw s=i.error.message,Rk.create("token-subscribe-failed",{errorInfo:s});if(!i.token)throw Rk.create("token-subscribe-no-token");return[2,i.token]}})})}(r,i)];case 1:return e=t.sent(),n={token:e,createTime:Date.now(),subscriptionOptions:i},[4,Wk(r,n)];case 2:return t.sent(),[2,n.token]}})})}function iR(t){return"object"==typeof t&&!!t&&Qk in t}(tR=Zk=Zk||{}).PUSH_RECEIVED="push-received",tR.NOTIFICATION_CLICKED="notification-clicked";var oR=(Object.defineProperty(sR.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!0,configurable:!0}),sR.prototype.getToken=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.vapidKey||(this.vapidKey=Gk),[4,this.getServiceWorkerRegistration()];case 1:return e=t.sent(),"default"!==Notification.permission?[3,3]:[4,Notification.requestPermission()];case 2:t.sent(),t.label=3;case 3:if("granted"!==Notification.permission)throw Rk.create("permission-blocked");return[2,eR(this.firebaseDependencies,e,this.vapidKey)]}})})},sR.prototype.deleteToken=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,this.getServiceWorkerRegistration()];case 1:return e=t.sent(),[2,nR(this.firebaseDependencies,e)]}})})},sR.prototype.requestPermission=function(){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?Rk.create("permission-blocked"):Rk.create("permission-default")}})})},sR.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Rk.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Rk.create("invalid-vapid-key");this.vapidKey=t},sR.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw Rk.create("invalid-sw-registration");if(this.swRegistration)throw Rk.create("use-sw-after-get-token");this.swRegistration=t},sR.prototype.onMessage=function(t){var e=this;return this.onMessageCallback="function"==typeof t?t:t.next,function(){e.onMessageCallback=null}},sR.prototype.setBackgroundMessageHandler=function(){throw Rk.create("only-available-in-sw")},sR.prototype.onTokenRefresh=function(){return function(){}},sR.prototype.getServiceWorkerRegistration=function(){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:if(this.swRegistration)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),e=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 2:return e.swRegistration=t.sent(),this.swRegistration.update().catch(function(){}),[3,4];case 3:throw n=t.sent(),Rk.create("failed-service-worker-registration",{browserErrorMessage:n.message});case 4:return[2,this.swRegistration]}})})},sR.prototype.messageEventListener=function(o){var s;return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return(null===(s=o.data)||void 0===s?void 0:s.firebaseMessaging)?(e=o.data.firebaseMessaging,n=e.type,r=e.payload,this.onMessageCallback&&n===Zk.PUSH_RECEIVED&&this.onMessageCallback(r),iR(i=r.data)&&"1"===i["google.c.a.e"]?[4,this.logEvent(n,i)]:[3,2]):[2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},sR.prototype.logEvent=function(n,r){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return e=function(t){switch(t){case Zk.NOTIFICATION_CLICKED:return"notification_open";case Zk.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(n),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return t.sent().logEvent(e,{message_id:r[Qk],message_name:r["google.c.a.c_l"],message_time:r["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}})})},sR);function sR(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",function(t){return e.messageEventListener(t)})}var aR=(Object.defineProperty(uR.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!0,configurable:!0}),uR.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!=typeof t)throw Rk.create("invalid-bg-handler");this.bgMessageHandler=t},uR.prototype.getToken=function(){var n,r,i;return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return this.vapidKey?[3,2]:[4,Bk(this.firebaseDependencies)];case 1:e=t.sent(),this.vapidKey=null!=(i=null===(r=null===(n=e)||void 0===n?void 0:n.subscriptionOptions)||void 0===r?void 0:r.vapidKey)?i:Gk,t.label=2;case 2:return[2,eR(this.firebaseDependencies,self.registration,this.vapidKey)]}})})},uR.prototype.deleteToken=function(){return nR(this.firebaseDependencies,self.registration)},uR.prototype.requestPermission=function(){throw Rk.create("only-available-in-window")},uR.prototype.usePublicVapidKey=function(t){if(null!==this.vapidKey)throw Rk.create("use-vapid-key-after-get-token");if("string"!=typeof t||0===t.length)throw Rk.create("invalid-vapid-key");this.vapidKey=t},uR.prototype.useServiceWorker=function(){throw Rk.create("only-available-in-window")},uR.prototype.onMessage=function(){throw Rk.create("only-available-in-window")},uR.prototype.onTokenRefresh=function(){throw Rk.create("only-available-in-window")},uR.prototype.onPush=function(i){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return(e=function(t){var e=t.data;if(!e)return null;try{return e.json()}catch(t){return null}}(i))?[4,cR()]:[2];case 1:return function(t){return t.some(function(t){return"visible"===t.visibilityState&&!t.url.startsWith("chrome-extension://")})}(n=t.sent())?[2,function(t,e){var n,r,i=hR(Zk.PUSH_RECEIVED,e);try{for(var o=Ss(t),s=o.next();!s.done;s=o.next())s.value.postMessage(i)}catch(t){n={error:t}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}(n,e)]:(r=function(t){var e;if(t&&"object"==typeof t.notification){var n=Es({},t.notification);return n.data=Es(Es({},t.notification.data),((e={})[zk]=t,e)),n}}(e))?[4,function(t){var e,n=null!==(e=t.title)&&void 0!==e?e:"",r=t.actions,i=Notification.maxActions;return r&&i&&r.length>i&&console.warn("This browser only supports "+i+" actions. The remaining actions will not be displayed."),self.registration.showNotification(n,t)}(r)]:[3,3];case 2:return t.sent(),[3,5];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:t.sent(),t.label=5;case 5:return[2]}})})},uR.prototype.onSubChange=function(n){var r,i,o;return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return n.newSubscription?[3,2]:[4,nR(this.firebaseDependencies,self.registration)];case 1:return t.sent(),[2];case 2:return[4,Bk(this.firebaseDependencies)];case 3:return e=t.sent(),[4,nR(this.firebaseDependencies,self.registration)];case 4:return t.sent(),[4,eR(this.firebaseDependencies,self.registration,(o=null===(i=null===(r=e)||void 0===r?void 0:r.subscriptionOptions)||void 0===i?void 0:i.vapidKey,null!=o?o:Gk))];case 5:return t.sent(),[2]}})})},uR.prototype.onNotificationClick=function(o){var s,a;return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return(e=null===(a=null===(s=o.notification)||void 0===s?void 0:s.data)||void 0===a?void 0:a[zk])?o.action?[2]:(o.stopImmediatePropagation(),o.notification.close(),(n=function(t){var e,n,r,i=null!==(n=null===(e=t.fcmOptions)||void 0===e?void 0:e.link)&&void 0!==n?n:null===(r=t.notification)||void 0===r?void 0:r.click_action;return i||(iR(t.data)?self.location.origin:null)}(e))?[4,function(u){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a;return Ts(this,function(t){switch(t.label){case 0:return e=new URL(u,self.location.href).href,[4,cR()];case 1:n=t.sent();try{for(r=Ss(n),i=r.next();!i.done;i=r.next())if(o=i.value,new URL(o.url,self.location.href).href===e)return[2,o]}catch(t){s={error:t}}finally{try{i&&!i.done&&(a=r.return)&&a.call(r)}finally{if(s)throw s.error}}return[2,null]}})})}(n)]:[2]):[2];case 1:return(r=t.sent())?[3,4]:[4,self.clients.openWindow(n)];case 2:return r=t.sent(),[4,function(e){return new Promise(function(t){setTimeout(t,e)})}(3e3)];case 3:return t.sent(),[3,6];case 4:return[4,r.focus()];case 5:r=t.sent(),t.label=6;case 6:return r?(i=hR(Zk.NOTIFICATION_CLICKED,e),[2,r.postMessage(i)]):[2]}})})},uR);function uR(t){var e=this;this.firebaseDependencies=t,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",function(t){t.waitUntil(e.onPush(t))}),self.addEventListener("pushsubscriptionchange",function(t){t.waitUntil(e.onSubChange(t))}),self.addEventListener("notificationclick",function(t){t.waitUntil(e.onNotificationClick(t))})}function cR(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function hR(t,e){return{firebaseMessaging:{type:t,payload:e}}}var lR={isSupported:fR};function fR(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}fl.INTERNAL.registerComponent(new pa("messaging",function(t){var e=t.getProvider("app").getImmediate(),n={app:e,appConfig:function(t){var e,n;if(!t||!t.options)throw Ok("App Configuration Object");if(!t.name)throw Ok("App Name");var r=t.options;try{for(var i=Ss(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var s=o.value;if(!r[s])throw Ok(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return{appName:t.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e),installations:t.getProvider("installations").getImmediate(),analyticsProvider:t.getProvider("analytics-internal")};if(!fR())throw Rk.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new aR(n):new oR(n)},"PUBLIC").setServiceProps(lR));var pR="firebasestorage.googleapis.com",dR="storageBucket",vR=(yR.prototype.codeProp=function(){return this.code},yR.prototype.codeEquals=function(t){return mR(t)===this.codeProp()},yR.prototype.serverResponseProp=function(){return this.serverResponse_},yR.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(yR.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(yR.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(yR.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(yR.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),yR);function yR(t,e){this.code_=mR(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}var gR={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"};function mR(t){return"storage/"+t}function wR(){return new vR(gR.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function bR(){return new vR(gR.CANCELED,"User canceled the upload/download.")}function _R(){return new vR(gR.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function ER(t,e,n){return new vR(gR.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function IR(){return new vR(gR.APP_DELETED,"The Firebase app was deleted.")}function TR(t,e){return new vR(gR.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function SR(t){throw new vR(gR.INTERNAL_ERROR,"Internal error: "+t)}var CR={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};function NR(t){switch(t){case CR.RAW:case CR.BASE64:case CR.BASE64URL:case CR.DATA_URL:return;default:throw"Expected one of the event types: ["+CR.RAW+", "+CR.BASE64+", "+CR.BASE64URL+", "+CR.DATA_URL+"]."}}var AR=function(t,e){this.data=t,this.contentType=e||null};function kR(t,e){switch(t){case CR.RAW:return new AR(RR(e));case CR.BASE64:case CR.BASE64URL:return new AR(OR(t,e));case CR.DATA_URL:return new AR(function(t){var e=new PR(t);return e.base64?OR(CR.BASE64,e.rest):function(t){var e;try{e=decodeURIComponent(t)}catch(t){throw TR(CR.DATA_URL,"Malformed data URL.")}return RR(e)}(e.rest)}(e),function(t){return new PR(t).contentType}(e))}throw wR()}function RR(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r))if(n<t.length-1&&56320==(64512&t.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&t.charCodeAt(++n),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else e.push(239,191,189);else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function OR(e,t){switch(e){case CR.BASE64:var n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw TR(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case CR.BASE64URL:var i=-1!==t.indexOf("+"),o=-1!==t.indexOf("/");if(i||o)throw TR(e,"Invalid character '"+(i?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(t)}catch(t){throw TR(e,"Invalid character found")}for(var a=new Uint8Array(s.length),u=0;u<s.length;u++)a[u]=s.charCodeAt(u);return a}var PR=function(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw TR(CR.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=function(t,e){return t.length>=e.length&&t.substring(t.length-e.length)===e}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)};var DR,xR,LR={STATE_CHANGED:"state_changed"},MR="running",UR="pausing",FR="paused",jR="success",qR="canceling",VR="canceled",BR="error",WR={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function HR(t){switch(t){case MR:case UR:case qR:return WR.RUNNING;case FR:return WR.PAUSED;case jR:return WR.SUCCESS;case VR:return WR.CANCELED;case BR:default:return WR.ERROR}}function GR(t){return null!=t}function KR(t){return void 0!==t}function zR(t){return"function"==typeof t}function QR(t){return"object"==typeof t}function YR(t){return"string"==typeof t||t instanceof String}function XR(t){return"number"==typeof t||t instanceof Number}function JR(t){return $R()&&t instanceof Blob}function $R(){return"undefined"!=typeof Blob}(xR=DR=DR||{})[xR.NO_ERROR=0]="NO_ERROR",xR[xR.NETWORK_ERROR=1]="NETWORK_ERROR",xR[xR.ABORT=2]="ABORT";var ZR=(tO.prototype.send=function(t,e,n,r){if(this.sent_)throw SR("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),GR(r))for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return GR(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},tO.prototype.getErrorCode=function(){if(!this.sent_)throw SR("cannot .getErrorCode() before sending");return this.errorCode_},tO.prototype.getStatus=function(){if(!this.sent_)throw SR("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},tO.prototype.getResponseText=function(){if(!this.sent_)throw SR("cannot .getResponseText() before sending");return this.xhr_.responseText},tO.prototype.abort=function(){this.xhr_.abort()},tO.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},tO.prototype.addUploadProgressListener=function(t){GR(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},tO.prototype.removeUploadProgressListener=function(t){GR(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},tO);function tO(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=DR.NO_ERROR,this.sendPromise_=new Promise(function(t){e.xhr_.addEventListener("abort",function(){e.errorCode_=DR.ABORT,t(e)}),e.xhr_.addEventListener("error",function(){e.errorCode_=DR.NETWORK_ERROR,t(e)}),e.xhr_.addEventListener("load",function(){t(e)})})}var eO=(nO.prototype.createXhrIo=function(){return new ZR},nO);function nO(){}function rO(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if($R())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}var iO=(oO.prototype.size=function(){return this.size_},oO.prototype.type=function(){return this.type_},oO.prototype.slice=function(t,e){if(JR(this.data_)){var n=function(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}(this.data_,t,e);return null===n?null:new oO(n)}return new oO(new Uint8Array(this.data_.buffer,t,e-t),!0)},oO.getBlob=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if($R()){var n=t.map(function(t){return t instanceof oO?t.data_:t});return new oO(rO.apply(null,n))}var r=t.map(function(t){return YR(t)?kR(CR.RAW,t).data:t.data_}),i=0;r.forEach(function(t){i+=t.byteLength});var o=new Uint8Array(i),s=0;return r.forEach(function(t){for(var e=0;e<t.length;e++)o[s++]=t[e]}),new oO(o,!0)},oO.prototype.uploadData=function(){return this.data_},oO);function oO(t,e){var n=0,r="";JR(t)?(n=(this.data_=t).size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}var sO=(Object.defineProperty(aO.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),Object.defineProperty(aO.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!0,configurable:!0}),aO.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},aO.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},aO.makeFromBucketSpec=function(e){var t;try{t=aO.makeFromUrl(e)}catch(t){return new aO(e,"")}if(""===t.path)return t;throw function(t){return new vR(gR.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}(e)},aO.makeFromUrl=function(t){for(var e=null,n="([A-Za-z0-9.\\-_]+)",r=new RegExp("^gs://"+n+"(/(.*))?$","i"),i=pR.replace(/[.]/g,"\\."),o=[{regex:r,indices:{bucket:1,path:3},postModify:function(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+i+"/v[A-Za-z0-9_]+/b/"+n+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:function(t){t.path_=decodeURIComponent(t.path)}}],s=0;s<o.length;s++){var a=o[s],u=a.regex.exec(t);if(u){var c=u[a.indices.bucket],h=u[a.indices.path];e=new aO(c,h=h||""),a.postModify(e);break}}if(null==e)throw function(t){return new vR(gR.INVALID_URL,"Invalid URL '"+t+"'.")}(t);return e},aO);function aO(t,e){this.bucket=t,this.path_=e}function uO(t){var e;try{e=JSON.parse(t)}catch(t){return null}return function(t){return QR(t)&&!Array.isArray(t)}(e)?e:null}function cO(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function hO(t){return"https://"+pR+"/v0"+t}function lO(t){var e=encodeURIComponent,n="?";for(var r in t){if(t.hasOwnProperty(r))n=n+(e(r)+"="+e(t[r]))+"&"}return n=n.slice(0,-1)}function fO(t,e){return e}var pO=function(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||fO},dO=null;function vO(){if(dO)return dO;var t=[];t.push(new pO("bucket")),t.push(new pO("generation")),t.push(new pO("metageneration")),t.push(new pO("name","fullPath",!0));var e=new pO("name");e.xform=function(t,e){return function(t){return!YR(t)||t.length<2?t:cO(t)}(e)},t.push(e);var n=new pO("size");return n.xform=function(t,e){return GR(e)?Number(e):e},t.push(n),t.push(new pO("timeCreated")),t.push(new pO("updated")),t.push(new pO("md5Hash",null,!0)),t.push(new pO("cacheControl",null,!0)),t.push(new pO("contentDisposition",null,!0)),t.push(new pO("contentEncoding",null,!0)),t.push(new pO("contentLanguage",null,!0)),t.push(new pO("contentType",null,!0)),t.push(new pO("metadata","customMetadata",!0)),dO=t}function yO(r,i){Object.defineProperty(r,"ref",{get:function(){var t=r.bucket,e=r.fullPath,n=new sO(t,e);return i.makeStorageReference(n)}})}function gO(t,e,n){var r=uO(e);return null===r?null:function(t,e,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var s=n[o];r[s.local]=s.xform(r,e[s.server])}return yO(r,t),r}(t,r,n)}function mO(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function wO(t){if(!QR(t)||!t)throw"Expected Metadata object.";for(var e in t)if(t.hasOwnProperty(e)){var n=t[e];if("customMetadata"===e){if(!QR(n))throw"Expected object for 'customMetadata' mapping."}else if(QR(r=n)&&null!==r)throw"Mapping for '"+e+"' cannot be an object."}var r}var bO="maxResults",_O=1e3,EO="pageToken",IO="prefixes",TO="items";function SO(t,e){var n={prefixes:[],items:[],nextPageToken:e.nextPageToken},r=t.bucket();if(null===r)throw new vR(gR.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+dR+"' property when initializing the app?");if(e[IO])for(var i=0,o=e[IO];i<o.length;i++){var s=o[i].replace(/\/$/,""),a=t.makeStorageReference(new sO(r,s));n.prefixes.push(a)}if(e[TO])for(var u=0,c=e[TO];u<c.length;u++){var h=c[u];a=t.makeStorageReference(new sO(r,h.name));n.items.push(a)}return n}function CO(t){if(!QR(t)||!t)throw"Expected ListOptions object.";for(var e in t)if(e===bO){if(!XR(n=t[bO])||!Number.isInteger(n)||t[bO]<=0)throw"Expected maxResults to be a positive number.";if(1e3<t[bO])throw"Expected maxResults to be less than or equal to "+_O+"."}else{if(e!==EO)throw"Unknown option: "+e;if(t[EO]&&!YR(t[EO]))throw"Expected pageToken to be string."}var n}var NO=function(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function AO(t){if(!t)throw wR()}function kO(r,i){return function(t,e){var n=gO(r,e,i);return AO(null!==n),n}}function RO(r){return function(t,e){var n=function(t,e){var n=uO(e);return null===n?null:SO(t,n)}(r,e);return AO(null!==n),n}}function OO(r,i){return function(t,e){var n=gO(r,e,i);return AO(null!==n),function(r,t){var e=uO(t);if(null===e)return null;if(!YR(e.downloadTokens))return null;var n=e.downloadTokens;if(0===n.length)return null;var i=encodeURIComponent;return n.split(",").map(function(t){var e=r.bucket,n=r.fullPath;return hO("/b/"+i(e)+"/o/"+i(n))+lO({alt:"media",token:t})})[0]}(n,e)}}function PO(r){return function(t,e){var n;return(n=401===t.getStatus()?new vR(gR.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?function(t){return new vR(gR.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}(r.bucket):403===t.getStatus()?function(t){return new vR(gR.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}(r.path):e).setServerResponseProp(e.serverResponseProp()),n}}function DO(r){var i=PO(r);return function(t,e){var n=i(t,e);return 404===t.getStatus()&&(n=function(t){return new vR(gR.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}(r.path)),n.setServerResponseProp(e.serverResponseProp()),n}}function xO(t,e,n){var r=hO(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new NO(r,"GET",kO(t,n),i);return o.errorHandler=DO(e),o}function LO(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=function(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}(null,e)),r}function MO(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s={"X-Goog-Upload-Protocol":"multipart"};var a=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();s["Content-Type"]="multipart/related; boundary="+a;var u=LO(e,r,i),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+mO(u,n)+"\r\n--"+a+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+a+"--",l=iO.getBlob(c,r,h);if(null===l)throw _R();var f={name:u.fullPath},p=hO(o),d=t.maxUploadRetryTime(),v=new NO(p,"POST",kO(t,n),d);return v.urlParams=f,v.headers=s,v.body=l.uploadData(),v.errorHandler=PO(e),v}var UO=function(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null};function FO(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){AO(!1)}return AO(!!n&&-1!==(e||["active"]).indexOf(n)),n}function jO(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),s=LO(e,r,i),a={name:s.fullPath},u=hO(o),c={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},h=mO(s,n),l=t.maxUploadRetryTime();var f=new NO(u,"POST",function(t){var e;FO(t);try{e=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){AO(!1)}return AO(YR(e)),e},l);return f.urlParams=a,f.headers=c,f.body=h,f.errorHandler=PO(e),f}function qO(t,e,n,i){var r=t.maxUploadRetryTime(),o=new NO(n,"POST",function(t){var e=FO(t,["active","final"]),n=null;try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){AO(!1)}n||AO(!1);var r=Number(n);return AO(!isNaN(r)),new UO(r,i.size(),"final"===e)},r);return o.headers={"X-Goog-Upload-Command":"query"},o.errorHandler=PO(e),o}function VO(t,s,e,a,n,u,r,i){var c=new UO(0,0);if(r?(c.current=r.current,c.total=r.total):(c.current=0,c.total=a.size()),a.size()!==c.total)throw new vR(gR.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");var o=c.total-c.current,h=o;0<n&&(h=Math.min(h,n));var l=c.current,f=l+h,p={"X-Goog-Upload-Command":h===o?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},d=a.slice(l,f);if(null===d)throw _R();var v=s.maxUploadRetryTime(),y=new NO(e,"POST",function(t,e){var n,r=FO(t,["active","final"]),i=c.current+h,o=a.size();return n="final"===r?kO(s,u)(t,e):null,new UO(i,o,"final"===r,n)},v);return y.headers=p,y.body=d.uploadData(),y.progressCallback=i||null,y.errorHandler=PO(t),y}var BO=function(t,e,n){if(zR(t)||GR(e)||GR(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}},WO=function(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o};function HO(e,t,n){for(var r=t.length,i=t.length,o=0;o<t.length;o++)if(t[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw function(t,e,n,r){var i,o;return o=t===e?1===(i=t)?"argument":"arguments":(i="between "+t+" and "+e,"arguments"),new vR(gR.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}(r,i,e,n.length);for(o=0;o<n.length;o++)try{t[o].validator(n[o])}catch(t){throw t instanceof Error?ER(o,e,t.message):ER(o,e,t)}}var GO=function(e,t){var n=this;this.validator=function(t){n.optional&&!KR(t)||e(t)},this.optional=!!t};function KO(t,e){function n(t){if(!YR(t))throw"Expected string."}var r;return r=t?function(e,n){return function(t){e(t),n(t)}}(n,t):n,new GO(r,e)}function zO(){return new GO(function(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||$R()&&t instanceof Blob))throw"Expected Blob or File."})}function QO(t){return new GO(wO,t)}function YO(){return new GO(function(t){if(!(XR(t)&&0<=t))throw"Expected a number 0 or greater."})}function XO(e,t){return new GO(function(t){if(!(null===t||GR(t)&&t instanceof Object))throw"Expected an Object.";null!=e&&e(t)},t)}function JO(t){return new GO(function(t){if(!(null===t||zR(t)))throw"Expected a Function."},t)}function $O(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];Promise.resolve().then(function(){return n.apply(void 0,t)})}}var ZO=(tP.prototype.makeProgressCallback_=function(){var e=this,n=this.transferred_;return function(t){return e.updateProgress_(n+t)}},tP.prototype.shouldDoResumable_=function(t){return 262144<t.size()},tP.prototype.start_=function(){this.state_===MR&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},tP.prototype.resolveToken_=function(e){var n=this;this.authWrapper_.getAuthToken().then(function(t){switch(n.state_){case MR:e(t);break;case qR:n.transition_(VR);break;case UR:n.transition_(FR)}})},tP.prototype.createResumable_=function(){var r=this;this.resolveToken_(function(t){var e=jO(r.authWrapper_,r.location_,r.mappings_,r.blob_,r.metadata_),n=r.authWrapper_.makeRequest(e,t);(r.request_=n).getPromise().then(function(t){r.request_=null,r.uploadUrl_=t,r.needToFetchStatus_=!1,r.completeTransitions_()},r.errorHandler_)})},tP.prototype.fetchStatus_=function(){var r=this,i=this.uploadUrl_;this.resolveToken_(function(t){var e=qO(r.authWrapper_,r.location_,i,r.blob_),n=r.authWrapper_.makeRequest(e,t);(r.request_=n).getPromise().then(function(t){t=t,r.request_=null,r.updateProgress_(t.current),r.needToFetchStatus_=!1,t.finalized&&(r.needToFetchMetadata_=!0),r.completeTransitions_()},r.errorHandler_)})},tP.prototype.continueUpload_=function(){var r=this,i=262144*this.chunkMultiplier_,o=new UO(this.transferred_,this.blob_.size()),s=this.uploadUrl_;this.resolveToken_(function(t){var e;try{e=VO(r.location_,r.authWrapper_,s,r.blob_,i,r.mappings_,o,r.makeProgressCallback_())}catch(t){return r.error_=t,void r.transition_(BR)}var n=r.authWrapper_.makeRequest(e,t);(r.request_=n).getPromise().then(function(t){r.increaseMultiplier_(),r.request_=null,r.updateProgress_(t.current),t.finalized?(r.metadata_=t.metadata,r.transition_(jR)):r.completeTransitions_()},r.errorHandler_)})},tP.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},tP.prototype.fetchMetadata_=function(){var r=this;this.resolveToken_(function(t){var e=xO(r.authWrapper_,r.location_,r.mappings_),n=r.authWrapper_.makeRequest(e,t);(r.request_=n).getPromise().then(function(t){r.request_=null,r.metadata_=t,r.transition_(jR)},r.metadataErrorHandler_)})},tP.prototype.oneShotUpload_=function(){var r=this;this.resolveToken_(function(t){var e=MO(r.authWrapper_,r.location_,r.mappings_,r.blob_,r.metadata_),n=r.authWrapper_.makeRequest(e,t);(r.request_=n).getPromise().then(function(t){r.request_=null,r.metadata_=t,r.updateProgress_(r.blob_.size()),r.transition_(jR)},r.errorHandler_)})},tP.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},tP.prototype.transition_=function(t){if(this.state_!==t)switch(t){case qR:case UR:this.state_=t,null!==this.request_&&this.request_.cancel();break;case MR:var e=this.state_===FR;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case FR:this.state_=t,this.notifyObservers_();break;case VR:this.error_=bR(),this.state_=t,this.notifyObservers_();break;case BR:case jR:this.state_=t,this.notifyObservers_()}},tP.prototype.completeTransitions_=function(){switch(this.state_){case UR:this.transition_(FR);break;case qR:this.transition_(VR);break;case MR:this.start_()}},Object.defineProperty(tP.prototype,"snapshot",{get:function(){var t=HR(this.state_);return new WO(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),tP.prototype.on=function(t,e,n,o){var r="Expected a function or an Object with one of `next`, `error`, `complete` properties.",i=JO(!0).validator,s=XO(null,!0).validator;function a(t){try{return void i(t)}catch(t){}try{if(s(t),!(KR(t.next)||KR(t.error)||KR(t.complete)))throw"";return}catch(t){throw r}}HO("on",[KO(function(){if(t!==LR.STATE_CHANGED)throw"Expected one of the event types: ["+LR.STATE_CHANGED+"]."}),XO(a,!0),JO(!0),JO(!0)],arguments);var u=this;function c(i){return function(t,e,n){null!==i&&HO("on",i,arguments);var r=new BO(t,e,o);return u.addObserver_(r),function(){u.removeObserver_(r)}}}var h=[XO(function(t){if(null===t)throw r;a(t)}),JO(!0),JO(!0)];return KR(e)||KR(n)||KR(o)?c(null)(e,n,o):c(h)},tP.prototype.then=function(t,e){return this.promise_.then(t,e)},tP.prototype.catch=function(t){return this.then(null,t)},tP.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},tP.prototype.removeObserver_=function(t){var e=this.observers_.indexOf(t);-1!==e&&this.observers_.splice(e,1)},tP.prototype.notifyObservers_=function(){var e=this;this.finishPromise_(),this.observers_.slice().forEach(function(t){e.notifyObserver_(t)})},tP.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(HR(this.state_)){case WR.SUCCESS:$O(this.resolve_.bind(null,this.snapshot))();break;case WR.CANCELED:case WR.ERROR:$O(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},tP.prototype.notifyObserver_=function(t){switch(HR(this.state_)){case WR.RUNNING:case WR.PAUSED:t.next&&$O(t.next.bind(t,this.snapshot))();break;case WR.SUCCESS:t.complete&&$O(t.complete.bind(t))();break;case WR.CANCELED:case WR.ERROR:t.error&&$O(t.error.bind(t,this.error_))();break;default:t.error&&$O(t.error.bind(t,this.error_))()}},tP.prototype.resume=function(){HO("resume",[],arguments);var t=this.state_===FR||this.state_===UR;return t&&this.transition_(MR),t},tP.prototype.pause=function(){HO("pause",[],arguments);var t=this.state_===MR;return t&&this.transition_(UR),t},tP.prototype.cancel=function(){HO("cancel",[],arguments);var t=this.state_===MR||this.state_===UR;return t&&this.transition_(qR),t},tP);function tP(t,e,n,r,i,o){var s=this;void 0===o&&(o=null),this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=MR,this.errorHandler_=function(t){s.request_=null,s.chunkMultiplier_=1,t.codeEquals(gR.CANCELED)?(s.needToFetchStatus_=!0,s.completeTransitions_()):(s.error_=t,s.transition_(BR))},this.metadataErrorHandler_=function(t){s.request_=null,t.codeEquals(gR.CANCELED)?s.completeTransitions_():(s.error_=t,s.transition_(BR))},this.promise_=new Promise(function(t,e){s.resolve_=t,s.reject_=e,s.start_()}),this.promise_.then(null,function(){})}var eP=(nP.prototype.toString=function(){return HO("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},nP.prototype.newRef=function(t,e){return new nP(t,e)},nP.prototype.mappings=function(){return vO()},nP.prototype.child=function(t){HO("child",[KO()],arguments);var e=function(t,e){var n=e.split("/").filter(function(t){return 0<t.length}).join("/");return 0===t.length?n:t+"/"+n}(this.location.path,t),n=new sO(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(nP.prototype,"parent",{get:function(){var t=function(t){if(0===t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}(this.location.path);if(null===t)return null;var e=new sO(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(nP.prototype,"root",{get:function(){var t=new sO(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(nP.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(nP.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(nP.prototype,"name",{get:function(){return cO(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(nP.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),nP.prototype.put=function(t,e){return void 0===e&&(e=null),HO("put",[zO(),QO(!0)],arguments),this.throwIfRoot_("put"),new ZO(this,this.authWrapper,this.location,this.mappings(),new iO(t),e)},nP.prototype.putString=function(t,e,n){void 0===e&&(e=CR.RAW),HO("putString",[KO(),KO(NR,!0),QO(!0)],arguments),this.throwIfRoot_("putString");var r=kR(e,t),i=Object.assign({},n);return!GR(i.contentType)&&GR(r.contentType)&&(i.contentType=r.contentType),new ZO(this,this.authWrapper,this.location,this.mappings(),new iO(r.data,!0),i)},nP.prototype.delete=function(){var n=this;return HO("delete",[],arguments),this.throwIfRoot_("delete"),this.authWrapper.getAuthToken().then(function(t){var e=function(t,e){var n=hO(e.fullServerUrl()),r=t.maxOperationRetryTime(),i=new NO(n,"DELETE",function(t,e){},r);return i.successCodes=[200,204],i.errorHandler=DO(e),i}(n.authWrapper,n.location);return n.authWrapper.makeRequest(e,t).getPromise()})},nP.prototype.listAll=function(){HO("listAll",[],arguments);var t={prefixes:[],items:[]};return this.listAllHelper(t).then(function(){return t})},nP.prototype.listAllHelper=function(o,s){return Is(this,void 0,void 0,function(){var e,n,r,i;return Ts(this,function(t){switch(t.label){case 0:return e={pageToken:s},[4,this.list(e)];case 1:return n=t.sent(),(r=o.prefixes).push.apply(r,n.prefixes),(i=o.items).push.apply(i,n.items),null==n.nextPageToken?[3,3]:[4,this.listAllHelper(o,n.nextPageToken)];case 2:t.sent(),t.label=3;case 3:return[2]}})})},nP.prototype.list=function(r){HO("list",[function(t){return new GO(CO,t)}(!0)],arguments);var i=this;return this.authWrapper.getAuthToken().then(function(t){var e=r||{},n=function(t,e,n,r,i){var o={};e.isRoot?o.prefix="":o.prefix=e.path+"/",n&&0<n.length&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var s=hO(e.bucketOnlyServerUrl()),a=t.maxOperationRetryTime(),u=new NO(s,"GET",RO(t),a);return u.urlParams=o,u.errorHandler=PO(e),u}(i.authWrapper,i.location,"/",e.pageToken,e.maxResults);return i.authWrapper.makeRequest(n,t).getPromise()})},nP.prototype.getMetadata=function(){var n=this;return HO("getMetadata",[],arguments),this.throwIfRoot_("getMetadata"),this.authWrapper.getAuthToken().then(function(t){var e=xO(n.authWrapper,n.location,n.mappings());return n.authWrapper.makeRequest(e,t).getPromise()})},nP.prototype.updateMetadata=function(n){var r=this;return HO("updateMetadata",[QO()],arguments),this.throwIfRoot_("updateMetadata"),this.authWrapper.getAuthToken().then(function(t){var e=function(t,e,n,r){var i=hO(e.fullServerUrl()),o=mO(n,r),s=t.maxOperationRetryTime(),a=new NO(i,"PATCH",kO(t,r),s);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=o,a.errorHandler=DO(e),a}(r.authWrapper,r.location,n,r.mappings());return r.authWrapper.makeRequest(e,t).getPromise()})},nP.prototype.getDownloadURL=function(){var n=this;return HO("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.authWrapper.getAuthToken().then(function(t){var e=function(t,e,n){var r=hO(e.fullServerUrl()),i=t.maxOperationRetryTime(),o=new NO(r,"GET",OO(t,n),i);return o.errorHandler=DO(e),o}(n.authWrapper,n.location,n.mappings());return n.authWrapper.makeRequest(e,t).getPromise().then(function(t){if(null===t)throw new vR(gR.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return t})})},nP.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw function(t){return new vR(gR.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(t)},nP);function nP(t,e){this.authWrapper=t,this.location=e instanceof sO?e:sO.makeFromUrl(e)}var rP=(iP.prototype.getPromise=function(){return this.promise_},iP.prototype.cancel=function(t){},iP);function iP(t){this.promise_=Promise.reject(t)}var oP=(sP.prototype.addRequest=function(t){var e=this,n=this.id;this.id++,this.map.set(n,t),t.getPromise().then(function(){return e.map.delete(n)},function(){return e.map.delete(n)})},sP.prototype.clear=function(){this.map.forEach(function(t){t&&t.cancel(!0)}),this.map.clear()},sP);function sP(){this.map=new Map,this.id=-9007199254740991}var aP=(uP.extractBucket_=function(t){var e=t[dR]||null;return null==e?null:sO.makeFromBucketSpec(e).bucket},uP.prototype.getAuthToken=function(){var t=this.authProvider_.getImmediate({optional:!0});return t?t.getToken().then(function(t){return null!==t?t.accessToken:null},function(){return null}):Promise.resolve(null)},uP.prototype.bucket=function(){if(this.deleted_)throw IR();return this.bucket_},uP.prototype.service=function(){return this.service_},uP.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},uP.prototype.makeRequest=function(t,e){if(this.deleted_)return new rP(IR());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},uP.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},uP.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},uP.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},uP.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},uP.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},uP);function uP(t,e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=t,null!==this.app_){var s=this.app_.options;GR(s)&&(this.bucket_=uP.extractBucket_(s))}this.authProvider_=e,this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=12e4,this.maxUploadRetryTime_=6e5,this.requestMap_=new oP}var cP=(hP.prototype.start_=function(){var a=this;function t(t,e){var n,r=a.resolve_,i=a.reject_,o=e.xhr;if(e.wasSuccessCode)try{var s=a.callback_(o,o.getResponseText());KR(s)?r(s):r()}catch(t){i(t)}else null!==o?((n=wR()).setServerResponseProp(o.getResponseText()),a.errorCallback_?i(a.errorCallback_(o,n)):i(n)):e.canceled?i(n=a.appDelete_?IR():bR()):i(n=new vR(gR.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again."))}this.canceled_?t(0,new lP(!1,null,!0)):this.backoffId_=function(e,n,t){var r=1,i=null,o=!1,s=0;function a(){return 2===s}var u=!1;function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];u||(u=!0,n.apply(null,t))}function h(t){i=setTimeout(function(){i=null,e(l,a())},t)}function l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];u||(t?c.call.apply(c,As([null,t],e)):a()||o?c.call.apply(c,As([null,t],e)):(r<64&&(r*=2),h(1===s?(s=2,0):1e3*(r+Math.random()))))}var f=!1;function p(t){f||(f=!0,u||(null!==i?(t||(s=2),clearTimeout(i),h(0)):t||(s=1)))}return h(0),setTimeout(function(){p(o=!0)},t),p}(function(o,t){if(t)o(!1,new lP(!1,null,!0));else{var e=a.pool_.createXhrIo();a.pendingXhr_=e,null!==a.progressCallback_&&e.addUploadProgressListener(s),e.send(a.url_,a.method_,a.body_,a.headers_).then(function(t){null!==a.progressCallback_&&t.removeUploadProgressListener(s),a.pendingXhr_=null;var e=(t=t).getErrorCode()===DR.NO_ERROR,n=t.getStatus();if(e&&!a.isRetryStatusCode_(n)){var r=-1!==a.successCodes_.indexOf(n);o(!0,new lP(r,t))}else{var i=t.getErrorCode()===DR.ABORT;o(!1,new lP(!1,null,i))}})}function s(t){var e=t.loaded,n=t.lengthComputable?t.total:-1;null!==a.progressCallback_&&a.progressCallback_(e,n)}},t,this.timeout_)},hP.prototype.getPromise=function(){return this.promise_},hP.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&function(t){t(!1)}(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},hP.prototype.isRetryStatusCode_=function(t){var e=500<=t&&t<600,n=-1!==[408,429].indexOf(t),r=-1!==this.additionalRetryCodes_.indexOf(t);return e||n||r},hP);function hP(t,e,n,r,i,o,s,a,u,c,h){var l=this;this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=s,this.errorCallback_=a,this.progressCallback_=c,this.timeout_=u,this.pool_=h,this.promise_=new Promise(function(t,e){l.resolve_=t,l.reject_=e,l.start_()})}var lP=function(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n};function fP(t,e,n){var r=lO(t.urlParams),i=t.url+r,o=Object.assign({},t.headers);return function(t,e){null!==e&&0<e.length&&(t.Authorization="Firebase "+e)}(o,e),function(t){var e=void 0!==fl?fl.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}(o),new cP(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}var pP=(dP.prototype.ref=function(t){if(HO("ref",[KO(function(t){if("string"!=typeof t)throw"Path is not a string.";if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."},!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var e=new eP(this.authWrapper_,this.bucket_);return null!=t?e.child(t):e},dP.prototype.refFromURL=function(t){return HO("refFromURL",[KO(function(t){if("string"!=typeof t)throw"Path is not a string.";if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{sO.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}},!1)],arguments),new eP(this.authWrapper_,t)},Object.defineProperty(dP.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),dP.prototype.setMaxUploadRetryTime=function(t){HO("setMaxUploadRetryTime",[YO()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},dP.prototype.setMaxOperationRetryTime=function(t){HO("setMaxOperationRetryTime",[YO()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(dP.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(dP.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),dP);function dP(t,e,n,r){if(this.bucket_=null,this.authWrapper_=new aP(t,e,function(t,e){return new eP(t,e)},fP,this,n),this.app_=t,null!=r)this.bucket_=sO.makeFromBucketSpec(r);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new sO(i,""))}this.internals_=new vP(this)}var vP=(yP.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),Promise.resolve()},yP);function yP(t){this.service_=t}var gP,mP;function wP(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal");return new pP(n,r,new eO,e)}mP={TaskState:WR,TaskEvent:LR,StringFormat:CR,Storage:pP,Reference:eP},(gP=fl).INTERNAL.registerComponent(new pa("storage",wP,"PUBLIC").setServiceProps(mP).setMultipleInstances(!0)),gP.registerVersion("@firebase/storage","0.3.26");var bP,_P,EP,IP,TP="0.2.32",SP="FB-PERF-TRACE-MEASURE",CP="@firebase/performance/config",NP="@firebase/performance/configexpire",AP="Performance",kP=((bP={})["trace started"]="Trace {$traceName} was started before.",bP["trace stopped"]="Trace {$traceName} is not running.",bP["no window"]="Window is not available.",bP["no app id"]="App id is not available.",bP["no project id"]="Project id is not available.",bP["no api key"]="Api key is not available.",bP["invalid cc log"]="Attempted to queue invalid cc event",bP["FB not default"]="Performance can only start when Firebase app instance is the default one.",bP["RC response not ok"]="RC response is not ok",bP["invalid attribute name"]="Attribute name {$attributeName} is invalid.",bP["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",bP["invalide custom metric name"]="Custom metric name {$customMetricName} is invalid",bP),RP=new Ks("performance",AP,kP),OP=(PP.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},PP.prototype.mark=function(t){this.performance&&this.performance.mark&&this.performance.mark(t)},PP.prototype.measure=function(t,e,n){this.performance&&this.performance.measure&&this.performance.measure(t,e,n)},PP.prototype.getEntriesByType=function(t){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(t):[]},PP.prototype.getEntriesByName=function(t){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(t):[]},PP.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},PP.prototype.requiredApisAvailable=function(){return!!(fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled)},PP.prototype.setupObserver=function(t,i){this.PerformanceObserver&&new this.PerformanceObserver(function(t){for(var e=0,n=t.getEntries();e<n.length;e++){var r=n[e];i(r)}}).observe({entryTypes:[t]})},PP.getInstance=function(){return void 0===_P&&(_P=new PP(EP)),_P},PP);function PP(t){if(!(this.window=t))throw RP.create("no window");this.performance=t.performance,this.PerformanceObserver=t.PerformanceObserver,this.windowLocation=t.location,this.navigator=t.navigator,this.document=t.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=t.localStorage),t.perfMetrics&&t.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=t.perfMetrics.onFirstInputDelay)}var DP,xP,LP,MP=(UP.prototype.getAppId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!t)throw RP.create("no app id");return t},UP.prototype.getProjectId=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!t)throw RP.create("no project id");return t},UP.prototype.getApiKey=function(){var t=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!t)throw RP.create("no api key");return t},UP.getInstance=function(){return void 0===IP&&(IP=new UP),IP},UP);function UP(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}function FP(){return DP}(LP=xP=xP||{})[LP.UNKNOWN=0]="UNKNOWN",LP[LP.VISIBLE=1]="VISIBLE",LP[LP.HIDDEN=2]="HIDDEN";var jP=["firebase_","google_","ga_"],qP=new RegExp("^[a-zA-Z]\\w*$");function VP(){switch(OP.getInstance().document.visibilityState){case"visible":return xP.VISIBLE;case"hidden":return xP.HIDDEN;default:return xP.UNKNOWN}}var BP=new Ca(AP);BP.logLevel=ma.INFO;var WP="0.0.1",HP={loggingEnabled:!0},GP="FIREBASE_INSTALLATIONS_AUTH";function KP(t){var e=function(){var t=OP.getInstance().localStorage;if(!t)return;var e=t.getItem(NP);if(!e||!function(t){return Number(t)>Date.now()}(e))return;var n=t.getItem(CP);if(!n)return;try{return JSON.parse(n)}catch(t){return}}();return e?(QP(e),Promise.resolve()):function(r){return function(){var t=MP.getInstance().installationsService.getToken();return t.then(function(t){}),t}().then(function(t){var e="https://firebaseremoteconfig.googleapis.com/v1/projects/"+MP.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+MP.getInstance().getApiKey(),n=new Request(e,{method:"POST",headers:{Authorization:GP+" "+t},body:JSON.stringify({app_instance_id:r,app_instance_id_token:t,app_id:MP.getInstance().getAppId(),app_version:TP,sdk_version:WP})});return fetch(n).then(function(t){if(t.ok)return t.json();throw RP.create("RC response not ok")})}).catch(function(){BP.info(zP)})}(t).then(function(t){return QP(t)}).then(function(t){return function(t){var e=OP.getInstance().localStorage;if(!t||!e)return;e.setItem(CP,JSON.stringify(t)),e.setItem(NP,String(Date.now()+60*MP.getInstance().configTimeToLive*60*1e3))}(t)},function(){})}var zP="Could not fetch config, will use default configs";function QP(t){if(!t)return t;var e=MP.getInstance(),n=t.entries||{};return void 0!==n.fpr_enabled?e.loggingEnabled="true"===String(n.fpr_enabled):e.loggingEnabled=HP.loggingEnabled,n.fpr_log_source&&(e.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(e.logEndPointUrl=n.fpr_log_endpoint_url),void 0!==n.fpr_vc_network_request_sampling_rate&&(e.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(e.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),e.logTraceAfterSampling=YP(e.tracesSamplingRate),e.logNetworkAfterSampling=YP(e.networkRequestsSamplingRate),t}function YP(t){return Math.random()<=t}var XP,JP=1;function $P(){return JP=2,XP=XP||function(){var n=OP.getInstance().document;return new Promise(function(t){if(n&&"complete"!==n.readyState){var e=function(){"complete"===n.readyState&&(n.removeEventListener("readystatechange",e),t())};n.addEventListener("readystatechange",e)}else t()})}().then(function(){return function(){var t=MP.getInstance().installationsService.getId();return t.then(function(t){DP=t}),t}()}).then(function(t){return KP(t)}).then(function(){return ZP()},function(){return ZP()})}function ZP(){JP=3}var tD,eD=1e4,nD=5500,rD=3,iD=rD,oD=[],sD=!1;function aD(){sD||(!function r(t){setTimeout(function(){if(0!==iD){if(!oD.length)return r(eD);var t=As(oD);oD=[];var e=t.map(function(t){return{source_extension_json_proto3:t.message,event_time_ms:String(t.eventTime)}}),n={request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:MP.getInstance().logSource,log_event:e};fetch(MP.getInstance().logEndPointUrl,{method:"POST",body:JSON.stringify(n)}).then(function(t){return t.ok||BP.info("Call to Firebase backend failed."),t.json()}).then(function(t){var e=Number(t.next_request_wait_millis),n=isNaN(e)?eD:Math.max(eD,e);iD=rD,r(n)}).catch(function(){oD=As(t,oD),iD--,BP.info("Tries left: "+iD+"."),r(eD)})}},t)}(nD),sD=!0)}function uD(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];!function(t){if(!t.eventTime||!t.message)throw RP.create("invalid cc log");oD=As(oD,[t])}({message:n.apply(void 0,t),eventTime:Date.now()})}}function cD(t,e){(tD=tD||uD(fD))(t,e)}function hD(t){var e=MP.getInstance();!e.instrumentationEnabled&&t.isAuto||(e.dataCollectionEnabled||t.isAuto)&&OP.getInstance().requiredApisAvailable()&&(t.isAuto&&VP()!==xP.VISIBLE||e.loggingEnabled&&e.logTraceAfterSampling&&(3===JP?lD(t):$P().then(function(){return lD(t)},function(){return lD(t)})))}function lD(t){FP()&&setTimeout(function(){return cD(t,1)},0)}function fD(t,e){return 0===e?function(t){var e={url:t.url,http_method:t.httpMethod||0,http_response_code:200,response_payload_bytes:t.responsePayloadBytes,client_start_time_us:t.startTimeUs,time_to_response_initiated_us:t.timeToResponseInitiatedUs,time_to_response_completed_us:t.timeToResponseCompletedUs},n={application_info:pD(),network_request_metric:e};return JSON.stringify(n)}(t):function(t){var e={name:t.name,is_auto:t.isAuto,client_start_time_us:t.startTimeUs,duration_us:t.durationUs};0!==Object.keys(t.counters).length&&(e.counters=t.counters);var n=t.getAttributes();0!==Object.keys(n).length&&(e.custom_attributes=n);var r={application_info:pD(),trace_metric:e};return JSON.stringify(r)}(t)}function pD(){return{google_app_id:MP.getInstance().getAppId(),app_instance_id:FP(),web_app_info:{sdk_version:TP,page_url:OP.getInstance().getUrl(),service_worker_status:function(){var t=OP.getInstance().navigator;return"serviceWorker"in t?t.serviceWorker.controller?2:3:1}(),visibility_state:VP(),effective_connection_type:function(){var t=OP.getInstance().navigator.connection;switch(t&&t.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}()},application_process_state:0}}var dD=["_fp","_fcp","_fid"];var vD=(yD.prototype.start=function(){if(1!==this.state)throw RP.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},yD.prototype.stop=function(){if(2!==this.state)throw RP.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),hD(this)},yD.prototype.record=function(t,e,n){if(this.durationUs=Math.floor(1e3*e),this.startTimeUs=Math.floor(1e3*t),n&&n.attributes&&(this.customAttributes=Es({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}hD(this)},yD.prototype.incrementMetric=function(t,e){void 0===e&&(e=1),void 0===this.counters[t]&&this.putMetric(t,0),this.counters[t]+=e},yD.prototype.putMetric=function(t,e){if(!function(t,e){return!(0===t.length||100<t.length)&&(e&&e.startsWith("_wt_")&&-1<dD.indexOf(t)||!t.startsWith("_"))}(t,this.name))throw RP.create("invalide custom metric name",{customMetricName:t});this.counters[t]=e},yD.prototype.getMetric=function(t){return this.counters[t]||0},yD.prototype.putAttribute=function(t,e){var n=function(e){return!(0===e.length||40<e.length||jP.some(function(t){return e.startsWith(t)})||!e.match(qP))}(t),r=function(t){return 0!==t.length&&t.length<=100}(e);if(n&&r)this.customAttributes[t]=e;else{if(!n)throw RP.create("invalid attribute name",{attributeName:t});if(!r)throw RP.create("invalid attribute value",{attributeValue:e})}},yD.prototype.getAttribute=function(t){return this.customAttributes[t]},yD.prototype.removeAttribute=function(t){void 0!==this.customAttributes[t]&&delete this.customAttributes[t]},yD.prototype.getAttributes=function(){return Es({},this.customAttributes)},yD.prototype.setStartTime=function(t){this.startTimeUs=t},yD.prototype.setDuration=function(t){this.durationUs=t},yD.prototype.calculateTraceMetrics=function(){var t=this.api.getEntriesByName(this.traceMeasure),e=t&&t[0];e&&(this.durationUs=Math.floor(1e3*e.duration),this.startTimeUs=Math.floor(1e3*(e.startTime+this.api.getTimeOrigin())))},yD.createOobTrace=function(t,e,n){var r=OP.getInstance().getUrl();if(r){var i=new yD("_wt_"+r,!0),o=Math.floor(1e3*OP.getInstance().getTimeOrigin());if(i.setStartTime(o),t&&t[0]&&(i.setDuration(Math.floor(1e3*t[0].duration)),i.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),i.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),i.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd))),e){var s=e.find(function(t){return"first-paint"===t.name});s&&s.startTime&&i.putMetric("_fp",Math.floor(1e3*s.startTime));var a=e.find(function(t){return"first-contentful-paint"===t.name});a&&a.startTime&&i.putMetric("_fcp",Math.floor(1e3*a.startTime)),n&&i.putMetric("_fid",Math.floor(1e3*n))}hD(i)}},yD.createUserTimingTrace=function(t){hD(new yD(t,!1,t))},yD);function yD(t,e,n){void 0===e&&(e=!1),this.name=t,this.isAuto=e,this.state=1,this.customAttributes={},this.counters={},this.api=OP.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||SP+"-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}function gD(t){var e=t;if(e&&void 0!==e.responseStart){var n=OP.getInstance().getTimeOrigin(),r=Math.floor(1e3*(e.startTime+n)),i=e.responseStart?Math.floor(1e3*(e.responseStart-e.startTime)):void 0,o=Math.floor(1e3*(e.responseEnd-e.startTime));!function(t){var e=MP.getInstance();e.instrumentationEnabled&&t.url!==e.logEndPointUrl.split("?")[0]&&e.loggingEnabled&&e.logNetworkAfterSampling&&setTimeout(function(){return cD(t,0)},0)}({url:e.name&&e.name.split("?")[0],responsePayloadBytes:e.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}var mD=5e3;function wD(){FP()&&(setTimeout(function(){return function(){var t=OP.getInstance(),e=t.getEntriesByType("navigation"),n=t.getEntriesByType("paint");if(t.onFirstInputDelay){var r=setTimeout(function(){vD.createOobTrace(e,n),r=void 0},mD);t.onFirstInputDelay(function(t){r&&(clearTimeout(r),vD.createOobTrace(e,n,t))})}else vD.createOobTrace(e,n)}()},0),setTimeout(function(){return function(){for(var t=OP.getInstance(),e=t.getEntriesByType("resource"),n=0,r=e;n<r.length;n++){gD(r[n])}t.setupObserver("resource",gD)}()},0),setTimeout(function(){return function(){for(var t=OP.getInstance(),e=t.getEntriesByType("measure"),n=0,r=e;n<r.length;n++){bD(r[n])}t.setupObserver("measure",bD)}()},0))}function bD(t){var e=t.name;e.substring(0,SP.length)!==SP&&vD.createUserTimingTrace(e)}var _D=(ED.prototype.trace=function(t){return new vD(t)},Object.defineProperty(ED.prototype,"instrumentationEnabled",{get:function(){return MP.getInstance().instrumentationEnabled},set:function(t){MP.getInstance().instrumentationEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(ED.prototype,"dataCollectionEnabled",{get:function(){return MP.getInstance().dataCollectionEnabled},set:function(t){MP.getInstance().dataCollectionEnabled=t},enumerable:!0,configurable:!0}),ED);function ED(t){this.app=t,OP.getInstance().requiredApisAvailable()?(aD(),$P().then(wD,wD)):BP.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled.")}var ID;function TD(t,e){if("[DEFAULT]"!==t.name)throw RP.create("FB not default");if("undefined"==typeof window)throw RP.create("no window");return function(t){EP=t}(window),MP.getInstance().firebaseAppInstance=t,MP.getInstance().installationsService=e,new _D(t)}(ID=fl).INTERNAL.registerComponent(new pa("performance",function(t){var e=t.getProvider("app").getImmediate(),n=t.getProvider("installations").getImmediate();return TD(e,n)},"PUBLIC")),ID.registerVersion("@firebase/performance","0.2.32");var SD,CD,ND,AD,kD,RD="measurementId",OD="firebase_id",PD="origin",DD="https://www.googletagmanager.com/gtag/js";function xD(t,n,e){var r=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window[n].push(arguments)};return window[e]&&"function"==typeof window[e]&&(r=window[e]),window[e]=function(f,p){return function(t,e,n){if(t===SD.EVENT){var r=[];if(n&&n.send_to){var i=n.send_to;Array.isArray(i)||(i=[i]);for(var o=0,s=i;o<s.length;o++){var a=s[o],u=p[a];if(!u){r=[];break}r.push(u)}}if(0===r.length)for(var c=0,h=Object.values(p);c<h.length;c++){var l=h[c];r.push(l)}Promise.all(r).then(function(){return f(SD.EVENT,e,n||{})}).catch(function(t){return console.error(t)})}else if(t===SD.CONFIG){(p[e]||Promise.resolve()).then(function(){f(SD.CONFIG,e,n)}).catch(function(t){return console.error(t)})}else f(SD.SET,e)}}(r,t),{gtagCore:r,wrappedGtag:window[e]}}(CD=SD=SD||{}).EVENT="event",CD.SET="set",CD.CONFIG="config",(AD=ND=ND||{}).ADD_PAYMENT_INFO="add_payment_info",AD.ADD_TO_CART="add_to_cart",AD.ADD_TO_WISHLIST="add_to_wishlist",AD.BEGIN_CHECKOUT="begin_checkout",AD.CHECKOUT_PROGRESS="checkout_progress",AD.EXCEPTION="exception",AD.GENERATE_LEAD="generate_lead",AD.LOGIN="login",AD.PAGE_VIEW="page_view",AD.PURCHASE="purchase",AD.REFUND="refund",AD.REMOVE_FROM_CART="remove_from_cart",AD.SCREEN_VIEW="screen_view",AD.SEARCH="search",AD.SELECT_CONTENT="select_content",AD.SET_CHECKOUT_OPTION="set_checkout_option",AD.SHARE="share",AD.SIGN_UP="sign_up",AD.TIMING_COMPLETE="timing_complete",AD.VIEW_ITEM="view_item",AD.VIEW_ITEM_LIST="view_item_list",AD.VIEW_PROMOTION="view_promotion",AD.VIEW_SEARCH_RESULTS="view_search_results";var LD,MD,UD=((kD={})["no-ga-id"]='"'+RD+'" field is empty in Firebase config. Firebase Analytics requires this field to contain a valid measurement ID.',kD["already-exists"]="A Firebase Analytics instance with the measurement ID ${id}  already exists. Only one Firebase Analytics instance can be created for each measurement ID.",kD["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",kD["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate",kD),FD=new Ks("analytics","Analytics",UD),jD={},qD="dataLayer",VD="gtag",BD=!1;function WD(t){if(BD)throw FD.create("already-initialized");t.dataLayerName&&(qD=t.dataLayerName),t.gtagName&&(VD=t.gtagName)}function HD(t,e){var r=t.options[RD];if(!r)throw FD.create("no-ga-id");if(null!=jD[r])throw FD.create("already-exists",{id:r});if(!BD){!function(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(DD))return r}return null}()&&function(t){var e=document.createElement("script");e.src=DD+"?l="+t,e.async=!0,document.head.appendChild(e)}(qD),function(t){var e=[];Array.isArray(window[t])?e=window[t]:window[t]=e}(qD);var n=xD(jD,qD,VD),i=n.wrappedGtag,o=n.gtagCore;MD=i,LD=o,BD=!0}return jD[r]=function(r,i,o){return Is(this,void 0,void 0,function(){var e,n;return Ts(this,function(t){switch(t.label){case 0:return[4,i.getId()];case 1:return e=t.sent(),o("js",new Date),o(SD.CONFIG,r.options[RD],((n={})[OD]=e,n[PD]="firebase",n.update=!0,n)),[2]}})})}(t,e,LD),{app:t,logEvent:function(t,e,n){return function(t,e,n,r,i){var o=r||{};i&&i.global||(o=Es(Es({},r),{send_to:e})),t(SD.EVENT,n,o||{})}(MD,r,t,e,n)},setCurrentScreen:function(t,e){return function(t,e,n,r){r&&r.global?t(SD.SET,{screen_name:n}):t(SD.CONFIG,e,{update:!0,screen_name:n})}(MD,r,t,e)},setUserId:function(t,e){return function(t,e,n,r){r&&r.global?t(SD.SET,{user_id:n}):t(SD.CONFIG,e,{update:!0,user_id:n})}(MD,r,t,e)},setUserProperties:function(t,e){return function(t,e,n,r){if(r&&r.global){for(var i={},o=0,s=Object.keys(n);o<s.length;o++){var a=s[o];i["user_properties."+a]=n[a]}t(SD.SET,i)}else t(SD.CONFIG,e,{update:!0,user_properties:n})}(MD,r,t,e)},setAnalyticsCollectionEnabled:function(t){return function(t,e){window["ga-disable-"+t]=!e}(r,t)}}}var GD,KD="analytics";(GD=fl).INTERNAL.registerComponent(new pa(KD,function(t){return HD(t.getProvider("app").getImmediate(),t.getProvider("installations").getImmediate())},"PUBLIC").setServiceProps({settings:WD,EventName:ND})),GD.INTERNAL.registerComponent(new pa("analytics-internal",function(t){try{return{logEvent:t.getProvider(KD).getImmediate().logEvent}}catch(t){throw FD.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),GD.registerVersion("@firebase/analytics","0.2.13");var zD,QD=(YD.prototype.isCachedDataFresh=function(t,e){if(!e)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-e,r=n<=t;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+t+". Is cache hit: "+r+"."),r},YD.prototype.fetch=function(s){return Is(this,void 0,void 0,function(){var e,n,r,i,o;return Ts(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return e=t.sent(),n=e[0],(r=e[1])&&this.isCachedDataFresh(s.cacheMaxAgeMillis,n)?[2,r]:(s.eTag=r&&r.eTag,[4,this.client.fetch(s)]);case 2:return i=t.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return t.sent(),[2,i]}})})},YD);function YD(t,e,n,r){this.client=t,this.storage=e,this.storageCache=n,this.logger=r}var XD=((zD={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",zD["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",zD["registration-api-key"]="Undefined API key. Check Firebase app initialization.",zD["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",zD["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",zD["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",zD["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",zD["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",zD["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",zD["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',zD["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',zD["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",zD["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",zD),JD=new Ks("remoteconfig","Remote Config",XD);var $D=(ZD.prototype.fetch=function(b){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s,a,u,c,h,l,f,p,d,v,y,g,m,w;return Ts(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:e=t.sent(),n=e[0],r=e[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,s={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":b.eTag||"*"},a={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:function(t){return void 0===t&&(t=navigator),t.languages&&t.languages[0]||t.language}()},u={method:"POST",headers:s,body:JSON.stringify(a)},c=fetch(o,u),h=new Promise(function(t,e){b.signal.addEventListener(function(){var t=new Error("The operation was aborted.");t.name="AbortError",e(t)})}),t.label=2;case 2:return t.trys.push([2,5,,6]),[4,Promise.race([c,h])];case 3:return t.sent(),[4,c];case 4:return l=t.sent(),[3,6];case 5:throw f=t.sent(),p="fetch-client-network","AbortError"===f.name&&(p="fetch-timeout"),JD.create(p,{originalErrorMessage:f.message});case 6:if(d=l.status,v=l.headers.get("ETag")||void 0,200!==l.status)return[3,11];m=void 0,t.label=7;case 7:return t.trys.push([7,9,,10]),[4,l.json()];case 8:return m=t.sent(),[3,10];case 9:throw w=t.sent(),JD.create("fetch-client-parse",{originalErrorMessage:w.message});case 10:y=m.entries,g=m.state,t.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===g?d=500:"NO_CHANGE"===g?d=304:"NO_TEMPLATE"!==g&&"EMPTY_CONFIG"!==g||(y={}),304!==d&&200!==d)throw JD.create("fetch-status",{httpStatus:d});return[2,{status:d,eTag:v,config:y}]}})})},ZD);function ZD(t,e,n,r,i,o){this.firebaseInstallations=t,this.sdkVersion=e,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}var tx=(ex.prototype.addEventListener=function(t){this.listeners.push(t)},ex.prototype.abort=function(){this.listeners.forEach(function(t){return t()})},ex);function ex(){this.listeners=[]}var nx=["1","true","t","yes","y","on"],rx=(ix.prototype.asString=function(){return this._value},ix.prototype.asBoolean=function(){return"static"!==this._source&&0<=nx.indexOf(this._value.toLowerCase())},ix.prototype.asNumber=function(){if("static"===this._source)return 0;var t=Number(this._value);return isNaN(t)&&(t=0),t},ix.prototype.getSource=function(){return this._source},ix);function ix(t,e){void 0===e&&(e=""),this._source=t,this._value=e}var ox=(sx.prototype.setLogLevel=function(t){switch(t){case"debug":this._logger.logLevel=ma.DEBUG;break;case"silent":this._logger.logLevel=ma.SILENT;break;default:this._logger.logLevel=ma.ERROR}},Object.defineProperty(sx.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!0,configurable:!0}),Object.defineProperty(sx.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!0,configurable:!0}),sx.prototype.activate=function(){return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return e=t.sent(),n=e[0],r=e[1],n&&n.config&&n.eTag&&n.eTag!==r?[4,Promise.all([this._storageCache.setActiveConfig(n.config),this._storage.setActiveConfigEtag(n.eTag)])]:[2,!1];case 2:return t.sent(),[2,!0]}})})},sx.prototype.ensureInitialized=function(){var t=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then(function(){t._isInitializationComplete=!0})),this._initializePromise},sx.prototype.fetch=function(){return Is(this,void 0,void 0,function(){var e,n,r,i=this;return Ts(this,function(t){switch(t.label){case 0:e=new tx,setTimeout(function(){return Is(i,void 0,void 0,function(){return Ts(this,function(t){return e.abort(),[2]})})},this.settings.fetchTimeoutMillis),t.label=1;case 1:return t.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:e})];case 2:return t.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return t.sent(),[3,6];case 4:return n=t.sent(),r=function(t,e){return t instanceof Hs&&-1!==t.code.indexOf(e)}(n,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(r)];case 5:throw t.sent(),n;case 6:return[2]}})})},sx.prototype.fetchAndActivate=function(){return Is(this,void 0,void 0,function(){return Ts(this,function(t){switch(t.label){case 0:return[4,this.fetch()];case 1:return t.sent(),[2,this.activate()]}})})},sx.prototype.getAll=function(){var n=this;return function(t,e){return void 0===t&&(t={}),void 0===e&&(e={}),Object.keys(Es(Es({},t),e))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce(function(t,e){return t[e]=n.getValue(e),t},{})},sx.prototype.getBoolean=function(t){return this.getValue(t).asBoolean()},sx.prototype.getNumber=function(t){return this.getValue(t).asNumber()},sx.prototype.getString=function(t){return this.getValue(t).asString()},sx.prototype.getValue=function(t){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+t+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var e=this._storageCache.getActiveConfig();return e&&void 0!==e[t]?new rx("remote",e[t]):this.defaultConfig&&void 0!==this.defaultConfig[t]?new rx("default",String(this.defaultConfig[t])):(this._logger.debug('Returning static value for key "'+t+'". Define a default or remote value if this is unintentional.'),new rx("static"))},sx);function sx(t,e,n,r,i){this.app=t,this._client=e,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}function ax(t,e){var n=t.target.error||void 0;return JD.create(e,{originalErrorMessage:n&&n.message})}var ux="app_namespace_store",cx="firebase_remote_config",hx=1;var lx=(fx.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},fx.prototype.setLastFetchStatus=function(t){return this.set("last_fetch_status",t)},fx.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},fx.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.set("last_successful_fetch_timestamp_millis",t)},fx.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},fx.prototype.setLastSuccessfulFetchResponse=function(t){return this.set("last_successful_fetch_response",t)},fx.prototype.getActiveConfig=function(){return this.get("active_config")},fx.prototype.setActiveConfig=function(t){return this.set("active_config",t)},fx.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},fx.prototype.setActiveConfigEtag=function(t){return this.set("active_config_etag",t)},fx.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},fx.prototype.setThrottleMetadata=function(t){return this.set("throttle_metadata",t)},fx.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},fx.prototype.get=function(a){return Is(this,void 0,void 0,function(){var o,s=this;return Ts(this,function(t){switch(t.label){case 0:return[4,this.openDbPromise];case 1:return o=t.sent(),[2,new Promise(function(n,e){var t=o.transaction([ux],"readonly").objectStore(ux),r=s.createCompositeKey(a);try{var i=t.get(r);i.onerror=function(t){e(ax(t,"storage-get"))},i.onsuccess=function(t){var e=t.target.result;n(e?e.value:void 0)}}catch(t){e(JD.create("storage-get",{originalErrorMessage:t&&t.message}))}})]}})})},fx.prototype.set=function(a,u){return Is(this,void 0,void 0,function(){var o,s=this;return Ts(this,function(t){switch(t.label){case 0:return[4,this.openDbPromise];case 1:return o=t.sent(),[2,new Promise(function(t,e){var n=o.transaction([ux],"readwrite").objectStore(ux),r=s.createCompositeKey(a);try{var i=n.put({compositeKey:r,value:u});i.onerror=function(t){e(ax(t,"storage-set"))},i.onsuccess=function(){t()}}catch(t){e(JD.create("storage-set",{originalErrorMessage:t&&t.message}))}})]}})})},fx.prototype.delete=function(a){return Is(this,void 0,void 0,function(){var o,s=this;return Ts(this,function(t){switch(t.label){case 0:return[4,this.openDbPromise];case 1:return o=t.sent(),[2,new Promise(function(t,e){var n=o.transaction([ux],"readwrite").objectStore(ux),r=s.createCompositeKey(a);try{var i=n.delete(r);i.onerror=function(t){e(ax(t,"storage-delete"))},i.onsuccess=function(){t()}}catch(t){e(JD.create("storage-delete",{originalErrorMessage:t&&t.message}))}})]}})})},fx.prototype.createCompositeKey=function(t){return[this.appId,this.appName,this.namespace,t].join()},fx);function fx(t,e,n,r){void 0===r&&(r=new Promise(function(e,n){var t=indexedDB.open(cx,hx);t.onerror=function(t){n(ax(t,"storage-open"))},t.onsuccess=function(t){e(t.target.result)},t.onupgradeneeded=function(t){var e=t.target.result;switch(t.oldVersion){case 0:e.createObjectStore(ux,{keyPath:"compositeKey"})}}})),this.appId=t,this.appName=e,this.namespace=n,this.openDbPromise=r}var px=(dx.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},dx.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},dx.prototype.getActiveConfig=function(){return this.activeConfig},dx.prototype.loadFromStorage=function(){return Is(this,void 0,void 0,function(){var e,n,r,i,o,s;return Ts(this,function(t){switch(t.label){case 0:return e=this.storage.getLastFetchStatus(),n=this.storage.getLastSuccessfulFetchTimestampMillis(),r=this.storage.getActiveConfig(),[4,e];case 1:return(i=t.sent())&&(this.lastFetchStatus=i),[4,n];case 2:return(o=t.sent())&&(this.lastSuccessfulFetchTimestampMillis=o),[4,r];case 3:return(s=t.sent())&&(this.activeConfig=s),[2]}})})},dx.prototype.setLastFetchStatus=function(t){return this.lastFetchStatus=t,this.storage.setLastFetchStatus(t)},dx.prototype.setLastSuccessfulFetchTimestampMillis=function(t){return this.lastSuccessfulFetchTimestampMillis=t,this.storage.setLastSuccessfulFetchTimestampMillis(t)},dx.prototype.setActiveConfig=function(t){return this.activeConfig=t,this.storage.setActiveConfig(t)},dx);function dx(t){this.storage=t}var vx=(yx.prototype.fetch=function(n){return Is(this,void 0,void 0,function(){var e;return Ts(this,function(t){switch(t.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return e=t.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(n,e)]}})})},yx.prototype.attemptFetch=function(i,t){var o=t.throttleEndTimeMillis,s=t.backoffCount;return Is(this,void 0,void 0,function(){var e,n,r;return Ts(this,function(t){switch(t.label){case 0:return[4,function(i,o){return new Promise(function(t,e){var n=Math.max(o-Date.now(),0),r=setTimeout(t,n);i.addEventListener(function(){clearTimeout(r),e(JD.create("fetch-throttle",{throttleEndTimeMillis:o}))})})}(i.signal,o)];case 1:t.sent(),t.label=2;case 2:return t.trys.push([2,5,,7]),[4,this.client.fetch(i)];case 3:return e=t.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return t.sent(),[2,e];case 5:if(!function(t){if(!(t instanceof Hs))return!1;var e=Number(t.httpStatus);return 429===e||500===e||503===e||504===e}(n=t.sent()))throw n;return r={throttleEndTimeMillis:Date.now()+function(t){var e=1e3*Math.pow(2,t),n=Math.round(.5*e*(Math.random()-.5)*2);return Math.min(144e5,e+n)}(s),backoffCount:s+1},[4,this.storage.setThrottleMetadata(r)];case 6:return t.sent(),[2,this.attemptFetch(i,r)];case 7:return[2]}})})},yx);function yx(t,e){this.client=t,this.storage=e}var gx,mx="@firebase/remote-config";return(gx=fl).INTERNAL.registerComponent(new pa("remoteConfig",function(t,e){var n=t.getProvider("app").getImmediate(),r=t.getProvider("installations").getImmediate();if("undefined"==typeof window)throw JD.create("registration-window");var i=n.options,o=i.projectId,s=i.apiKey,a=i.appId;if(!o)throw JD.create("registration-project-id");if(!s)throw JD.create("registration-api-key");if(!a)throw JD.create("registration-app-id");e=e||"firebase";var u=new lx(a,n.name,e),c=new px(u),h=new Ca(mx);h.logLevel=ma.ERROR;var l=new $D(r,gx.SDK_VERSION,e,o,s,a),f=new vx(l,u),p=new QD(f,u,c,h),d=new ox(n,p,c,u,h);return d.ensureInitialized(),d},"PUBLIC").setMultipleInstances(!0)),gx.registerVersion(mx,"0.1.13"),console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the CDN builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nhttps://www.gstatic.com/firebasejs/5.0.0/firebase-<PACKAGE>.js\n"),fl.registerVersion("firebase","7.9.1","cdn"),fl});
//# sourceMappingURL=firebase.js.map
